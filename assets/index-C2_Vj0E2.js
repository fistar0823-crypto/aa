var JM=Object.defineProperty;var eO=(n,e,t)=>e in n?JM(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var _e=(n,e,t)=>eO(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function D2(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Qy={exports:{}},wh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hw;function tO(){if(Hw)return wh;Hw=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,i,r){var l=null;if(r!==void 0&&(l=""+r),i.key!==void 0&&(l=""+i.key),"key"in i){r={};for(var c in i)c!=="key"&&(r[c]=i[c])}else r=i;return i=r.ref,{$$typeof:n,type:s,key:l,ref:i!==void 0?i:null,props:r}}return wh.Fragment=e,wh.jsx=t,wh.jsxs=t,wh}var qw;function nO(){return qw||(qw=1,Qy.exports=tO()),Qy.exports}var y=nO(),Xy={exports:{}},ze={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gw;function sO(){if(Gw)return ze;Gw=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),_=Symbol.iterator;function v(z){return z===null||typeof z!="object"?null:(z=_&&z[_]||z["@@iterator"],typeof z=="function"?z:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,E={};function R(z,se,he){this.props=z,this.context=se,this.refs=E,this.updater=he||T}R.prototype.isReactComponent={},R.prototype.setState=function(z,se){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,se,"setState")},R.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function k(){}k.prototype=R.prototype;function L(z,se,he){this.props=z,this.context=se,this.refs=E,this.updater=he||T}var O=L.prototype=new k;O.constructor=L,S(O,R.prototype),O.isPureReactComponent=!0;var H=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},U=Object.prototype.hasOwnProperty;function C(z,se,he,de,ye,Pe){return he=Pe.ref,{$$typeof:n,type:z,key:se,ref:he!==void 0?he:null,props:Pe}}function I(z,se){return C(z.type,se,void 0,void 0,void 0,z.props)}function N(z){return typeof z=="object"&&z!==null&&z.$$typeof===n}function V(z){var se={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(he){return se[he]})}var j=/\/+/g;function B(z,se){return typeof z=="object"&&z!==null&&z.key!=null?V(""+z.key):se.toString(36)}function M(){}function ne(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(M,M):(z.status="pending",z.then(function(se){z.status==="pending"&&(z.status="fulfilled",z.value=se)},function(se){z.status==="pending"&&(z.status="rejected",z.reason=se)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function be(z,se,he,de,ye){var Pe=typeof z;(Pe==="undefined"||Pe==="boolean")&&(z=null);var Ae=!1;if(z===null)Ae=!0;else switch(Pe){case"bigint":case"string":case"number":Ae=!0;break;case"object":switch(z.$$typeof){case n:case e:Ae=!0;break;case m:return Ae=z._init,be(Ae(z._payload),se,he,de,ye)}}if(Ae)return ye=ye(z),Ae=de===""?"."+B(z,0):de,H(ye)?(he="",Ae!=null&&(he=Ae.replace(j,"$&/")+"/"),be(ye,se,he,"",function(zt){return zt})):ye!=null&&(N(ye)&&(ye=I(ye,he+(ye.key==null||z&&z.key===ye.key?"":(""+ye.key).replace(j,"$&/")+"/")+Ae)),se.push(ye)),1;Ae=0;var Ct=de===""?".":de+":";if(H(z))for(var tt=0;tt<z.length;tt++)de=z[tt],Pe=Ct+B(de,tt),Ae+=be(de,se,he,Pe,ye);else if(tt=v(z),typeof tt=="function")for(z=tt.call(z),tt=0;!(de=z.next()).done;)de=de.value,Pe=Ct+B(de,tt++),Ae+=be(de,se,he,Pe,ye);else if(Pe==="object"){if(typeof z.then=="function")return be(ne(z),se,he,de,ye);throw se=String(z),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return Ae}function Y(z,se,he){if(z==null)return z;var de=[],ye=0;return be(z,de,"","",function(Pe){return se.call(he,Pe,ye++)}),de}function ae(z){if(z._status===-1){var se=z._result;se=se(),se.then(function(he){(z._status===0||z._status===-1)&&(z._status=1,z._result=he)},function(he){(z._status===0||z._status===-1)&&(z._status=2,z._result=he)}),z._status===-1&&(z._status=0,z._result=se)}if(z._status===1)return z._result.default;throw z._result}var me=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)};function Ce(){}return ze.Children={map:Y,forEach:function(z,se,he){Y(z,function(){se.apply(this,arguments)},he)},count:function(z){var se=0;return Y(z,function(){se++}),se},toArray:function(z){return Y(z,function(se){return se})||[]},only:function(z){if(!N(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},ze.Component=R,ze.Fragment=t,ze.Profiler=i,ze.PureComponent=L,ze.StrictMode=s,ze.Suspense=h,ze.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,ze.__COMPILER_RUNTIME={__proto__:null,c:function(z){return F.H.useMemoCache(z)}},ze.cache=function(z){return function(){return z.apply(null,arguments)}},ze.cloneElement=function(z,se,he){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var de=S({},z.props),ye=z.key,Pe=void 0;if(se!=null)for(Ae in se.ref!==void 0&&(Pe=void 0),se.key!==void 0&&(ye=""+se.key),se)!U.call(se,Ae)||Ae==="key"||Ae==="__self"||Ae==="__source"||Ae==="ref"&&se.ref===void 0||(de[Ae]=se[Ae]);var Ae=arguments.length-2;if(Ae===1)de.children=he;else if(1<Ae){for(var Ct=Array(Ae),tt=0;tt<Ae;tt++)Ct[tt]=arguments[tt+2];de.children=Ct}return C(z.type,ye,void 0,void 0,Pe,de)},ze.createContext=function(z){return z={$$typeof:l,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:r,_context:z},z},ze.createElement=function(z,se,he){var de,ye={},Pe=null;if(se!=null)for(de in se.key!==void 0&&(Pe=""+se.key),se)U.call(se,de)&&de!=="key"&&de!=="__self"&&de!=="__source"&&(ye[de]=se[de]);var Ae=arguments.length-2;if(Ae===1)ye.children=he;else if(1<Ae){for(var Ct=Array(Ae),tt=0;tt<Ae;tt++)Ct[tt]=arguments[tt+2];ye.children=Ct}if(z&&z.defaultProps)for(de in Ae=z.defaultProps,Ae)ye[de]===void 0&&(ye[de]=Ae[de]);return C(z,Pe,void 0,void 0,null,ye)},ze.createRef=function(){return{current:null}},ze.forwardRef=function(z){return{$$typeof:c,render:z}},ze.isValidElement=N,ze.lazy=function(z){return{$$typeof:m,_payload:{_status:-1,_result:z},_init:ae}},ze.memo=function(z,se){return{$$typeof:d,type:z,compare:se===void 0?null:se}},ze.startTransition=function(z){var se=F.T,he={};F.T=he;try{var de=z(),ye=F.S;ye!==null&&ye(he,de),typeof de=="object"&&de!==null&&typeof de.then=="function"&&de.then(Ce,me)}catch(Pe){me(Pe)}finally{F.T=se}},ze.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},ze.use=function(z){return F.H.use(z)},ze.useActionState=function(z,se,he){return F.H.useActionState(z,se,he)},ze.useCallback=function(z,se){return F.H.useCallback(z,se)},ze.useContext=function(z){return F.H.useContext(z)},ze.useDebugValue=function(){},ze.useDeferredValue=function(z,se){return F.H.useDeferredValue(z,se)},ze.useEffect=function(z,se,he){var de=F.H;if(typeof he=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return de.useEffect(z,se)},ze.useId=function(){return F.H.useId()},ze.useImperativeHandle=function(z,se,he){return F.H.useImperativeHandle(z,se,he)},ze.useInsertionEffect=function(z,se){return F.H.useInsertionEffect(z,se)},ze.useLayoutEffect=function(z,se){return F.H.useLayoutEffect(z,se)},ze.useMemo=function(z,se){return F.H.useMemo(z,se)},ze.useOptimistic=function(z,se){return F.H.useOptimistic(z,se)},ze.useReducer=function(z,se,he){return F.H.useReducer(z,se,he)},ze.useRef=function(z){return F.H.useRef(z)},ze.useState=function(z){return F.H.useState(z)},ze.useSyncExternalStore=function(z,se,he){return F.H.useSyncExternalStore(z,se,he)},ze.useTransition=function(){return F.H.useTransition()},ze.version="19.1.1",ze}var $w;function Ub(){return $w||($w=1,Xy.exports=sO()),Xy.exports}var ue=Ub();const iO=D2(ue);var Zy={exports:{}},Sh={},Jy={exports:{}},e0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ww;function rO(){return Ww||(Ww=1,(function(n){function e(Y,ae){var me=Y.length;Y.push(ae);e:for(;0<me;){var Ce=me-1>>>1,z=Y[Ce];if(0<i(z,ae))Y[Ce]=ae,Y[me]=z,me=Ce;else break e}}function t(Y){return Y.length===0?null:Y[0]}function s(Y){if(Y.length===0)return null;var ae=Y[0],me=Y.pop();if(me!==ae){Y[0]=me;e:for(var Ce=0,z=Y.length,se=z>>>1;Ce<se;){var he=2*(Ce+1)-1,de=Y[he],ye=he+1,Pe=Y[ye];if(0>i(de,me))ye<z&&0>i(Pe,de)?(Y[Ce]=Pe,Y[ye]=me,Ce=ye):(Y[Ce]=de,Y[he]=me,Ce=he);else if(ye<z&&0>i(Pe,me))Y[Ce]=Pe,Y[ye]=me,Ce=ye;else break e}}return ae}function i(Y,ae){var me=Y.sortIndex-ae.sortIndex;return me!==0?me:Y.id-ae.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var l=Date,c=l.now();n.unstable_now=function(){return l.now()-c}}var h=[],d=[],m=1,_=null,v=3,T=!1,S=!1,E=!1,R=!1,k=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function H(Y){for(var ae=t(d);ae!==null;){if(ae.callback===null)s(d);else if(ae.startTime<=Y)s(d),ae.sortIndex=ae.expirationTime,e(h,ae);else break;ae=t(d)}}function F(Y){if(E=!1,H(Y),!S)if(t(h)!==null)S=!0,U||(U=!0,B());else{var ae=t(d);ae!==null&&be(F,ae.startTime-Y)}}var U=!1,C=-1,I=5,N=-1;function V(){return R?!0:!(n.unstable_now()-N<I)}function j(){if(R=!1,U){var Y=n.unstable_now();N=Y;var ae=!0;try{e:{S=!1,E&&(E=!1,L(C),C=-1),T=!0;var me=v;try{t:{for(H(Y),_=t(h);_!==null&&!(_.expirationTime>Y&&V());){var Ce=_.callback;if(typeof Ce=="function"){_.callback=null,v=_.priorityLevel;var z=Ce(_.expirationTime<=Y);if(Y=n.unstable_now(),typeof z=="function"){_.callback=z,H(Y),ae=!0;break t}_===t(h)&&s(h),H(Y)}else s(h);_=t(h)}if(_!==null)ae=!0;else{var se=t(d);se!==null&&be(F,se.startTime-Y),ae=!1}}break e}finally{_=null,v=me,T=!1}ae=void 0}}finally{ae?B():U=!1}}}var B;if(typeof O=="function")B=function(){O(j)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,ne=M.port2;M.port1.onmessage=j,B=function(){ne.postMessage(null)}}else B=function(){k(j,0)};function be(Y,ae){C=k(function(){Y(n.unstable_now())},ae)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Y){Y.callback=null},n.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<Y?Math.floor(1e3/Y):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_next=function(Y){switch(v){case 1:case 2:case 3:var ae=3;break;default:ae=v}var me=v;v=ae;try{return Y()}finally{v=me}},n.unstable_requestPaint=function(){R=!0},n.unstable_runWithPriority=function(Y,ae){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var me=v;v=Y;try{return ae()}finally{v=me}},n.unstable_scheduleCallback=function(Y,ae,me){var Ce=n.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?Ce+me:Ce):me=Ce,Y){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=me+z,Y={id:m++,callback:ae,priorityLevel:Y,startTime:me,expirationTime:z,sortIndex:-1},me>Ce?(Y.sortIndex=me,e(d,Y),t(h)===null&&Y===t(d)&&(E?(L(C),C=-1):E=!0,be(F,me-Ce))):(Y.sortIndex=z,e(h,Y),S||T||(S=!0,U||(U=!0,B()))),Y},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(Y){var ae=v;return function(){var me=v;v=ae;try{return Y.apply(this,arguments)}finally{v=me}}}})(e0)),e0}var Yw;function aO(){return Yw||(Yw=1,Jy.exports=rO()),Jy.exports}var t0={exports:{}},kn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kw;function oO(){if(Kw)return kn;Kw=1;var n=Ub();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function r(h,d,m){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:_==null?null:""+_,children:h,containerInfo:d,implementation:m}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return kn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,kn.createPortal=function(h,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return r(h,d,null,m)},kn.flushSync=function(h){var d=l.T,m=s.p;try{if(l.T=null,s.p=2,h)return h()}finally{l.T=d,s.p=m,s.d.f()}},kn.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,s.d.C(h,d))},kn.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},kn.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var m=d.as,_=c(m,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,T=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?s.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:_,integrity:v,fetchPriority:T}):m==="script"&&s.d.X(h,{crossOrigin:_,integrity:v,fetchPriority:T,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},kn.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=c(d.as,d.crossOrigin);s.d.M(h,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&s.d.M(h)},kn.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,_=c(m,d.crossOrigin);s.d.L(h,m,{crossOrigin:_,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},kn.preloadModule=function(h,d){if(typeof h=="string")if(d){var m=c(d.as,d.crossOrigin);s.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else s.d.m(h)},kn.requestFormReset=function(h){s.d.r(h)},kn.unstable_batchedUpdates=function(h,d){return h(d)},kn.useFormState=function(h,d,m){return l.H.useFormState(h,d,m)},kn.useFormStatus=function(){return l.H.useHostTransitionStatus()},kn.version="19.1.1",kn}var Qw;function lO(){if(Qw)return t0.exports;Qw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),t0.exports=oO(),t0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xw;function cO(){if(Xw)return Sh;Xw=1;var n=aO(),e=Ub(),t=lO();function s(a){var o="https://react.dev/errors/"+a;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+a+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function r(a){var o=a,u=a;if(a.alternate)for(;o.return;)o=o.return;else{a=o;do o=a,(o.flags&4098)!==0&&(u=o.return),a=o.return;while(a)}return o.tag===3?u:null}function l(a){if(a.tag===13){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function c(a){if(r(a)!==a)throw Error(s(188))}function h(a){var o=a.alternate;if(!o){if(o=r(a),o===null)throw Error(s(188));return o!==a?null:a}for(var u=a,f=o;;){var p=u.return;if(p===null)break;var b=p.alternate;if(b===null){if(f=p.return,f!==null){u=f;continue}break}if(p.child===b.child){for(b=p.child;b;){if(b===u)return c(p),a;if(b===f)return c(p),o;b=b.sibling}throw Error(s(188))}if(u.return!==f.return)u=p,f=b;else{for(var A=!1,D=p.child;D;){if(D===u){A=!0,u=p,f=b;break}if(D===f){A=!0,f=p,u=b;break}D=D.sibling}if(!A){for(D=b.child;D;){if(D===u){A=!0,u=b,f=p;break}if(D===f){A=!0,f=b,u=p;break}D=D.sibling}if(!A)throw Error(s(189))}}if(u.alternate!==f)throw Error(s(190))}if(u.tag!==3)throw Error(s(188));return u.stateNode.current===u?a:o}function d(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a;for(a=a.child;a!==null;){if(o=d(a),o!==null)return o;a=a.sibling}return null}var m=Object.assign,_=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),L=Symbol.for("react.consumer"),O=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),j=Symbol.iterator;function B(a){return a===null||typeof a!="object"?null:(a=j&&a[j]||a["@@iterator"],typeof a=="function"?a:null)}var M=Symbol.for("react.client.reference");function ne(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===M?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case S:return"Fragment";case R:return"Profiler";case E:return"StrictMode";case F:return"Suspense";case U:return"SuspenseList";case N:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case T:return"Portal";case O:return(a.displayName||"Context")+".Provider";case L:return(a._context.displayName||"Context")+".Consumer";case H:var o=a.render;return a=a.displayName,a||(a=o.displayName||o.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case C:return o=a.displayName||null,o!==null?o:ne(a.type)||"Memo";case I:o=a._payload,a=a._init;try{return ne(a(o))}catch{}}return null}var be=Array.isArray,Y=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me={pending:!1,data:null,method:null,action:null},Ce=[],z=-1;function se(a){return{current:a}}function he(a){0>z||(a.current=Ce[z],Ce[z]=null,z--)}function de(a,o){z++,Ce[z]=a.current,a.current=o}var ye=se(null),Pe=se(null),Ae=se(null),Ct=se(null);function tt(a,o){switch(de(Ae,o),de(Pe,a),de(ye,null),o.nodeType){case 9:case 11:a=(a=o.documentElement)&&(a=a.namespaceURI)?_w(a):0;break;default:if(a=o.tagName,o=o.namespaceURI)o=_w(o),a=yw(o,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}he(ye),de(ye,a)}function zt(){he(ye),he(Pe),he(Ae)}function wr(a){a.memoizedState!==null&&de(Ct,a);var o=ye.current,u=yw(o,a.type);o!==u&&(de(Pe,a),de(ye,u))}function ti(a){Pe.current===a&&(he(ye),he(Pe)),Ct.current===a&&(he(Ct),bh._currentValue=me)}var ki=Object.prototype.hasOwnProperty,Mi=n.unstable_scheduleCallback,Sr=n.unstable_cancelCallback,Xp=n.unstable_shouldYield,bu=n.unstable_requestPaint,Xn=n.unstable_now,df=n.unstable_getCurrentPriorityLevel,sn=n.unstable_ImmediatePriority,fn=n.unstable_UserBlockingPriority,Oi=n.unstable_NormalPriority,Zp=n.unstable_LowPriority,vu=n.unstable_IdlePriority,Jp=n.log,eo=n.unstable_setDisableYieldValue,Ar=null,Cn=null;function bs(a){if(typeof Jp=="function"&&eo(a),Cn&&typeof Cn.setStrictMode=="function")try{Cn.setStrictMode(Ar,a)}catch{}}var zn=Math.clz32?Math.clz32:mf,e_=Math.log,ff=Math.LN2;function mf(a){return a>>>=0,a===0?32:31-(e_(a)/ff|0)|0}var ni=256,Ir=4194304;function Ls(a){var o=a&42;if(o!==0)return o;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function vs(a,o,u){var f=a.pendingLanes;if(f===0)return 0;var p=0,b=a.suspendedLanes,A=a.pingedLanes;a=a.warmLanes;var D=f&134217727;return D!==0?(f=D&~b,f!==0?p=Ls(f):(A&=D,A!==0?p=Ls(A):u||(u=D&~a,u!==0&&(p=Ls(u))))):(D=f&~b,D!==0?p=Ls(D):A!==0?p=Ls(A):u||(u=f&~a,u!==0&&(p=Ls(u)))),p===0?0:o!==0&&o!==p&&(o&b)===0&&(b=p&-p,u=o&-o,b>=u||b===32&&(u&4194048)!==0)?o:p}function Rr(a,o){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&o)===0}function Al(a,o){switch(a){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xu(){var a=ni;return ni<<=1,(ni&4194048)===0&&(ni=256),a}function Cr(){var a=Ir;return Ir<<=1,(Ir&62914560)===0&&(Ir=4194304),a}function Il(a){for(var o=[],u=0;31>u;u++)o.push(a);return o}function Ht(a,o){a.pendingLanes|=o,o!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function gf(a,o,u,f,p,b){var A=a.pendingLanes;a.pendingLanes=u,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=u,a.entangledLanes&=u,a.errorRecoveryDisabledLanes&=u,a.shellSuspendCounter=0;var D=a.entanglements,q=a.expirationTimes,X=a.hiddenUpdates;for(u=A&~u;0<u;){var ie=31-zn(u),oe=1<<ie;D[ie]=0,q[ie]=-1;var Z=X[ie];if(Z!==null)for(X[ie]=null,ie=0;ie<Z.length;ie++){var J=Z[ie];J!==null&&(J.lane&=-536870913)}u&=~oe}f!==0&&Dr(a,f,0),b!==0&&p===0&&a.tag!==0&&(a.suspendedLanes|=b&~(A&~o))}function Dr(a,o,u){a.pendingLanes|=o,a.suspendedLanes&=~o;var f=31-zn(o);a.entangledLanes|=o,a.entanglements[f]=a.entanglements[f]|1073741824|u&4194090}function Nr(a,o){var u=a.entangledLanes|=o;for(a=a.entanglements;u;){var f=31-zn(u),p=1<<f;p&o|a[f]&o&&(a[f]|=o),u&=~p}}function Tu(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Eu(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Pi(){var a=ae.p;return a!==0?a:(a=window.event,a===void 0?32:Lw(a.type))}function t_(a,o){var u=ae.p;try{return ae.p=a,o()}finally{ae.p=u}}var si=Math.random().toString(36).slice(2),qt="__reactFiber$"+si,xn="__reactProps$"+si,Vi="__reactContainer$"+si,to="__reactEvents$"+si,no="__reactListeners$"+si,n_="__reactHandles$"+si,js="__reactResources$"+si,kr="__reactMarker$"+si;function Rl(a){delete a[qt],delete a[xn],delete a[to],delete a[no],delete a[n_]}function ii(a){var o=a[qt];if(o)return o;for(var u=a.parentNode;u;){if(o=u[Vi]||u[qt]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(a=Tw(a);a!==null;){if(u=a[qt])return u;a=Tw(a)}return o}a=u,u=a.parentNode}return null}function ri(a){if(a=a[qt]||a[Vi]){var o=a.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return a}return null}function Mr(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a.stateNode;throw Error(s(33))}function Or(a){var o=a[js];return o||(o=a[js]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Gt(a){a[kr]=!0}var pf=new Set,so={};function ai(a,o){oi(a,o),oi(a+"Capture",o)}function oi(a,o){for(so[a]=o,a=0;a<o.length;a++)pf.add(o[a])}var io=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),li={},Cl={};function s_(a){return ki.call(Cl,a)?!0:ki.call(li,a)?!1:io.test(a)?Cl[a]=!0:(li[a]=!0,!1)}function ro(a,o,u){if(s_(o))if(u===null)a.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":a.removeAttribute(o);return;case"boolean":var f=o.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){a.removeAttribute(o);return}}a.setAttribute(o,""+u)}}function ao(a,o,u){if(u===null)a.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(o);return}a.setAttribute(o,""+u)}}function xs(a,o,u,f){if(f===null)a.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(u);return}a.setAttributeNS(o,u,""+f)}}var oo,Dl;function Li(a){if(oo===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);oo=o&&o[1]||"",Dl=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+oo+a+Dl}var Nl=!1;function kl(a,o){if(!a||Nl)return"";Nl=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(o){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(J){var Z=J}Reflect.construct(a,[],oe)}else{try{oe.call()}catch(J){Z=J}a.call(oe.prototype)}}else{try{throw Error()}catch(J){Z=J}(oe=a())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(J){if(J&&Z&&typeof J.stack=="string")return[J.stack,Z.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=f.DetermineComponentFrameRoot(),A=b[0],D=b[1];if(A&&D){var q=A.split(`
`),X=D.split(`
`);for(p=f=0;f<q.length&&!q[f].includes("DetermineComponentFrameRoot");)f++;for(;p<X.length&&!X[p].includes("DetermineComponentFrameRoot");)p++;if(f===q.length||p===X.length)for(f=q.length-1,p=X.length-1;1<=f&&0<=p&&q[f]!==X[p];)p--;for(;1<=f&&0<=p;f--,p--)if(q[f]!==X[p]){if(f!==1||p!==1)do if(f--,p--,0>p||q[f]!==X[p]){var ie=`
`+q[f].replace(" at new "," at ");return a.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",a.displayName)),ie}while(1<=f&&0<=p);break}}}finally{Nl=!1,Error.prepareStackTrace=u}return(u=a?a.displayName||a.name:"")?Li(u):""}function i_(a){switch(a.tag){case 26:case 27:case 5:return Li(a.type);case 16:return Li("Lazy");case 13:return Li("Suspense");case 19:return Li("SuspenseList");case 0:case 15:return kl(a.type,!1);case 11:return kl(a.type.render,!1);case 1:return kl(a.type,!0);case 31:return Li("Activity");default:return""}}function Us(a){try{var o="";do o+=i_(a),a=a.return;while(a);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function Vt(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Pr(a){var o=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function lo(a){var o=Pr(a)?"checked":"value",u=Object.getOwnPropertyDescriptor(a.constructor.prototype,o),f=""+a[o];if(!a.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var p=u.get,b=u.set;return Object.defineProperty(a,o,{configurable:!0,get:function(){return p.call(this)},set:function(A){f=""+A,b.call(this,A)}}),Object.defineProperty(a,o,{enumerable:u.enumerable}),{getValue:function(){return f},setValue:function(A){f=""+A},stopTracking:function(){a._valueTracker=null,delete a[o]}}}}function Vr(a){a._valueTracker||(a._valueTracker=lo(a))}function gt(a){if(!a)return!1;var o=a._valueTracker;if(!o)return!0;var u=o.getValue(),f="";return a&&(f=Pr(a)?a.checked?"true":"false":a.value),a=f,a!==u?(o.setValue(a),!0):!1}function ji(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var co=/[\n"\\]/g;function mn(a){return a.replace(co,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function wu(a,o,u,f,p,b,A,D){a.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?a.type=A:a.removeAttribute("type"),o!=null?A==="number"?(o===0&&a.value===""||a.value!=o)&&(a.value=""+Vt(o)):a.value!==""+Vt(o)&&(a.value=""+Vt(o)):A!=="submit"&&A!=="reset"||a.removeAttribute("value"),o!=null?Au(a,A,Vt(o)):u!=null?Au(a,A,Vt(u)):f!=null&&a.removeAttribute("value"),p==null&&b!=null&&(a.defaultChecked=!!b),p!=null&&(a.checked=p&&typeof p!="function"&&typeof p!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?a.name=""+Vt(D):a.removeAttribute("name")}function Su(a,o,u,f,p,b,A,D){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(a.type=b),o!=null||u!=null){if(!(b!=="submit"&&b!=="reset"||o!=null))return;u=u!=null?""+Vt(u):"",o=o!=null?""+Vt(o):u,D||o===a.value||(a.value=o),a.defaultValue=o}f=f??p,f=typeof f!="function"&&typeof f!="symbol"&&!!f,a.checked=D?a.checked:!!f,a.defaultChecked=!!f,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(a.name=A)}function Au(a,o,u){o==="number"&&ji(a.ownerDocument)===a||a.defaultValue===""+u||(a.defaultValue=""+u)}function Lr(a,o,u,f){if(a=a.options,o){o={};for(var p=0;p<u.length;p++)o["$"+u[p]]=!0;for(u=0;u<a.length;u++)p=o.hasOwnProperty("$"+a[u].value),a[u].selected!==p&&(a[u].selected=p),p&&f&&(a[u].defaultSelected=!0)}else{for(u=""+Vt(u),o=null,p=0;p<a.length;p++){if(a[p].value===u){a[p].selected=!0,f&&(a[p].defaultSelected=!0);return}o!==null||a[p].disabled||(o=a[p])}o!==null&&(o.selected=!0)}}function _f(a,o,u){if(o!=null&&(o=""+Vt(o),o!==a.value&&(a.value=o),u==null)){a.defaultValue!==o&&(a.defaultValue=o);return}a.defaultValue=u!=null?""+Vt(u):""}function yf(a,o,u,f){if(o==null){if(f!=null){if(u!=null)throw Error(s(92));if(be(f)){if(1<f.length)throw Error(s(93));f=f[0]}u=f}u==null&&(u=""),o=u}u=Vt(o),a.defaultValue=u,f=a.textContent,f===u&&f!==""&&f!==null&&(a.value=f)}function Ts(a,o){if(o){var u=a.firstChild;if(u&&u===a.lastChild&&u.nodeType===3){u.nodeValue=o;return}}a.textContent=o}var Ui=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Iu(a,o,u){var f=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?f?a.setProperty(o,""):o==="float"?a.cssFloat="":a[o]="":f?a.setProperty(o,u):typeof u!="number"||u===0||Ui.has(o)?o==="float"?a.cssFloat=u:a[o]=(""+u).trim():a[o]=u+"px"}function Ru(a,o,u){if(o!=null&&typeof o!="object")throw Error(s(62));if(a=a.style,u!=null){for(var f in u)!u.hasOwnProperty(f)||o!=null&&o.hasOwnProperty(f)||(f.indexOf("--")===0?a.setProperty(f,""):f==="float"?a.cssFloat="":a[f]="");for(var p in o)f=o[p],o.hasOwnProperty(p)&&u[p]!==f&&Iu(a,p,f)}else for(var b in o)o.hasOwnProperty(b)&&Iu(a,b,o[b])}function Ml(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),vf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Bs(a){return vf.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var Cu=null;function Du(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var jr=null,Hn=null;function xf(a){var o=ri(a);if(o&&(a=o.stateNode)){var u=a[xn]||null;e:switch(a=o.stateNode,o.type){case"input":if(wu(a,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=a;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+mn(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var f=u[o];if(f!==a&&f.form===a.form){var p=f[xn]||null;if(!p)throw Error(s(90));wu(f,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(o=0;o<u.length;o++)f=u[o],f.form===a.form&&gt(f)}break e;case"textarea":_f(a,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&Lr(a,!!u.multiple,o,!1)}}}var uo=!1;function ho(a,o,u){if(uo)return a(o,u);uo=!0;try{var f=a(o);return f}finally{if(uo=!1,(jr!==null||Hn!==null)&&(um(),jr&&(o=jr,a=Hn,Hn=jr=null,xf(o),a)))for(o=0;o<a.length;o++)xf(a[o])}}function Ur(a,o){var u=a.stateNode;if(u===null)return null;var f=u[xn]||null;if(f===null)return null;u=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(a=a.type,f=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!f;break e;default:a=!1}if(a)return null;if(u&&typeof u!="function")throw Error(s(231,o,typeof u));return u}var qn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bi=!1;if(qn)try{var Br={};Object.defineProperty(Br,"passive",{get:function(){Bi=!0}}),window.addEventListener("test",Br,Br),window.removeEventListener("test",Br,Br)}catch{Bi=!1}var Es=null,vt=null,Ol=null;function Tf(){if(Ol)return Ol;var a,o=vt,u=o.length,f,p="value"in Es?Es.value:Es.textContent,b=p.length;for(a=0;a<u&&o[a]===p[a];a++);var A=u-a;for(f=1;f<=A&&o[u-f]===p[b-f];f++);return Ol=p.slice(a,1<f?1-f:void 0)}function fo(a){var o=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&o===13&&(a=13)):a=o,a===10&&(a=13),32<=a||a===13?a:0}function mo(){return!0}function Nu(){return!1}function rn(a){function o(u,f,p,b,A){this._reactName=u,this._targetInst=p,this.type=f,this.nativeEvent=b,this.target=A,this.currentTarget=null;for(var D in a)a.hasOwnProperty(D)&&(u=a[D],this[D]=u?u(b):b[D]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?mo:Nu,this.isPropagationStopped=Nu,this}return m(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=mo)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=mo)},persist:function(){},isPersistent:mo}),o}var Dn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},go=rn(Dn),po=m({},Dn,{view:0,detail:0}),_o=rn(po),Pl,yo,ci,bo=m({},po,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jl,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==ci&&(ci&&a.type==="mousemove"?(Pl=a.screenX-ci.screenX,yo=a.screenY-ci.screenY):yo=Pl=0,ci=a),Pl)},movementY:function(a){return"movementY"in a?a.movementY:yo}}),vo=rn(bo),r_=m({},bo,{dataTransfer:0}),Ef=rn(r_),xo=m({},po,{relatedTarget:0}),Vl=rn(xo),wf=m({},Dn,{animationName:0,elapsedTime:0,pseudoElement:0}),ku=rn(wf),Mu=m({},Dn,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Sf=rn(Mu),Ll=m({},Dn,{data:0}),Ou=rn(Ll),Af={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},If={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rf(a){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(a):(a=If[a])?!!o[a]:!1}function jl(){return Rf}var Cf=m({},po,{key:function(a){if(a.key){var o=Af[a.key]||a.key;if(o!=="Unidentified")return o}return a.type==="keypress"?(a=fo(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Fi[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jl,charCode:function(a){return a.type==="keypress"?fo(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?fo(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Ul=rn(Cf),Gn=m({},bo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pu=rn(Gn),Df=m({},po,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jl}),Fr=rn(Df),g=m({},Dn,{propertyName:0,elapsedTime:0,pseudoElement:0}),x=rn(g),w=m({},bo,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),P=rn(w),Q=m({},Dn,{newState:0,oldState:0}),te=rn(Q),ge=[9,13,27,32],Le=qn&&"CompositionEvent"in window,At=null;qn&&"documentMode"in document&&(At=document.documentMode);var ct=qn&&"TextEvent"in window&&!At,$t=qn&&(!Le||At&&8<At&&11>=At),as=" ",ui=!1;function Fs(a,o){switch(a){case"keyup":return ge.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zs(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Hs=!1;function Vu(a,o){switch(a){case"compositionend":return zs(o);case"keypress":return o.which!==32?null:(ui=!0,as);case"textInput":return a=o.data,a===as&&ui?null:a;default:return null}}function Ak(a,o){if(Hs)return a==="compositionend"||!Le&&Fs(a,o)?(a=Tf(),Ol=vt=Es=null,Hs=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return $t&&o.locale!=="ko"?null:o.data;default:return null}}var Ik={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nx(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o==="input"?!!Ik[a.type]:o==="textarea"}function kx(a,o,u,f){jr?Hn?Hn.push(f):Hn=[f]:jr=f,o=pm(o,"onChange"),0<o.length&&(u=new go("onChange","change",null,u,f),a.push({event:u,listeners:o}))}var Lu=null,ju=null;function Rk(a){dw(a,0)}function Nf(a){var o=Mr(a);if(gt(o))return a}function Mx(a,o){if(a==="change")return o}var Ox=!1;if(qn){var a_;if(qn){var o_="oninput"in document;if(!o_){var Px=document.createElement("div");Px.setAttribute("oninput","return;"),o_=typeof Px.oninput=="function"}a_=o_}else a_=!1;Ox=a_&&(!document.documentMode||9<document.documentMode)}function Vx(){Lu&&(Lu.detachEvent("onpropertychange",Lx),ju=Lu=null)}function Lx(a){if(a.propertyName==="value"&&Nf(ju)){var o=[];kx(o,ju,a,Du(a)),ho(Rk,o)}}function Ck(a,o,u){a==="focusin"?(Vx(),Lu=o,ju=u,Lu.attachEvent("onpropertychange",Lx)):a==="focusout"&&Vx()}function Dk(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Nf(ju)}function Nk(a,o){if(a==="click")return Nf(o)}function kk(a,o){if(a==="input"||a==="change")return Nf(o)}function Mk(a,o){return a===o&&(a!==0||1/a===1/o)||a!==a&&o!==o}var os=typeof Object.is=="function"?Object.is:Mk;function Uu(a,o){if(os(a,o))return!0;if(typeof a!="object"||a===null||typeof o!="object"||o===null)return!1;var u=Object.keys(a),f=Object.keys(o);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var p=u[f];if(!ki.call(o,p)||!os(a[p],o[p]))return!1}return!0}function jx(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Ux(a,o){var u=jx(a);a=0;for(var f;u;){if(u.nodeType===3){if(f=a+u.textContent.length,a<=o&&f>=o)return{node:u,offset:o-a};a=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=jx(u)}}function Bx(a,o){return a&&o?a===o?!0:a&&a.nodeType===3?!1:o&&o.nodeType===3?Bx(a,o.parentNode):"contains"in a?a.contains(o):a.compareDocumentPosition?!!(a.compareDocumentPosition(o)&16):!1:!1}function Fx(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var o=ji(a.document);o instanceof a.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)a=o.contentWindow;else break;o=ji(a.document)}return o}function l_(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o&&(o==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||o==="textarea"||a.contentEditable==="true")}var Ok=qn&&"documentMode"in document&&11>=document.documentMode,Bl=null,c_=null,Bu=null,u_=!1;function zx(a,o,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;u_||Bl==null||Bl!==ji(f)||(f=Bl,"selectionStart"in f&&l_(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Bu&&Uu(Bu,f)||(Bu=f,f=pm(c_,"onSelect"),0<f.length&&(o=new go("onSelect","select",null,o,u),a.push({event:o,listeners:f}),o.target=Bl)))}function To(a,o){var u={};return u[a.toLowerCase()]=o.toLowerCase(),u["Webkit"+a]="webkit"+o,u["Moz"+a]="moz"+o,u}var Fl={animationend:To("Animation","AnimationEnd"),animationiteration:To("Animation","AnimationIteration"),animationstart:To("Animation","AnimationStart"),transitionrun:To("Transition","TransitionRun"),transitionstart:To("Transition","TransitionStart"),transitioncancel:To("Transition","TransitionCancel"),transitionend:To("Transition","TransitionEnd")},h_={},Hx={};qn&&(Hx=document.createElement("div").style,"AnimationEvent"in window||(delete Fl.animationend.animation,delete Fl.animationiteration.animation,delete Fl.animationstart.animation),"TransitionEvent"in window||delete Fl.transitionend.transition);function Eo(a){if(h_[a])return h_[a];if(!Fl[a])return a;var o=Fl[a],u;for(u in o)if(o.hasOwnProperty(u)&&u in Hx)return h_[a]=o[u];return a}var qx=Eo("animationend"),Gx=Eo("animationiteration"),$x=Eo("animationstart"),Pk=Eo("transitionrun"),Vk=Eo("transitionstart"),Lk=Eo("transitioncancel"),Wx=Eo("transitionend"),Yx=new Map,d_="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");d_.push("scrollEnd");function qs(a,o){Yx.set(a,o),ai(o,[a])}var Kx=new WeakMap;function ws(a,o){if(typeof a=="object"&&a!==null){var u=Kx.get(a);return u!==void 0?u:(o={value:a,source:o,stack:Us(o)},Kx.set(a,o),o)}return{value:a,source:o,stack:Us(o)}}var Ss=[],zl=0,f_=0;function kf(){for(var a=zl,o=f_=zl=0;o<a;){var u=Ss[o];Ss[o++]=null;var f=Ss[o];Ss[o++]=null;var p=Ss[o];Ss[o++]=null;var b=Ss[o];if(Ss[o++]=null,f!==null&&p!==null){var A=f.pending;A===null?p.next=p:(p.next=A.next,A.next=p),f.pending=p}b!==0&&Qx(u,p,b)}}function Mf(a,o,u,f){Ss[zl++]=a,Ss[zl++]=o,Ss[zl++]=u,Ss[zl++]=f,f_|=f,a.lanes|=f,a=a.alternate,a!==null&&(a.lanes|=f)}function m_(a,o,u,f){return Mf(a,o,u,f),Of(a)}function Hl(a,o){return Mf(a,null,null,o),Of(a)}function Qx(a,o,u){a.lanes|=u;var f=a.alternate;f!==null&&(f.lanes|=u);for(var p=!1,b=a.return;b!==null;)b.childLanes|=u,f=b.alternate,f!==null&&(f.childLanes|=u),b.tag===22&&(a=b.stateNode,a===null||a._visibility&1||(p=!0)),a=b,b=b.return;return a.tag===3?(b=a.stateNode,p&&o!==null&&(p=31-zn(u),a=b.hiddenUpdates,f=a[p],f===null?a[p]=[o]:f.push(o),o.lane=u|536870912),b):null}function Of(a){if(50<hh)throw hh=0,vy=null,Error(s(185));for(var o=a.return;o!==null;)a=o,o=a.return;return a.tag===3?a.stateNode:null}var ql={};function jk(a,o,u,f){this.tag=a,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ls(a,o,u,f){return new jk(a,o,u,f)}function g_(a){return a=a.prototype,!(!a||!a.isReactComponent)}function zi(a,o){var u=a.alternate;return u===null?(u=ls(a.tag,o,a.key,a.mode),u.elementType=a.elementType,u.type=a.type,u.stateNode=a.stateNode,u.alternate=a,a.alternate=u):(u.pendingProps=o,u.type=a.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=a.flags&65011712,u.childLanes=a.childLanes,u.lanes=a.lanes,u.child=a.child,u.memoizedProps=a.memoizedProps,u.memoizedState=a.memoizedState,u.updateQueue=a.updateQueue,o=a.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=a.sibling,u.index=a.index,u.ref=a.ref,u.refCleanup=a.refCleanup,u}function Xx(a,o){a.flags&=65011714;var u=a.alternate;return u===null?(a.childLanes=0,a.lanes=o,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=u.childLanes,a.lanes=u.lanes,a.child=u.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=u.memoizedProps,a.memoizedState=u.memoizedState,a.updateQueue=u.updateQueue,a.type=u.type,o=u.dependencies,a.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),a}function Pf(a,o,u,f,p,b){var A=0;if(f=a,typeof a=="function")g_(a)&&(A=1);else if(typeof a=="string")A=BM(a,u,ye.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case N:return a=ls(31,u,o,p),a.elementType=N,a.lanes=b,a;case S:return wo(u.children,p,b,o);case E:A=8,p|=24;break;case R:return a=ls(12,u,o,p|2),a.elementType=R,a.lanes=b,a;case F:return a=ls(13,u,o,p),a.elementType=F,a.lanes=b,a;case U:return a=ls(19,u,o,p),a.elementType=U,a.lanes=b,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case k:case O:A=10;break e;case L:A=9;break e;case H:A=11;break e;case C:A=14;break e;case I:A=16,f=null;break e}A=29,u=Error(s(130,a===null?"null":typeof a,"")),f=null}return o=ls(A,u,o,p),o.elementType=a,o.type=f,o.lanes=b,o}function wo(a,o,u,f){return a=ls(7,a,f,o),a.lanes=u,a}function p_(a,o,u){return a=ls(6,a,null,o),a.lanes=u,a}function __(a,o,u){return o=ls(4,a.children!==null?a.children:[],a.key,o),o.lanes=u,o.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},o}var Gl=[],$l=0,Vf=null,Lf=0,As=[],Is=0,So=null,Hi=1,qi="";function Ao(a,o){Gl[$l++]=Lf,Gl[$l++]=Vf,Vf=a,Lf=o}function Zx(a,o,u){As[Is++]=Hi,As[Is++]=qi,As[Is++]=So,So=a;var f=Hi;a=qi;var p=32-zn(f)-1;f&=~(1<<p),u+=1;var b=32-zn(o)+p;if(30<b){var A=p-p%5;b=(f&(1<<A)-1).toString(32),f>>=A,p-=A,Hi=1<<32-zn(o)+p|u<<p|f,qi=b+a}else Hi=1<<b|u<<p|f,qi=a}function y_(a){a.return!==null&&(Ao(a,1),Zx(a,1,0))}function b_(a){for(;a===Vf;)Vf=Gl[--$l],Gl[$l]=null,Lf=Gl[--$l],Gl[$l]=null;for(;a===So;)So=As[--Is],As[Is]=null,qi=As[--Is],As[Is]=null,Hi=As[--Is],As[Is]=null}var $n=null,jt=null,ot=!1,Io=null,hi=!1,v_=Error(s(519));function Ro(a){var o=Error(s(418,""));throw Hu(ws(o,a)),v_}function Jx(a){var o=a.stateNode,u=a.type,f=a.memoizedProps;switch(o[qt]=a,o[xn]=f,u){case"dialog":We("cancel",o),We("close",o);break;case"iframe":case"object":case"embed":We("load",o);break;case"video":case"audio":for(u=0;u<fh.length;u++)We(fh[u],o);break;case"source":We("error",o);break;case"img":case"image":case"link":We("error",o),We("load",o);break;case"details":We("toggle",o);break;case"input":We("invalid",o),Su(o,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),Vr(o);break;case"select":We("invalid",o);break;case"textarea":We("invalid",o),yf(o,f.value,f.defaultValue,f.children),Vr(o)}u=f.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||f.suppressHydrationWarning===!0||pw(o.textContent,u)?(f.popover!=null&&(We("beforetoggle",o),We("toggle",o)),f.onScroll!=null&&We("scroll",o),f.onScrollEnd!=null&&We("scrollend",o),f.onClick!=null&&(o.onclick=_m),o=!0):o=!1,o||Ro(a)}function eT(a){for($n=a.return;$n;)switch($n.tag){case 5:case 13:hi=!1;return;case 27:case 3:hi=!0;return;default:$n=$n.return}}function Fu(a){if(a!==$n)return!1;if(!ot)return eT(a),ot=!0,!1;var o=a.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=a.type,u=!(u!=="form"&&u!=="button")||Vy(a.type,a.memoizedProps)),u=!u),u&&jt&&Ro(a),eT(a),o===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(s(317));e:{for(a=a.nextSibling,o=0;a;){if(a.nodeType===8)if(u=a.data,u==="/$"){if(o===0){jt=$s(a.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++;a=a.nextSibling}jt=null}}else o===27?(o=jt,sa(a.type)?(a=By,By=null,jt=a):jt=o):jt=$n?$s(a.stateNode.nextSibling):null;return!0}function zu(){jt=$n=null,ot=!1}function tT(){var a=Io;return a!==null&&(es===null?es=a:es.push.apply(es,a),Io=null),a}function Hu(a){Io===null?Io=[a]:Io.push(a)}var x_=se(null),Co=null,Gi=null;function zr(a,o,u){de(x_,o._currentValue),o._currentValue=u}function $i(a){a._currentValue=x_.current,he(x_)}function T_(a,o,u){for(;a!==null;){var f=a.alternate;if((a.childLanes&o)!==o?(a.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),a===u)break;a=a.return}}function E_(a,o,u,f){var p=a.child;for(p!==null&&(p.return=a);p!==null;){var b=p.dependencies;if(b!==null){var A=p.child;b=b.firstContext;e:for(;b!==null;){var D=b;b=p;for(var q=0;q<o.length;q++)if(D.context===o[q]){b.lanes|=u,D=b.alternate,D!==null&&(D.lanes|=u),T_(b.return,u,a),f||(A=null);break e}b=D.next}}else if(p.tag===18){if(A=p.return,A===null)throw Error(s(341));A.lanes|=u,b=A.alternate,b!==null&&(b.lanes|=u),T_(A,u,a),A=null}else A=p.child;if(A!==null)A.return=p;else for(A=p;A!==null;){if(A===a){A=null;break}if(p=A.sibling,p!==null){p.return=A.return,A=p;break}A=A.return}p=A}}function qu(a,o,u,f){a=null;for(var p=o,b=!1;p!==null;){if(!b){if((p.flags&524288)!==0)b=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var A=p.alternate;if(A===null)throw Error(s(387));if(A=A.memoizedProps,A!==null){var D=p.type;os(p.pendingProps.value,A.value)||(a!==null?a.push(D):a=[D])}}else if(p===Ct.current){if(A=p.alternate,A===null)throw Error(s(387));A.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(a!==null?a.push(bh):a=[bh])}p=p.return}a!==null&&E_(o,a,u,f),o.flags|=262144}function jf(a){for(a=a.firstContext;a!==null;){if(!os(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Do(a){Co=a,Gi=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Nn(a){return nT(Co,a)}function Uf(a,o){return Co===null&&Do(a),nT(a,o)}function nT(a,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},Gi===null){if(a===null)throw Error(s(308));Gi=o,a.dependencies={lanes:0,firstContext:o},a.flags|=524288}else Gi=Gi.next=o;return u}var Uk=typeof AbortController<"u"?AbortController:function(){var a=[],o=this.signal={aborted:!1,addEventListener:function(u,f){a.push(f)}};this.abort=function(){o.aborted=!0,a.forEach(function(u){return u()})}},Bk=n.unstable_scheduleCallback,Fk=n.unstable_NormalPriority,an={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function w_(){return{controller:new Uk,data:new Map,refCount:0}}function Gu(a){a.refCount--,a.refCount===0&&Bk(Fk,function(){a.controller.abort()})}var $u=null,S_=0,Wl=0,Yl=null;function zk(a,o){if($u===null){var u=$u=[];S_=0,Wl=Iy(),Yl={status:"pending",value:void 0,then:function(f){u.push(f)}}}return S_++,o.then(sT,sT),o}function sT(){if(--S_===0&&$u!==null){Yl!==null&&(Yl.status="fulfilled");var a=$u;$u=null,Wl=0,Yl=null;for(var o=0;o<a.length;o++)(0,a[o])()}}function Hk(a,o){var u=[],f={status:"pending",value:null,reason:null,then:function(p){u.push(p)}};return a.then(function(){f.status="fulfilled",f.value=o;for(var p=0;p<u.length;p++)(0,u[p])(o)},function(p){for(f.status="rejected",f.reason=p,p=0;p<u.length;p++)(0,u[p])(void 0)}),f}var iT=Y.S;Y.S=function(a,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&zk(a,o),iT!==null&&iT(a,o)};var No=se(null);function A_(){var a=No.current;return a!==null?a:xt.pooledCache}function Bf(a,o){o===null?de(No,No.current):de(No,o.pool)}function rT(){var a=A_();return a===null?null:{parent:an._currentValue,pool:a}}var Wu=Error(s(460)),aT=Error(s(474)),Ff=Error(s(542)),I_={then:function(){}};function oT(a){return a=a.status,a==="fulfilled"||a==="rejected"}function zf(){}function lT(a,o,u){switch(u=a[u],u===void 0?a.push(o):u!==o&&(o.then(zf,zf),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,uT(a),a;default:if(typeof o.status=="string")o.then(zf,zf);else{if(a=xt,a!==null&&100<a.shellSuspendCounter)throw Error(s(482));a=o,a.status="pending",a.then(function(f){if(o.status==="pending"){var p=o;p.status="fulfilled",p.value=f}},function(f){if(o.status==="pending"){var p=o;p.status="rejected",p.reason=f}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,uT(a),a}throw Yu=o,Wu}}var Yu=null;function cT(){if(Yu===null)throw Error(s(459));var a=Yu;return Yu=null,a}function uT(a){if(a===Wu||a===Ff)throw Error(s(483))}var Hr=!1;function R_(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function C_(a,o){a=a.updateQueue,o.updateQueue===a&&(o.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function qr(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Gr(a,o,u){var f=a.updateQueue;if(f===null)return null;if(f=f.shared,(ut&2)!==0){var p=f.pending;return p===null?o.next=o:(o.next=p.next,p.next=o),f.pending=o,o=Of(a),Qx(a,null,u),o}return Mf(a,f,o,u),Of(a)}function Ku(a,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var f=o.lanes;f&=a.pendingLanes,u|=f,o.lanes=u,Nr(a,u)}}function D_(a,o){var u=a.updateQueue,f=a.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var p=null,b=null;if(u=u.firstBaseUpdate,u!==null){do{var A={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};b===null?p=b=A:b=b.next=A,u=u.next}while(u!==null);b===null?p=b=o:b=b.next=o}else p=b=o;u={baseState:f.baseState,firstBaseUpdate:p,lastBaseUpdate:b,shared:f.shared,callbacks:f.callbacks},a.updateQueue=u;return}a=u.lastBaseUpdate,a===null?u.firstBaseUpdate=o:a.next=o,u.lastBaseUpdate=o}var N_=!1;function Qu(){if(N_){var a=Yl;if(a!==null)throw a}}function Xu(a,o,u,f){N_=!1;var p=a.updateQueue;Hr=!1;var b=p.firstBaseUpdate,A=p.lastBaseUpdate,D=p.shared.pending;if(D!==null){p.shared.pending=null;var q=D,X=q.next;q.next=null,A===null?b=X:A.next=X,A=q;var ie=a.alternate;ie!==null&&(ie=ie.updateQueue,D=ie.lastBaseUpdate,D!==A&&(D===null?ie.firstBaseUpdate=X:D.next=X,ie.lastBaseUpdate=q))}if(b!==null){var oe=p.baseState;A=0,ie=X=q=null,D=b;do{var Z=D.lane&-536870913,J=Z!==D.lane;if(J?(Je&Z)===Z:(f&Z)===Z){Z!==0&&Z===Wl&&(N_=!0),ie!==null&&(ie=ie.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var Me=a,Ne=D;Z=o;var yt=u;switch(Ne.tag){case 1:if(Me=Ne.payload,typeof Me=="function"){oe=Me.call(yt,oe,Z);break e}oe=Me;break e;case 3:Me.flags=Me.flags&-65537|128;case 0:if(Me=Ne.payload,Z=typeof Me=="function"?Me.call(yt,oe,Z):Me,Z==null)break e;oe=m({},oe,Z);break e;case 2:Hr=!0}}Z=D.callback,Z!==null&&(a.flags|=64,J&&(a.flags|=8192),J=p.callbacks,J===null?p.callbacks=[Z]:J.push(Z))}else J={lane:Z,tag:D.tag,payload:D.payload,callback:D.callback,next:null},ie===null?(X=ie=J,q=oe):ie=ie.next=J,A|=Z;if(D=D.next,D===null){if(D=p.shared.pending,D===null)break;J=D,D=J.next,J.next=null,p.lastBaseUpdate=J,p.shared.pending=null}}while(!0);ie===null&&(q=oe),p.baseState=q,p.firstBaseUpdate=X,p.lastBaseUpdate=ie,b===null&&(p.shared.lanes=0),Jr|=A,a.lanes=A,a.memoizedState=oe}}function hT(a,o){if(typeof a!="function")throw Error(s(191,a));a.call(o)}function dT(a,o){var u=a.callbacks;if(u!==null)for(a.callbacks=null,a=0;a<u.length;a++)hT(u[a],o)}var Kl=se(null),Hf=se(0);function fT(a,o){a=Ji,de(Hf,a),de(Kl,o),Ji=a|o.baseLanes}function k_(){de(Hf,Ji),de(Kl,Kl.current)}function M_(){Ji=Hf.current,he(Kl),he(Hf)}var $r=0,He=null,pt=null,Jt=null,qf=!1,Ql=!1,ko=!1,Gf=0,Zu=0,Xl=null,qk=0;function Wt(){throw Error(s(321))}function O_(a,o){if(o===null)return!1;for(var u=0;u<o.length&&u<a.length;u++)if(!os(a[u],o[u]))return!1;return!0}function P_(a,o,u,f,p,b){return $r=b,He=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Y.H=a===null||a.memoizedState===null?QT:XT,ko=!1,b=u(f,p),ko=!1,Ql&&(b=gT(o,u,f,p)),mT(a),b}function mT(a){Y.H=Xf;var o=pt!==null&&pt.next!==null;if($r=0,Jt=pt=He=null,qf=!1,Zu=0,Xl=null,o)throw Error(s(300));a===null||gn||(a=a.dependencies,a!==null&&jf(a)&&(gn=!0))}function gT(a,o,u,f){He=a;var p=0;do{if(Ql&&(Xl=null),Zu=0,Ql=!1,25<=p)throw Error(s(301));if(p+=1,Jt=pt=null,a.updateQueue!=null){var b=a.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}Y.H=Xk,b=o(u,f)}while(Ql);return b}function Gk(){var a=Y.H,o=a.useState()[0];return o=typeof o.then=="function"?Ju(o):o,a=a.useState()[0],(pt!==null?pt.memoizedState:null)!==a&&(He.flags|=1024),o}function V_(){var a=Gf!==0;return Gf=0,a}function L_(a,o,u){o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~u}function j_(a){if(qf){for(a=a.memoizedState;a!==null;){var o=a.queue;o!==null&&(o.pending=null),a=a.next}qf=!1}$r=0,Jt=pt=He=null,Ql=!1,Zu=Gf=0,Xl=null}function Zn(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?He.memoizedState=Jt=a:Jt=Jt.next=a,Jt}function en(){if(pt===null){var a=He.alternate;a=a!==null?a.memoizedState:null}else a=pt.next;var o=Jt===null?He.memoizedState:Jt.next;if(o!==null)Jt=o,pt=a;else{if(a===null)throw He.alternate===null?Error(s(467)):Error(s(310));pt=a,a={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},Jt===null?He.memoizedState=Jt=a:Jt=Jt.next=a}return Jt}function U_(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ju(a){var o=Zu;return Zu+=1,Xl===null&&(Xl=[]),a=lT(Xl,a,o),o=He,(Jt===null?o.memoizedState:Jt.next)===null&&(o=o.alternate,Y.H=o===null||o.memoizedState===null?QT:XT),a}function $f(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Ju(a);if(a.$$typeof===O)return Nn(a)}throw Error(s(438,String(a)))}function B_(a){var o=null,u=He.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var f=He.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(o={data:f.data.map(function(p){return p.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=U_(),He.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(a),f=0;f<a;f++)u[f]=V;return o.index++,u}function Wi(a,o){return typeof o=="function"?o(a):o}function Wf(a){var o=en();return F_(o,pt,a)}function F_(a,o,u){var f=a.queue;if(f===null)throw Error(s(311));f.lastRenderedReducer=u;var p=a.baseQueue,b=f.pending;if(b!==null){if(p!==null){var A=p.next;p.next=b.next,b.next=A}o.baseQueue=p=b,f.pending=null}if(b=a.baseState,p===null)a.memoizedState=b;else{o=p.next;var D=A=null,q=null,X=o,ie=!1;do{var oe=X.lane&-536870913;if(oe!==X.lane?(Je&oe)===oe:($r&oe)===oe){var Z=X.revertLane;if(Z===0)q!==null&&(q=q.next={lane:0,revertLane:0,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null}),oe===Wl&&(ie=!0);else if(($r&Z)===Z){X=X.next,Z===Wl&&(ie=!0);continue}else oe={lane:0,revertLane:X.revertLane,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},q===null?(D=q=oe,A=b):q=q.next=oe,He.lanes|=Z,Jr|=Z;oe=X.action,ko&&u(b,oe),b=X.hasEagerState?X.eagerState:u(b,oe)}else Z={lane:oe,revertLane:X.revertLane,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},q===null?(D=q=Z,A=b):q=q.next=Z,He.lanes|=oe,Jr|=oe;X=X.next}while(X!==null&&X!==o);if(q===null?A=b:q.next=D,!os(b,a.memoizedState)&&(gn=!0,ie&&(u=Yl,u!==null)))throw u;a.memoizedState=b,a.baseState=A,a.baseQueue=q,f.lastRenderedState=b}return p===null&&(f.lanes=0),[a.memoizedState,f.dispatch]}function z_(a){var o=en(),u=o.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=a;var f=u.dispatch,p=u.pending,b=o.memoizedState;if(p!==null){u.pending=null;var A=p=p.next;do b=a(b,A.action),A=A.next;while(A!==p);os(b,o.memoizedState)||(gn=!0),o.memoizedState=b,o.baseQueue===null&&(o.baseState=b),u.lastRenderedState=b}return[b,f]}function pT(a,o,u){var f=He,p=en(),b=ot;if(b){if(u===void 0)throw Error(s(407));u=u()}else u=o();var A=!os((pt||p).memoizedState,u);A&&(p.memoizedState=u,gn=!0),p=p.queue;var D=bT.bind(null,f,p,a);if(eh(2048,8,D,[a]),p.getSnapshot!==o||A||Jt!==null&&Jt.memoizedState.tag&1){if(f.flags|=2048,Zl(9,Yf(),yT.bind(null,f,p,u,o),null),xt===null)throw Error(s(349));b||($r&124)!==0||_T(f,o,u)}return u}function _T(a,o,u){a.flags|=16384,a={getSnapshot:o,value:u},o=He.updateQueue,o===null?(o=U_(),He.updateQueue=o,o.stores=[a]):(u=o.stores,u===null?o.stores=[a]:u.push(a))}function yT(a,o,u,f){o.value=u,o.getSnapshot=f,vT(o)&&xT(a)}function bT(a,o,u){return u(function(){vT(o)&&xT(a)})}function vT(a){var o=a.getSnapshot;a=a.value;try{var u=o();return!os(a,u)}catch{return!0}}function xT(a){var o=Hl(a,2);o!==null&&fs(o,a,2)}function H_(a){var o=Zn();if(typeof a=="function"){var u=a;if(a=u(),ko){bs(!0);try{u()}finally{bs(!1)}}}return o.memoizedState=o.baseState=a,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:a},o}function TT(a,o,u,f){return a.baseState=u,F_(a,pt,typeof f=="function"?f:Wi)}function $k(a,o,u,f,p){if(Qf(a))throw Error(s(485));if(a=o.action,a!==null){var b={payload:p,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){b.listeners.push(A)}};Y.T!==null?u(!0):b.isTransition=!1,f(b),u=o.pending,u===null?(b.next=o.pending=b,ET(o,b)):(b.next=u.next,o.pending=u.next=b)}}function ET(a,o){var u=o.action,f=o.payload,p=a.state;if(o.isTransition){var b=Y.T,A={};Y.T=A;try{var D=u(p,f),q=Y.S;q!==null&&q(A,D),wT(a,o,D)}catch(X){q_(a,o,X)}finally{Y.T=b}}else try{b=u(p,f),wT(a,o,b)}catch(X){q_(a,o,X)}}function wT(a,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(f){ST(a,o,f)},function(f){return q_(a,o,f)}):ST(a,o,u)}function ST(a,o,u){o.status="fulfilled",o.value=u,AT(o),a.state=u,o=a.pending,o!==null&&(u=o.next,u===o?a.pending=null:(u=u.next,o.next=u,ET(a,u)))}function q_(a,o,u){var f=a.pending;if(a.pending=null,f!==null){f=f.next;do o.status="rejected",o.reason=u,AT(o),o=o.next;while(o!==f)}a.action=null}function AT(a){a=a.listeners;for(var o=0;o<a.length;o++)(0,a[o])()}function IT(a,o){return o}function RT(a,o){if(ot){var u=xt.formState;if(u!==null){e:{var f=He;if(ot){if(jt){t:{for(var p=jt,b=hi;p.nodeType!==8;){if(!b){p=null;break t}if(p=$s(p.nextSibling),p===null){p=null;break t}}b=p.data,p=b==="F!"||b==="F"?p:null}if(p){jt=$s(p.nextSibling),f=p.data==="F!";break e}}Ro(f)}f=!1}f&&(o=u[0])}}return u=Zn(),u.memoizedState=u.baseState=o,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:IT,lastRenderedState:o},u.queue=f,u=WT.bind(null,He,f),f.dispatch=u,f=H_(!1),b=K_.bind(null,He,!1,f.queue),f=Zn(),p={state:o,dispatch:null,action:a,pending:null},f.queue=p,u=$k.bind(null,He,p,b,u),p.dispatch=u,f.memoizedState=a,[o,u,!1]}function CT(a){var o=en();return DT(o,pt,a)}function DT(a,o,u){if(o=F_(a,o,IT)[0],a=Wf(Wi)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var f=Ju(o)}catch(A){throw A===Wu?Ff:A}else f=o;o=en();var p=o.queue,b=p.dispatch;return u!==o.memoizedState&&(He.flags|=2048,Zl(9,Yf(),Wk.bind(null,p,u),null)),[f,b,a]}function Wk(a,o){a.action=o}function NT(a){var o=en(),u=pt;if(u!==null)return DT(o,u,a);en(),o=o.memoizedState,u=en();var f=u.queue.dispatch;return u.memoizedState=a,[o,f,!1]}function Zl(a,o,u,f){return a={tag:a,create:u,deps:f,inst:o,next:null},o=He.updateQueue,o===null&&(o=U_(),He.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=a.next=a:(f=u.next,u.next=a,a.next=f,o.lastEffect=a),a}function Yf(){return{destroy:void 0,resource:void 0}}function kT(){return en().memoizedState}function Kf(a,o,u,f){var p=Zn();f=f===void 0?null:f,He.flags|=a,p.memoizedState=Zl(1|o,Yf(),u,f)}function eh(a,o,u,f){var p=en();f=f===void 0?null:f;var b=p.memoizedState.inst;pt!==null&&f!==null&&O_(f,pt.memoizedState.deps)?p.memoizedState=Zl(o,b,u,f):(He.flags|=a,p.memoizedState=Zl(1|o,b,u,f))}function MT(a,o){Kf(8390656,8,a,o)}function OT(a,o){eh(2048,8,a,o)}function PT(a,o){return eh(4,2,a,o)}function VT(a,o){return eh(4,4,a,o)}function LT(a,o){if(typeof o=="function"){a=a();var u=o(a);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return a=a(),o.current=a,function(){o.current=null}}function jT(a,o,u){u=u!=null?u.concat([a]):null,eh(4,4,LT.bind(null,o,a),u)}function G_(){}function UT(a,o){var u=en();o=o===void 0?null:o;var f=u.memoizedState;return o!==null&&O_(o,f[1])?f[0]:(u.memoizedState=[a,o],a)}function BT(a,o){var u=en();o=o===void 0?null:o;var f=u.memoizedState;if(o!==null&&O_(o,f[1]))return f[0];if(f=a(),ko){bs(!0);try{a()}finally{bs(!1)}}return u.memoizedState=[f,o],f}function $_(a,o,u){return u===void 0||($r&1073741824)!==0?a.memoizedState=o:(a.memoizedState=u,a=HE(),He.lanes|=a,Jr|=a,u)}function FT(a,o,u,f){return os(u,o)?u:Kl.current!==null?(a=$_(a,u,f),os(a,o)||(gn=!0),a):($r&42)===0?(gn=!0,a.memoizedState=u):(a=HE(),He.lanes|=a,Jr|=a,o)}function zT(a,o,u,f,p){var b=ae.p;ae.p=b!==0&&8>b?b:8;var A=Y.T,D={};Y.T=D,K_(a,!1,o,u);try{var q=p(),X=Y.S;if(X!==null&&X(D,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var ie=Hk(q,f);th(a,o,ie,ds(a))}else th(a,o,f,ds(a))}catch(oe){th(a,o,{then:function(){},status:"rejected",reason:oe},ds())}finally{ae.p=b,Y.T=A}}function Yk(){}function W_(a,o,u,f){if(a.tag!==5)throw Error(s(476));var p=HT(a).queue;zT(a,p,o,me,u===null?Yk:function(){return qT(a),u(f)})}function HT(a){var o=a.memoizedState;if(o!==null)return o;o={memoizedState:me,baseState:me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:me},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:u},next:null},a.memoizedState=o,a=a.alternate,a!==null&&(a.memoizedState=o),o}function qT(a){var o=HT(a).next.queue;th(a,o,{},ds())}function Y_(){return Nn(bh)}function GT(){return en().memoizedState}function $T(){return en().memoizedState}function Kk(a){for(var o=a.return;o!==null;){switch(o.tag){case 24:case 3:var u=ds();a=qr(u);var f=Gr(o,a,u);f!==null&&(fs(f,o,u),Ku(f,o,u)),o={cache:w_()},a.payload=o;return}o=o.return}}function Qk(a,o,u){var f=ds();u={lane:f,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},Qf(a)?YT(o,u):(u=m_(a,o,u,f),u!==null&&(fs(u,a,f),KT(u,o,f)))}function WT(a,o,u){var f=ds();th(a,o,u,f)}function th(a,o,u,f){var p={lane:f,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(Qf(a))YT(o,p);else{var b=a.alternate;if(a.lanes===0&&(b===null||b.lanes===0)&&(b=o.lastRenderedReducer,b!==null))try{var A=o.lastRenderedState,D=b(A,u);if(p.hasEagerState=!0,p.eagerState=D,os(D,A))return Mf(a,o,p,0),xt===null&&kf(),!1}catch{}finally{}if(u=m_(a,o,p,f),u!==null)return fs(u,a,f),KT(u,o,f),!0}return!1}function K_(a,o,u,f){if(f={lane:2,revertLane:Iy(),action:f,hasEagerState:!1,eagerState:null,next:null},Qf(a)){if(o)throw Error(s(479))}else o=m_(a,u,f,2),o!==null&&fs(o,a,2)}function Qf(a){var o=a.alternate;return a===He||o!==null&&o===He}function YT(a,o){Ql=qf=!0;var u=a.pending;u===null?o.next=o:(o.next=u.next,u.next=o),a.pending=o}function KT(a,o,u){if((u&4194048)!==0){var f=o.lanes;f&=a.pendingLanes,u|=f,o.lanes=u,Nr(a,u)}}var Xf={readContext:Nn,use:$f,useCallback:Wt,useContext:Wt,useEffect:Wt,useImperativeHandle:Wt,useLayoutEffect:Wt,useInsertionEffect:Wt,useMemo:Wt,useReducer:Wt,useRef:Wt,useState:Wt,useDebugValue:Wt,useDeferredValue:Wt,useTransition:Wt,useSyncExternalStore:Wt,useId:Wt,useHostTransitionStatus:Wt,useFormState:Wt,useActionState:Wt,useOptimistic:Wt,useMemoCache:Wt,useCacheRefresh:Wt},QT={readContext:Nn,use:$f,useCallback:function(a,o){return Zn().memoizedState=[a,o===void 0?null:o],a},useContext:Nn,useEffect:MT,useImperativeHandle:function(a,o,u){u=u!=null?u.concat([a]):null,Kf(4194308,4,LT.bind(null,o,a),u)},useLayoutEffect:function(a,o){return Kf(4194308,4,a,o)},useInsertionEffect:function(a,o){Kf(4,2,a,o)},useMemo:function(a,o){var u=Zn();o=o===void 0?null:o;var f=a();if(ko){bs(!0);try{a()}finally{bs(!1)}}return u.memoizedState=[f,o],f},useReducer:function(a,o,u){var f=Zn();if(u!==void 0){var p=u(o);if(ko){bs(!0);try{u(o)}finally{bs(!1)}}}else p=o;return f.memoizedState=f.baseState=p,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:p},f.queue=a,a=a.dispatch=Qk.bind(null,He,a),[f.memoizedState,a]},useRef:function(a){var o=Zn();return a={current:a},o.memoizedState=a},useState:function(a){a=H_(a);var o=a.queue,u=WT.bind(null,He,o);return o.dispatch=u,[a.memoizedState,u]},useDebugValue:G_,useDeferredValue:function(a,o){var u=Zn();return $_(u,a,o)},useTransition:function(){var a=H_(!1);return a=zT.bind(null,He,a.queue,!0,!1),Zn().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,o,u){var f=He,p=Zn();if(ot){if(u===void 0)throw Error(s(407));u=u()}else{if(u=o(),xt===null)throw Error(s(349));(Je&124)!==0||_T(f,o,u)}p.memoizedState=u;var b={value:u,getSnapshot:o};return p.queue=b,MT(bT.bind(null,f,b,a),[a]),f.flags|=2048,Zl(9,Yf(),yT.bind(null,f,b,u,o),null),u},useId:function(){var a=Zn(),o=xt.identifierPrefix;if(ot){var u=qi,f=Hi;u=(f&~(1<<32-zn(f)-1)).toString(32)+u,o="«"+o+"R"+u,u=Gf++,0<u&&(o+="H"+u.toString(32)),o+="»"}else u=qk++,o="«"+o+"r"+u.toString(32)+"»";return a.memoizedState=o},useHostTransitionStatus:Y_,useFormState:RT,useActionState:RT,useOptimistic:function(a){var o=Zn();o.memoizedState=o.baseState=a;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=K_.bind(null,He,!0,u),u.dispatch=o,[a,o]},useMemoCache:B_,useCacheRefresh:function(){return Zn().memoizedState=Kk.bind(null,He)}},XT={readContext:Nn,use:$f,useCallback:UT,useContext:Nn,useEffect:OT,useImperativeHandle:jT,useInsertionEffect:PT,useLayoutEffect:VT,useMemo:BT,useReducer:Wf,useRef:kT,useState:function(){return Wf(Wi)},useDebugValue:G_,useDeferredValue:function(a,o){var u=en();return FT(u,pt.memoizedState,a,o)},useTransition:function(){var a=Wf(Wi)[0],o=en().memoizedState;return[typeof a=="boolean"?a:Ju(a),o]},useSyncExternalStore:pT,useId:GT,useHostTransitionStatus:Y_,useFormState:CT,useActionState:CT,useOptimistic:function(a,o){var u=en();return TT(u,pt,a,o)},useMemoCache:B_,useCacheRefresh:$T},Xk={readContext:Nn,use:$f,useCallback:UT,useContext:Nn,useEffect:OT,useImperativeHandle:jT,useInsertionEffect:PT,useLayoutEffect:VT,useMemo:BT,useReducer:z_,useRef:kT,useState:function(){return z_(Wi)},useDebugValue:G_,useDeferredValue:function(a,o){var u=en();return pt===null?$_(u,a,o):FT(u,pt.memoizedState,a,o)},useTransition:function(){var a=z_(Wi)[0],o=en().memoizedState;return[typeof a=="boolean"?a:Ju(a),o]},useSyncExternalStore:pT,useId:GT,useHostTransitionStatus:Y_,useFormState:NT,useActionState:NT,useOptimistic:function(a,o){var u=en();return pt!==null?TT(u,pt,a,o):(u.baseState=a,[a,u.queue.dispatch])},useMemoCache:B_,useCacheRefresh:$T},Jl=null,nh=0;function Zf(a){var o=nh;return nh+=1,Jl===null&&(Jl=[]),lT(Jl,a,o)}function sh(a,o){o=o.props.ref,a.ref=o!==void 0?o:null}function Jf(a,o){throw o.$$typeof===_?Error(s(525)):(a=Object.prototype.toString.call(o),Error(s(31,a==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":a)))}function ZT(a){var o=a._init;return o(a._payload)}function JT(a){function o($,G){if(a){var K=$.deletions;K===null?($.deletions=[G],$.flags|=16):K.push(G)}}function u($,G){if(!a)return null;for(;G!==null;)o($,G),G=G.sibling;return null}function f($){for(var G=new Map;$!==null;)$.key!==null?G.set($.key,$):G.set($.index,$),$=$.sibling;return G}function p($,G){return $=zi($,G),$.index=0,$.sibling=null,$}function b($,G,K){return $.index=K,a?(K=$.alternate,K!==null?(K=K.index,K<G?($.flags|=67108866,G):K):($.flags|=67108866,G)):($.flags|=1048576,G)}function A($){return a&&$.alternate===null&&($.flags|=67108866),$}function D($,G,K,re){return G===null||G.tag!==6?(G=p_(K,$.mode,re),G.return=$,G):(G=p(G,K),G.return=$,G)}function q($,G,K,re){var Ee=K.type;return Ee===S?ie($,G,K.props.children,re,K.key):G!==null&&(G.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===I&&ZT(Ee)===G.type)?(G=p(G,K.props),sh(G,K),G.return=$,G):(G=Pf(K.type,K.key,K.props,null,$.mode,re),sh(G,K),G.return=$,G)}function X($,G,K,re){return G===null||G.tag!==4||G.stateNode.containerInfo!==K.containerInfo||G.stateNode.implementation!==K.implementation?(G=__(K,$.mode,re),G.return=$,G):(G=p(G,K.children||[]),G.return=$,G)}function ie($,G,K,re,Ee){return G===null||G.tag!==7?(G=wo(K,$.mode,re,Ee),G.return=$,G):(G=p(G,K),G.return=$,G)}function oe($,G,K){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=p_(""+G,$.mode,K),G.return=$,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case v:return K=Pf(G.type,G.key,G.props,null,$.mode,K),sh(K,G),K.return=$,K;case T:return G=__(G,$.mode,K),G.return=$,G;case I:var re=G._init;return G=re(G._payload),oe($,G,K)}if(be(G)||B(G))return G=wo(G,$.mode,K,null),G.return=$,G;if(typeof G.then=="function")return oe($,Zf(G),K);if(G.$$typeof===O)return oe($,Uf($,G),K);Jf($,G)}return null}function Z($,G,K,re){var Ee=G!==null?G.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return Ee!==null?null:D($,G,""+K,re);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case v:return K.key===Ee?q($,G,K,re):null;case T:return K.key===Ee?X($,G,K,re):null;case I:return Ee=K._init,K=Ee(K._payload),Z($,G,K,re)}if(be(K)||B(K))return Ee!==null?null:ie($,G,K,re,null);if(typeof K.then=="function")return Z($,G,Zf(K),re);if(K.$$typeof===O)return Z($,G,Uf($,K),re);Jf($,K)}return null}function J($,G,K,re,Ee){if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return $=$.get(K)||null,D(G,$,""+re,Ee);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case v:return $=$.get(re.key===null?K:re.key)||null,q(G,$,re,Ee);case T:return $=$.get(re.key===null?K:re.key)||null,X(G,$,re,Ee);case I:var qe=re._init;return re=qe(re._payload),J($,G,K,re,Ee)}if(be(re)||B(re))return $=$.get(K)||null,ie(G,$,re,Ee,null);if(typeof re.then=="function")return J($,G,K,Zf(re),Ee);if(re.$$typeof===O)return J($,G,K,Uf(G,re),Ee);Jf(G,re)}return null}function Me($,G,K,re){for(var Ee=null,qe=null,De=G,ke=G=0,_n=null;De!==null&&ke<K.length;ke++){De.index>ke?(_n=De,De=null):_n=De.sibling;var st=Z($,De,K[ke],re);if(st===null){De===null&&(De=_n);break}a&&De&&st.alternate===null&&o($,De),G=b(st,G,ke),qe===null?Ee=st:qe.sibling=st,qe=st,De=_n}if(ke===K.length)return u($,De),ot&&Ao($,ke),Ee;if(De===null){for(;ke<K.length;ke++)De=oe($,K[ke],re),De!==null&&(G=b(De,G,ke),qe===null?Ee=De:qe.sibling=De,qe=De);return ot&&Ao($,ke),Ee}for(De=f(De);ke<K.length;ke++)_n=J(De,$,ke,K[ke],re),_n!==null&&(a&&_n.alternate!==null&&De.delete(_n.key===null?ke:_n.key),G=b(_n,G,ke),qe===null?Ee=_n:qe.sibling=_n,qe=_n);return a&&De.forEach(function(la){return o($,la)}),ot&&Ao($,ke),Ee}function Ne($,G,K,re){if(K==null)throw Error(s(151));for(var Ee=null,qe=null,De=G,ke=G=0,_n=null,st=K.next();De!==null&&!st.done;ke++,st=K.next()){De.index>ke?(_n=De,De=null):_n=De.sibling;var la=Z($,De,st.value,re);if(la===null){De===null&&(De=_n);break}a&&De&&la.alternate===null&&o($,De),G=b(la,G,ke),qe===null?Ee=la:qe.sibling=la,qe=la,De=_n}if(st.done)return u($,De),ot&&Ao($,ke),Ee;if(De===null){for(;!st.done;ke++,st=K.next())st=oe($,st.value,re),st!==null&&(G=b(st,G,ke),qe===null?Ee=st:qe.sibling=st,qe=st);return ot&&Ao($,ke),Ee}for(De=f(De);!st.done;ke++,st=K.next())st=J(De,$,ke,st.value,re),st!==null&&(a&&st.alternate!==null&&De.delete(st.key===null?ke:st.key),G=b(st,G,ke),qe===null?Ee=st:qe.sibling=st,qe=st);return a&&De.forEach(function(ZM){return o($,ZM)}),ot&&Ao($,ke),Ee}function yt($,G,K,re){if(typeof K=="object"&&K!==null&&K.type===S&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case v:e:{for(var Ee=K.key;G!==null;){if(G.key===Ee){if(Ee=K.type,Ee===S){if(G.tag===7){u($,G.sibling),re=p(G,K.props.children),re.return=$,$=re;break e}}else if(G.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===I&&ZT(Ee)===G.type){u($,G.sibling),re=p(G,K.props),sh(re,K),re.return=$,$=re;break e}u($,G);break}else o($,G);G=G.sibling}K.type===S?(re=wo(K.props.children,$.mode,re,K.key),re.return=$,$=re):(re=Pf(K.type,K.key,K.props,null,$.mode,re),sh(re,K),re.return=$,$=re)}return A($);case T:e:{for(Ee=K.key;G!==null;){if(G.key===Ee)if(G.tag===4&&G.stateNode.containerInfo===K.containerInfo&&G.stateNode.implementation===K.implementation){u($,G.sibling),re=p(G,K.children||[]),re.return=$,$=re;break e}else{u($,G);break}else o($,G);G=G.sibling}re=__(K,$.mode,re),re.return=$,$=re}return A($);case I:return Ee=K._init,K=Ee(K._payload),yt($,G,K,re)}if(be(K))return Me($,G,K,re);if(B(K)){if(Ee=B(K),typeof Ee!="function")throw Error(s(150));return K=Ee.call(K),Ne($,G,K,re)}if(typeof K.then=="function")return yt($,G,Zf(K),re);if(K.$$typeof===O)return yt($,G,Uf($,K),re);Jf($,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,G!==null&&G.tag===6?(u($,G.sibling),re=p(G,K),re.return=$,$=re):(u($,G),re=p_(K,$.mode,re),re.return=$,$=re),A($)):u($,G)}return function($,G,K,re){try{nh=0;var Ee=yt($,G,K,re);return Jl=null,Ee}catch(De){if(De===Wu||De===Ff)throw De;var qe=ls(29,De,null,$.mode);return qe.lanes=re,qe.return=$,qe}finally{}}}var ec=JT(!0),eE=JT(!1),Rs=se(null),di=null;function Wr(a){var o=a.alternate;de(on,on.current&1),de(Rs,a),di===null&&(o===null||Kl.current!==null||o.memoizedState!==null)&&(di=a)}function tE(a){if(a.tag===22){if(de(on,on.current),de(Rs,a),di===null){var o=a.alternate;o!==null&&o.memoizedState!==null&&(di=a)}}else Yr()}function Yr(){de(on,on.current),de(Rs,Rs.current)}function Yi(a){he(Rs),di===a&&(di=null),he(on)}var on=se(0);function em(a){for(var o=a;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||Uy(u)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function Q_(a,o,u,f){o=a.memoizedState,u=u(f,o),u=u==null?o:m({},o,u),a.memoizedState=u,a.lanes===0&&(a.updateQueue.baseState=u)}var X_={enqueueSetState:function(a,o,u){a=a._reactInternals;var f=ds(),p=qr(f);p.payload=o,u!=null&&(p.callback=u),o=Gr(a,p,f),o!==null&&(fs(o,a,f),Ku(o,a,f))},enqueueReplaceState:function(a,o,u){a=a._reactInternals;var f=ds(),p=qr(f);p.tag=1,p.payload=o,u!=null&&(p.callback=u),o=Gr(a,p,f),o!==null&&(fs(o,a,f),Ku(o,a,f))},enqueueForceUpdate:function(a,o){a=a._reactInternals;var u=ds(),f=qr(u);f.tag=2,o!=null&&(f.callback=o),o=Gr(a,f,u),o!==null&&(fs(o,a,u),Ku(o,a,u))}};function nE(a,o,u,f,p,b,A){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(f,b,A):o.prototype&&o.prototype.isPureReactComponent?!Uu(u,f)||!Uu(p,b):!0}function sE(a,o,u,f){a=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,f),o.state!==a&&X_.enqueueReplaceState(o,o.state,null)}function Mo(a,o){var u=o;if("ref"in o){u={};for(var f in o)f!=="ref"&&(u[f]=o[f])}if(a=a.defaultProps){u===o&&(u=m({},u));for(var p in a)u[p]===void 0&&(u[p]=a[p])}return u}var tm=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function iE(a){tm(a)}function rE(a){console.error(a)}function aE(a){tm(a)}function nm(a,o){try{var u=a.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(f){setTimeout(function(){throw f})}}function oE(a,o,u){try{var f=a.onCaughtError;f(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Z_(a,o,u){return u=qr(u),u.tag=3,u.payload={element:null},u.callback=function(){nm(a,o)},u}function lE(a){return a=qr(a),a.tag=3,a}function cE(a,o,u,f){var p=u.type.getDerivedStateFromError;if(typeof p=="function"){var b=f.value;a.payload=function(){return p(b)},a.callback=function(){oE(o,u,f)}}var A=u.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(a.callback=function(){oE(o,u,f),typeof p!="function"&&(ea===null?ea=new Set([this]):ea.add(this));var D=f.stack;this.componentDidCatch(f.value,{componentStack:D!==null?D:""})})}function Zk(a,o,u,f,p){if(u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(o=u.alternate,o!==null&&qu(o,u,p,!0),u=Rs.current,u!==null){switch(u.tag){case 13:return di===null?Ty():u.alternate===null&&Ut===0&&(Ut=3),u.flags&=-257,u.flags|=65536,u.lanes=p,f===I_?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([f]):o.add(f),wy(a,f,p)),!1;case 22:return u.flags|=65536,f===I_?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([f])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([f]):u.add(f)),wy(a,f,p)),!1}throw Error(s(435,u.tag))}return wy(a,f,p),Ty(),!1}if(ot)return o=Rs.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=p,f!==v_&&(a=Error(s(422),{cause:f}),Hu(ws(a,u)))):(f!==v_&&(o=Error(s(423),{cause:f}),Hu(ws(o,u))),a=a.current.alternate,a.flags|=65536,p&=-p,a.lanes|=p,f=ws(f,u),p=Z_(a.stateNode,f,p),D_(a,p),Ut!==4&&(Ut=2)),!1;var b=Error(s(520),{cause:f});if(b=ws(b,u),uh===null?uh=[b]:uh.push(b),Ut!==4&&(Ut=2),o===null)return!0;f=ws(f,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,a=p&-p,u.lanes|=a,a=Z_(u.stateNode,f,a),D_(u,a),!1;case 1:if(o=u.type,b=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(ea===null||!ea.has(b))))return u.flags|=65536,p&=-p,u.lanes|=p,p=lE(p),cE(p,a,u,f),D_(u,p),!1}u=u.return}while(u!==null);return!1}var uE=Error(s(461)),gn=!1;function Tn(a,o,u,f){o.child=a===null?eE(o,null,u,f):ec(o,a.child,u,f)}function hE(a,o,u,f,p){u=u.render;var b=o.ref;if("ref"in f){var A={};for(var D in f)D!=="ref"&&(A[D]=f[D])}else A=f;return Do(o),f=P_(a,o,u,A,b,p),D=V_(),a!==null&&!gn?(L_(a,o,p),Ki(a,o,p)):(ot&&D&&y_(o),o.flags|=1,Tn(a,o,f,p),o.child)}function dE(a,o,u,f,p){if(a===null){var b=u.type;return typeof b=="function"&&!g_(b)&&b.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=b,fE(a,o,b,f,p)):(a=Pf(u.type,null,f,o,o.mode,p),a.ref=o.ref,a.return=o,o.child=a)}if(b=a.child,!ay(a,p)){var A=b.memoizedProps;if(u=u.compare,u=u!==null?u:Uu,u(A,f)&&a.ref===o.ref)return Ki(a,o,p)}return o.flags|=1,a=zi(b,f),a.ref=o.ref,a.return=o,o.child=a}function fE(a,o,u,f,p){if(a!==null){var b=a.memoizedProps;if(Uu(b,f)&&a.ref===o.ref)if(gn=!1,o.pendingProps=f=b,ay(a,p))(a.flags&131072)!==0&&(gn=!0);else return o.lanes=a.lanes,Ki(a,o,p)}return J_(a,o,u,f,p)}function mE(a,o,u){var f=o.pendingProps,p=f.children,b=a!==null?a.memoizedState:null;if(f.mode==="hidden"){if((o.flags&128)!==0){if(f=b!==null?b.baseLanes|u:u,a!==null){for(p=o.child=a.child,b=0;p!==null;)b=b|p.lanes|p.childLanes,p=p.sibling;o.childLanes=b&~f}else o.childLanes=0,o.child=null;return gE(a,o,f,u)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},a!==null&&Bf(o,b!==null?b.cachePool:null),b!==null?fT(o,b):k_(),tE(o);else return o.lanes=o.childLanes=536870912,gE(a,o,b!==null?b.baseLanes|u:u,u)}else b!==null?(Bf(o,b.cachePool),fT(o,b),Yr(),o.memoizedState=null):(a!==null&&Bf(o,null),k_(),Yr());return Tn(a,o,p,u),o.child}function gE(a,o,u,f){var p=A_();return p=p===null?null:{parent:an._currentValue,pool:p},o.memoizedState={baseLanes:u,cachePool:p},a!==null&&Bf(o,null),k_(),tE(o),a!==null&&qu(a,o,f,!0),null}function sm(a,o){var u=o.ref;if(u===null)a!==null&&a.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(s(284));(a===null||a.ref!==u)&&(o.flags|=4194816)}}function J_(a,o,u,f,p){return Do(o),u=P_(a,o,u,f,void 0,p),f=V_(),a!==null&&!gn?(L_(a,o,p),Ki(a,o,p)):(ot&&f&&y_(o),o.flags|=1,Tn(a,o,u,p),o.child)}function pE(a,o,u,f,p,b){return Do(o),o.updateQueue=null,u=gT(o,f,u,p),mT(a),f=V_(),a!==null&&!gn?(L_(a,o,b),Ki(a,o,b)):(ot&&f&&y_(o),o.flags|=1,Tn(a,o,u,b),o.child)}function _E(a,o,u,f,p){if(Do(o),o.stateNode===null){var b=ql,A=u.contextType;typeof A=="object"&&A!==null&&(b=Nn(A)),b=new u(f,b),o.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=X_,o.stateNode=b,b._reactInternals=o,b=o.stateNode,b.props=f,b.state=o.memoizedState,b.refs={},R_(o),A=u.contextType,b.context=typeof A=="object"&&A!==null?Nn(A):ql,b.state=o.memoizedState,A=u.getDerivedStateFromProps,typeof A=="function"&&(Q_(o,u,A,f),b.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(A=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),A!==b.state&&X_.enqueueReplaceState(b,b.state,null),Xu(o,f,b,p),Qu(),b.state=o.memoizedState),typeof b.componentDidMount=="function"&&(o.flags|=4194308),f=!0}else if(a===null){b=o.stateNode;var D=o.memoizedProps,q=Mo(u,D);b.props=q;var X=b.context,ie=u.contextType;A=ql,typeof ie=="object"&&ie!==null&&(A=Nn(ie));var oe=u.getDerivedStateFromProps;ie=typeof oe=="function"||typeof b.getSnapshotBeforeUpdate=="function",D=o.pendingProps!==D,ie||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(D||X!==A)&&sE(o,b,f,A),Hr=!1;var Z=o.memoizedState;b.state=Z,Xu(o,f,b,p),Qu(),X=o.memoizedState,D||Z!==X||Hr?(typeof oe=="function"&&(Q_(o,u,oe,f),X=o.memoizedState),(q=Hr||nE(o,u,q,f,Z,X,A))?(ie||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(o.flags|=4194308)):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=X),b.props=f,b.state=X,b.context=A,f=q):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{b=o.stateNode,C_(a,o),A=o.memoizedProps,ie=Mo(u,A),b.props=ie,oe=o.pendingProps,Z=b.context,X=u.contextType,q=ql,typeof X=="object"&&X!==null&&(q=Nn(X)),D=u.getDerivedStateFromProps,(X=typeof D=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(A!==oe||Z!==q)&&sE(o,b,f,q),Hr=!1,Z=o.memoizedState,b.state=Z,Xu(o,f,b,p),Qu();var J=o.memoizedState;A!==oe||Z!==J||Hr||a!==null&&a.dependencies!==null&&jf(a.dependencies)?(typeof D=="function"&&(Q_(o,u,D,f),J=o.memoizedState),(ie=Hr||nE(o,u,ie,f,Z,J,q)||a!==null&&a.dependencies!==null&&jf(a.dependencies))?(X||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(f,J,q),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(f,J,q)),typeof b.componentDidUpdate=="function"&&(o.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof b.componentDidUpdate!="function"||A===a.memoizedProps&&Z===a.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||A===a.memoizedProps&&Z===a.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=J),b.props=f,b.state=J,b.context=q,f=ie):(typeof b.componentDidUpdate!="function"||A===a.memoizedProps&&Z===a.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||A===a.memoizedProps&&Z===a.memoizedState||(o.flags|=1024),f=!1)}return b=f,sm(a,o),f=(o.flags&128)!==0,b||f?(b=o.stateNode,u=f&&typeof u.getDerivedStateFromError!="function"?null:b.render(),o.flags|=1,a!==null&&f?(o.child=ec(o,a.child,null,p),o.child=ec(o,null,u,p)):Tn(a,o,u,p),o.memoizedState=b.state,a=o.child):a=Ki(a,o,p),a}function yE(a,o,u,f){return zu(),o.flags|=256,Tn(a,o,u,f),o.child}var ey={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ty(a){return{baseLanes:a,cachePool:rT()}}function ny(a,o,u){return a=a!==null?a.childLanes&~u:0,o&&(a|=Cs),a}function bE(a,o,u){var f=o.pendingProps,p=!1,b=(o.flags&128)!==0,A;if((A=b)||(A=a!==null&&a.memoizedState===null?!1:(on.current&2)!==0),A&&(p=!0,o.flags&=-129),A=(o.flags&32)!==0,o.flags&=-33,a===null){if(ot){if(p?Wr(o):Yr(),ot){var D=jt,q;if(q=D){e:{for(q=D,D=hi;q.nodeType!==8;){if(!D){D=null;break e}if(q=$s(q.nextSibling),q===null){D=null;break e}}D=q}D!==null?(o.memoizedState={dehydrated:D,treeContext:So!==null?{id:Hi,overflow:qi}:null,retryLane:536870912,hydrationErrors:null},q=ls(18,null,null,0),q.stateNode=D,q.return=o,o.child=q,$n=o,jt=null,q=!0):q=!1}q||Ro(o)}if(D=o.memoizedState,D!==null&&(D=D.dehydrated,D!==null))return Uy(D)?o.lanes=32:o.lanes=536870912,null;Yi(o)}return D=f.children,f=f.fallback,p?(Yr(),p=o.mode,D=im({mode:"hidden",children:D},p),f=wo(f,p,u,null),D.return=o,f.return=o,D.sibling=f,o.child=D,p=o.child,p.memoizedState=ty(u),p.childLanes=ny(a,A,u),o.memoizedState=ey,f):(Wr(o),sy(o,D))}if(q=a.memoizedState,q!==null&&(D=q.dehydrated,D!==null)){if(b)o.flags&256?(Wr(o),o.flags&=-257,o=iy(a,o,u)):o.memoizedState!==null?(Yr(),o.child=a.child,o.flags|=128,o=null):(Yr(),p=f.fallback,D=o.mode,f=im({mode:"visible",children:f.children},D),p=wo(p,D,u,null),p.flags|=2,f.return=o,p.return=o,f.sibling=p,o.child=f,ec(o,a.child,null,u),f=o.child,f.memoizedState=ty(u),f.childLanes=ny(a,A,u),o.memoizedState=ey,o=p);else if(Wr(o),Uy(D)){if(A=D.nextSibling&&D.nextSibling.dataset,A)var X=A.dgst;A=X,f=Error(s(419)),f.stack="",f.digest=A,Hu({value:f,source:null,stack:null}),o=iy(a,o,u)}else if(gn||qu(a,o,u,!1),A=(u&a.childLanes)!==0,gn||A){if(A=xt,A!==null&&(f=u&-u,f=(f&42)!==0?1:Tu(f),f=(f&(A.suspendedLanes|u))!==0?0:f,f!==0&&f!==q.retryLane))throw q.retryLane=f,Hl(a,f),fs(A,a,f),uE;D.data==="$?"||Ty(),o=iy(a,o,u)}else D.data==="$?"?(o.flags|=192,o.child=a.child,o=null):(a=q.treeContext,jt=$s(D.nextSibling),$n=o,ot=!0,Io=null,hi=!1,a!==null&&(As[Is++]=Hi,As[Is++]=qi,As[Is++]=So,Hi=a.id,qi=a.overflow,So=o),o=sy(o,f.children),o.flags|=4096);return o}return p?(Yr(),p=f.fallback,D=o.mode,q=a.child,X=q.sibling,f=zi(q,{mode:"hidden",children:f.children}),f.subtreeFlags=q.subtreeFlags&65011712,X!==null?p=zi(X,p):(p=wo(p,D,u,null),p.flags|=2),p.return=o,f.return=o,f.sibling=p,o.child=f,f=p,p=o.child,D=a.child.memoizedState,D===null?D=ty(u):(q=D.cachePool,q!==null?(X=an._currentValue,q=q.parent!==X?{parent:X,pool:X}:q):q=rT(),D={baseLanes:D.baseLanes|u,cachePool:q}),p.memoizedState=D,p.childLanes=ny(a,A,u),o.memoizedState=ey,f):(Wr(o),u=a.child,a=u.sibling,u=zi(u,{mode:"visible",children:f.children}),u.return=o,u.sibling=null,a!==null&&(A=o.deletions,A===null?(o.deletions=[a],o.flags|=16):A.push(a)),o.child=u,o.memoizedState=null,u)}function sy(a,o){return o=im({mode:"visible",children:o},a.mode),o.return=a,a.child=o}function im(a,o){return a=ls(22,a,null,o),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function iy(a,o,u){return ec(o,a.child,null,u),a=sy(o,o.pendingProps.children),a.flags|=2,o.memoizedState=null,a}function vE(a,o,u){a.lanes|=o;var f=a.alternate;f!==null&&(f.lanes|=o),T_(a.return,o,u)}function ry(a,o,u,f,p){var b=a.memoizedState;b===null?a.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:p}:(b.isBackwards=o,b.rendering=null,b.renderingStartTime=0,b.last=f,b.tail=u,b.tailMode=p)}function xE(a,o,u){var f=o.pendingProps,p=f.revealOrder,b=f.tail;if(Tn(a,o,f.children,u),f=on.current,(f&2)!==0)f=f&1|2,o.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=o.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&vE(a,u,o);else if(a.tag===19)vE(a,u,o);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}f&=1}switch(de(on,f),p){case"forwards":for(u=o.child,p=null;u!==null;)a=u.alternate,a!==null&&em(a)===null&&(p=u),u=u.sibling;u=p,u===null?(p=o.child,o.child=null):(p=u.sibling,u.sibling=null),ry(o,!1,p,u,b);break;case"backwards":for(u=null,p=o.child,o.child=null;p!==null;){if(a=p.alternate,a!==null&&em(a)===null){o.child=p;break}a=p.sibling,p.sibling=u,u=p,p=a}ry(o,!0,u,null,b);break;case"together":ry(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Ki(a,o,u){if(a!==null&&(o.dependencies=a.dependencies),Jr|=o.lanes,(u&o.childLanes)===0)if(a!==null){if(qu(a,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(a!==null&&o.child!==a.child)throw Error(s(153));if(o.child!==null){for(a=o.child,u=zi(a,a.pendingProps),o.child=u,u.return=o;a.sibling!==null;)a=a.sibling,u=u.sibling=zi(a,a.pendingProps),u.return=o;u.sibling=null}return o.child}function ay(a,o){return(a.lanes&o)!==0?!0:(a=a.dependencies,!!(a!==null&&jf(a)))}function Jk(a,o,u){switch(o.tag){case 3:tt(o,o.stateNode.containerInfo),zr(o,an,a.memoizedState.cache),zu();break;case 27:case 5:wr(o);break;case 4:tt(o,o.stateNode.containerInfo);break;case 10:zr(o,o.type,o.memoizedProps.value);break;case 13:var f=o.memoizedState;if(f!==null)return f.dehydrated!==null?(Wr(o),o.flags|=128,null):(u&o.child.childLanes)!==0?bE(a,o,u):(Wr(o),a=Ki(a,o,u),a!==null?a.sibling:null);Wr(o);break;case 19:var p=(a.flags&128)!==0;if(f=(u&o.childLanes)!==0,f||(qu(a,o,u,!1),f=(u&o.childLanes)!==0),p){if(f)return xE(a,o,u);o.flags|=128}if(p=o.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),de(on,on.current),f)break;return null;case 22:case 23:return o.lanes=0,mE(a,o,u);case 24:zr(o,an,a.memoizedState.cache)}return Ki(a,o,u)}function TE(a,o,u){if(a!==null)if(a.memoizedProps!==o.pendingProps)gn=!0;else{if(!ay(a,u)&&(o.flags&128)===0)return gn=!1,Jk(a,o,u);gn=(a.flags&131072)!==0}else gn=!1,ot&&(o.flags&1048576)!==0&&Zx(o,Lf,o.index);switch(o.lanes=0,o.tag){case 16:e:{a=o.pendingProps;var f=o.elementType,p=f._init;if(f=p(f._payload),o.type=f,typeof f=="function")g_(f)?(a=Mo(f,a),o.tag=1,o=_E(null,o,f,a,u)):(o.tag=0,o=J_(null,o,f,a,u));else{if(f!=null){if(p=f.$$typeof,p===H){o.tag=11,o=hE(null,o,f,a,u);break e}else if(p===C){o.tag=14,o=dE(null,o,f,a,u);break e}}throw o=ne(f)||f,Error(s(306,o,""))}}return o;case 0:return J_(a,o,o.type,o.pendingProps,u);case 1:return f=o.type,p=Mo(f,o.pendingProps),_E(a,o,f,p,u);case 3:e:{if(tt(o,o.stateNode.containerInfo),a===null)throw Error(s(387));f=o.pendingProps;var b=o.memoizedState;p=b.element,C_(a,o),Xu(o,f,null,u);var A=o.memoizedState;if(f=A.cache,zr(o,an,f),f!==b.cache&&E_(o,[an],u,!0),Qu(),f=A.element,b.isDehydrated)if(b={element:f,isDehydrated:!1,cache:A.cache},o.updateQueue.baseState=b,o.memoizedState=b,o.flags&256){o=yE(a,o,f,u);break e}else if(f!==p){p=ws(Error(s(424)),o),Hu(p),o=yE(a,o,f,u);break e}else{switch(a=o.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(jt=$s(a.firstChild),$n=o,ot=!0,Io=null,hi=!0,u=eE(o,null,f,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(zu(),f===p){o=Ki(a,o,u);break e}Tn(a,o,f,u)}o=o.child}return o;case 26:return sm(a,o),a===null?(u=Aw(o.type,null,o.pendingProps,null))?o.memoizedState=u:ot||(u=o.type,a=o.pendingProps,f=ym(Ae.current).createElement(u),f[qt]=o,f[xn]=a,wn(f,u,a),Gt(f),o.stateNode=f):o.memoizedState=Aw(o.type,a.memoizedProps,o.pendingProps,a.memoizedState),null;case 27:return wr(o),a===null&&ot&&(f=o.stateNode=Ew(o.type,o.pendingProps,Ae.current),$n=o,hi=!0,p=jt,sa(o.type)?(By=p,jt=$s(f.firstChild)):jt=p),Tn(a,o,o.pendingProps.children,u),sm(a,o),a===null&&(o.flags|=4194304),o.child;case 5:return a===null&&ot&&((p=f=jt)&&(f=IM(f,o.type,o.pendingProps,hi),f!==null?(o.stateNode=f,$n=o,jt=$s(f.firstChild),hi=!1,p=!0):p=!1),p||Ro(o)),wr(o),p=o.type,b=o.pendingProps,A=a!==null?a.memoizedProps:null,f=b.children,Vy(p,b)?f=null:A!==null&&Vy(p,A)&&(o.flags|=32),o.memoizedState!==null&&(p=P_(a,o,Gk,null,null,u),bh._currentValue=p),sm(a,o),Tn(a,o,f,u),o.child;case 6:return a===null&&ot&&((a=u=jt)&&(u=RM(u,o.pendingProps,hi),u!==null?(o.stateNode=u,$n=o,jt=null,a=!0):a=!1),a||Ro(o)),null;case 13:return bE(a,o,u);case 4:return tt(o,o.stateNode.containerInfo),f=o.pendingProps,a===null?o.child=ec(o,null,f,u):Tn(a,o,f,u),o.child;case 11:return hE(a,o,o.type,o.pendingProps,u);case 7:return Tn(a,o,o.pendingProps,u),o.child;case 8:return Tn(a,o,o.pendingProps.children,u),o.child;case 12:return Tn(a,o,o.pendingProps.children,u),o.child;case 10:return f=o.pendingProps,zr(o,o.type,f.value),Tn(a,o,f.children,u),o.child;case 9:return p=o.type._context,f=o.pendingProps.children,Do(o),p=Nn(p),f=f(p),o.flags|=1,Tn(a,o,f,u),o.child;case 14:return dE(a,o,o.type,o.pendingProps,u);case 15:return fE(a,o,o.type,o.pendingProps,u);case 19:return xE(a,o,u);case 31:return f=o.pendingProps,u=o.mode,f={mode:f.mode,children:f.children},a===null?(u=im(f,u),u.ref=o.ref,o.child=u,u.return=o,o=u):(u=zi(a.child,f),u.ref=o.ref,o.child=u,u.return=o,o=u),o;case 22:return mE(a,o,u);case 24:return Do(o),f=Nn(an),a===null?(p=A_(),p===null&&(p=xt,b=w_(),p.pooledCache=b,b.refCount++,b!==null&&(p.pooledCacheLanes|=u),p=b),o.memoizedState={parent:f,cache:p},R_(o),zr(o,an,p)):((a.lanes&u)!==0&&(C_(a,o),Xu(o,null,null,u),Qu()),p=a.memoizedState,b=o.memoizedState,p.parent!==f?(p={parent:f,cache:f},o.memoizedState=p,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=p),zr(o,an,f)):(f=b.cache,zr(o,an,f),f!==p.cache&&E_(o,[an],u,!0))),Tn(a,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(s(156,o.tag))}function Qi(a){a.flags|=4}function EE(a,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!Nw(o)){if(o=Rs.current,o!==null&&((Je&4194048)===Je?di!==null:(Je&62914560)!==Je&&(Je&536870912)===0||o!==di))throw Yu=I_,aT;a.flags|=8192}}function rm(a,o){o!==null&&(a.flags|=4),a.flags&16384&&(o=a.tag!==22?Cr():536870912,a.lanes|=o,ic|=o)}function ih(a,o){if(!ot)switch(a.tailMode){case"hidden":o=a.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?a.tail=null:u.sibling=null;break;case"collapsed":u=a.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?o||a.tail===null?a.tail=null:a.tail.sibling=null:f.sibling=null}}function Lt(a){var o=a.alternate!==null&&a.alternate.child===a.child,u=0,f=0;if(o)for(var p=a.child;p!==null;)u|=p.lanes|p.childLanes,f|=p.subtreeFlags&65011712,f|=p.flags&65011712,p.return=a,p=p.sibling;else for(p=a.child;p!==null;)u|=p.lanes|p.childLanes,f|=p.subtreeFlags,f|=p.flags,p.return=a,p=p.sibling;return a.subtreeFlags|=f,a.childLanes=u,o}function eM(a,o,u){var f=o.pendingProps;switch(b_(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Lt(o),null;case 1:return Lt(o),null;case 3:return u=o.stateNode,f=null,a!==null&&(f=a.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),$i(an),zt(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(a===null||a.child===null)&&(Fu(o)?Qi(o):a===null||a.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,tT())),Lt(o),null;case 26:return u=o.memoizedState,a===null?(Qi(o),u!==null?(Lt(o),EE(o,u)):(Lt(o),o.flags&=-16777217)):u?u!==a.memoizedState?(Qi(o),Lt(o),EE(o,u)):(Lt(o),o.flags&=-16777217):(a.memoizedProps!==f&&Qi(o),Lt(o),o.flags&=-16777217),null;case 27:ti(o),u=Ae.current;var p=o.type;if(a!==null&&o.stateNode!=null)a.memoizedProps!==f&&Qi(o);else{if(!f){if(o.stateNode===null)throw Error(s(166));return Lt(o),null}a=ye.current,Fu(o)?Jx(o):(a=Ew(p,f,u),o.stateNode=a,Qi(o))}return Lt(o),null;case 5:if(ti(o),u=o.type,a!==null&&o.stateNode!=null)a.memoizedProps!==f&&Qi(o);else{if(!f){if(o.stateNode===null)throw Error(s(166));return Lt(o),null}if(a=ye.current,Fu(o))Jx(o);else{switch(p=ym(Ae.current),a){case 1:a=p.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:a=p.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":a=p.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":a=p.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":a=p.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof f.is=="string"?p.createElement("select",{is:f.is}):p.createElement("select"),f.multiple?a.multiple=!0:f.size&&(a.size=f.size);break;default:a=typeof f.is=="string"?p.createElement(u,{is:f.is}):p.createElement(u)}}a[qt]=o,a[xn]=f;e:for(p=o.child;p!==null;){if(p.tag===5||p.tag===6)a.appendChild(p.stateNode);else if(p.tag!==4&&p.tag!==27&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===o)break e;for(;p.sibling===null;){if(p.return===null||p.return===o)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}o.stateNode=a;e:switch(wn(a,u,f),u){case"button":case"input":case"select":case"textarea":a=!!f.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&Qi(o)}}return Lt(o),o.flags&=-16777217,null;case 6:if(a&&o.stateNode!=null)a.memoizedProps!==f&&Qi(o);else{if(typeof f!="string"&&o.stateNode===null)throw Error(s(166));if(a=Ae.current,Fu(o)){if(a=o.stateNode,u=o.memoizedProps,f=null,p=$n,p!==null)switch(p.tag){case 27:case 5:f=p.memoizedProps}a[qt]=o,a=!!(a.nodeValue===u||f!==null&&f.suppressHydrationWarning===!0||pw(a.nodeValue,u)),a||Ro(o)}else a=ym(a).createTextNode(f),a[qt]=o,o.stateNode=a}return Lt(o),null;case 13:if(f=o.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(p=Fu(o),f!==null&&f.dehydrated!==null){if(a===null){if(!p)throw Error(s(318));if(p=o.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(s(317));p[qt]=o}else zu(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Lt(o),p=!1}else p=tT(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=p),p=!0;if(!p)return o.flags&256?(Yi(o),o):(Yi(o),null)}if(Yi(o),(o.flags&128)!==0)return o.lanes=u,o;if(u=f!==null,a=a!==null&&a.memoizedState!==null,u){f=o.child,p=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(p=f.alternate.memoizedState.cachePool.pool);var b=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(b=f.memoizedState.cachePool.pool),b!==p&&(f.flags|=2048)}return u!==a&&u&&(o.child.flags|=8192),rm(o,o.updateQueue),Lt(o),null;case 4:return zt(),a===null&&Ny(o.stateNode.containerInfo),Lt(o),null;case 10:return $i(o.type),Lt(o),null;case 19:if(he(on),p=o.memoizedState,p===null)return Lt(o),null;if(f=(o.flags&128)!==0,b=p.rendering,b===null)if(f)ih(p,!1);else{if(Ut!==0||a!==null&&(a.flags&128)!==0)for(a=o.child;a!==null;){if(b=em(a),b!==null){for(o.flags|=128,ih(p,!1),a=b.updateQueue,o.updateQueue=a,rm(o,a),o.subtreeFlags=0,a=u,u=o.child;u!==null;)Xx(u,a),u=u.sibling;return de(on,on.current&1|2),o.child}a=a.sibling}p.tail!==null&&Xn()>lm&&(o.flags|=128,f=!0,ih(p,!1),o.lanes=4194304)}else{if(!f)if(a=em(b),a!==null){if(o.flags|=128,f=!0,a=a.updateQueue,o.updateQueue=a,rm(o,a),ih(p,!0),p.tail===null&&p.tailMode==="hidden"&&!b.alternate&&!ot)return Lt(o),null}else 2*Xn()-p.renderingStartTime>lm&&u!==536870912&&(o.flags|=128,f=!0,ih(p,!1),o.lanes=4194304);p.isBackwards?(b.sibling=o.child,o.child=b):(a=p.last,a!==null?a.sibling=b:o.child=b,p.last=b)}return p.tail!==null?(o=p.tail,p.rendering=o,p.tail=o.sibling,p.renderingStartTime=Xn(),o.sibling=null,a=on.current,de(on,f?a&1|2:a&1),o):(Lt(o),null);case 22:case 23:return Yi(o),M_(),f=o.memoizedState!==null,a!==null?a.memoizedState!==null!==f&&(o.flags|=8192):f&&(o.flags|=8192),f?(u&536870912)!==0&&(o.flags&128)===0&&(Lt(o),o.subtreeFlags&6&&(o.flags|=8192)):Lt(o),u=o.updateQueue,u!==null&&rm(o,u.retryQueue),u=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),f=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==u&&(o.flags|=2048),a!==null&&he(No),null;case 24:return u=null,a!==null&&(u=a.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),$i(an),Lt(o),null;case 25:return null;case 30:return null}throw Error(s(156,o.tag))}function tM(a,o){switch(b_(o),o.tag){case 1:return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 3:return $i(an),zt(),a=o.flags,(a&65536)!==0&&(a&128)===0?(o.flags=a&-65537|128,o):null;case 26:case 27:case 5:return ti(o),null;case 13:if(Yi(o),a=o.memoizedState,a!==null&&a.dehydrated!==null){if(o.alternate===null)throw Error(s(340));zu()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 19:return he(on),null;case 4:return zt(),null;case 10:return $i(o.type),null;case 22:case 23:return Yi(o),M_(),a!==null&&he(No),a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 24:return $i(an),null;case 25:return null;default:return null}}function wE(a,o){switch(b_(o),o.tag){case 3:$i(an),zt();break;case 26:case 27:case 5:ti(o);break;case 4:zt();break;case 13:Yi(o);break;case 19:he(on);break;case 10:$i(o.type);break;case 22:case 23:Yi(o),M_(),a!==null&&he(No);break;case 24:$i(an)}}function rh(a,o){try{var u=o.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var p=f.next;u=p;do{if((u.tag&a)===a){f=void 0;var b=u.create,A=u.inst;f=b(),A.destroy=f}u=u.next}while(u!==p)}}catch(D){bt(o,o.return,D)}}function Kr(a,o,u){try{var f=o.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var b=p.next;f=b;do{if((f.tag&a)===a){var A=f.inst,D=A.destroy;if(D!==void 0){A.destroy=void 0,p=o;var q=u,X=D;try{X()}catch(ie){bt(p,q,ie)}}}f=f.next}while(f!==b)}}catch(ie){bt(o,o.return,ie)}}function SE(a){var o=a.updateQueue;if(o!==null){var u=a.stateNode;try{dT(o,u)}catch(f){bt(a,a.return,f)}}}function AE(a,o,u){u.props=Mo(a.type,a.memoizedProps),u.state=a.memoizedState;try{u.componentWillUnmount()}catch(f){bt(a,o,f)}}function ah(a,o){try{var u=a.ref;if(u!==null){switch(a.tag){case 26:case 27:case 5:var f=a.stateNode;break;case 30:f=a.stateNode;break;default:f=a.stateNode}typeof u=="function"?a.refCleanup=u(f):u.current=f}}catch(p){bt(a,o,p)}}function fi(a,o){var u=a.ref,f=a.refCleanup;if(u!==null)if(typeof f=="function")try{f()}catch(p){bt(a,o,p)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(p){bt(a,o,p)}else u.current=null}function IE(a){var o=a.type,u=a.memoizedProps,f=a.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&f.focus();break e;case"img":u.src?f.src=u.src:u.srcSet&&(f.srcset=u.srcSet)}}catch(p){bt(a,a.return,p)}}function oy(a,o,u){try{var f=a.stateNode;TM(f,a.type,u,o),f[xn]=o}catch(p){bt(a,a.return,p)}}function RE(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&sa(a.type)||a.tag===4}function ly(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||RE(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&sa(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function cy(a,o,u){var f=a.tag;if(f===5||f===6)a=a.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(a,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(a),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=_m));else if(f!==4&&(f===27&&sa(a.type)&&(u=a.stateNode,o=null),a=a.child,a!==null))for(cy(a,o,u),a=a.sibling;a!==null;)cy(a,o,u),a=a.sibling}function am(a,o,u){var f=a.tag;if(f===5||f===6)a=a.stateNode,o?u.insertBefore(a,o):u.appendChild(a);else if(f!==4&&(f===27&&sa(a.type)&&(u=a.stateNode),a=a.child,a!==null))for(am(a,o,u),a=a.sibling;a!==null;)am(a,o,u),a=a.sibling}function CE(a){var o=a.stateNode,u=a.memoizedProps;try{for(var f=a.type,p=o.attributes;p.length;)o.removeAttributeNode(p[0]);wn(o,f,u),o[qt]=a,o[xn]=u}catch(b){bt(a,a.return,b)}}var Xi=!1,Yt=!1,uy=!1,DE=typeof WeakSet=="function"?WeakSet:Set,pn=null;function nM(a,o){if(a=a.containerInfo,Oy=wm,a=Fx(a),l_(a)){if("selectionStart"in a)var u={start:a.selectionStart,end:a.selectionEnd};else e:{u=(u=a.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var p=f.anchorOffset,b=f.focusNode;f=f.focusOffset;try{u.nodeType,b.nodeType}catch{u=null;break e}var A=0,D=-1,q=-1,X=0,ie=0,oe=a,Z=null;t:for(;;){for(var J;oe!==u||p!==0&&oe.nodeType!==3||(D=A+p),oe!==b||f!==0&&oe.nodeType!==3||(q=A+f),oe.nodeType===3&&(A+=oe.nodeValue.length),(J=oe.firstChild)!==null;)Z=oe,oe=J;for(;;){if(oe===a)break t;if(Z===u&&++X===p&&(D=A),Z===b&&++ie===f&&(q=A),(J=oe.nextSibling)!==null)break;oe=Z,Z=oe.parentNode}oe=J}u=D===-1||q===-1?null:{start:D,end:q}}else u=null}u=u||{start:0,end:0}}else u=null;for(Py={focusedElem:a,selectionRange:u},wm=!1,pn=o;pn!==null;)if(o=pn,a=o.child,(o.subtreeFlags&1024)!==0&&a!==null)a.return=o,pn=a;else for(;pn!==null;){switch(o=pn,b=o.alternate,a=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&b!==null){a=void 0,u=o,p=b.memoizedProps,b=b.memoizedState,f=u.stateNode;try{var Me=Mo(u.type,p,u.elementType===u.type);a=f.getSnapshotBeforeUpdate(Me,b),f.__reactInternalSnapshotBeforeUpdate=a}catch(Ne){bt(u,u.return,Ne)}}break;case 3:if((a&1024)!==0){if(a=o.stateNode.containerInfo,u=a.nodeType,u===9)jy(a);else if(u===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":jy(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(s(163))}if(a=o.sibling,a!==null){a.return=o.return,pn=a;break}pn=o.return}}function NE(a,o,u){var f=u.flags;switch(u.tag){case 0:case 11:case 15:Qr(a,u),f&4&&rh(5,u);break;case 1:if(Qr(a,u),f&4)if(a=u.stateNode,o===null)try{a.componentDidMount()}catch(A){bt(u,u.return,A)}else{var p=Mo(u.type,o.memoizedProps);o=o.memoizedState;try{a.componentDidUpdate(p,o,a.__reactInternalSnapshotBeforeUpdate)}catch(A){bt(u,u.return,A)}}f&64&&SE(u),f&512&&ah(u,u.return);break;case 3:if(Qr(a,u),f&64&&(a=u.updateQueue,a!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{dT(a,o)}catch(A){bt(u,u.return,A)}}break;case 27:o===null&&f&4&&CE(u);case 26:case 5:Qr(a,u),o===null&&f&4&&IE(u),f&512&&ah(u,u.return);break;case 12:Qr(a,u);break;case 13:Qr(a,u),f&4&&OE(a,u),f&64&&(a=u.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(u=hM.bind(null,u),CM(a,u))));break;case 22:if(f=u.memoizedState!==null||Xi,!f){o=o!==null&&o.memoizedState!==null||Yt,p=Xi;var b=Yt;Xi=f,(Yt=o)&&!b?Xr(a,u,(u.subtreeFlags&8772)!==0):Qr(a,u),Xi=p,Yt=b}break;case 30:break;default:Qr(a,u)}}function kE(a){var o=a.alternate;o!==null&&(a.alternate=null,kE(o)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(o=a.stateNode,o!==null&&Rl(o)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Dt=null,Jn=!1;function Zi(a,o,u){for(u=u.child;u!==null;)ME(a,o,u),u=u.sibling}function ME(a,o,u){if(Cn&&typeof Cn.onCommitFiberUnmount=="function")try{Cn.onCommitFiberUnmount(Ar,u)}catch{}switch(u.tag){case 26:Yt||fi(u,o),Zi(a,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Yt||fi(u,o);var f=Dt,p=Jn;sa(u.type)&&(Dt=u.stateNode,Jn=!1),Zi(a,o,u),gh(u.stateNode),Dt=f,Jn=p;break;case 5:Yt||fi(u,o);case 6:if(f=Dt,p=Jn,Dt=null,Zi(a,o,u),Dt=f,Jn=p,Dt!==null)if(Jn)try{(Dt.nodeType===9?Dt.body:Dt.nodeName==="HTML"?Dt.ownerDocument.body:Dt).removeChild(u.stateNode)}catch(b){bt(u,o,b)}else try{Dt.removeChild(u.stateNode)}catch(b){bt(u,o,b)}break;case 18:Dt!==null&&(Jn?(a=Dt,xw(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,u.stateNode),Eh(a)):xw(Dt,u.stateNode));break;case 4:f=Dt,p=Jn,Dt=u.stateNode.containerInfo,Jn=!0,Zi(a,o,u),Dt=f,Jn=p;break;case 0:case 11:case 14:case 15:Yt||Kr(2,u,o),Yt||Kr(4,u,o),Zi(a,o,u);break;case 1:Yt||(fi(u,o),f=u.stateNode,typeof f.componentWillUnmount=="function"&&AE(u,o,f)),Zi(a,o,u);break;case 21:Zi(a,o,u);break;case 22:Yt=(f=Yt)||u.memoizedState!==null,Zi(a,o,u),Yt=f;break;default:Zi(a,o,u)}}function OE(a,o){if(o.memoizedState===null&&(a=o.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Eh(a)}catch(u){bt(o,o.return,u)}}function sM(a){switch(a.tag){case 13:case 19:var o=a.stateNode;return o===null&&(o=a.stateNode=new DE),o;case 22:return a=a.stateNode,o=a._retryCache,o===null&&(o=a._retryCache=new DE),o;default:throw Error(s(435,a.tag))}}function hy(a,o){var u=sM(a);o.forEach(function(f){var p=dM.bind(null,a,f);u.has(f)||(u.add(f),f.then(p,p))})}function cs(a,o){var u=o.deletions;if(u!==null)for(var f=0;f<u.length;f++){var p=u[f],b=a,A=o,D=A;e:for(;D!==null;){switch(D.tag){case 27:if(sa(D.type)){Dt=D.stateNode,Jn=!1;break e}break;case 5:Dt=D.stateNode,Jn=!1;break e;case 3:case 4:Dt=D.stateNode.containerInfo,Jn=!0;break e}D=D.return}if(Dt===null)throw Error(s(160));ME(b,A,p),Dt=null,Jn=!1,b=p.alternate,b!==null&&(b.return=null),p.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)PE(o,a),o=o.sibling}var Gs=null;function PE(a,o){var u=a.alternate,f=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:cs(o,a),us(a),f&4&&(Kr(3,a,a.return),rh(3,a),Kr(5,a,a.return));break;case 1:cs(o,a),us(a),f&512&&(Yt||u===null||fi(u,u.return)),f&64&&Xi&&(a=a.updateQueue,a!==null&&(f=a.callbacks,f!==null&&(u=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=u===null?f:u.concat(f))));break;case 26:var p=Gs;if(cs(o,a),us(a),f&512&&(Yt||u===null||fi(u,u.return)),f&4){var b=u!==null?u.memoizedState:null;if(f=a.memoizedState,u===null)if(f===null)if(a.stateNode===null){e:{f=a.type,u=a.memoizedProps,p=p.ownerDocument||p;t:switch(f){case"title":b=p.getElementsByTagName("title")[0],(!b||b[kr]||b[qt]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=p.createElement(f),p.head.insertBefore(b,p.querySelector("head > title"))),wn(b,f,u),b[qt]=a,Gt(b),f=b;break e;case"link":var A=Cw("link","href",p).get(f+(u.href||""));if(A){for(var D=0;D<A.length;D++)if(b=A[D],b.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&b.getAttribute("rel")===(u.rel==null?null:u.rel)&&b.getAttribute("title")===(u.title==null?null:u.title)&&b.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){A.splice(D,1);break t}}b=p.createElement(f),wn(b,f,u),p.head.appendChild(b);break;case"meta":if(A=Cw("meta","content",p).get(f+(u.content||""))){for(D=0;D<A.length;D++)if(b=A[D],b.getAttribute("content")===(u.content==null?null:""+u.content)&&b.getAttribute("name")===(u.name==null?null:u.name)&&b.getAttribute("property")===(u.property==null?null:u.property)&&b.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&b.getAttribute("charset")===(u.charSet==null?null:u.charSet)){A.splice(D,1);break t}}b=p.createElement(f),wn(b,f,u),p.head.appendChild(b);break;default:throw Error(s(468,f))}b[qt]=a,Gt(b),f=b}a.stateNode=f}else Dw(p,a.type,a.stateNode);else a.stateNode=Rw(p,f,a.memoizedProps);else b!==f?(b===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):b.count--,f===null?Dw(p,a.type,a.stateNode):Rw(p,f,a.memoizedProps)):f===null&&a.stateNode!==null&&oy(a,a.memoizedProps,u.memoizedProps)}break;case 27:cs(o,a),us(a),f&512&&(Yt||u===null||fi(u,u.return)),u!==null&&f&4&&oy(a,a.memoizedProps,u.memoizedProps);break;case 5:if(cs(o,a),us(a),f&512&&(Yt||u===null||fi(u,u.return)),a.flags&32){p=a.stateNode;try{Ts(p,"")}catch(J){bt(a,a.return,J)}}f&4&&a.stateNode!=null&&(p=a.memoizedProps,oy(a,p,u!==null?u.memoizedProps:p)),f&1024&&(uy=!0);break;case 6:if(cs(o,a),us(a),f&4){if(a.stateNode===null)throw Error(s(162));f=a.memoizedProps,u=a.stateNode;try{u.nodeValue=f}catch(J){bt(a,a.return,J)}}break;case 3:if(xm=null,p=Gs,Gs=bm(o.containerInfo),cs(o,a),Gs=p,us(a),f&4&&u!==null&&u.memoizedState.isDehydrated)try{Eh(o.containerInfo)}catch(J){bt(a,a.return,J)}uy&&(uy=!1,VE(a));break;case 4:f=Gs,Gs=bm(a.stateNode.containerInfo),cs(o,a),us(a),Gs=f;break;case 12:cs(o,a),us(a);break;case 13:cs(o,a),us(a),a.child.flags&8192&&a.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(_y=Xn()),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,hy(a,f)));break;case 22:p=a.memoizedState!==null;var q=u!==null&&u.memoizedState!==null,X=Xi,ie=Yt;if(Xi=X||p,Yt=ie||q,cs(o,a),Yt=ie,Xi=X,us(a),f&8192)e:for(o=a.stateNode,o._visibility=p?o._visibility&-2:o._visibility|1,p&&(u===null||q||Xi||Yt||Oo(a)),u=null,o=a;;){if(o.tag===5||o.tag===26){if(u===null){q=u=o;try{if(b=q.stateNode,p)A=b.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{D=q.stateNode;var oe=q.memoizedProps.style,Z=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;D.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(J){bt(q,q.return,J)}}}else if(o.tag===6){if(u===null){q=o;try{q.stateNode.nodeValue=p?"":q.memoizedProps}catch(J){bt(q,q.return,J)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===a)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}f&4&&(f=a.updateQueue,f!==null&&(u=f.retryQueue,u!==null&&(f.retryQueue=null,hy(a,u))));break;case 19:cs(o,a),us(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,hy(a,f)));break;case 30:break;case 21:break;default:cs(o,a),us(a)}}function us(a){var o=a.flags;if(o&2){try{for(var u,f=a.return;f!==null;){if(RE(f)){u=f;break}f=f.return}if(u==null)throw Error(s(160));switch(u.tag){case 27:var p=u.stateNode,b=ly(a);am(a,b,p);break;case 5:var A=u.stateNode;u.flags&32&&(Ts(A,""),u.flags&=-33);var D=ly(a);am(a,D,A);break;case 3:case 4:var q=u.stateNode.containerInfo,X=ly(a);cy(a,X,q);break;default:throw Error(s(161))}}catch(ie){bt(a,a.return,ie)}a.flags&=-3}o&4096&&(a.flags&=-4097)}function VE(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var o=a;VE(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),a=a.sibling}}function Qr(a,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)NE(a,o.alternate,o),o=o.sibling}function Oo(a){for(a=a.child;a!==null;){var o=a;switch(o.tag){case 0:case 11:case 14:case 15:Kr(4,o,o.return),Oo(o);break;case 1:fi(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&AE(o,o.return,u),Oo(o);break;case 27:gh(o.stateNode);case 26:case 5:fi(o,o.return),Oo(o);break;case 22:o.memoizedState===null&&Oo(o);break;case 30:Oo(o);break;default:Oo(o)}a=a.sibling}}function Xr(a,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var f=o.alternate,p=a,b=o,A=b.flags;switch(b.tag){case 0:case 11:case 15:Xr(p,b,u),rh(4,b);break;case 1:if(Xr(p,b,u),f=b,p=f.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(X){bt(f,f.return,X)}if(f=b,p=f.updateQueue,p!==null){var D=f.stateNode;try{var q=p.shared.hiddenCallbacks;if(q!==null)for(p.shared.hiddenCallbacks=null,p=0;p<q.length;p++)hT(q[p],D)}catch(X){bt(f,f.return,X)}}u&&A&64&&SE(b),ah(b,b.return);break;case 27:CE(b);case 26:case 5:Xr(p,b,u),u&&f===null&&A&4&&IE(b),ah(b,b.return);break;case 12:Xr(p,b,u);break;case 13:Xr(p,b,u),u&&A&4&&OE(p,b);break;case 22:b.memoizedState===null&&Xr(p,b,u),ah(b,b.return);break;case 30:break;default:Xr(p,b,u)}o=o.sibling}}function dy(a,o){var u=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),a=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(a=o.memoizedState.cachePool.pool),a!==u&&(a!=null&&a.refCount++,u!=null&&Gu(u))}function fy(a,o){a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&Gu(a))}function mi(a,o,u,f){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)LE(a,o,u,f),o=o.sibling}function LE(a,o,u,f){var p=o.flags;switch(o.tag){case 0:case 11:case 15:mi(a,o,u,f),p&2048&&rh(9,o);break;case 1:mi(a,o,u,f);break;case 3:mi(a,o,u,f),p&2048&&(a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&Gu(a)));break;case 12:if(p&2048){mi(a,o,u,f),a=o.stateNode;try{var b=o.memoizedProps,A=b.id,D=b.onPostCommit;typeof D=="function"&&D(A,o.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(q){bt(o,o.return,q)}}else mi(a,o,u,f);break;case 13:mi(a,o,u,f);break;case 23:break;case 22:b=o.stateNode,A=o.alternate,o.memoizedState!==null?b._visibility&2?mi(a,o,u,f):oh(a,o):b._visibility&2?mi(a,o,u,f):(b._visibility|=2,tc(a,o,u,f,(o.subtreeFlags&10256)!==0)),p&2048&&dy(A,o);break;case 24:mi(a,o,u,f),p&2048&&fy(o.alternate,o);break;default:mi(a,o,u,f)}}function tc(a,o,u,f,p){for(p=p&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var b=a,A=o,D=u,q=f,X=A.flags;switch(A.tag){case 0:case 11:case 15:tc(b,A,D,q,p),rh(8,A);break;case 23:break;case 22:var ie=A.stateNode;A.memoizedState!==null?ie._visibility&2?tc(b,A,D,q,p):oh(b,A):(ie._visibility|=2,tc(b,A,D,q,p)),p&&X&2048&&dy(A.alternate,A);break;case 24:tc(b,A,D,q,p),p&&X&2048&&fy(A.alternate,A);break;default:tc(b,A,D,q,p)}o=o.sibling}}function oh(a,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=a,f=o,p=f.flags;switch(f.tag){case 22:oh(u,f),p&2048&&dy(f.alternate,f);break;case 24:oh(u,f),p&2048&&fy(f.alternate,f);break;default:oh(u,f)}o=o.sibling}}var lh=8192;function nc(a){if(a.subtreeFlags&lh)for(a=a.child;a!==null;)jE(a),a=a.sibling}function jE(a){switch(a.tag){case 26:nc(a),a.flags&lh&&a.memoizedState!==null&&zM(Gs,a.memoizedState,a.memoizedProps);break;case 5:nc(a);break;case 3:case 4:var o=Gs;Gs=bm(a.stateNode.containerInfo),nc(a),Gs=o;break;case 22:a.memoizedState===null&&(o=a.alternate,o!==null&&o.memoizedState!==null?(o=lh,lh=16777216,nc(a),lh=o):nc(a));break;default:nc(a)}}function UE(a){var o=a.alternate;if(o!==null&&(a=o.child,a!==null)){o.child=null;do o=a.sibling,a.sibling=null,a=o;while(a!==null)}}function ch(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];pn=f,FE(f,a)}UE(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)BE(a),a=a.sibling}function BE(a){switch(a.tag){case 0:case 11:case 15:ch(a),a.flags&2048&&Kr(9,a,a.return);break;case 3:ch(a);break;case 12:ch(a);break;case 22:var o=a.stateNode;a.memoizedState!==null&&o._visibility&2&&(a.return===null||a.return.tag!==13)?(o._visibility&=-3,om(a)):ch(a);break;default:ch(a)}}function om(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];pn=f,FE(f,a)}UE(a)}for(a=a.child;a!==null;){switch(o=a,o.tag){case 0:case 11:case 15:Kr(8,o,o.return),om(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,om(o));break;default:om(o)}a=a.sibling}}function FE(a,o){for(;pn!==null;){var u=pn;switch(u.tag){case 0:case 11:case 15:Kr(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var f=u.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Gu(u.memoizedState.cache)}if(f=u.child,f!==null)f.return=u,pn=f;else e:for(u=a;pn!==null;){f=pn;var p=f.sibling,b=f.return;if(kE(f),f===u){pn=null;break e}if(p!==null){p.return=b,pn=p;break e}pn=b}}}var iM={getCacheForType:function(a){var o=Nn(an),u=o.data.get(a);return u===void 0&&(u=a(),o.data.set(a,u)),u}},rM=typeof WeakMap=="function"?WeakMap:Map,ut=0,xt=null,$e=null,Je=0,ht=0,hs=null,Zr=!1,sc=!1,my=!1,Ji=0,Ut=0,Jr=0,Po=0,gy=0,Cs=0,ic=0,uh=null,es=null,py=!1,_y=0,lm=1/0,cm=null,ea=null,En=0,ta=null,rc=null,ac=0,yy=0,by=null,zE=null,hh=0,vy=null;function ds(){if((ut&2)!==0&&Je!==0)return Je&-Je;if(Y.T!==null){var a=Wl;return a!==0?a:Iy()}return Pi()}function HE(){Cs===0&&(Cs=(Je&536870912)===0||ot?xu():536870912);var a=Rs.current;return a!==null&&(a.flags|=32),Cs}function fs(a,o,u){(a===xt&&(ht===2||ht===9)||a.cancelPendingCommit!==null)&&(oc(a,0),na(a,Je,Cs,!1)),Ht(a,u),((ut&2)===0||a!==xt)&&(a===xt&&((ut&2)===0&&(Po|=u),Ut===4&&na(a,Je,Cs,!1)),gi(a))}function qE(a,o,u){if((ut&6)!==0)throw Error(s(327));var f=!u&&(o&124)===0&&(o&a.expiredLanes)===0||Rr(a,o),p=f?lM(a,o):Ey(a,o,!0),b=f;do{if(p===0){sc&&!f&&na(a,o,0,!1);break}else{if(u=a.current.alternate,b&&!aM(u)){p=Ey(a,o,!1),b=!1;continue}if(p===2){if(b=o,a.errorRecoveryDisabledLanes&b)var A=0;else A=a.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){o=A;e:{var D=a;p=uh;var q=D.current.memoizedState.isDehydrated;if(q&&(oc(D,A).flags|=256),A=Ey(D,A,!1),A!==2){if(my&&!q){D.errorRecoveryDisabledLanes|=b,Po|=b,p=4;break e}b=es,es=p,b!==null&&(es===null?es=b:es.push.apply(es,b))}p=A}if(b=!1,p!==2)continue}}if(p===1){oc(a,0),na(a,o,0,!0);break}e:{switch(f=a,b=p,b){case 0:case 1:throw Error(s(345));case 4:if((o&4194048)!==o)break;case 6:na(f,o,Cs,!Zr);break e;case 2:es=null;break;case 3:case 5:break;default:throw Error(s(329))}if((o&62914560)===o&&(p=_y+300-Xn(),10<p)){if(na(f,o,Cs,!Zr),vs(f,0,!0)!==0)break e;f.timeoutHandle=bw(GE.bind(null,f,u,es,cm,py,o,Cs,Po,ic,Zr,b,2,-0,0),p);break e}GE(f,u,es,cm,py,o,Cs,Po,ic,Zr,b,0,-0,0)}}break}while(!0);gi(a)}function GE(a,o,u,f,p,b,A,D,q,X,ie,oe,Z,J){if(a.timeoutHandle=-1,oe=o.subtreeFlags,(oe&8192||(oe&16785408)===16785408)&&(yh={stylesheets:null,count:0,unsuspend:FM},jE(o),oe=HM(),oe!==null)){a.cancelPendingCommit=oe(ZE.bind(null,a,o,b,u,f,p,A,D,q,ie,1,Z,J)),na(a,b,A,!X);return}ZE(a,o,b,u,f,p,A,D,q)}function aM(a){for(var o=a;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var f=0;f<u.length;f++){var p=u[f],b=p.getSnapshot;p=p.value;try{if(!os(b(),p))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function na(a,o,u,f){o&=~gy,o&=~Po,a.suspendedLanes|=o,a.pingedLanes&=~o,f&&(a.warmLanes|=o),f=a.expirationTimes;for(var p=o;0<p;){var b=31-zn(p),A=1<<b;f[b]=-1,p&=~A}u!==0&&Dr(a,u,o)}function um(){return(ut&6)===0?(dh(0),!1):!0}function xy(){if($e!==null){if(ht===0)var a=$e.return;else a=$e,Gi=Co=null,j_(a),Jl=null,nh=0,a=$e;for(;a!==null;)wE(a.alternate,a),a=a.return;$e=null}}function oc(a,o){var u=a.timeoutHandle;u!==-1&&(a.timeoutHandle=-1,wM(u)),u=a.cancelPendingCommit,u!==null&&(a.cancelPendingCommit=null,u()),xy(),xt=a,$e=u=zi(a.current,null),Je=o,ht=0,hs=null,Zr=!1,sc=Rr(a,o),my=!1,ic=Cs=gy=Po=Jr=Ut=0,es=uh=null,py=!1,(o&8)!==0&&(o|=o&32);var f=a.entangledLanes;if(f!==0)for(a=a.entanglements,f&=o;0<f;){var p=31-zn(f),b=1<<p;o|=a[p],f&=~b}return Ji=o,kf(),u}function $E(a,o){He=null,Y.H=Xf,o===Wu||o===Ff?(o=cT(),ht=3):o===aT?(o=cT(),ht=4):ht=o===uE?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,hs=o,$e===null&&(Ut=1,nm(a,ws(o,a.current)))}function WE(){var a=Y.H;return Y.H=Xf,a===null?Xf:a}function YE(){var a=Y.A;return Y.A=iM,a}function Ty(){Ut=4,Zr||(Je&4194048)!==Je&&Rs.current!==null||(sc=!0),(Jr&134217727)===0&&(Po&134217727)===0||xt===null||na(xt,Je,Cs,!1)}function Ey(a,o,u){var f=ut;ut|=2;var p=WE(),b=YE();(xt!==a||Je!==o)&&(cm=null,oc(a,o)),o=!1;var A=Ut;e:do try{if(ht!==0&&$e!==null){var D=$e,q=hs;switch(ht){case 8:xy(),A=6;break e;case 3:case 2:case 9:case 6:Rs.current===null&&(o=!0);var X=ht;if(ht=0,hs=null,lc(a,D,q,X),u&&sc){A=0;break e}break;default:X=ht,ht=0,hs=null,lc(a,D,q,X)}}oM(),A=Ut;break}catch(ie){$E(a,ie)}while(!0);return o&&a.shellSuspendCounter++,Gi=Co=null,ut=f,Y.H=p,Y.A=b,$e===null&&(xt=null,Je=0,kf()),A}function oM(){for(;$e!==null;)KE($e)}function lM(a,o){var u=ut;ut|=2;var f=WE(),p=YE();xt!==a||Je!==o?(cm=null,lm=Xn()+500,oc(a,o)):sc=Rr(a,o);e:do try{if(ht!==0&&$e!==null){o=$e;var b=hs;t:switch(ht){case 1:ht=0,hs=null,lc(a,o,b,1);break;case 2:case 9:if(oT(b)){ht=0,hs=null,QE(o);break}o=function(){ht!==2&&ht!==9||xt!==a||(ht=7),gi(a)},b.then(o,o);break e;case 3:ht=7;break e;case 4:ht=5;break e;case 7:oT(b)?(ht=0,hs=null,QE(o)):(ht=0,hs=null,lc(a,o,b,7));break;case 5:var A=null;switch($e.tag){case 26:A=$e.memoizedState;case 5:case 27:var D=$e;if(!A||Nw(A)){ht=0,hs=null;var q=D.sibling;if(q!==null)$e=q;else{var X=D.return;X!==null?($e=X,hm(X)):$e=null}break t}}ht=0,hs=null,lc(a,o,b,5);break;case 6:ht=0,hs=null,lc(a,o,b,6);break;case 8:xy(),Ut=6;break e;default:throw Error(s(462))}}cM();break}catch(ie){$E(a,ie)}while(!0);return Gi=Co=null,Y.H=f,Y.A=p,ut=u,$e!==null?0:(xt=null,Je=0,kf(),Ut)}function cM(){for(;$e!==null&&!Xp();)KE($e)}function KE(a){var o=TE(a.alternate,a,Ji);a.memoizedProps=a.pendingProps,o===null?hm(a):$e=o}function QE(a){var o=a,u=o.alternate;switch(o.tag){case 15:case 0:o=pE(u,o,o.pendingProps,o.type,void 0,Je);break;case 11:o=pE(u,o,o.pendingProps,o.type.render,o.ref,Je);break;case 5:j_(o);default:wE(u,o),o=$e=Xx(o,Ji),o=TE(u,o,Ji)}a.memoizedProps=a.pendingProps,o===null?hm(a):$e=o}function lc(a,o,u,f){Gi=Co=null,j_(o),Jl=null,nh=0;var p=o.return;try{if(Zk(a,p,o,u,Je)){Ut=1,nm(a,ws(u,a.current)),$e=null;return}}catch(b){if(p!==null)throw $e=p,b;Ut=1,nm(a,ws(u,a.current)),$e=null;return}o.flags&32768?(ot||f===1?a=!0:sc||(Je&536870912)!==0?a=!1:(Zr=a=!0,(f===2||f===9||f===3||f===6)&&(f=Rs.current,f!==null&&f.tag===13&&(f.flags|=16384))),XE(o,a)):hm(o)}function hm(a){var o=a;do{if((o.flags&32768)!==0){XE(o,Zr);return}a=o.return;var u=eM(o.alternate,o,Ji);if(u!==null){$e=u;return}if(o=o.sibling,o!==null){$e=o;return}$e=o=a}while(o!==null);Ut===0&&(Ut=5)}function XE(a,o){do{var u=tM(a.alternate,a);if(u!==null){u.flags&=32767,$e=u;return}if(u=a.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(a=a.sibling,a!==null)){$e=a;return}$e=a=u}while(a!==null);Ut=6,$e=null}function ZE(a,o,u,f,p,b,A,D,q){a.cancelPendingCommit=null;do dm();while(En!==0);if((ut&6)!==0)throw Error(s(327));if(o!==null){if(o===a.current)throw Error(s(177));if(b=o.lanes|o.childLanes,b|=f_,gf(a,u,b,A,D,q),a===xt&&($e=xt=null,Je=0),rc=o,ta=a,ac=u,yy=b,by=p,zE=f,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,fM(Oi,function(){return sw(),null})):(a.callbackNode=null,a.callbackPriority=0),f=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||f){f=Y.T,Y.T=null,p=ae.p,ae.p=2,A=ut,ut|=4;try{nM(a,o,u)}finally{ut=A,ae.p=p,Y.T=f}}En=1,JE(),ew(),tw()}}function JE(){if(En===1){En=0;var a=ta,o=rc,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=Y.T,Y.T=null;var f=ae.p;ae.p=2;var p=ut;ut|=4;try{PE(o,a);var b=Py,A=Fx(a.containerInfo),D=b.focusedElem,q=b.selectionRange;if(A!==D&&D&&D.ownerDocument&&Bx(D.ownerDocument.documentElement,D)){if(q!==null&&l_(D)){var X=q.start,ie=q.end;if(ie===void 0&&(ie=X),"selectionStart"in D)D.selectionStart=X,D.selectionEnd=Math.min(ie,D.value.length);else{var oe=D.ownerDocument||document,Z=oe&&oe.defaultView||window;if(Z.getSelection){var J=Z.getSelection(),Me=D.textContent.length,Ne=Math.min(q.start,Me),yt=q.end===void 0?Ne:Math.min(q.end,Me);!J.extend&&Ne>yt&&(A=yt,yt=Ne,Ne=A);var $=Ux(D,Ne),G=Ux(D,yt);if($&&G&&(J.rangeCount!==1||J.anchorNode!==$.node||J.anchorOffset!==$.offset||J.focusNode!==G.node||J.focusOffset!==G.offset)){var K=oe.createRange();K.setStart($.node,$.offset),J.removeAllRanges(),Ne>yt?(J.addRange(K),J.extend(G.node,G.offset)):(K.setEnd(G.node,G.offset),J.addRange(K))}}}}for(oe=[],J=D;J=J.parentNode;)J.nodeType===1&&oe.push({element:J,left:J.scrollLeft,top:J.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<oe.length;D++){var re=oe[D];re.element.scrollLeft=re.left,re.element.scrollTop=re.top}}wm=!!Oy,Py=Oy=null}finally{ut=p,ae.p=f,Y.T=u}}a.current=o,En=2}}function ew(){if(En===2){En=0;var a=ta,o=rc,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=Y.T,Y.T=null;var f=ae.p;ae.p=2;var p=ut;ut|=4;try{NE(a,o.alternate,o)}finally{ut=p,ae.p=f,Y.T=u}}En=3}}function tw(){if(En===4||En===3){En=0,bu();var a=ta,o=rc,u=ac,f=zE;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?En=5:(En=0,rc=ta=null,nw(a,a.pendingLanes));var p=a.pendingLanes;if(p===0&&(ea=null),Eu(u),o=o.stateNode,Cn&&typeof Cn.onCommitFiberRoot=="function")try{Cn.onCommitFiberRoot(Ar,o,void 0,(o.current.flags&128)===128)}catch{}if(f!==null){o=Y.T,p=ae.p,ae.p=2,Y.T=null;try{for(var b=a.onRecoverableError,A=0;A<f.length;A++){var D=f[A];b(D.value,{componentStack:D.stack})}}finally{Y.T=o,ae.p=p}}(ac&3)!==0&&dm(),gi(a),p=a.pendingLanes,(u&4194090)!==0&&(p&42)!==0?a===vy?hh++:(hh=0,vy=a):hh=0,dh(0)}}function nw(a,o){(a.pooledCacheLanes&=o)===0&&(o=a.pooledCache,o!=null&&(a.pooledCache=null,Gu(o)))}function dm(a){return JE(),ew(),tw(),sw()}function sw(){if(En!==5)return!1;var a=ta,o=yy;yy=0;var u=Eu(ac),f=Y.T,p=ae.p;try{ae.p=32>u?32:u,Y.T=null,u=by,by=null;var b=ta,A=ac;if(En=0,rc=ta=null,ac=0,(ut&6)!==0)throw Error(s(331));var D=ut;if(ut|=4,BE(b.current),LE(b,b.current,A,u),ut=D,dh(0,!1),Cn&&typeof Cn.onPostCommitFiberRoot=="function")try{Cn.onPostCommitFiberRoot(Ar,b)}catch{}return!0}finally{ae.p=p,Y.T=f,nw(a,o)}}function iw(a,o,u){o=ws(u,o),o=Z_(a.stateNode,o,2),a=Gr(a,o,2),a!==null&&(Ht(a,2),gi(a))}function bt(a,o,u){if(a.tag===3)iw(a,a,u);else for(;o!==null;){if(o.tag===3){iw(o,a,u);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(ea===null||!ea.has(f))){a=ws(u,a),u=lE(2),f=Gr(o,u,2),f!==null&&(cE(u,f,o,a),Ht(f,2),gi(f));break}}o=o.return}}function wy(a,o,u){var f=a.pingCache;if(f===null){f=a.pingCache=new rM;var p=new Set;f.set(o,p)}else p=f.get(o),p===void 0&&(p=new Set,f.set(o,p));p.has(u)||(my=!0,p.add(u),a=uM.bind(null,a,o,u),o.then(a,a))}function uM(a,o,u){var f=a.pingCache;f!==null&&f.delete(o),a.pingedLanes|=a.suspendedLanes&u,a.warmLanes&=~u,xt===a&&(Je&u)===u&&(Ut===4||Ut===3&&(Je&62914560)===Je&&300>Xn()-_y?(ut&2)===0&&oc(a,0):gy|=u,ic===Je&&(ic=0)),gi(a)}function rw(a,o){o===0&&(o=Cr()),a=Hl(a,o),a!==null&&(Ht(a,o),gi(a))}function hM(a){var o=a.memoizedState,u=0;o!==null&&(u=o.retryLane),rw(a,u)}function dM(a,o){var u=0;switch(a.tag){case 13:var f=a.stateNode,p=a.memoizedState;p!==null&&(u=p.retryLane);break;case 19:f=a.stateNode;break;case 22:f=a.stateNode._retryCache;break;default:throw Error(s(314))}f!==null&&f.delete(o),rw(a,u)}function fM(a,o){return Mi(a,o)}var fm=null,cc=null,Sy=!1,mm=!1,Ay=!1,Vo=0;function gi(a){a!==cc&&a.next===null&&(cc===null?fm=cc=a:cc=cc.next=a),mm=!0,Sy||(Sy=!0,gM())}function dh(a,o){if(!Ay&&mm){Ay=!0;do for(var u=!1,f=fm;f!==null;){if(a!==0){var p=f.pendingLanes;if(p===0)var b=0;else{var A=f.suspendedLanes,D=f.pingedLanes;b=(1<<31-zn(42|a)+1)-1,b&=p&~(A&~D),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(u=!0,cw(f,b))}else b=Je,b=vs(f,f===xt?b:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(b&3)===0||Rr(f,b)||(u=!0,cw(f,b));f=f.next}while(u);Ay=!1}}function mM(){aw()}function aw(){mm=Sy=!1;var a=0;Vo!==0&&(EM()&&(a=Vo),Vo=0);for(var o=Xn(),u=null,f=fm;f!==null;){var p=f.next,b=ow(f,o);b===0?(f.next=null,u===null?fm=p:u.next=p,p===null&&(cc=u)):(u=f,(a!==0||(b&3)!==0)&&(mm=!0)),f=p}dh(a)}function ow(a,o){for(var u=a.suspendedLanes,f=a.pingedLanes,p=a.expirationTimes,b=a.pendingLanes&-62914561;0<b;){var A=31-zn(b),D=1<<A,q=p[A];q===-1?((D&u)===0||(D&f)!==0)&&(p[A]=Al(D,o)):q<=o&&(a.expiredLanes|=D),b&=~D}if(o=xt,u=Je,u=vs(a,a===o?u:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f=a.callbackNode,u===0||a===o&&(ht===2||ht===9)||a.cancelPendingCommit!==null)return f!==null&&f!==null&&Sr(f),a.callbackNode=null,a.callbackPriority=0;if((u&3)===0||Rr(a,u)){if(o=u&-u,o===a.callbackPriority)return o;switch(f!==null&&Sr(f),Eu(u)){case 2:case 8:u=fn;break;case 32:u=Oi;break;case 268435456:u=vu;break;default:u=Oi}return f=lw.bind(null,a),u=Mi(u,f),a.callbackPriority=o,a.callbackNode=u,o}return f!==null&&f!==null&&Sr(f),a.callbackPriority=2,a.callbackNode=null,2}function lw(a,o){if(En!==0&&En!==5)return a.callbackNode=null,a.callbackPriority=0,null;var u=a.callbackNode;if(dm()&&a.callbackNode!==u)return null;var f=Je;return f=vs(a,a===xt?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f===0?null:(qE(a,f,o),ow(a,Xn()),a.callbackNode!=null&&a.callbackNode===u?lw.bind(null,a):null)}function cw(a,o){if(dm())return null;qE(a,o,!0)}function gM(){SM(function(){(ut&6)!==0?Mi(sn,mM):aw()})}function Iy(){return Vo===0&&(Vo=xu()),Vo}function uw(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Bs(""+a)}function hw(a,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,a.id&&u.setAttribute("form",a.id),o.parentNode.insertBefore(u,o),a=new FormData(a),u.parentNode.removeChild(u),a}function pM(a,o,u,f,p){if(o==="submit"&&u&&u.stateNode===p){var b=uw((p[xn]||null).action),A=f.submitter;A&&(o=(o=A[xn]||null)?uw(o.formAction):A.getAttribute("formAction"),o!==null&&(b=o,A=null));var D=new go("action","action",null,f,p);a.push({event:D,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Vo!==0){var q=A?hw(p,A):new FormData(p);W_(u,{pending:!0,data:q,method:p.method,action:b},null,q)}}else typeof b=="function"&&(D.preventDefault(),q=A?hw(p,A):new FormData(p),W_(u,{pending:!0,data:q,method:p.method,action:b},b,q))},currentTarget:p}]})}}for(var Ry=0;Ry<d_.length;Ry++){var Cy=d_[Ry],_M=Cy.toLowerCase(),yM=Cy[0].toUpperCase()+Cy.slice(1);qs(_M,"on"+yM)}qs(qx,"onAnimationEnd"),qs(Gx,"onAnimationIteration"),qs($x,"onAnimationStart"),qs("dblclick","onDoubleClick"),qs("focusin","onFocus"),qs("focusout","onBlur"),qs(Pk,"onTransitionRun"),qs(Vk,"onTransitionStart"),qs(Lk,"onTransitionCancel"),qs(Wx,"onTransitionEnd"),oi("onMouseEnter",["mouseout","mouseover"]),oi("onMouseLeave",["mouseout","mouseover"]),oi("onPointerEnter",["pointerout","pointerover"]),oi("onPointerLeave",["pointerout","pointerover"]),ai("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ai("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ai("onBeforeInput",["compositionend","keypress","textInput","paste"]),ai("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ai("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ai("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bM=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fh));function dw(a,o){o=(o&4)!==0;for(var u=0;u<a.length;u++){var f=a[u],p=f.event;f=f.listeners;e:{var b=void 0;if(o)for(var A=f.length-1;0<=A;A--){var D=f[A],q=D.instance,X=D.currentTarget;if(D=D.listener,q!==b&&p.isPropagationStopped())break e;b=D,p.currentTarget=X;try{b(p)}catch(ie){tm(ie)}p.currentTarget=null,b=q}else for(A=0;A<f.length;A++){if(D=f[A],q=D.instance,X=D.currentTarget,D=D.listener,q!==b&&p.isPropagationStopped())break e;b=D,p.currentTarget=X;try{b(p)}catch(ie){tm(ie)}p.currentTarget=null,b=q}}}}function We(a,o){var u=o[to];u===void 0&&(u=o[to]=new Set);var f=a+"__bubble";u.has(f)||(fw(o,a,2,!1),u.add(f))}function Dy(a,o,u){var f=0;o&&(f|=4),fw(u,a,f,o)}var gm="_reactListening"+Math.random().toString(36).slice(2);function Ny(a){if(!a[gm]){a[gm]=!0,pf.forEach(function(u){u!=="selectionchange"&&(bM.has(u)||Dy(u,!1,a),Dy(u,!0,a))});var o=a.nodeType===9?a:a.ownerDocument;o===null||o[gm]||(o[gm]=!0,Dy("selectionchange",!1,o))}}function fw(a,o,u,f){switch(Lw(o)){case 2:var p=$M;break;case 8:p=WM;break;default:p=Gy}u=p.bind(null,o,u,a),p=void 0,!Bi||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(p=!0),f?p!==void 0?a.addEventListener(o,u,{capture:!0,passive:p}):a.addEventListener(o,u,!0):p!==void 0?a.addEventListener(o,u,{passive:p}):a.addEventListener(o,u,!1)}function ky(a,o,u,f,p){var b=f;if((o&1)===0&&(o&2)===0&&f!==null)e:for(;;){if(f===null)return;var A=f.tag;if(A===3||A===4){var D=f.stateNode.containerInfo;if(D===p)break;if(A===4)for(A=f.return;A!==null;){var q=A.tag;if((q===3||q===4)&&A.stateNode.containerInfo===p)return;A=A.return}for(;D!==null;){if(A=ii(D),A===null)return;if(q=A.tag,q===5||q===6||q===26||q===27){f=b=A;continue e}D=D.parentNode}}f=f.return}ho(function(){var X=b,ie=Du(u),oe=[];e:{var Z=Yx.get(a);if(Z!==void 0){var J=go,Me=a;switch(a){case"keypress":if(fo(u)===0)break e;case"keydown":case"keyup":J=Ul;break;case"focusin":Me="focus",J=Vl;break;case"focusout":Me="blur",J=Vl;break;case"beforeblur":case"afterblur":J=Vl;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":J=vo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":J=Ef;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":J=Fr;break;case qx:case Gx:case $x:J=ku;break;case Wx:J=x;break;case"scroll":case"scrollend":J=_o;break;case"wheel":J=P;break;case"copy":case"cut":case"paste":J=Sf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":J=Pu;break;case"toggle":case"beforetoggle":J=te}var Ne=(o&4)!==0,yt=!Ne&&(a==="scroll"||a==="scrollend"),$=Ne?Z!==null?Z+"Capture":null:Z;Ne=[];for(var G=X,K;G!==null;){var re=G;if(K=re.stateNode,re=re.tag,re!==5&&re!==26&&re!==27||K===null||$===null||(re=Ur(G,$),re!=null&&Ne.push(mh(G,re,K))),yt)break;G=G.return}0<Ne.length&&(Z=new J(Z,Me,null,u,ie),oe.push({event:Z,listeners:Ne}))}}if((o&7)===0){e:{if(Z=a==="mouseover"||a==="pointerover",J=a==="mouseout"||a==="pointerout",Z&&u!==Cu&&(Me=u.relatedTarget||u.fromElement)&&(ii(Me)||Me[Vi]))break e;if((J||Z)&&(Z=ie.window===ie?ie:(Z=ie.ownerDocument)?Z.defaultView||Z.parentWindow:window,J?(Me=u.relatedTarget||u.toElement,J=X,Me=Me?ii(Me):null,Me!==null&&(yt=r(Me),Ne=Me.tag,Me!==yt||Ne!==5&&Ne!==27&&Ne!==6)&&(Me=null)):(J=null,Me=X),J!==Me)){if(Ne=vo,re="onMouseLeave",$="onMouseEnter",G="mouse",(a==="pointerout"||a==="pointerover")&&(Ne=Pu,re="onPointerLeave",$="onPointerEnter",G="pointer"),yt=J==null?Z:Mr(J),K=Me==null?Z:Mr(Me),Z=new Ne(re,G+"leave",J,u,ie),Z.target=yt,Z.relatedTarget=K,re=null,ii(ie)===X&&(Ne=new Ne($,G+"enter",Me,u,ie),Ne.target=K,Ne.relatedTarget=yt,re=Ne),yt=re,J&&Me)t:{for(Ne=J,$=Me,G=0,K=Ne;K;K=uc(K))G++;for(K=0,re=$;re;re=uc(re))K++;for(;0<G-K;)Ne=uc(Ne),G--;for(;0<K-G;)$=uc($),K--;for(;G--;){if(Ne===$||$!==null&&Ne===$.alternate)break t;Ne=uc(Ne),$=uc($)}Ne=null}else Ne=null;J!==null&&mw(oe,Z,J,Ne,!1),Me!==null&&yt!==null&&mw(oe,yt,Me,Ne,!0)}}e:{if(Z=X?Mr(X):window,J=Z.nodeName&&Z.nodeName.toLowerCase(),J==="select"||J==="input"&&Z.type==="file")var Ee=Mx;else if(Nx(Z))if(Ox)Ee=kk;else{Ee=Dk;var qe=Ck}else J=Z.nodeName,!J||J.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?X&&Ml(X.elementType)&&(Ee=Mx):Ee=Nk;if(Ee&&(Ee=Ee(a,X))){kx(oe,Ee,u,ie);break e}qe&&qe(a,Z,X),a==="focusout"&&X&&Z.type==="number"&&X.memoizedProps.value!=null&&Au(Z,"number",Z.value)}switch(qe=X?Mr(X):window,a){case"focusin":(Nx(qe)||qe.contentEditable==="true")&&(Bl=qe,c_=X,Bu=null);break;case"focusout":Bu=c_=Bl=null;break;case"mousedown":u_=!0;break;case"contextmenu":case"mouseup":case"dragend":u_=!1,zx(oe,u,ie);break;case"selectionchange":if(Ok)break;case"keydown":case"keyup":zx(oe,u,ie)}var De;if(Le)e:{switch(a){case"compositionstart":var ke="onCompositionStart";break e;case"compositionend":ke="onCompositionEnd";break e;case"compositionupdate":ke="onCompositionUpdate";break e}ke=void 0}else Hs?Fs(a,u)&&(ke="onCompositionEnd"):a==="keydown"&&u.keyCode===229&&(ke="onCompositionStart");ke&&($t&&u.locale!=="ko"&&(Hs||ke!=="onCompositionStart"?ke==="onCompositionEnd"&&Hs&&(De=Tf()):(Es=ie,vt="value"in Es?Es.value:Es.textContent,Hs=!0)),qe=pm(X,ke),0<qe.length&&(ke=new Ou(ke,a,null,u,ie),oe.push({event:ke,listeners:qe}),De?ke.data=De:(De=zs(u),De!==null&&(ke.data=De)))),(De=ct?Vu(a,u):Ak(a,u))&&(ke=pm(X,"onBeforeInput"),0<ke.length&&(qe=new Ou("onBeforeInput","beforeinput",null,u,ie),oe.push({event:qe,listeners:ke}),qe.data=De)),pM(oe,a,X,u,ie)}dw(oe,o)})}function mh(a,o,u){return{instance:a,listener:o,currentTarget:u}}function pm(a,o){for(var u=o+"Capture",f=[];a!==null;){var p=a,b=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||b===null||(p=Ur(a,u),p!=null&&f.unshift(mh(a,p,b)),p=Ur(a,o),p!=null&&f.push(mh(a,p,b))),a.tag===3)return f;a=a.return}return[]}function uc(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function mw(a,o,u,f,p){for(var b=o._reactName,A=[];u!==null&&u!==f;){var D=u,q=D.alternate,X=D.stateNode;if(D=D.tag,q!==null&&q===f)break;D!==5&&D!==26&&D!==27||X===null||(q=X,p?(X=Ur(u,b),X!=null&&A.unshift(mh(u,X,q))):p||(X=Ur(u,b),X!=null&&A.push(mh(u,X,q)))),u=u.return}A.length!==0&&a.push({event:o,listeners:A})}var vM=/\r\n?/g,xM=/\u0000|\uFFFD/g;function gw(a){return(typeof a=="string"?a:""+a).replace(vM,`
`).replace(xM,"")}function pw(a,o){return o=gw(o),gw(a)===o}function _m(){}function _t(a,o,u,f,p,b){switch(u){case"children":typeof f=="string"?o==="body"||o==="textarea"&&f===""||Ts(a,f):(typeof f=="number"||typeof f=="bigint")&&o!=="body"&&Ts(a,""+f);break;case"className":ao(a,"class",f);break;case"tabIndex":ao(a,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":ao(a,u,f);break;case"style":Ru(a,f,b);break;case"data":if(o!=="object"){ao(a,"data",f);break}case"src":case"href":if(f===""&&(o!=="a"||u!=="href")){a.removeAttribute(u);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(u);break}f=Bs(""+f),a.setAttribute(u,f);break;case"action":case"formAction":if(typeof f=="function"){a.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(u==="formAction"?(o!=="input"&&_t(a,o,"name",p.name,p,null),_t(a,o,"formEncType",p.formEncType,p,null),_t(a,o,"formMethod",p.formMethod,p,null),_t(a,o,"formTarget",p.formTarget,p,null)):(_t(a,o,"encType",p.encType,p,null),_t(a,o,"method",p.method,p,null),_t(a,o,"target",p.target,p,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(u);break}f=Bs(""+f),a.setAttribute(u,f);break;case"onClick":f!=null&&(a.onclick=_m);break;case"onScroll":f!=null&&We("scroll",a);break;case"onScrollEnd":f!=null&&We("scrollend",a);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(s(61));if(u=f.__html,u!=null){if(p.children!=null)throw Error(s(60));a.innerHTML=u}}break;case"multiple":a.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":a.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){a.removeAttribute("xlink:href");break}u=Bs(""+f),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(u,""+f):a.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(u,""):a.removeAttribute(u);break;case"capture":case"download":f===!0?a.setAttribute(u,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(u,f):a.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?a.setAttribute(u,f):a.removeAttribute(u);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?a.removeAttribute(u):a.setAttribute(u,f);break;case"popover":We("beforetoggle",a),We("toggle",a),ro(a,"popover",f);break;case"xlinkActuate":xs(a,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":xs(a,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":xs(a,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":xs(a,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":xs(a,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":xs(a,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":xs(a,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":xs(a,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":xs(a,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":ro(a,"is",f);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=bf.get(u)||u,ro(a,u,f))}}function My(a,o,u,f,p,b){switch(u){case"style":Ru(a,f,b);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(s(61));if(u=f.__html,u!=null){if(p.children!=null)throw Error(s(60));a.innerHTML=u}}break;case"children":typeof f=="string"?Ts(a,f):(typeof f=="number"||typeof f=="bigint")&&Ts(a,""+f);break;case"onScroll":f!=null&&We("scroll",a);break;case"onScrollEnd":f!=null&&We("scrollend",a);break;case"onClick":f!=null&&(a.onclick=_m);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!so.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(p=u.endsWith("Capture"),o=u.slice(2,p?u.length-7:void 0),b=a[xn]||null,b=b!=null?b[u]:null,typeof b=="function"&&a.removeEventListener(o,b,p),typeof f=="function")){typeof b!="function"&&b!==null&&(u in a?a[u]=null:a.hasAttribute(u)&&a.removeAttribute(u)),a.addEventListener(o,f,p);break e}u in a?a[u]=f:f===!0?a.setAttribute(u,""):ro(a,u,f)}}}function wn(a,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":We("error",a),We("load",a);var f=!1,p=!1,b;for(b in u)if(u.hasOwnProperty(b)){var A=u[b];if(A!=null)switch(b){case"src":f=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,o));default:_t(a,o,b,A,u,null)}}p&&_t(a,o,"srcSet",u.srcSet,u,null),f&&_t(a,o,"src",u.src,u,null);return;case"input":We("invalid",a);var D=b=A=p=null,q=null,X=null;for(f in u)if(u.hasOwnProperty(f)){var ie=u[f];if(ie!=null)switch(f){case"name":p=ie;break;case"type":A=ie;break;case"checked":q=ie;break;case"defaultChecked":X=ie;break;case"value":b=ie;break;case"defaultValue":D=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(s(137,o));break;default:_t(a,o,f,ie,u,null)}}Su(a,b,D,q,X,A,p,!1),Vr(a);return;case"select":We("invalid",a),f=A=b=null;for(p in u)if(u.hasOwnProperty(p)&&(D=u[p],D!=null))switch(p){case"value":b=D;break;case"defaultValue":A=D;break;case"multiple":f=D;default:_t(a,o,p,D,u,null)}o=b,u=A,a.multiple=!!f,o!=null?Lr(a,!!f,o,!1):u!=null&&Lr(a,!!f,u,!0);return;case"textarea":We("invalid",a),b=p=f=null;for(A in u)if(u.hasOwnProperty(A)&&(D=u[A],D!=null))switch(A){case"value":f=D;break;case"defaultValue":p=D;break;case"children":b=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(s(91));break;default:_t(a,o,A,D,u,null)}yf(a,f,p,b),Vr(a);return;case"option":for(q in u)if(u.hasOwnProperty(q)&&(f=u[q],f!=null))switch(q){case"selected":a.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:_t(a,o,q,f,u,null)}return;case"dialog":We("beforetoggle",a),We("toggle",a),We("cancel",a),We("close",a);break;case"iframe":case"object":We("load",a);break;case"video":case"audio":for(f=0;f<fh.length;f++)We(fh[f],a);break;case"image":We("error",a),We("load",a);break;case"details":We("toggle",a);break;case"embed":case"source":case"link":We("error",a),We("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(X in u)if(u.hasOwnProperty(X)&&(f=u[X],f!=null))switch(X){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,o));default:_t(a,o,X,f,u,null)}return;default:if(Ml(o)){for(ie in u)u.hasOwnProperty(ie)&&(f=u[ie],f!==void 0&&My(a,o,ie,f,u,void 0));return}}for(D in u)u.hasOwnProperty(D)&&(f=u[D],f!=null&&_t(a,o,D,f,u,null))}function TM(a,o,u,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,b=null,A=null,D=null,q=null,X=null,ie=null;for(J in u){var oe=u[J];if(u.hasOwnProperty(J)&&oe!=null)switch(J){case"checked":break;case"value":break;case"defaultValue":q=oe;default:f.hasOwnProperty(J)||_t(a,o,J,null,f,oe)}}for(var Z in f){var J=f[Z];if(oe=u[Z],f.hasOwnProperty(Z)&&(J!=null||oe!=null))switch(Z){case"type":b=J;break;case"name":p=J;break;case"checked":X=J;break;case"defaultChecked":ie=J;break;case"value":A=J;break;case"defaultValue":D=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(s(137,o));break;default:J!==oe&&_t(a,o,Z,J,f,oe)}}wu(a,A,D,q,X,ie,b,p);return;case"select":J=A=D=Z=null;for(b in u)if(q=u[b],u.hasOwnProperty(b)&&q!=null)switch(b){case"value":break;case"multiple":J=q;default:f.hasOwnProperty(b)||_t(a,o,b,null,f,q)}for(p in f)if(b=f[p],q=u[p],f.hasOwnProperty(p)&&(b!=null||q!=null))switch(p){case"value":Z=b;break;case"defaultValue":D=b;break;case"multiple":A=b;default:b!==q&&_t(a,o,p,b,f,q)}o=D,u=A,f=J,Z!=null?Lr(a,!!u,Z,!1):!!f!=!!u&&(o!=null?Lr(a,!!u,o,!0):Lr(a,!!u,u?[]:"",!1));return;case"textarea":J=Z=null;for(D in u)if(p=u[D],u.hasOwnProperty(D)&&p!=null&&!f.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:_t(a,o,D,null,f,p)}for(A in f)if(p=f[A],b=u[A],f.hasOwnProperty(A)&&(p!=null||b!=null))switch(A){case"value":Z=p;break;case"defaultValue":J=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(s(91));break;default:p!==b&&_t(a,o,A,p,f,b)}_f(a,Z,J);return;case"option":for(var Me in u)if(Z=u[Me],u.hasOwnProperty(Me)&&Z!=null&&!f.hasOwnProperty(Me))switch(Me){case"selected":a.selected=!1;break;default:_t(a,o,Me,null,f,Z)}for(q in f)if(Z=f[q],J=u[q],f.hasOwnProperty(q)&&Z!==J&&(Z!=null||J!=null))switch(q){case"selected":a.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:_t(a,o,q,Z,f,J)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ne in u)Z=u[Ne],u.hasOwnProperty(Ne)&&Z!=null&&!f.hasOwnProperty(Ne)&&_t(a,o,Ne,null,f,Z);for(X in f)if(Z=f[X],J=u[X],f.hasOwnProperty(X)&&Z!==J&&(Z!=null||J!=null))switch(X){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(s(137,o));break;default:_t(a,o,X,Z,f,J)}return;default:if(Ml(o)){for(var yt in u)Z=u[yt],u.hasOwnProperty(yt)&&Z!==void 0&&!f.hasOwnProperty(yt)&&My(a,o,yt,void 0,f,Z);for(ie in f)Z=f[ie],J=u[ie],!f.hasOwnProperty(ie)||Z===J||Z===void 0&&J===void 0||My(a,o,ie,Z,f,J);return}}for(var $ in u)Z=u[$],u.hasOwnProperty($)&&Z!=null&&!f.hasOwnProperty($)&&_t(a,o,$,null,f,Z);for(oe in f)Z=f[oe],J=u[oe],!f.hasOwnProperty(oe)||Z===J||Z==null&&J==null||_t(a,o,oe,Z,f,J)}var Oy=null,Py=null;function ym(a){return a.nodeType===9?a:a.ownerDocument}function _w(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function yw(a,o){if(a===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&o==="foreignObject"?0:a}function Vy(a,o){return a==="textarea"||a==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Ly=null;function EM(){var a=window.event;return a&&a.type==="popstate"?a===Ly?!1:(Ly=a,!0):(Ly=null,!1)}var bw=typeof setTimeout=="function"?setTimeout:void 0,wM=typeof clearTimeout=="function"?clearTimeout:void 0,vw=typeof Promise=="function"?Promise:void 0,SM=typeof queueMicrotask=="function"?queueMicrotask:typeof vw<"u"?function(a){return vw.resolve(null).then(a).catch(AM)}:bw;function AM(a){setTimeout(function(){throw a})}function sa(a){return a==="head"}function xw(a,o){var u=o,f=0,p=0;do{var b=u.nextSibling;if(a.removeChild(u),b&&b.nodeType===8)if(u=b.data,u==="/$"){if(0<f&&8>f){u=f;var A=a.ownerDocument;if(u&1&&gh(A.documentElement),u&2&&gh(A.body),u&4)for(u=A.head,gh(u),A=u.firstChild;A;){var D=A.nextSibling,q=A.nodeName;A[kr]||q==="SCRIPT"||q==="STYLE"||q==="LINK"&&A.rel.toLowerCase()==="stylesheet"||u.removeChild(A),A=D}}if(p===0){a.removeChild(b),Eh(o);return}p--}else u==="$"||u==="$?"||u==="$!"?p++:f=u.charCodeAt(0)-48;else f=0;u=b}while(u);Eh(o)}function jy(a){var o=a.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":jy(u),Rl(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}a.removeChild(u)}}function IM(a,o,u,f){for(;a.nodeType===1;){var p=u;if(a.nodeName.toLowerCase()!==o.toLowerCase()){if(!f&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(f){if(!a[kr])switch(o){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(b=a.getAttribute("rel"),b==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(b!==p.rel||a.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||a.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||a.getAttribute("title")!==(p.title==null?null:p.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(b=a.getAttribute("src"),(b!==(p.src==null?null:p.src)||a.getAttribute("type")!==(p.type==null?null:p.type)||a.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&b&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(o==="input"&&a.type==="hidden"){var b=p.name==null?null:""+p.name;if(p.type==="hidden"&&a.getAttribute("name")===b)return a}else return a;if(a=$s(a.nextSibling),a===null)break}return null}function RM(a,o,u){if(o==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!u||(a=$s(a.nextSibling),a===null))return null;return a}function Uy(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function CM(a,o){var u=a.ownerDocument;if(a.data!=="$?"||u.readyState==="complete")o();else{var f=function(){o(),u.removeEventListener("DOMContentLoaded",f)};u.addEventListener("DOMContentLoaded",f),a._reactRetry=f}}function $s(a){for(;a!=null;a=a.nextSibling){var o=a.nodeType;if(o===1||o===3)break;if(o===8){if(o=a.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return a}var By=null;function Tw(a){a=a.previousSibling;for(var o=0;a;){if(a.nodeType===8){var u=a.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return a;o--}else u==="/$"&&o++}a=a.previousSibling}return null}function Ew(a,o,u){switch(o=ym(u),a){case"html":if(a=o.documentElement,!a)throw Error(s(452));return a;case"head":if(a=o.head,!a)throw Error(s(453));return a;case"body":if(a=o.body,!a)throw Error(s(454));return a;default:throw Error(s(451))}}function gh(a){for(var o=a.attributes;o.length;)a.removeAttributeNode(o[0]);Rl(a)}var Ds=new Map,ww=new Set;function bm(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var er=ae.d;ae.d={f:DM,r:NM,D:kM,C:MM,L:OM,m:PM,X:LM,S:VM,M:jM};function DM(){var a=er.f(),o=um();return a||o}function NM(a){var o=ri(a);o!==null&&o.tag===5&&o.type==="form"?qT(o):er.r(a)}var hc=typeof document>"u"?null:document;function Sw(a,o,u){var f=hc;if(f&&typeof o=="string"&&o){var p=mn(o);p='link[rel="'+a+'"][href="'+p+'"]',typeof u=="string"&&(p+='[crossorigin="'+u+'"]'),ww.has(p)||(ww.add(p),a={rel:a,crossOrigin:u,href:o},f.querySelector(p)===null&&(o=f.createElement("link"),wn(o,"link",a),Gt(o),f.head.appendChild(o)))}}function kM(a){er.D(a),Sw("dns-prefetch",a,null)}function MM(a,o){er.C(a,o),Sw("preconnect",a,o)}function OM(a,o,u){er.L(a,o,u);var f=hc;if(f&&a&&o){var p='link[rel="preload"][as="'+mn(o)+'"]';o==="image"&&u&&u.imageSrcSet?(p+='[imagesrcset="'+mn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(p+='[imagesizes="'+mn(u.imageSizes)+'"]')):p+='[href="'+mn(a)+'"]';var b=p;switch(o){case"style":b=dc(a);break;case"script":b=fc(a)}Ds.has(b)||(a=m({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:a,as:o},u),Ds.set(b,a),f.querySelector(p)!==null||o==="style"&&f.querySelector(ph(b))||o==="script"&&f.querySelector(_h(b))||(o=f.createElement("link"),wn(o,"link",a),Gt(o),f.head.appendChild(o)))}}function PM(a,o){er.m(a,o);var u=hc;if(u&&a){var f=o&&typeof o.as=="string"?o.as:"script",p='link[rel="modulepreload"][as="'+mn(f)+'"][href="'+mn(a)+'"]',b=p;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=fc(a)}if(!Ds.has(b)&&(a=m({rel:"modulepreload",href:a},o),Ds.set(b,a),u.querySelector(p)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(_h(b)))return}f=u.createElement("link"),wn(f,"link",a),Gt(f),u.head.appendChild(f)}}}function VM(a,o,u){er.S(a,o,u);var f=hc;if(f&&a){var p=Or(f).hoistableStyles,b=dc(a);o=o||"default";var A=p.get(b);if(!A){var D={loading:0,preload:null};if(A=f.querySelector(ph(b)))D.loading=5;else{a=m({rel:"stylesheet",href:a,"data-precedence":o},u),(u=Ds.get(b))&&Fy(a,u);var q=A=f.createElement("link");Gt(q),wn(q,"link",a),q._p=new Promise(function(X,ie){q.onload=X,q.onerror=ie}),q.addEventListener("load",function(){D.loading|=1}),q.addEventListener("error",function(){D.loading|=2}),D.loading|=4,vm(A,o,f)}A={type:"stylesheet",instance:A,count:1,state:D},p.set(b,A)}}}function LM(a,o){er.X(a,o);var u=hc;if(u&&a){var f=Or(u).hoistableScripts,p=fc(a),b=f.get(p);b||(b=u.querySelector(_h(p)),b||(a=m({src:a,async:!0},o),(o=Ds.get(p))&&zy(a,o),b=u.createElement("script"),Gt(b),wn(b,"link",a),u.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},f.set(p,b))}}function jM(a,o){er.M(a,o);var u=hc;if(u&&a){var f=Or(u).hoistableScripts,p=fc(a),b=f.get(p);b||(b=u.querySelector(_h(p)),b||(a=m({src:a,async:!0,type:"module"},o),(o=Ds.get(p))&&zy(a,o),b=u.createElement("script"),Gt(b),wn(b,"link",a),u.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},f.set(p,b))}}function Aw(a,o,u,f){var p=(p=Ae.current)?bm(p):null;if(!p)throw Error(s(446));switch(a){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=dc(u.href),u=Or(p).hoistableStyles,f=u.get(o),f||(f={type:"style",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){a=dc(u.href);var b=Or(p).hoistableStyles,A=b.get(a);if(A||(p=p.ownerDocument||p,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(a,A),(b=p.querySelector(ph(a)))&&!b._p&&(A.instance=b,A.state.loading=5),Ds.has(a)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Ds.set(a,u),b||UM(p,a,u,A.state))),o&&f===null)throw Error(s(528,""));return A}if(o&&f!==null)throw Error(s(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=fc(u),u=Or(p).hoistableScripts,f=u.get(o),f||(f={type:"script",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,a))}}function dc(a){return'href="'+mn(a)+'"'}function ph(a){return'link[rel="stylesheet"]['+a+"]"}function Iw(a){return m({},a,{"data-precedence":a.precedence,precedence:null})}function UM(a,o,u,f){a.querySelector('link[rel="preload"][as="style"]['+o+"]")?f.loading=1:(o=a.createElement("link"),f.preload=o,o.addEventListener("load",function(){return f.loading|=1}),o.addEventListener("error",function(){return f.loading|=2}),wn(o,"link",u),Gt(o),a.head.appendChild(o))}function fc(a){return'[src="'+mn(a)+'"]'}function _h(a){return"script[async]"+a}function Rw(a,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var f=a.querySelector('style[data-href~="'+mn(u.href)+'"]');if(f)return o.instance=f,Gt(f),f;var p=m({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return f=(a.ownerDocument||a).createElement("style"),Gt(f),wn(f,"style",p),vm(f,u.precedence,a),o.instance=f;case"stylesheet":p=dc(u.href);var b=a.querySelector(ph(p));if(b)return o.state.loading|=4,o.instance=b,Gt(b),b;f=Iw(u),(p=Ds.get(p))&&Fy(f,p),b=(a.ownerDocument||a).createElement("link"),Gt(b);var A=b;return A._p=new Promise(function(D,q){A.onload=D,A.onerror=q}),wn(b,"link",f),o.state.loading|=4,vm(b,u.precedence,a),o.instance=b;case"script":return b=fc(u.src),(p=a.querySelector(_h(b)))?(o.instance=p,Gt(p),p):(f=u,(p=Ds.get(b))&&(f=m({},u),zy(f,p)),a=a.ownerDocument||a,p=a.createElement("script"),Gt(p),wn(p,"link",f),a.head.appendChild(p),o.instance=p);case"void":return null;default:throw Error(s(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(f=o.instance,o.state.loading|=4,vm(f,u.precedence,a));return o.instance}function vm(a,o,u){for(var f=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=f.length?f[f.length-1]:null,b=p,A=0;A<f.length;A++){var D=f[A];if(D.dataset.precedence===o)b=D;else if(b!==p)break}b?b.parentNode.insertBefore(a,b.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(a,o.firstChild))}function Fy(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.title==null&&(a.title=o.title)}function zy(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.integrity==null&&(a.integrity=o.integrity)}var xm=null;function Cw(a,o,u){if(xm===null){var f=new Map,p=xm=new Map;p.set(u,f)}else p=xm,f=p.get(u),f||(f=new Map,p.set(u,f));if(f.has(a))return f;for(f.set(a,null),u=u.getElementsByTagName(a),p=0;p<u.length;p++){var b=u[p];if(!(b[kr]||b[qt]||a==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var A=b.getAttribute(o)||"";A=a+A;var D=f.get(A);D?D.push(b):f.set(A,[b])}}return f}function Dw(a,o,u){a=a.ownerDocument||a,a.head.insertBefore(u,o==="title"?a.querySelector("head > title"):null)}function BM(a,o,u){if(u===1||o.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return a=o.disabled,typeof o.precedence=="string"&&a==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function Nw(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var yh=null;function FM(){}function zM(a,o,u){if(yh===null)throw Error(s(475));var f=yh;if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var p=dc(u.href),b=a.querySelector(ph(p));if(b){a=b._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(f.count++,f=Tm.bind(f),a.then(f,f)),o.state.loading|=4,o.instance=b,Gt(b);return}b=a.ownerDocument||a,u=Iw(u),(p=Ds.get(p))&&Fy(u,p),b=b.createElement("link"),Gt(b);var A=b;A._p=new Promise(function(D,q){A.onload=D,A.onerror=q}),wn(b,"link",u),o.instance=b}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(f.count++,o=Tm.bind(f),a.addEventListener("load",o),a.addEventListener("error",o))}}function HM(){if(yh===null)throw Error(s(475));var a=yh;return a.stylesheets&&a.count===0&&Hy(a,a.stylesheets),0<a.count?function(o){var u=setTimeout(function(){if(a.stylesheets&&Hy(a,a.stylesheets),a.unsuspend){var f=a.unsuspend;a.unsuspend=null,f()}},6e4);return a.unsuspend=o,function(){a.unsuspend=null,clearTimeout(u)}}:null}function Tm(){if(this.count--,this.count===0){if(this.stylesheets)Hy(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var Em=null;function Hy(a,o){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Em=new Map,o.forEach(qM,a),Em=null,Tm.call(a))}function qM(a,o){if(!(o.state.loading&4)){var u=Em.get(a);if(u)var f=u.get(null);else{u=new Map,Em.set(a,u);for(var p=a.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<p.length;b++){var A=p[b];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(u.set(A.dataset.precedence,A),f=A)}f&&u.set(null,f)}p=o.instance,A=p.getAttribute("data-precedence"),b=u.get(A)||f,b===f&&u.set(null,p),u.set(A,p),this.count++,f=Tm.bind(this),p.addEventListener("load",f),p.addEventListener("error",f),b?b.parentNode.insertBefore(p,b.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(p,a.firstChild)),o.state.loading|=4}}var bh={$$typeof:O,Provider:null,Consumer:null,_currentValue:me,_currentValue2:me,_threadCount:0};function GM(a,o,u,f,p,b,A,D){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Il(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Il(0),this.hiddenUpdates=Il(null),this.identifierPrefix=f,this.onUncaughtError=p,this.onCaughtError=b,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function kw(a,o,u,f,p,b,A,D,q,X,ie,oe){return a=new GM(a,o,u,A,D,q,X,oe),o=1,b===!0&&(o|=24),b=ls(3,null,null,o),a.current=b,b.stateNode=a,o=w_(),o.refCount++,a.pooledCache=o,o.refCount++,b.memoizedState={element:f,isDehydrated:u,cache:o},R_(b),a}function Mw(a){return a?(a=ql,a):ql}function Ow(a,o,u,f,p,b){p=Mw(p),f.context===null?f.context=p:f.pendingContext=p,f=qr(o),f.payload={element:u},b=b===void 0?null:b,b!==null&&(f.callback=b),u=Gr(a,f,o),u!==null&&(fs(u,a,o),Ku(u,a,o))}function Pw(a,o){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var u=a.retryLane;a.retryLane=u!==0&&u<o?u:o}}function qy(a,o){Pw(a,o),(a=a.alternate)&&Pw(a,o)}function Vw(a){if(a.tag===13){var o=Hl(a,67108864);o!==null&&fs(o,a,67108864),qy(a,67108864)}}var wm=!0;function $M(a,o,u,f){var p=Y.T;Y.T=null;var b=ae.p;try{ae.p=2,Gy(a,o,u,f)}finally{ae.p=b,Y.T=p}}function WM(a,o,u,f){var p=Y.T;Y.T=null;var b=ae.p;try{ae.p=8,Gy(a,o,u,f)}finally{ae.p=b,Y.T=p}}function Gy(a,o,u,f){if(wm){var p=$y(f);if(p===null)ky(a,o,f,Sm,u),jw(a,f);else if(KM(p,a,o,u,f))f.stopPropagation();else if(jw(a,f),o&4&&-1<YM.indexOf(a)){for(;p!==null;){var b=ri(p);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var A=Ls(b.pendingLanes);if(A!==0){var D=b;for(D.pendingLanes|=2,D.entangledLanes|=2;A;){var q=1<<31-zn(A);D.entanglements[1]|=q,A&=~q}gi(b),(ut&6)===0&&(lm=Xn()+500,dh(0))}}break;case 13:D=Hl(b,2),D!==null&&fs(D,b,2),um(),qy(b,2)}if(b=$y(f),b===null&&ky(a,o,f,Sm,u),b===p)break;p=b}p!==null&&f.stopPropagation()}else ky(a,o,f,null,u)}}function $y(a){return a=Du(a),Wy(a)}var Sm=null;function Wy(a){if(Sm=null,a=ii(a),a!==null){var o=r(a);if(o===null)a=null;else{var u=o.tag;if(u===13){if(a=l(o),a!==null)return a;a=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null)}}return Sm=a,null}function Lw(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(df()){case sn:return 2;case fn:return 8;case Oi:case Zp:return 32;case vu:return 268435456;default:return 32}default:return 32}}var Yy=!1,ia=null,ra=null,aa=null,vh=new Map,xh=new Map,oa=[],YM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function jw(a,o){switch(a){case"focusin":case"focusout":ia=null;break;case"dragenter":case"dragleave":ra=null;break;case"mouseover":case"mouseout":aa=null;break;case"pointerover":case"pointerout":vh.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":xh.delete(o.pointerId)}}function Th(a,o,u,f,p,b){return a===null||a.nativeEvent!==b?(a={blockedOn:o,domEventName:u,eventSystemFlags:f,nativeEvent:b,targetContainers:[p]},o!==null&&(o=ri(o),o!==null&&Vw(o)),a):(a.eventSystemFlags|=f,o=a.targetContainers,p!==null&&o.indexOf(p)===-1&&o.push(p),a)}function KM(a,o,u,f,p){switch(o){case"focusin":return ia=Th(ia,a,o,u,f,p),!0;case"dragenter":return ra=Th(ra,a,o,u,f,p),!0;case"mouseover":return aa=Th(aa,a,o,u,f,p),!0;case"pointerover":var b=p.pointerId;return vh.set(b,Th(vh.get(b)||null,a,o,u,f,p)),!0;case"gotpointercapture":return b=p.pointerId,xh.set(b,Th(xh.get(b)||null,a,o,u,f,p)),!0}return!1}function Uw(a){var o=ii(a.target);if(o!==null){var u=r(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){a.blockedOn=o,t_(a.priority,function(){if(u.tag===13){var f=ds();f=Tu(f);var p=Hl(u,f);p!==null&&fs(p,u,f),qy(u,f)}});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){a.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Am(a){if(a.blockedOn!==null)return!1;for(var o=a.targetContainers;0<o.length;){var u=$y(a.nativeEvent);if(u===null){u=a.nativeEvent;var f=new u.constructor(u.type,u);Cu=f,u.target.dispatchEvent(f),Cu=null}else return o=ri(u),o!==null&&Vw(o),a.blockedOn=u,!1;o.shift()}return!0}function Bw(a,o,u){Am(a)&&u.delete(o)}function QM(){Yy=!1,ia!==null&&Am(ia)&&(ia=null),ra!==null&&Am(ra)&&(ra=null),aa!==null&&Am(aa)&&(aa=null),vh.forEach(Bw),xh.forEach(Bw)}function Im(a,o){a.blockedOn===o&&(a.blockedOn=null,Yy||(Yy=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,QM)))}var Rm=null;function Fw(a){Rm!==a&&(Rm=a,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Rm===a&&(Rm=null);for(var o=0;o<a.length;o+=3){var u=a[o],f=a[o+1],p=a[o+2];if(typeof f!="function"){if(Wy(f||u)===null)continue;break}var b=ri(u);b!==null&&(a.splice(o,3),o-=3,W_(b,{pending:!0,data:p,method:u.method,action:f},f,p))}}))}function Eh(a){function o(q){return Im(q,a)}ia!==null&&Im(ia,a),ra!==null&&Im(ra,a),aa!==null&&Im(aa,a),vh.forEach(o),xh.forEach(o);for(var u=0;u<oa.length;u++){var f=oa[u];f.blockedOn===a&&(f.blockedOn=null)}for(;0<oa.length&&(u=oa[0],u.blockedOn===null);)Uw(u),u.blockedOn===null&&oa.shift();if(u=(a.ownerDocument||a).$$reactFormReplay,u!=null)for(f=0;f<u.length;f+=3){var p=u[f],b=u[f+1],A=p[xn]||null;if(typeof b=="function")A||Fw(u);else if(A){var D=null;if(b&&b.hasAttribute("formAction")){if(p=b,A=b[xn]||null)D=A.formAction;else if(Wy(p)!==null)continue}else D=A.action;typeof D=="function"?u[f+1]=D:(u.splice(f,3),f-=3),Fw(u)}}}function Ky(a){this._internalRoot=a}Cm.prototype.render=Ky.prototype.render=function(a){var o=this._internalRoot;if(o===null)throw Error(s(409));var u=o.current,f=ds();Ow(u,f,a,o,null,null)},Cm.prototype.unmount=Ky.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var o=a.containerInfo;Ow(a.current,2,null,a,null,null),um(),o[Vi]=null}};function Cm(a){this._internalRoot=a}Cm.prototype.unstable_scheduleHydration=function(a){if(a){var o=Pi();a={blockedOn:null,target:a,priority:o};for(var u=0;u<oa.length&&o!==0&&o<oa[u].priority;u++);oa.splice(u,0,a),u===0&&Uw(a)}};var zw=e.version;if(zw!=="19.1.1")throw Error(s(527,zw,"19.1.1"));ae.findDOMNode=function(a){var o=a._reactInternals;if(o===void 0)throw typeof a.render=="function"?Error(s(188)):(a=Object.keys(a).join(","),Error(s(268,a)));return a=h(o),a=a!==null?d(a):null,a=a===null?null:a.stateNode,a};var XM={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dm.isDisabled&&Dm.supportsFiber)try{Ar=Dm.inject(XM),Cn=Dm}catch{}}return Sh.createRoot=function(a,o){if(!i(a))throw Error(s(299));var u=!1,f="",p=iE,b=rE,A=aE,D=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(p=o.onUncaughtError),o.onCaughtError!==void 0&&(b=o.onCaughtError),o.onRecoverableError!==void 0&&(A=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(D=o.unstable_transitionCallbacks)),o=kw(a,1,!1,null,null,u,f,p,b,A,D,null),a[Vi]=o.current,Ny(a),new Ky(o)},Sh.hydrateRoot=function(a,o,u){if(!i(a))throw Error(s(299));var f=!1,p="",b=iE,A=rE,D=aE,q=null,X=null;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(p=u.identifierPrefix),u.onUncaughtError!==void 0&&(b=u.onUncaughtError),u.onCaughtError!==void 0&&(A=u.onCaughtError),u.onRecoverableError!==void 0&&(D=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(q=u.unstable_transitionCallbacks),u.formState!==void 0&&(X=u.formState)),o=kw(a,1,!0,o,u??null,f,p,b,A,D,q,X),o.context=Mw(null),u=o.current,f=ds(),f=Tu(f),p=qr(f),p.callback=null,Gr(u,p,f),u=f,o.current.lanes=u,Ht(o,u),gi(o),a[Vi]=o.current,Ny(a),new Cm(o)},Sh.version="19.1.1",Sh}var Zw;function uO(){if(Zw)return Zy.exports;Zw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Zy.exports=cO(),Zy.exports}var hO=uO();const dO=D2(hO),fO=()=>{};var Jw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N2=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let i=n.charCodeAt(s);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},mO=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const i=n[t++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=n[t++];e[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=n[t++],l=n[t++],c=n[t++],h=((i&7)<<18|(r&63)<<12|(l&63)<<6|c&63)-65536;e[s++]=String.fromCharCode(55296+(h>>10)),e[s++]=String.fromCharCode(56320+(h&1023))}else{const r=n[t++],l=n[t++];e[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|l&63)}}return e.join("")},k2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<n.length;i+=3){const r=n[i],l=i+1<n.length,c=l?n[i+1]:0,h=i+2<n.length,d=h?n[i+2]:0,m=r>>2,_=(r&3)<<4|c>>4;let v=(c&15)<<2|d>>6,T=d&63;h||(T=64,l||(v=64)),s.push(t[m],t[_],t[v],t[T])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(N2(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):mO(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<n.length;){const r=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;const d=i<n.length?t[n.charAt(i)]:64;++i;const _=i<n.length?t[n.charAt(i)]:64;if(++i,r==null||c==null||d==null||_==null)throw new gO;const v=r<<2|c>>4;if(s.push(v),d!==64){const T=c<<4&240|d>>2;if(s.push(T),_!==64){const S=d<<6&192|_;s.push(S)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class gO extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const pO=function(n){const e=N2(n);return k2.encodeByteArray(e,!0)},wg=function(n){return pO(n).replace(/\./g,"")},Bb=function(n){try{return k2.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Sg(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!_O(t)||(n[t]=Sg(n[t],e[t]));return n}function _O(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yO=()=>Fb().__FIREBASE_DEFAULTS__,bO=()=>{if(typeof process>"u"||typeof Jw>"u")return;const n=Jw.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},vO=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Bb(n[1]);return e&&JSON.parse(e)},dp=()=>{try{return fO()||yO()||bO()||vO()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},M2=n=>{var e,t;return(t=(e=dp())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},xO=n=>{const e=M2(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},zb=()=>{var n;return(n=dp())==null?void 0:n.config},O2=n=>{var e;return(e=dp())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TO{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cu(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function P2(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EO(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",i=n.iat||0,r=n.sub||n.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}},...n};return[wg(JSON.stringify(t)),wg(JSON.stringify(l)),""].join(".")}const Kh={};function wO(){const n={prod:[],emulator:[]};for(const e of Object.keys(Kh))Kh[e]?n.emulator.push(e):n.prod.push(e);return n}function SO(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let eS=!1;function V2(n,e){if(typeof window>"u"||typeof document>"u"||!cu(window.location.host)||Kh[n]===e||Kh[n]||eS)return;Kh[n]=e;function t(v){return`__firebase__banner__${v}`}const s="__firebase__banner",r=wO().prod.length>0;function l(){const v=document.getElementById(s);v&&v.remove()}function c(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function h(v,T){v.setAttribute("width","24"),v.setAttribute("id",T),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function d(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{eS=!0,l()},v}function m(v,T){v.setAttribute("id",T),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function _(){const v=SO(s),T=t("text"),S=document.getElementById(T)||document.createElement("span"),E=t("learnmore"),R=document.getElementById(E)||document.createElement("a"),k=t("preprendIcon"),L=document.getElementById(k)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const O=v.element;c(O),m(R,E);const H=d();h(L,k),O.append(L,S,R,H),document.body.appendChild(O)}r?(S.innerText="Preview backend disconnected.",L.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(L.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function AO(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(hn())}function L2(){var e;const n=(e=dp())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function IO(){return typeof window<"u"||j2()}function j2(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function RO(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function CO(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function DO(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function NO(){const n=hn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function U2(){return!L2()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function B2(){return!L2()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function F2(){try{return typeof indexedDB=="object"}catch{return!1}}function kO(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var r;e(((r=i.error)==null?void 0:r.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MO="FirebaseError";class Ni extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=MO,Object.setPrototypeOf(this,Ni.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xl.prototype.create)}}class xl{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},i=`${this.service}/${e}`,r=this.errors[e],l=r?OO(r,s):"Error",c=`${this.serviceName}: ${l} (${i}).`;return new Ni(i,c,s)}}function OO(n,e){return n.replace(PO,(t,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const PO=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tS(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function VO(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function dr(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const i of t){if(!s.includes(i))return!1;const r=n[i],l=e[i];if(nS(r)&&nS(l)){if(!dr(r,l))return!1}else if(r!==l)return!1}for(const i of s)if(!t.includes(i))return!1;return!0}function nS(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fd(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function z2(n,e){const t=new LO(n,e);return t.subscribe.bind(t)}class LO{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let i;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");jO(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:s},i.next===void 0&&(i.next=n0),i.error===void 0&&(i.error=n0),i.complete===void 0&&(i.complete=n0);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function jO(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function n0(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wt(n){return n&&n._delegate?n._delegate:n}class fr{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UO{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new TO;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(FO(e))try{this.getOrInitializeService({instanceIdentifier:zo})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(e=zo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=zo){return this.instances.has(e)}getOptions(e=zo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[r,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(r);s===c&&l.resolve(i)}return i}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(s)??new Set;i.add(e),this.onInitCallbacks.set(s,i);const r=this.instances.get(s);return r&&e(r,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const i of s)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:BO(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=zo){return this.component?this.component.multipleInstances?e:zo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function BO(n){return n===zo?void 0:n}function FO(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new UO(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb=[];var Ye;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ye||(Ye={}));const q2={debug:Ye.DEBUG,verbose:Ye.VERBOSE,info:Ye.INFO,warn:Ye.WARN,error:Ye.ERROR,silent:Ye.SILENT},zO=Ye.INFO,HO={[Ye.DEBUG]:"log",[Ye.VERBOSE]:"log",[Ye.INFO]:"info",[Ye.WARN]:"warn",[Ye.ERROR]:"error"},qO=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),i=HO[e];if(i)console[i](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class fp{constructor(e){this.name=e,this._logLevel=zO,this._logHandler=qO,this._userLogHandler=null,Hb.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?q2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ye.DEBUG,...e),this._logHandler(this,Ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ye.VERBOSE,...e),this._logHandler(this,Ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ye.INFO,...e),this._logHandler(this,Ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ye.WARN,...e),this._logHandler(this,Ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ye.ERROR,...e),this._logHandler(this,Ye.ERROR,...e)}}function GO(n){Hb.forEach(e=>{e.setLogLevel(n)})}function $O(n,e){for(const t of Hb){let s=null;e&&e.level&&(s=q2[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,r,...l)=>{const c=l.map(h=>{if(h==null)return null;if(typeof h=="string")return h;if(typeof h=="number"||typeof h=="boolean")return h.toString();if(h instanceof Error)return h.message;try{return JSON.stringify(h)}catch{return null}}).filter(h=>h).join(" ");r>=(s??i.logLevel)&&n({level:Ye[r].toLowerCase(),message:c,args:l,type:i.name})}}}const WO=(n,e)=>e.some(t=>n instanceof t);let sS,iS;function YO(){return sS||(sS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function KO(){return iS||(iS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const G2=new WeakMap,V0=new WeakMap,$2=new WeakMap,s0=new WeakMap,qb=new WeakMap;function QO(n){const e=new Promise((t,s)=>{const i=()=>{n.removeEventListener("success",r),n.removeEventListener("error",l)},r=()=>{t(Aa(n.result)),i()},l=()=>{s(n.error),i()};n.addEventListener("success",r),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&G2.set(t,n)}).catch(()=>{}),qb.set(e,n),e}function XO(n){if(V0.has(n))return;const e=new Promise((t,s)=>{const i=()=>{n.removeEventListener("complete",r),n.removeEventListener("error",l),n.removeEventListener("abort",l)},r=()=>{t(),i()},l=()=>{s(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",r),n.addEventListener("error",l),n.addEventListener("abort",l)});V0.set(n,e)}let L0={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return V0.get(n);if(e==="objectStoreNames")return n.objectStoreNames||$2.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Aa(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function ZO(n){L0=n(L0)}function JO(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(i0(this),e,...t);return $2.set(s,e.sort?e.sort():[e]),Aa(s)}:KO().includes(n)?function(...e){return n.apply(i0(this),e),Aa(G2.get(this))}:function(...e){return Aa(n.apply(i0(this),e))}}function eP(n){return typeof n=="function"?JO(n):(n instanceof IDBTransaction&&XO(n),WO(n,YO())?new Proxy(n,L0):n)}function Aa(n){if(n instanceof IDBRequest)return QO(n);if(s0.has(n))return s0.get(n);const e=eP(n);return e!==n&&(s0.set(n,e),qb.set(e,n)),e}const i0=n=>qb.get(n);function tP(n,e,{blocked:t,upgrade:s,blocking:i,terminated:r}={}){const l=indexedDB.open(n,e),c=Aa(l);return s&&l.addEventListener("upgradeneeded",h=>{s(Aa(l.result),h.oldVersion,h.newVersion,Aa(l.transaction),h)}),t&&l.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),c.then(h=>{r&&h.addEventListener("close",()=>r()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const nP=["get","getKey","getAll","getAllKeys","count"],sP=["put","add","delete","clear"],r0=new Map;function rS(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(r0.get(e))return r0.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,i=sP.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(i||nP.includes(t)))return;const r=async function(l,...c){const h=this.transaction(l,i?"readwrite":"readonly");let d=h.store;return s&&(d=d.index(c.shift())),(await Promise.all([d[t](...c),i&&h.done]))[0]};return r0.set(e,r),r}ZO(n=>({...n,get:(e,t,s)=>rS(e,t)||n.get(e,t,s),has:(e,t)=>!!rS(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(rP(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function rP(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ag="@firebase/app",j0="0.14.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mr=new fp("@firebase/app"),aP="@firebase/app-compat",oP="@firebase/analytics-compat",lP="@firebase/analytics",cP="@firebase/app-check-compat",uP="@firebase/app-check",hP="@firebase/auth",dP="@firebase/auth-compat",fP="@firebase/database",mP="@firebase/data-connect",gP="@firebase/database-compat",pP="@firebase/functions",_P="@firebase/functions-compat",yP="@firebase/installations",bP="@firebase/installations-compat",vP="@firebase/messaging",xP="@firebase/messaging-compat",TP="@firebase/performance",EP="@firebase/performance-compat",wP="@firebase/remote-config",SP="@firebase/remote-config-compat",AP="@firebase/storage",IP="@firebase/storage-compat",RP="@firebase/firestore",CP="@firebase/ai",DP="@firebase/firestore-compat",NP="firebase",kP="12.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ka="[DEFAULT]",MP={[Ag]:"fire-core",[aP]:"fire-core-compat",[lP]:"fire-analytics",[oP]:"fire-analytics-compat",[uP]:"fire-app-check",[cP]:"fire-app-check-compat",[hP]:"fire-auth",[dP]:"fire-auth-compat",[fP]:"fire-rtdb",[mP]:"fire-data-connect",[gP]:"fire-rtdb-compat",[pP]:"fire-fn",[_P]:"fire-fn-compat",[yP]:"fire-iid",[bP]:"fire-iid-compat",[vP]:"fire-fcm",[xP]:"fire-fcm-compat",[TP]:"fire-perf",[EP]:"fire-perf-compat",[wP]:"fire-rc",[SP]:"fire-rc-compat",[AP]:"fire-gcs",[IP]:"fire-gcs-compat",[RP]:"fire-fst",[DP]:"fire-fst-compat",[CP]:"fire-vertex","fire-js":"fire-js",[NP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma=new Map,Oc=new Map,Pc=new Map;function hd(n,e){try{n.container.addComponent(e)}catch(t){mr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function W2(n,e){n.container.addOrOverwriteComponent(e)}function Oa(n){const e=n.name;if(Pc.has(e))return mr.debug(`There were multiple attempts to register component ${e}.`),!1;Pc.set(e,n);for(const t of Ma.values())hd(t,n);for(const t of Oc.values())hd(t,n);return!0}function zd(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function OP(n,e,t=ka){zd(n,e).clearInstance(t)}function Gb(n){return n.options!==void 0}function Y2(n){return Gb(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function ks(n){return n==null?!1:n.settings!==void 0}function PP(){Pc.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ps=new xl("app","Firebase",VP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let K2=class{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new fr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ps.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aS(n,e){const t=Bb(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const i=JSON.parse(t).exp*1e3,r=new Date().getTime();i-r<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class LP extends K2{constructor(e,t,s,i){const r=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,l={name:s,automaticDataCollectionEnabled:r};if(e.apiKey!==void 0)super(e,l,i);else{const c=e;super(c.options,l,i)}this._serverConfig={automaticDataCollectionEnabled:r,...t},this._serverConfig.authIdToken&&aS(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&aS(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Os(Ag,j0,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Wb(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw ps.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wa=kP;function mp(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:ka,automaticDataCollectionEnabled:!0,...e},i=s.name;if(typeof i!="string"||!i)throw ps.create("bad-app-name",{appName:String(i)});if(t||(t=zb()),!t)throw ps.create("no-options");const r=Ma.get(i);if(r){if(dr(t,r.options)&&dr(s,r.config))return r;throw ps.create("duplicate-app",{appName:i})}const l=new H2(i);for(const h of Pc.values())l.addComponent(h);const c=new K2(t,s,l);return Ma.set(i,c),c}function jP(n,e={}){if(IO()&&!j2())throw ps.create("invalid-server-app-environment");let t,s=e||{};if(n&&(Gb(n)?t=n.options:Y2(n)?s=n:t=n),s.automaticDataCollectionEnabled===void 0&&(s.automaticDataCollectionEnabled=!0),t||(t=zb()),!t)throw ps.create("no-options");const i={...s,...t};i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;const r=m=>[...m].reduce((_,v)=>Math.imul(31,_)+v.charCodeAt(0)|0,0);if(s.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw ps.create("finalization-registry-not-supported",{});const l=""+r(JSON.stringify(i)),c=Oc.get(l);if(c)return c.incRefCount(s.releaseOnDeref),c;const h=new H2(l);for(const m of Pc.values())h.addComponent(m);const d=new LP(t,s,l,h);return Oc.set(l,d),d}function $b(n=ka){const e=Ma.get(n);if(!e&&n===ka&&zb())return mp();if(!e)throw ps.create("no-app",{appName:n});return e}function UP(){return Array.from(Ma.values())}async function Wb(n){let e=!1;const t=n.name;Ma.has(t)?(e=!0,Ma.delete(t)):Oc.has(t)&&n.decRefCount()<=0&&(Oc.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(s=>s.delete())),n.isDeleted=!0)}function Os(n,e,t){let s=MP[n]??n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),r=e.match(/\s|\//);if(i||r){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&r&&l.push("and"),r&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),mr.warn(l.join(" "));return}Oa(new fr(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}function Q2(n,e){if(n!==null&&typeof n!="function")throw ps.create("invalid-log-argument");$O(n,e)}function X2(n){GO(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BP="firebase-heartbeat-database",FP=1,dd="firebase-heartbeat-store";let a0=null;function Z2(){return a0||(a0=tP(BP,FP,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(dd)}catch(t){console.warn(t)}}}}).catch(n=>{throw ps.create("idb-open",{originalErrorMessage:n.message})})),a0}async function zP(n){try{const t=(await Z2()).transaction(dd),s=await t.objectStore(dd).get(J2(n));return await t.done,s}catch(e){if(e instanceof Ni)mr.warn(e.message);else{const t=ps.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});mr.warn(t.message)}}}async function oS(n,e){try{const s=(await Z2()).transaction(dd,"readwrite");await s.objectStore(dd).put(e,J2(n)),await s.done}catch(t){if(t instanceof Ni)mr.warn(t.message);else{const s=ps.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});mr.warn(s.message)}}}function J2(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HP=1024,qP=30;class GP{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new WP(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=lS();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(l=>l.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:i}),this._heartbeatsCache.heartbeats.length>qP){const l=YP(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){mr.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=lS(),{heartbeatsToSend:s,unsentEntries:i}=$P(this._heartbeatsCache.heartbeats),r=wg(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return mr.warn(t),""}}}function lS(){return new Date().toISOString().substring(0,10)}function $P(n,e=HP){const t=[];let s=n.slice();for(const i of n){const r=t.find(l=>l.agent===i.agent);if(r){if(r.dates.push(i.date),cS(t)>e){r.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),cS(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class WP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return F2()?kO().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await zP(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return oS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return oS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function cS(n){return wg(JSON.stringify({version:2,heartbeats:n})).length}function YP(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KP(n){Oa(new fr("platform-logger",e=>new iP(e),"PRIVATE")),Oa(new fr("heartbeat",e=>new GP(e),"PRIVATE")),Os(Ag,j0,n),Os(Ag,j0,"esm2020"),Os("fire-js","")}KP("");const QP=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Ni,SDK_VERSION:Wa,_DEFAULT_ENTRY_NAME:ka,_addComponent:hd,_addOrOverwriteComponent:W2,_apps:Ma,_clearComponents:PP,_components:Pc,_getProvider:zd,_isFirebaseApp:Gb,_isFirebaseServerApp:ks,_isFirebaseServerAppSettings:Y2,_registerComponent:Oa,_removeServiceInstance:OP,_serverApps:Oc,deleteApp:Wb,getApp:$b,getApps:UP,initializeApp:mp,initializeServerApp:jP,onLog:Q2,registerVersion:Os,setLogLevel:X2},Symbol.toStringTag,{value:"Module"}));var XP="firebase",ZP="12.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Os(XP,ZP,"app");function eR(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const JP=eR,tR=new xl("auth","Firebase",eR());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ig=new fp("@firebase/auth");function eV(n,...e){Ig.logLevel<=Ye.WARN&&Ig.warn(`Auth (${Wa}): ${n}`,...e)}function eg(n,...e){Ig.logLevel<=Ye.ERROR&&Ig.error(`Auth (${Wa}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ri(n,...e){throw Kb(n,...e)}function Qs(n,...e){return Kb(n,...e)}function Yb(n,e,t){const s={...JP(),[e]:t};return new xl("auth","Firebase",s).create(e,{appName:n.name})}function il(n){return Yb(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function tV(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&Ri(n,"argument-error"),Yb(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Kb(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return tR.create(n,...e)}function Oe(n,e,...t){if(!n)throw Kb(e,...t)}function ar(n){const e="INTERNAL ASSERTION FAILED: "+n;throw eg(e),new Error(e)}function gr(n,e){n||ar(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U0(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function nV(){return uS()==="http:"||uS()==="https:"}function uS(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nV()||CO()||"connection"in navigator)?navigator.onLine:!0}function iV(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd{constructor(e,t){this.shortDelay=e,this.longDelay=t,gr(t>e,"Short delay should be less than long delay!"),this.isMobile=AO()||DO()}get(){return sV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qb(n,e){gr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ar("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ar("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ar("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aV=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],oV=new Hd(3e4,6e4);function Xb(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function uu(n,e,t,s,i={}){return sR(n,i,async()=>{let r={},l={};s&&(e==="GET"?l=s:r={body:JSON.stringify(s)});const c=Fd({key:n.config.apiKey,...l}).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);const d={method:e,headers:h,...r};return RO()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&cu(n.emulatorConfig.host)&&(d.credentials="include"),nR.fetch()(await iR(n,n.config.apiHost,t,c),d)})}async function sR(n,e,t){n._canInitEmulator=!1;const s={...rV,...e};try{const i=new cV(n),r=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const l=await r.json();if("needConfirmation"in l)throw Nm(n,"account-exists-with-different-credential",l);if(r.ok&&!("errorMessage"in l))return l;{const c=r.ok?l.errorMessage:l.error.message,[h,d]=c.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Nm(n,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw Nm(n,"email-already-in-use",l);if(h==="USER_DISABLED")throw Nm(n,"user-disabled",l);const m=s[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Yb(n,m,d);Ri(n,m)}}catch(i){if(i instanceof Ni)throw i;Ri(n,"network-request-failed",{message:String(i)})}}async function lV(n,e,t,s,i={}){const r=await uu(n,e,t,s,i);return"mfaPendingCredential"in r&&Ri(n,"multi-factor-auth-required",{_serverResponse:r}),r}async function iR(n,e,t,s){const i=`${e}${t}?${s}`,r=n,l=r.config.emulator?Qb(n.config,i):`${n.config.apiScheme}://${i}`;return aV.includes(t)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(l).toString():l}class cV{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(Qs(this.auth,"network-request-failed")),oV.get())})}}function Nm(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const i=Qs(n,e,s);return i.customData._tokenResponse=t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uV(n,e){return uu(n,"POST","/v1/accounts:delete",e)}async function Rg(n,e){return uu(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function hV(n,e=!1){const t=wt(n),s=await t.getIdToken(e),i=Zb(s);Oe(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const r=typeof i.firebase=="object"?i.firebase:void 0,l=r==null?void 0:r.sign_in_provider;return{claims:i,token:s,authTime:Qh(o0(i.auth_time)),issuedAtTime:Qh(o0(i.iat)),expirationTime:Qh(o0(i.exp)),signInProvider:l||null,signInSecondFactor:(r==null?void 0:r.sign_in_second_factor)||null}}function o0(n){return Number(n)*1e3}function Zb(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return eg("JWT malformed, contained fewer than 3 sections"),null;try{const i=Bb(t);return i?JSON.parse(i):(eg("Failed to decode base64 JWT payload"),null)}catch(i){return eg("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function hS(n){const e=Zb(n);return Oe(e,"internal-error"),Oe(typeof e.exp<"u","internal-error"),Oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fd(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof Ni&&dV(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function dV({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Qh(this.lastLoginAt),this.creationTime=Qh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cg(n){var _;const e=n.auth,t=await n.getIdToken(),s=await fd(n,Rg(e,{idToken:t}));Oe(s==null?void 0:s.users.length,e,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const r=(_=i.providerUserInfo)!=null&&_.length?rR(i.providerUserInfo):[],l=gV(n.providerData,r),c=n.isAnonymous,h=!(n.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?h:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new B0(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,m)}async function mV(n){const e=wt(n);await Cg(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function gV(n,e){return[...n.filter(s=>!e.some(i=>i.providerId===s.providerId)),...e]}function rR(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pV(n,e){const t=await sR(n,{},async()=>{const s=Fd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=n.config,l=await iR(n,i,"/v1/token",`key=${r}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:c,body:s};return n.emulatorConfig&&cu(n.emulatorConfig.host)&&(h.credentials="include"),nR.fetch()(l,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function _V(n,e){return uu(n,"POST","/v2/accounts:revokeToken",Xb(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Oe(e.idToken,"internal-error"),Oe(typeof e.idToken<"u","internal-error"),Oe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):hS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Oe(e.length!==0,"internal-error");const t=hS(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:i,expiresIn:r}=await pV(e,t);this.updateTokensAndExpiration(s,i,Number(r))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:i,expirationTime:r}=t,l=new Rc;return s&&(Oe(typeof s=="string","internal-error",{appName:e}),l.refreshToken=s),i&&(Oe(typeof i=="string","internal-error",{appName:e}),l.accessToken=i),r&&(Oe(typeof r=="number","internal-error",{appName:e}),l.expirationTime=r),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Rc,this.toJSON())}_performRefresh(){return ar("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ca(n,e){Oe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ys{constructor({uid:e,auth:t,stsTokenManager:s,...i}){this.providerId="firebase",this.proactiveRefresh=new fV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new B0(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await fd(this,this.stsTokenManager.getToken(this.auth,e));return Oe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return hV(this,e)}reload(){return mV(this)}_assign(e){this!==e&&(Oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ys({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Cg(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ks(this.auth.app))return Promise.reject(il(this.auth));const e=await this.getIdToken();return await fd(this,uV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const s=t.displayName??void 0,i=t.email??void 0,r=t.phoneNumber??void 0,l=t.photoURL??void 0,c=t.tenantId??void 0,h=t._redirectEventId??void 0,d=t.createdAt??void 0,m=t.lastLoginAt??void 0,{uid:_,emailVerified:v,isAnonymous:T,providerData:S,stsTokenManager:E}=t;Oe(_&&E,e,"internal-error");const R=Rc.fromJSON(this.name,E);Oe(typeof _=="string",e,"internal-error"),ca(s,e.name),ca(i,e.name),Oe(typeof v=="boolean",e,"internal-error"),Oe(typeof T=="boolean",e,"internal-error"),ca(r,e.name),ca(l,e.name),ca(c,e.name),ca(h,e.name),ca(d,e.name),ca(m,e.name);const k=new Ys({uid:_,auth:e,email:i,emailVerified:v,displayName:s,isAnonymous:T,photoURL:l,phoneNumber:r,tenantId:c,stsTokenManager:R,createdAt:d,lastLoginAt:m});return S&&Array.isArray(S)&&(k.providerData=S.map(L=>({...L}))),h&&(k._redirectEventId=h),k}static async _fromIdTokenResponse(e,t,s=!1){const i=new Rc;i.updateFromServerResponse(t);const r=new Ys({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:s});return await Cg(r),r}static async _fromGetAccountInfoResponse(e,t,s){const i=t.users[0];Oe(i.localId!==void 0,"internal-error");const r=i.providerUserInfo!==void 0?rR(i.providerUserInfo):[],l=!(i.email&&i.passwordHash)&&!(r!=null&&r.length),c=new Rc;c.updateFromIdToken(s);const h=new Ys({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:l}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new B0(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(r!=null&&r.length)};return Object.assign(h,d),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dS=new Map;function or(n){gr(n instanceof Function,"Expected a class definition");let e=dS.get(n);return e?(gr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,dS.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aR{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}aR.type="NONE";const fS=aR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tg(n,e,t){return`firebase:${n}:${e}:${t}`}class Cc{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:i,name:r}=this.auth;this.fullUserKey=tg(this.userKey,i.apiKey,r),this.fullPersistenceKey=tg("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Rg(this.auth,{idToken:e}).catch(()=>{});return t?Ys._fromGetAccountInfoResponse(this.auth,t,e):null}return Ys._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new Cc(or(fS),e,s);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let r=i[0]||or(fS);const l=tg(s,e.config.apiKey,e.name);let c=null;for(const d of t)try{const m=await d._get(l);if(m){let _;if(typeof m=="string"){const v=await Rg(e,{idToken:m}).catch(()=>{});if(!v)break;_=await Ys._fromGetAccountInfoResponse(e,v,m)}else _=Ys._fromJSON(e,m);d!==r&&(c=_),r=d;break}}catch{}const h=i.filter(d=>d._shouldAllowMigration);return!r._shouldAllowMigration||!h.length?new Cc(r,e,s):(r=h[0],c&&await r._set(l,c.toJSON()),await Promise.all(t.map(async d=>{if(d!==r)try{await d._remove(l)}catch{}})),new Cc(r,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mS(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(uR(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(oR(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(dR(e))return"Blackberry";if(fR(e))return"Webos";if(lR(e))return"Safari";if((e.includes("chrome/")||cR(e))&&!e.includes("edge/"))return"Chrome";if(hR(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function oR(n=hn()){return/firefox\//i.test(n)}function lR(n=hn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function cR(n=hn()){return/crios\//i.test(n)}function uR(n=hn()){return/iemobile/i.test(n)}function hR(n=hn()){return/android/i.test(n)}function dR(n=hn()){return/blackberry/i.test(n)}function fR(n=hn()){return/webos/i.test(n)}function Jb(n=hn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function yV(n=hn()){var e;return Jb(n)&&!!((e=window.navigator)!=null&&e.standalone)}function bV(){return NO()&&document.documentMode===10}function mR(n=hn()){return Jb(n)||hR(n)||fR(n)||dR(n)||/windows phone/i.test(n)||uR(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gR(n,e=[]){let t;switch(n){case"Browser":t=mS(hn());break;case"Worker":t=`${mS(hn())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Wa}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=r=>new Promise((l,c)=>{try{const h=e(r);l(h)}catch(h){c(h)}});s.onAbort=t,this.queue.push(s);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xV(n,e={}){return uu(n,"GET","/v2/passwordPolicy",Xb(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TV=6;class EV{constructor(e){var s;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??TV,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((s=e.allowedNonAlphanumericCharacters)==null?void 0:s.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let i=0;i<e.length;i++)s=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV{constructor(e,t,s,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gS(this),this.idTokenSubscription=new gS(this),this.beforeStateQueue=new vV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=tR,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=or(t)),this._initializationPromise=this.queue(async()=>{var s,i,r;if(!this._deleted&&(this.persistenceManager=await Cc.create(this,e),(s=this._resolvePersistenceManagerAvailable)==null||s.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((r=this.currentUser)==null?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Rg(this,{idToken:e}),s=await Ys._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(ks(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let s=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(r=this.redirectUser)==null?void 0:r._redirectEventId,c=s==null?void 0:s._redirectEventId,h=await this.tryRedirectSignIn(e);(!l||l===c)&&(h!=null&&h.user)&&(s=h.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(l){s=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Cg(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=iV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ks(this.app))return Promise.reject(il(this));const t=e?wt(e):null;return t&&Oe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ks(this.app)?Promise.reject(il(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ks(this.app)?Promise.reject(il(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(or(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await xV(this),t=new EV(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new xl("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await _V(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&or(e)||this._popupRedirectResolver;Oe(t,this,"argument-error"),this.redirectPersistenceManager=await Cc.create(this,[or(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)==null?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,i){if(this._deleted)return()=>{};const r=typeof t=="function"?t:t.next.bind(t);let l=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Oe(c,this,"internal-error"),c.then(()=>{l||r(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,s,i);return()=>{l=!0,h()}}else{const h=e.addObserver(t);return()=>{l=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=gR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){var t;if(ks(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&eV(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function gp(n){return wt(n)}class gS{constructor(e){this.auth=e,this.observer=null,this.addObserver=z2(t=>this.observer=t)}get next(){return Oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ev={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function SV(n){ev=n}function AV(n){return ev.loadJS(n)}function IV(){return ev.gapiScript}function RV(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CV(n,e){const t=zd(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),r=t.getOptions();if(dr(r,e??{}))return i;Ri(i,"already-initialized")}return t.initialize({options:e})}function DV(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(or);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function NV(n,e,t){const s=gp(n);Oe(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const i=!1,r=pR(e),{host:l,port:c}=kV(e),h=c===null?"":`:${c}`,d={url:`${r}//${l}${h}/`},m=Object.freeze({host:l,port:c,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!s._canInitEmulator){Oe(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),Oe(dr(d,s.config.emulator)&&dr(m,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=d,s.emulatorConfig=m,s.settings.appVerificationDisabledForTesting=!0,cu(l)?(P2(`${r}//${l}${h}`),V2("Auth",!0)):MV()}function pR(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function kV(n){const e=pR(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const r=i[1];return{host:r,port:pS(s.substr(r.length+1))}}else{const[r,l]=s.split(":");return{host:r,port:pS(l)}}}function pS(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function MV(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ar("not implemented")}_getIdTokenResponse(e){return ar("not implemented")}_linkToIdToken(e,t){return ar("not implemented")}_getReauthenticationResolver(e){return ar("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dc(n,e){return lV(n,"POST","/v1/accounts:signInWithIdp",Xb(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OV="http://localhost";class ll extends _R{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ll(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ri("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:i,...r}=t;if(!s||!i)return null;const l=new ll(s,i);return l.idToken=r.idToken||void 0,l.accessToken=r.accessToken||void 0,l.secret=r.secret,l.nonce=r.nonce,l.pendingToken=r.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return Dc(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Dc(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Dc(e,t)}buildRequest(){const e={requestUri:OV,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Fd(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qd extends tv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa extends qd{constructor(){super("facebook.com")}static credential(e){return ll._fromParams({providerId:pa.PROVIDER_ID,signInMethod:pa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return pa.credentialFromTaggedObject(e)}static credentialFromError(e){return pa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return pa.credential(e.oauthAccessToken)}catch{return null}}}pa.FACEBOOK_SIGN_IN_METHOD="facebook.com";pa.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr extends qd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ll._fromParams({providerId:rr.PROVIDER_ID,signInMethod:rr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return rr.credentialFromTaggedObject(e)}static credentialFromError(e){return rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return rr.credential(t,s)}catch{return null}}}rr.GOOGLE_SIGN_IN_METHOD="google.com";rr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a extends qd{constructor(){super("github.com")}static credential(e){return ll._fromParams({providerId:_a.PROVIDER_ID,signInMethod:_a.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _a.credentialFromTaggedObject(e)}static credentialFromError(e){return _a.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _a.credential(e.oauthAccessToken)}catch{return null}}}_a.GITHUB_SIGN_IN_METHOD="github.com";_a.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya extends qd{constructor(){super("twitter.com")}static credential(e,t){return ll._fromParams({providerId:ya.PROVIDER_ID,signInMethod:ya.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ya.credentialFromTaggedObject(e)}static credentialFromError(e){return ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return ya.credential(t,s)}catch{return null}}}ya.TWITTER_SIGN_IN_METHOD="twitter.com";ya.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,i=!1){const r=await Ys._fromIdTokenResponse(e,s,i),l=_S(s);return new Vc({user:r,providerId:l,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const i=_S(s);return new Vc({user:e,providerId:i,_tokenResponse:s,operationType:t})}}function _S(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dg extends Ni{constructor(e,t,s,i){super(t.code,t.message),this.operationType=s,this.user=i,Object.setPrototypeOf(this,Dg.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,i){return new Dg(e,t,s,i)}}function yR(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?Dg._fromErrorAndOperation(n,r,e,s):r})}async function PV(n,e,t=!1){const s=await fd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Vc._forOperation(n,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VV(n,e,t=!1){const{auth:s}=n;if(ks(s.app))return Promise.reject(il(s));const i="reauthenticate";try{const r=await fd(n,yR(s,i,e,n),t);Oe(r.idToken,s,"internal-error");const l=Zb(r.idToken);Oe(l,s,"internal-error");const{sub:c}=l;return Oe(n.uid===c,s,"user-mismatch"),Vc._forOperation(n,i,r)}catch(r){throw(r==null?void 0:r.code)==="auth/user-not-found"&&Ri(s,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LV(n,e,t=!1){if(ks(n.app))return Promise.reject(il(n));const s="signIn",i=await yR(n,s,e),r=await Vc._fromIdTokenResponse(n,s,i);return t||await n._updateCurrentUser(r.user),r}function jV(n,e,t,s){return wt(n).onIdTokenChanged(e,t,s)}function UV(n,e,t){return wt(n).beforeAuthStateChanged(e,t)}const Ng="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ng,"1"),this.storage.removeItem(Ng),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BV=1e3,FV=10;class vR extends bR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=mR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),i=this.localCache[t];s!==i&&e(t,i,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,c,h)=>{this.notifyListeners(l,h)});return}const s=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const l=this.storage.getItem(s);!t&&this.localCache[s]===l||this.notifyListeners(s,l)},r=this.storage.getItem(s);bV()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,FV):i()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},BV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}vR.type="LOCAL";const zV=vR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR extends bR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}xR.type="SESSION";const TR=xR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HV(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const s=new pp(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:i,data:r}=t.data,l=this.handlersMap[i];if(!(l!=null&&l.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:i});const c=Array.from(l).map(async d=>d(t.origin,r)),h=await HV(c);t.ports[0].postMessage({status:"done",eventId:s,eventType:i,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}pp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nv(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qV{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,l;return new Promise((c,h)=>{const d=nv("",20);i.port1.start();const m=setTimeout(()=>{h(new Error("unsupported_event"))},s);l={messageChannel:i,onMessage(_){const v=_;if(v.data.eventId===d)switch(v.data.status){case"ack":clearTimeout(m),r=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),c(v.data.response);break;default:clearTimeout(m),clearTimeout(r),h(new Error("invalid_response"));break}}},this.handlers.add(l),i.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ti(){return window}function GV(n){Ti().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ER(){return typeof Ti().WorkerGlobalScope<"u"&&typeof Ti().importScripts=="function"}async function $V(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function WV(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function YV(){return ER()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wR="firebaseLocalStorageDb",KV=1,kg="firebaseLocalStorage",SR="fbase_key";class Gd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function _p(n,e){return n.transaction([kg],e?"readwrite":"readonly").objectStore(kg)}function QV(){const n=indexedDB.deleteDatabase(wR);return new Gd(n).toPromise()}function F0(){const n=indexedDB.open(wR,KV);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(kg,{keyPath:SR})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(kg)?e(s):(s.close(),await QV(),e(await F0()))})})}async function yS(n,e,t){const s=_p(n,!0).put({[SR]:e,value:t});return new Gd(s).toPromise()}async function XV(n,e){const t=_p(n,!1).get(e),s=await new Gd(t).toPromise();return s===void 0?null:s.value}function bS(n,e){const t=_p(n,!0).delete(e);return new Gd(t).toPromise()}const ZV=800,JV=3;class AR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await F0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>JV)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ER()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=pp._getInstance(YV()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,s;if(this.activeServiceWorker=await $V(),!this.activeServiceWorker)return;this.sender=new qV(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(s=e[0])!=null&&s.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||WV()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await F0();return await yS(e,Ng,"1"),await bS(e,Ng),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>yS(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>XV(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>bS(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const r=_p(i,!1).getAll();return new Gd(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:i,value:r}of e)s.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!s.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ZV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}AR.type="LOCAL";const eL=AR;new Hd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IR(n,e){return e?or(e):(Oe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv extends _R{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Dc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Dc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Dc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function tL(n){return LV(n.auth,new sv(n),n.bypassAuthState)}function nL(n){const{auth:e,user:t}=n;return Oe(t,e,"internal-error"),VV(t,new sv(n),n.bypassAuthState)}async function sL(n){const{auth:e,user:t}=n;return Oe(t,e,"internal-error"),PV(t,new sv(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RR{constructor(e,t,s,i,r=!1){this.auth=e,this.resolver=s,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:i,tenantId:r,error:l,type:c}=e;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:t,sessionId:s,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(h))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return tL;case"linkViaPopup":case"linkViaRedirect":return sL;case"reauthViaPopup":case"reauthViaRedirect":return nL;default:Ri(this.auth,"internal-error")}}resolve(e){gr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){gr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iL=new Hd(2e3,1e4);async function rL(n,e,t){if(ks(n.app))return Promise.reject(Qs(n,"operation-not-supported-in-this-environment"));const s=gp(n);tV(n,e,tv);const i=IR(s,t);return new Zo(s,"signInViaPopup",e,i).executeNotNull()}class Zo extends RR{constructor(e,t,s,i,r){super(e,t,i,r),this.provider=s,this.authWindow=null,this.pollId=null,Zo.currentPopupAction&&Zo.currentPopupAction.cancel(),Zo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Oe(e,this.auth,"internal-error"),e}async onExecution(){gr(this.filter.length===1,"Popup operations only handle one event");const e=nv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Qs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Qs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Zo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if((s=(t=this.authWindow)==null?void 0:t.window)!=null&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Qs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,iL.get())};e()}}Zo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aL="pendingRedirect",ng=new Map;class oL extends RR{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=ng.get(this.auth._key());if(!e){try{const s=await lL(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}ng.set(this.auth._key(),e)}return this.bypassAuthState||ng.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function lL(n,e){const t=hL(e),s=uL(n);if(!await s._isAvailable())return!1;const i=await s._get(t)==="true";return await s._remove(t),i}function cL(n,e){ng.set(n._key(),e)}function uL(n){return or(n._redirectPersistence)}function hL(n){return tg(aL,n.config.apiKey,n.name)}async function dL(n,e,t=!1){if(ks(n.app))return Promise.reject(il(n));const s=gp(n),i=IR(s,e),l=await new oL(s,i,t).execute();return l&&!t&&(delete l.user._redirectEventId,await s._persistUserIfCurrent(l.user),await s._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fL=600*1e3;class mL{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!gL(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!CR(e)){const i=((s=e.error.code)==null?void 0:s.split("auth/")[1])||"internal-error";t.onError(Qs(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=fL&&this.cachedEventUids.clear(),this.cachedEventUids.has(vS(e))}saveEventToCache(e){this.cachedEventUids.add(vS(e)),this.lastProcessedEventTime=Date.now()}}function vS(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function CR({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function gL(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return CR(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pL(n,e={}){return uu(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _L=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,yL=/^https?/;async function bL(n){if(n.config.emulator)return;const{authorizedDomains:e}=await pL(n);for(const t of e)try{if(vL(t))return}catch{}Ri(n,"unauthorized-domain")}function vL(n){const e=U0(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===s}if(!yL.test(t))return!1;if(_L.test(n))return s===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xL=new Hd(3e4,6e4);function xS(){const n=Ti().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function TL(n){return new Promise((e,t)=>{var i,r,l;function s(){xS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{xS(),t(Qs(n,"network-request-failed"))},timeout:xL.get()})}if((r=(i=Ti().gapi)==null?void 0:i.iframes)!=null&&r.Iframe)e(gapi.iframes.getContext());else if((l=Ti().gapi)!=null&&l.load)s();else{const c=RV("iframefcb");return Ti()[c]=()=>{gapi.load?s():t(Qs(n,"network-request-failed"))},AV(`${IV()}?onload=${c}`).catch(h=>t(h))}}).catch(e=>{throw sg=null,e})}let sg=null;function EL(n){return sg=sg||TL(n),sg}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wL=new Hd(5e3,15e3),SL="__/auth/iframe",AL="emulator/auth/iframe",IL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},RL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function CL(n){const e=n.config;Oe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Qb(e,AL):`https://${n.config.authDomain}/${SL}`,s={apiKey:e.apiKey,appName:n.name,v:Wa},i=RL.get(n.config.apiHost);i&&(s.eid=i);const r=n._getFrameworks();return r.length&&(s.fw=r.join(",")),`${t}?${Fd(s).slice(1)}`}async function DL(n){const e=await EL(n),t=Ti().gapi;return Oe(t,n,"internal-error"),e.open({where:document.body,url:CL(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IL,dontclear:!0},s=>new Promise(async(i,r)=>{await s.restyle({setHideOnLeave:!1});const l=Qs(n,"network-request-failed"),c=Ti().setTimeout(()=>{r(l)},wL.get());function h(){Ti().clearTimeout(c),i(s)}s.ping(h).then(h,()=>{r(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NL={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},kL=500,ML=600,OL="_blank",PL="http://localhost";class TS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function VL(n,e,t,s=kL,i=ML){const r=Math.max((window.screen.availHeight-i)/2,0).toString(),l=Math.max((window.screen.availWidth-s)/2,0).toString();let c="";const h={...NL,width:s.toString(),height:i.toString(),top:r,left:l},d=hn().toLowerCase();t&&(c=cR(d)?OL:t),oR(d)&&(e=e||PL,h.scrollbars="yes");const m=Object.entries(h).reduce((v,[T,S])=>`${v}${T}=${S},`,"");if(yV(d)&&c!=="_self")return LL(e||"",c),new TS(null);const _=window.open(e||"",c,m);Oe(_,n,"popup-blocked");try{_.focus()}catch{}return new TS(_)}function LL(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jL="__/auth/handler",UL="emulator/auth/handler",BL=encodeURIComponent("fac");async function ES(n,e,t,s,i,r){Oe(n.config.authDomain,n,"auth-domain-config-required"),Oe(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:Wa,eventId:i};if(e instanceof tv){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",VO(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,_]of Object.entries({}))l[m]=_}if(e instanceof qd){const m=e.getScopes().filter(_=>_!=="");m.length>0&&(l.scopes=m.join(","))}n.tenantId&&(l.tid=n.tenantId);const c=l;for(const m of Object.keys(c))c[m]===void 0&&delete c[m];const h=await n._getAppCheckToken(),d=h?`#${BL}=${encodeURIComponent(h)}`:"";return`${FL(n)}?${Fd(c).slice(1)}${d}`}function FL({config:n}){return n.emulator?Qb(n,UL):`https://${n.authDomain}/${jL}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l0="webStorageSupport";class zL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=TR,this._completeRedirectFn=dL,this._overrideRedirectResult=cL}async _openPopup(e,t,s,i){var l;gr((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const r=await ES(e,t,s,U0(),i);return VL(e,r,nv())}async _openRedirect(e,t,s,i){await this._originValidation(e);const r=await ES(e,t,s,U0(),i);return GV(r),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:r}=this.eventManagers[t];return i?Promise.resolve(i):(gr(r,"If manager is not set, promise should be"),r)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await DL(e),s=new mL(e);return t.register("authEvent",i=>(Oe(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(l0,{type:l0},i=>{var l;const r=(l=i==null?void 0:i[0])==null?void 0:l[l0];r!==void 0&&t(!!r),Ri(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=bL(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return mR()||lR()||Jb()}}const HL=zL;var wS="@firebase/auth",SS="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qL{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GL(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function $L(n){Oa(new fr("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:l,authDomain:c}=s.options;Oe(l&&!l.includes(":"),"invalid-api-key",{appName:s.name});const h={apiKey:l,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:gR(n)},d=new wV(s,i,r,h);return DV(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),Oa(new fr("auth-internal",e=>{const t=gp(e.getProvider("auth").getImmediate());return(s=>new qL(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Os(wS,SS,GL(n)),Os(wS,SS,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WL=300,YL=O2("authIdTokenMaxAge")||WL;let AS=null;const KL=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>YL)return;const i=t==null?void 0:t.token;AS!==i&&(AS=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function QL(n=$b()){const e=zd(n,"auth");if(e.isInitialized())return e.getImmediate();const t=CV(n,{popupRedirectResolver:HL,persistence:[eL,zV,TR]}),s=O2("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(s,location.origin);if(location.origin===r.origin){const l=KL(r.toString());UV(t,l,()=>l(t.currentUser)),jV(t,c=>l(c))}}const i=M2("auth");return i&&NV(t,`http://${i}`),t}function XL(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}SV({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=i=>{const r=Qs("internal-error");r.customData=i,t(r)},s.type="text/javascript",s.charset="UTF-8",XL().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});$L("Browser");var IS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ia,DR;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,I){function N(){}N.prototype=I.prototype,C.F=I.prototype,C.prototype=new N,C.prototype.constructor=C,C.D=function(V,j,B){for(var M=Array(arguments.length-2),ne=2;ne<arguments.length;ne++)M[ne-2]=arguments[ne];return I.prototype[j].apply(V,M)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,I,N){N||(N=0);const V=Array(16);if(typeof I=="string")for(var j=0;j<16;++j)V[j]=I.charCodeAt(N++)|I.charCodeAt(N++)<<8|I.charCodeAt(N++)<<16|I.charCodeAt(N++)<<24;else for(j=0;j<16;++j)V[j]=I[N++]|I[N++]<<8|I[N++]<<16|I[N++]<<24;I=C.g[0],N=C.g[1],j=C.g[2];let B=C.g[3],M;M=I+(B^N&(j^B))+V[0]+3614090360&4294967295,I=N+(M<<7&4294967295|M>>>25),M=B+(j^I&(N^j))+V[1]+3905402710&4294967295,B=I+(M<<12&4294967295|M>>>20),M=j+(N^B&(I^N))+V[2]+606105819&4294967295,j=B+(M<<17&4294967295|M>>>15),M=N+(I^j&(B^I))+V[3]+3250441966&4294967295,N=j+(M<<22&4294967295|M>>>10),M=I+(B^N&(j^B))+V[4]+4118548399&4294967295,I=N+(M<<7&4294967295|M>>>25),M=B+(j^I&(N^j))+V[5]+1200080426&4294967295,B=I+(M<<12&4294967295|M>>>20),M=j+(N^B&(I^N))+V[6]+2821735955&4294967295,j=B+(M<<17&4294967295|M>>>15),M=N+(I^j&(B^I))+V[7]+4249261313&4294967295,N=j+(M<<22&4294967295|M>>>10),M=I+(B^N&(j^B))+V[8]+1770035416&4294967295,I=N+(M<<7&4294967295|M>>>25),M=B+(j^I&(N^j))+V[9]+2336552879&4294967295,B=I+(M<<12&4294967295|M>>>20),M=j+(N^B&(I^N))+V[10]+4294925233&4294967295,j=B+(M<<17&4294967295|M>>>15),M=N+(I^j&(B^I))+V[11]+2304563134&4294967295,N=j+(M<<22&4294967295|M>>>10),M=I+(B^N&(j^B))+V[12]+1804603682&4294967295,I=N+(M<<7&4294967295|M>>>25),M=B+(j^I&(N^j))+V[13]+4254626195&4294967295,B=I+(M<<12&4294967295|M>>>20),M=j+(N^B&(I^N))+V[14]+2792965006&4294967295,j=B+(M<<17&4294967295|M>>>15),M=N+(I^j&(B^I))+V[15]+1236535329&4294967295,N=j+(M<<22&4294967295|M>>>10),M=I+(j^B&(N^j))+V[1]+4129170786&4294967295,I=N+(M<<5&4294967295|M>>>27),M=B+(N^j&(I^N))+V[6]+3225465664&4294967295,B=I+(M<<9&4294967295|M>>>23),M=j+(I^N&(B^I))+V[11]+643717713&4294967295,j=B+(M<<14&4294967295|M>>>18),M=N+(B^I&(j^B))+V[0]+3921069994&4294967295,N=j+(M<<20&4294967295|M>>>12),M=I+(j^B&(N^j))+V[5]+3593408605&4294967295,I=N+(M<<5&4294967295|M>>>27),M=B+(N^j&(I^N))+V[10]+38016083&4294967295,B=I+(M<<9&4294967295|M>>>23),M=j+(I^N&(B^I))+V[15]+3634488961&4294967295,j=B+(M<<14&4294967295|M>>>18),M=N+(B^I&(j^B))+V[4]+3889429448&4294967295,N=j+(M<<20&4294967295|M>>>12),M=I+(j^B&(N^j))+V[9]+568446438&4294967295,I=N+(M<<5&4294967295|M>>>27),M=B+(N^j&(I^N))+V[14]+3275163606&4294967295,B=I+(M<<9&4294967295|M>>>23),M=j+(I^N&(B^I))+V[3]+4107603335&4294967295,j=B+(M<<14&4294967295|M>>>18),M=N+(B^I&(j^B))+V[8]+1163531501&4294967295,N=j+(M<<20&4294967295|M>>>12),M=I+(j^B&(N^j))+V[13]+2850285829&4294967295,I=N+(M<<5&4294967295|M>>>27),M=B+(N^j&(I^N))+V[2]+4243563512&4294967295,B=I+(M<<9&4294967295|M>>>23),M=j+(I^N&(B^I))+V[7]+1735328473&4294967295,j=B+(M<<14&4294967295|M>>>18),M=N+(B^I&(j^B))+V[12]+2368359562&4294967295,N=j+(M<<20&4294967295|M>>>12),M=I+(N^j^B)+V[5]+4294588738&4294967295,I=N+(M<<4&4294967295|M>>>28),M=B+(I^N^j)+V[8]+2272392833&4294967295,B=I+(M<<11&4294967295|M>>>21),M=j+(B^I^N)+V[11]+1839030562&4294967295,j=B+(M<<16&4294967295|M>>>16),M=N+(j^B^I)+V[14]+4259657740&4294967295,N=j+(M<<23&4294967295|M>>>9),M=I+(N^j^B)+V[1]+2763975236&4294967295,I=N+(M<<4&4294967295|M>>>28),M=B+(I^N^j)+V[4]+1272893353&4294967295,B=I+(M<<11&4294967295|M>>>21),M=j+(B^I^N)+V[7]+4139469664&4294967295,j=B+(M<<16&4294967295|M>>>16),M=N+(j^B^I)+V[10]+3200236656&4294967295,N=j+(M<<23&4294967295|M>>>9),M=I+(N^j^B)+V[13]+681279174&4294967295,I=N+(M<<4&4294967295|M>>>28),M=B+(I^N^j)+V[0]+3936430074&4294967295,B=I+(M<<11&4294967295|M>>>21),M=j+(B^I^N)+V[3]+3572445317&4294967295,j=B+(M<<16&4294967295|M>>>16),M=N+(j^B^I)+V[6]+76029189&4294967295,N=j+(M<<23&4294967295|M>>>9),M=I+(N^j^B)+V[9]+3654602809&4294967295,I=N+(M<<4&4294967295|M>>>28),M=B+(I^N^j)+V[12]+3873151461&4294967295,B=I+(M<<11&4294967295|M>>>21),M=j+(B^I^N)+V[15]+530742520&4294967295,j=B+(M<<16&4294967295|M>>>16),M=N+(j^B^I)+V[2]+3299628645&4294967295,N=j+(M<<23&4294967295|M>>>9),M=I+(j^(N|~B))+V[0]+4096336452&4294967295,I=N+(M<<6&4294967295|M>>>26),M=B+(N^(I|~j))+V[7]+1126891415&4294967295,B=I+(M<<10&4294967295|M>>>22),M=j+(I^(B|~N))+V[14]+2878612391&4294967295,j=B+(M<<15&4294967295|M>>>17),M=N+(B^(j|~I))+V[5]+4237533241&4294967295,N=j+(M<<21&4294967295|M>>>11),M=I+(j^(N|~B))+V[12]+1700485571&4294967295,I=N+(M<<6&4294967295|M>>>26),M=B+(N^(I|~j))+V[3]+2399980690&4294967295,B=I+(M<<10&4294967295|M>>>22),M=j+(I^(B|~N))+V[10]+4293915773&4294967295,j=B+(M<<15&4294967295|M>>>17),M=N+(B^(j|~I))+V[1]+2240044497&4294967295,N=j+(M<<21&4294967295|M>>>11),M=I+(j^(N|~B))+V[8]+1873313359&4294967295,I=N+(M<<6&4294967295|M>>>26),M=B+(N^(I|~j))+V[15]+4264355552&4294967295,B=I+(M<<10&4294967295|M>>>22),M=j+(I^(B|~N))+V[6]+2734768916&4294967295,j=B+(M<<15&4294967295|M>>>17),M=N+(B^(j|~I))+V[13]+1309151649&4294967295,N=j+(M<<21&4294967295|M>>>11),M=I+(j^(N|~B))+V[4]+4149444226&4294967295,I=N+(M<<6&4294967295|M>>>26),M=B+(N^(I|~j))+V[11]+3174756917&4294967295,B=I+(M<<10&4294967295|M>>>22),M=j+(I^(B|~N))+V[2]+718787259&4294967295,j=B+(M<<15&4294967295|M>>>17),M=N+(B^(j|~I))+V[9]+3951481745&4294967295,C.g[0]=C.g[0]+I&4294967295,C.g[1]=C.g[1]+(j+(M<<21&4294967295|M>>>11))&4294967295,C.g[2]=C.g[2]+j&4294967295,C.g[3]=C.g[3]+B&4294967295}s.prototype.v=function(C,I){I===void 0&&(I=C.length);const N=I-this.blockSize,V=this.C;let j=this.h,B=0;for(;B<I;){if(j==0)for(;B<=N;)i(this,C,B),B+=this.blockSize;if(typeof C=="string"){for(;B<I;)if(V[j++]=C.charCodeAt(B++),j==this.blockSize){i(this,V),j=0;break}}else for(;B<I;)if(V[j++]=C[B++],j==this.blockSize){i(this,V),j=0;break}}this.h=j,this.o+=I},s.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var I=1;I<C.length-8;++I)C[I]=0;I=this.o*8;for(var N=C.length-8;N<C.length;++N)C[N]=I&255,I/=256;for(this.v(C),C=Array(16),I=0,N=0;N<4;++N)for(let V=0;V<32;V+=8)C[I++]=this.g[N]>>>V&255;return C};function r(C,I){var N=c;return Object.prototype.hasOwnProperty.call(N,C)?N[C]:N[C]=I(C)}function l(C,I){this.h=I;const N=[];let V=!0;for(let j=C.length-1;j>=0;j--){const B=C[j]|0;V&&B==I||(N[j]=B,V=!1)}this.g=N}var c={};function h(C){return-128<=C&&C<128?r(C,function(I){return new l([I|0],I<0?-1:0)}):new l([C|0],C<0?-1:0)}function d(C){if(isNaN(C)||!isFinite(C))return _;if(C<0)return R(d(-C));const I=[];let N=1;for(let V=0;C>=N;V++)I[V]=C/N|0,N*=4294967296;return new l(I,0)}function m(C,I){if(C.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(C.charAt(0)=="-")return R(m(C.substring(1),I));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const N=d(Math.pow(I,8));let V=_;for(let B=0;B<C.length;B+=8){var j=Math.min(8,C.length-B);const M=parseInt(C.substring(B,B+j),I);j<8?(j=d(Math.pow(I,j)),V=V.j(j).add(d(M))):(V=V.j(N),V=V.add(d(M)))}return V}var _=h(0),v=h(1),T=h(16777216);n=l.prototype,n.m=function(){if(E(this))return-R(this).m();let C=0,I=1;for(let N=0;N<this.g.length;N++){const V=this.i(N);C+=(V>=0?V:4294967296+V)*I,I*=4294967296}return C},n.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(S(this))return"0";if(E(this))return"-"+R(this).toString(C);const I=d(Math.pow(C,6));var N=this;let V="";for(;;){const j=H(N,I).g;N=k(N,j.j(I));let B=((N.g.length>0?N.g[0]:N.h)>>>0).toString(C);if(N=j,S(N))return B+V;for(;B.length<6;)B="0"+B;V=B+V}},n.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function S(C){if(C.h!=0)return!1;for(let I=0;I<C.g.length;I++)if(C.g[I]!=0)return!1;return!0}function E(C){return C.h==-1}n.l=function(C){return C=k(this,C),E(C)?-1:S(C)?0:1};function R(C){const I=C.g.length,N=[];for(let V=0;V<I;V++)N[V]=~C.g[V];return new l(N,~C.h).add(v)}n.abs=function(){return E(this)?R(this):this},n.add=function(C){const I=Math.max(this.g.length,C.g.length),N=[];let V=0;for(let j=0;j<=I;j++){let B=V+(this.i(j)&65535)+(C.i(j)&65535),M=(B>>>16)+(this.i(j)>>>16)+(C.i(j)>>>16);V=M>>>16,B&=65535,M&=65535,N[j]=M<<16|B}return new l(N,N[N.length-1]&-2147483648?-1:0)};function k(C,I){return C.add(R(I))}n.j=function(C){if(S(this)||S(C))return _;if(E(this))return E(C)?R(this).j(R(C)):R(R(this).j(C));if(E(C))return R(this.j(R(C)));if(this.l(T)<0&&C.l(T)<0)return d(this.m()*C.m());const I=this.g.length+C.g.length,N=[];for(var V=0;V<2*I;V++)N[V]=0;for(V=0;V<this.g.length;V++)for(let j=0;j<C.g.length;j++){const B=this.i(V)>>>16,M=this.i(V)&65535,ne=C.i(j)>>>16,be=C.i(j)&65535;N[2*V+2*j]+=M*be,L(N,2*V+2*j),N[2*V+2*j+1]+=B*be,L(N,2*V+2*j+1),N[2*V+2*j+1]+=M*ne,L(N,2*V+2*j+1),N[2*V+2*j+2]+=B*ne,L(N,2*V+2*j+2)}for(C=0;C<I;C++)N[C]=N[2*C+1]<<16|N[2*C];for(C=I;C<2*I;C++)N[C]=0;return new l(N,0)};function L(C,I){for(;(C[I]&65535)!=C[I];)C[I+1]+=C[I]>>>16,C[I]&=65535,I++}function O(C,I){this.g=C,this.h=I}function H(C,I){if(S(I))throw Error("division by zero");if(S(C))return new O(_,_);if(E(C))return I=H(R(C),I),new O(R(I.g),R(I.h));if(E(I))return I=H(C,R(I)),new O(R(I.g),I.h);if(C.g.length>30){if(E(C)||E(I))throw Error("slowDivide_ only works with positive integers.");for(var N=v,V=I;V.l(C)<=0;)N=F(N),V=F(V);var j=U(N,1),B=U(V,1);for(V=U(V,2),N=U(N,2);!S(V);){var M=B.add(V);M.l(C)<=0&&(j=j.add(N),B=M),V=U(V,1),N=U(N,1)}return I=k(C,j.j(I)),new O(j,I)}for(j=_;C.l(I)>=0;){for(N=Math.max(1,Math.floor(C.m()/I.m())),V=Math.ceil(Math.log(N)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),B=d(N),M=B.j(I);E(M)||M.l(C)>0;)N-=V,B=d(N),M=B.j(I);S(B)&&(B=v),j=j.add(B),C=k(C,M)}return new O(j,C)}n.B=function(C){return H(this,C).h},n.and=function(C){const I=Math.max(this.g.length,C.g.length),N=[];for(let V=0;V<I;V++)N[V]=this.i(V)&C.i(V);return new l(N,this.h&C.h)},n.or=function(C){const I=Math.max(this.g.length,C.g.length),N=[];for(let V=0;V<I;V++)N[V]=this.i(V)|C.i(V);return new l(N,this.h|C.h)},n.xor=function(C){const I=Math.max(this.g.length,C.g.length),N=[];for(let V=0;V<I;V++)N[V]=this.i(V)^C.i(V);return new l(N,this.h^C.h)};function F(C){const I=C.g.length+1,N=[];for(let V=0;V<I;V++)N[V]=C.i(V)<<1|C.i(V-1)>>>31;return new l(N,C.h)}function U(C,I){const N=I>>5;I%=32;const V=C.g.length-N,j=[];for(let B=0;B<V;B++)j[B]=I>0?C.i(B+N)>>>I|C.i(B+N+1)<<32-I:C.i(B+N);return new l(j,C.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,DR=s,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=d,l.fromString=m,Ia=l}).apply(typeof IS<"u"?IS:typeof self<"u"?self:typeof window<"u"?window:{});var km=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var NR,Lh,kR,ig,z0,MR,OR,PR;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof km=="object"&&km];for(var x=0;x<g.length;++x){var w=g[x];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var s=t(this);function i(g,x){if(x)e:{var w=s;g=g.split(".");for(var P=0;P<g.length-1;P++){var Q=g[P];if(!(Q in w))break e;w=w[Q]}g=g[g.length-1],P=w[g],x=x(P),x!=P&&x!=null&&e(w,g,{configurable:!0,writable:!0,value:x})}}i("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(g){return g||function(x){var w=[],P;for(P in x)Object.prototype.hasOwnProperty.call(x,P)&&w.push([P,x[P]]);return w}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var r=r||{},l=this||self;function c(g){var x=typeof g;return x=="object"&&g!=null||x=="function"}function h(g,x,w){return g.call.apply(g.bind,arguments)}function d(g,x,w){return d=h,d.apply(null,arguments)}function m(g,x){var w=Array.prototype.slice.call(arguments,1);return function(){var P=w.slice();return P.push.apply(P,arguments),g.apply(this,P)}}function _(g,x){function w(){}w.prototype=x.prototype,g.Z=x.prototype,g.prototype=new w,g.prototype.constructor=g,g.Ob=function(P,Q,te){for(var ge=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)ge[Le-2]=arguments[Le];return x.prototype[Q].apply(P,ge)}}var v=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function T(g){const x=g.length;if(x>0){const w=Array(x);for(let P=0;P<x;P++)w[P]=g[P];return w}return[]}function S(g,x){for(let P=1;P<arguments.length;P++){const Q=arguments[P];var w=typeof Q;if(w=w!="object"?w:Q?Array.isArray(Q)?"array":w:"null",w=="array"||w=="object"&&typeof Q.length=="number"){w=g.length||0;const te=Q.length||0;g.length=w+te;for(let ge=0;ge<te;ge++)g[w+ge]=Q[ge]}else g.push(Q)}}class E{constructor(x,w){this.i=x,this.j=w,this.h=0,this.g=null}get(){let x;return this.h>0?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function R(g){l.setTimeout(()=>{throw g},0)}function k(){var g=C;let x=null;return g.g&&(x=g.g,g.g=g.g.next,g.g||(g.h=null),x.next=null),x}class L{constructor(){this.h=this.g=null}add(x,w){const P=O.get();P.set(x,w),this.h?this.h.next=P:this.g=P,this.h=P}}var O=new E(()=>new H,g=>g.reset());class H{constructor(){this.next=this.g=this.h=null}set(x,w){this.h=x,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let F,U=!1,C=new L,I=()=>{const g=Promise.resolve(void 0);F=()=>{g.then(N)}};function N(){for(var g;g=k();){try{g.h.call(g.g)}catch(w){R(w)}var x=O;x.j(g),x.h<100&&(x.h++,g.next=x.g,x.g=g)}U=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(g,x){this.type=g,this.g=this.target=x,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var g=!1,x=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const w=()=>{};l.addEventListener("test",w,x),l.removeEventListener("test",w,x)}catch{}return g})();function M(g){return/^[\s\xa0]*$/.test(g)}function ne(g,x){j.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,x)}_(ne,j),ne.prototype.init=function(g,x){const w=this.type=g.type,P=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=x,x=g.relatedTarget,x||(w=="mouseover"?x=g.fromElement:w=="mouseout"&&(x=g.toElement)),this.relatedTarget=x,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&ne.Z.h.call(this)},ne.prototype.h=function(){ne.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var be="closure_listenable_"+(Math.random()*1e6|0),Y=0;function ae(g,x,w,P,Q){this.listener=g,this.proxy=null,this.src=x,this.type=w,this.capture=!!P,this.ha=Q,this.key=++Y,this.da=this.fa=!1}function me(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function Ce(g,x,w){for(const P in g)x.call(w,g[P],P,g)}function z(g,x){for(const w in g)x.call(void 0,g[w],w,g)}function se(g){const x={};for(const w in g)x[w]=g[w];return x}const he="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function de(g,x){let w,P;for(let Q=1;Q<arguments.length;Q++){P=arguments[Q];for(w in P)g[w]=P[w];for(let te=0;te<he.length;te++)w=he[te],Object.prototype.hasOwnProperty.call(P,w)&&(g[w]=P[w])}}function ye(g){this.src=g,this.g={},this.h=0}ye.prototype.add=function(g,x,w,P,Q){const te=g.toString();g=this.g[te],g||(g=this.g[te]=[],this.h++);const ge=Ae(g,x,P,Q);return ge>-1?(x=g[ge],w||(x.fa=!1)):(x=new ae(x,this.src,te,!!P,Q),x.fa=w,g.push(x)),x};function Pe(g,x){const w=x.type;if(w in g.g){var P=g.g[w],Q=Array.prototype.indexOf.call(P,x,void 0),te;(te=Q>=0)&&Array.prototype.splice.call(P,Q,1),te&&(me(x),g.g[w].length==0&&(delete g.g[w],g.h--))}}function Ae(g,x,w,P){for(let Q=0;Q<g.length;++Q){const te=g[Q];if(!te.da&&te.listener==x&&te.capture==!!w&&te.ha==P)return Q}return-1}var Ct="closure_lm_"+(Math.random()*1e6|0),tt={};function zt(g,x,w,P,Q){if(Array.isArray(x)){for(let te=0;te<x.length;te++)zt(g,x[te],w,P,Q);return null}return w=df(w),g&&g[be]?g.J(x,w,c(P)?!!P.capture:!1,Q):wr(g,x,w,!1,P,Q)}function wr(g,x,w,P,Q,te){if(!x)throw Error("Invalid event type");const ge=c(Q)?!!Q.capture:!!Q;let Le=bu(g);if(Le||(g[Ct]=Le=new ye(g)),w=Le.add(x,w,P,ge,te),w.proxy)return w;if(P=ti(),w.proxy=P,P.src=g,P.listener=w,g.addEventListener)B||(Q=ge),Q===void 0&&(Q=!1),g.addEventListener(x.toString(),P,Q);else if(g.attachEvent)g.attachEvent(Sr(x.toString()),P);else if(g.addListener&&g.removeListener)g.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return w}function ti(){function g(w){return x.call(g.src,g.listener,w)}const x=Xp;return g}function ki(g,x,w,P,Q){if(Array.isArray(x))for(var te=0;te<x.length;te++)ki(g,x[te],w,P,Q);else P=c(P)?!!P.capture:!!P,w=df(w),g&&g[be]?(g=g.i,te=String(x).toString(),te in g.g&&(x=g.g[te],w=Ae(x,w,P,Q),w>-1&&(me(x[w]),Array.prototype.splice.call(x,w,1),x.length==0&&(delete g.g[te],g.h--)))):g&&(g=bu(g))&&(x=g.g[x.toString()],g=-1,x&&(g=Ae(x,w,P,Q)),(w=g>-1?x[g]:null)&&Mi(w))}function Mi(g){if(typeof g!="number"&&g&&!g.da){var x=g.src;if(x&&x[be])Pe(x.i,g);else{var w=g.type,P=g.proxy;x.removeEventListener?x.removeEventListener(w,P,g.capture):x.detachEvent?x.detachEvent(Sr(w),P):x.addListener&&x.removeListener&&x.removeListener(P),(w=bu(x))?(Pe(w,g),w.h==0&&(w.src=null,x[Ct]=null)):me(g)}}}function Sr(g){return g in tt?tt[g]:tt[g]="on"+g}function Xp(g,x){if(g.da)g=!0;else{x=new ne(x,this);const w=g.listener,P=g.ha||g.src;g.fa&&Mi(g),g=w.call(P,x)}return g}function bu(g){return g=g[Ct],g instanceof ye?g:null}var Xn="__closure_events_fn_"+(Math.random()*1e9>>>0);function df(g){return typeof g=="function"?g:(g[Xn]||(g[Xn]=function(x){return g.handleEvent(x)}),g[Xn])}function sn(){V.call(this),this.i=new ye(this),this.M=this,this.G=null}_(sn,V),sn.prototype[be]=!0,sn.prototype.removeEventListener=function(g,x,w,P){ki(this,g,x,w,P)};function fn(g,x){var w,P=g.G;if(P)for(w=[];P;P=P.G)w.push(P);if(g=g.M,P=x.type||x,typeof x=="string")x=new j(x,g);else if(x instanceof j)x.target=x.target||g;else{var Q=x;x=new j(P,g),de(x,Q)}Q=!0;let te,ge;if(w)for(ge=w.length-1;ge>=0;ge--)te=x.g=w[ge],Q=Oi(te,P,!0,x)&&Q;if(te=x.g=g,Q=Oi(te,P,!0,x)&&Q,Q=Oi(te,P,!1,x)&&Q,w)for(ge=0;ge<w.length;ge++)te=x.g=w[ge],Q=Oi(te,P,!1,x)&&Q}sn.prototype.N=function(){if(sn.Z.N.call(this),this.i){var g=this.i;for(const x in g.g){const w=g.g[x];for(let P=0;P<w.length;P++)me(w[P]);delete g.g[x],g.h--}}this.G=null},sn.prototype.J=function(g,x,w,P){return this.i.add(String(g),x,!1,w,P)},sn.prototype.K=function(g,x,w,P){return this.i.add(String(g),x,!0,w,P)};function Oi(g,x,w,P){if(x=g.i.g[String(x)],!x)return!0;x=x.concat();let Q=!0;for(let te=0;te<x.length;++te){const ge=x[te];if(ge&&!ge.da&&ge.capture==w){const Le=ge.listener,At=ge.ha||ge.src;ge.fa&&Pe(g.i,ge),Q=Le.call(At,P)!==!1&&Q}}return Q&&!P.defaultPrevented}function Zp(g,x){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=d(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(x)>2147483647?-1:l.setTimeout(g,x||0)}function vu(g){g.g=Zp(()=>{g.g=null,g.i&&(g.i=!1,vu(g))},g.l);const x=g.h;g.h=null,g.m.apply(null,x)}class Jp extends V{constructor(x,w){super(),this.m=x,this.l=w,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:vu(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function eo(g){V.call(this),this.h=g,this.g={}}_(eo,V);var Ar=[];function Cn(g){Ce(g.g,function(x,w){this.g.hasOwnProperty(w)&&Mi(x)},g),g.g={}}eo.prototype.N=function(){eo.Z.N.call(this),Cn(this)},eo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var bs=l.JSON.stringify,zn=l.JSON.parse,e_=class{stringify(g){return l.JSON.stringify(g,void 0)}parse(g){return l.JSON.parse(g,void 0)}};function ff(){}function mf(){}var ni={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ir(){j.call(this,"d")}_(Ir,j);function Ls(){j.call(this,"c")}_(Ls,j);var vs={},Rr=null;function Al(){return Rr=Rr||new sn}vs.Ia="serverreachability";function xu(g){j.call(this,vs.Ia,g)}_(xu,j);function Cr(g){const x=Al();fn(x,new xu(x))}vs.STAT_EVENT="statevent";function Il(g,x){j.call(this,vs.STAT_EVENT,g),this.stat=x}_(Il,j);function Ht(g){const x=Al();fn(x,new Il(x,g))}vs.Ja="timingevent";function gf(g,x){j.call(this,vs.Ja,g),this.size=x}_(gf,j);function Dr(g,x){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){g()},x)}function Nr(){this.g=!0}Nr.prototype.ua=function(){this.g=!1};function Tu(g,x,w,P,Q,te){g.info(function(){if(g.g)if(te){var ge="",Le=te.split("&");for(let ct=0;ct<Le.length;ct++){var At=Le[ct].split("=");if(At.length>1){const $t=At[0];At=At[1];const as=$t.split("_");ge=as.length>=2&&as[1]=="type"?ge+($t+"="+At+"&"):ge+($t+"=redacted&")}}}else ge=null;else ge=te;return"XMLHTTP REQ ("+P+") [attempt "+Q+"]: "+x+`
`+w+`
`+ge})}function Eu(g,x,w,P,Q,te,ge){g.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+Q+"]: "+x+`
`+w+`
`+te+" "+ge})}function Pi(g,x,w,P){g.info(function(){return"XMLHTTP TEXT ("+x+"): "+si(g,w)+(P?" "+P:"")})}function t_(g,x){g.info(function(){return"TIMEOUT: "+x})}Nr.prototype.info=function(){};function si(g,x){if(!g.g)return x;if(!x)return null;try{const te=JSON.parse(x);if(te){for(g=0;g<te.length;g++)if(Array.isArray(te[g])){var w=te[g];if(!(w.length<2)){var P=w[1];if(Array.isArray(P)&&!(P.length<1)){var Q=P[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(let ge=1;ge<P.length;ge++)P[ge]=""}}}}return bs(te)}catch{return x}}var qt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},xn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Vi;function to(){}_(to,ff),to.prototype.g=function(){return new XMLHttpRequest},Vi=new to;function no(g){return encodeURIComponent(String(g))}function n_(g){var x=1;g=g.split(":");const w=[];for(;x>0&&g.length;)w.push(g.shift()),x--;return g.length&&w.push(g.join(":")),w}function js(g,x,w,P){this.j=g,this.i=x,this.l=w,this.S=P||1,this.V=new eo(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new kr}function kr(){this.i=null,this.g="",this.h=!1}var Rl={},ii={};function ri(g,x,w){g.M=1,g.A=ji(Vt(x)),g.u=w,g.R=!0,Mr(g,null)}function Mr(g,x){g.F=Date.now(),so(g),g.B=Vt(g.A);var w=g.B,P=g.S;Array.isArray(P)||(P=[String(P)]),bf(w.i,"t",P),g.C=0,w=g.j.L,g.h=new kr,g.g=jl(g.j,w?x:null,!g.u),g.P>0&&(g.O=new Jp(d(g.Y,g,g.g),g.P)),x=g.V,w=g.g,P=g.ba;var Q="readystatechange";Array.isArray(Q)||(Q&&(Ar[0]=Q.toString()),Q=Ar);for(let te=0;te<Q.length;te++){const ge=zt(w,Q[te],P||x.handleEvent,!1,x.h||x);if(!ge)break;x.g[ge.key]=ge}x=g.J?se(g.J):{},g.u?(g.v||(g.v="POST"),x["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,x)):(g.v="GET",g.g.ea(g.B,g.v,null,x)),Cr(),Tu(g.i,g.v,g.B,g.l,g.S,g.u)}js.prototype.ba=function(g){g=g.target;const x=this.O;x&&Dn(g)==3?x.j():this.Y(g)},js.prototype.Y=function(g){try{if(g==this.g)e:{const Le=Dn(this.g),At=this.g.ya(),ct=this.g.ca();if(!(Le<3)&&(Le!=3||this.g&&(this.h.h||this.g.la()||go(this.g)))){this.K||Le!=4||At==7||(At==8||ct<=0?Cr(3):Cr(2)),oi(this);var x=this.g.ca();this.X=x;var w=Or(this);if(this.o=x==200,Eu(this.i,this.v,this.B,this.l,this.S,Le,x),this.o){if(this.U&&!this.L){t:{if(this.g){var P,Q=this.g;if((P=Q.g?Q.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(P)){var te=P;break t}}te=null}if(g=te)Pi(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Cl(this,g);else{this.o=!1,this.m=3,Ht(12),li(this),io(this);break e}}if(this.R){g=!0;let $t;for(;!this.K&&this.C<w.length;)if($t=pf(this,w),$t==ii){Le==4&&(this.m=4,Ht(14),g=!1),Pi(this.i,this.l,null,"[Incomplete Response]");break}else if($t==Rl){this.m=4,Ht(15),Pi(this.i,this.l,w,"[Invalid Chunk]"),g=!1;break}else Pi(this.i,this.l,$t,null),Cl(this,$t);if(Gt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Le!=4||w.length!=0||this.h.h||(this.m=1,Ht(16),g=!1),this.o=this.o&&g,!g)Pi(this.i,this.l,w,"[Invalid Chunked Response]"),li(this),io(this);else if(w.length>0&&!this.W){this.W=!0;var ge=this.j;ge.g==this&&ge.aa&&!ge.P&&(ge.j.info("Great, no buffering proxy detected. Bytes received: "+w.length),Mu(ge),ge.P=!0,Ht(11))}}else Pi(this.i,this.l,w,null),Cl(this,w);Le==4&&li(this),this.o&&!this.K&&(Le==4?Ou(this.j,this):(this.o=!1,so(this)))}else po(this.g),x==400&&w.indexOf("Unknown SID")>0?(this.m=3,Ht(12)):(this.m=0,Ht(13)),li(this),io(this)}}}catch{}finally{}};function Or(g){if(!Gt(g))return g.g.la();const x=go(g.g);if(x==="")return"";let w="";const P=x.length,Q=Dn(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return li(g),io(g),"";g.h.i=new l.TextDecoder}for(let te=0;te<P;te++)g.h.h=!0,w+=g.h.i.decode(x[te],{stream:!(Q&&te==P-1)});return x.length=0,g.h.g+=w,g.C=0,g.h.g}function Gt(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function pf(g,x){var w=g.C,P=x.indexOf(`
`,w);return P==-1?ii:(w=Number(x.substring(w,P)),isNaN(w)?Rl:(P+=1,P+w>x.length?ii:(x=x.slice(P,P+w),g.C=P+w,x)))}js.prototype.cancel=function(){this.K=!0,li(this)};function so(g){g.T=Date.now()+g.H,ai(g,g.H)}function ai(g,x){if(g.D!=null)throw Error("WatchDog timer not null");g.D=Dr(d(g.aa,g),x)}function oi(g){g.D&&(l.clearTimeout(g.D),g.D=null)}js.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(t_(this.i,this.B),this.M!=2&&(Cr(),Ht(17)),li(this),this.m=2,io(this)):ai(this,this.T-g)};function io(g){g.j.I==0||g.K||Ou(g.j,g)}function li(g){oi(g);var x=g.O;x&&typeof x.dispose=="function"&&x.dispose(),g.O=null,Cn(g.V),g.g&&(x=g.g,g.g=null,x.abort(),x.dispose())}function Cl(g,x){try{var w=g.j;if(w.I!=0&&(w.g==g||oo(w.h,g))){if(!g.L&&oo(w.h,g)&&w.I==3){try{var P=w.Ba.g.parse(x)}catch{P=null}if(Array.isArray(P)&&P.length==3){var Q=P;if(Q[0]==0){e:if(!w.v){if(w.g)if(w.g.F+3e3<g.F)Ll(w),ci(w);else break e;ku(w),Ht(18)}}else w.xa=Q[1],0<w.xa-w.K&&Q[2]<37500&&w.F&&w.A==0&&!w.C&&(w.C=Dr(d(w.Va,w),6e3));xs(w.h)<=1&&w.ta&&(w.ta=void 0)}else Fi(w,11)}else if((g.L||w.g==g)&&Ll(w),!M(x))for(Q=w.Ba.g.parse(x),x=0;x<Q.length;x++){let ct=Q[x];const $t=ct[0];if(!($t<=w.K))if(w.K=$t,ct=ct[1],w.I==2)if(ct[0]=="c"){w.M=ct[1],w.ba=ct[2];const as=ct[3];as!=null&&(w.ka=as,w.j.info("VER="+w.ka));const ui=ct[4];ui!=null&&(w.za=ui,w.j.info("SVER="+w.za));const Fs=ct[5];Fs!=null&&typeof Fs=="number"&&Fs>0&&(P=1.5*Fs,w.O=P,w.j.info("backChannelRequestTimeoutMs_="+P)),P=w;const zs=g.g;if(zs){const Hs=zs.g?zs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Hs){var te=P.h;te.g||Hs.indexOf("spdy")==-1&&Hs.indexOf("quic")==-1&&Hs.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(Dl(te,te.h),te.h=null))}if(P.G){const Vu=zs.g?zs.g.getResponseHeader("X-HTTP-Session-Id"):null;Vu&&(P.wa=Vu,gt(P.J,P.G,Vu))}}w.I=3,w.l&&w.l.ra(),w.aa&&(w.T=Date.now()-g.F,w.j.info("Handshake RTT: "+w.T+"ms")),P=w;var ge=g;if(P.na=Rf(P,P.L?P.ba:null,P.W),ge.L){Li(P.h,ge);var Le=ge,At=P.O;At&&(Le.H=At),Le.D&&(oi(Le),so(Le)),P.g=ge}else wf(P);w.i.length>0&&vo(w)}else ct[0]!="stop"&&ct[0]!="close"||Fi(w,7);else w.I==3&&(ct[0]=="stop"||ct[0]=="close"?ct[0]=="stop"?Fi(w,7):yo(w):ct[0]!="noop"&&w.l&&w.l.qa(ct),w.A=0)}}Cr(4)}catch{}}var s_=class{constructor(g,x){this.g=g,this.map=x}};function ro(g){this.l=g||10,l.PerformanceNavigationTiming?(g=l.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ao(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function xs(g){return g.h?1:g.g?g.g.size:0}function oo(g,x){return g.h?g.h==x:g.g?g.g.has(x):!1}function Dl(g,x){g.g?g.g.add(x):g.h=x}function Li(g,x){g.h&&g.h==x?g.h=null:g.g&&g.g.has(x)&&g.g.delete(x)}ro.prototype.cancel=function(){if(this.i=Nl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function Nl(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let x=g.i;for(const w of g.g.values())x=x.concat(w.G);return x}return T(g.i)}var kl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function i_(g,x){if(g){g=g.split("&");for(let w=0;w<g.length;w++){const P=g[w].indexOf("=");let Q,te=null;P>=0?(Q=g[w].substring(0,P),te=g[w].substring(P+1)):Q=g[w],x(Q,te?decodeURIComponent(te.replace(/\+/g," ")):"")}}}function Us(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let x;g instanceof Us?(this.l=g.l,Pr(this,g.j),this.o=g.o,this.g=g.g,lo(this,g.u),this.h=g.h,Vr(this,vf(g.i)),this.m=g.m):g&&(x=String(g).match(kl))?(this.l=!1,Pr(this,x[1]||"",!0),this.o=co(x[2]||""),this.g=co(x[3]||"",!0),lo(this,x[4]),this.h=co(x[5]||"",!0),Vr(this,x[6]||"",!0),this.m=co(x[7]||"")):(this.l=!1,this.i=new Ts(null,this.l))}Us.prototype.toString=function(){const g=[];var x=this.j;x&&g.push(mn(x,Su,!0),":");var w=this.g;return(w||x=="file")&&(g.push("//"),(x=this.o)&&g.push(mn(x,Su,!0),"@"),g.push(no(w).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.u,w!=null&&g.push(":",String(w))),(w=this.h)&&(this.g&&w.charAt(0)!="/"&&g.push("/"),g.push(mn(w,w.charAt(0)=="/"?Lr:Au,!0))),(w=this.i.toString())&&g.push("?",w),(w=this.m)&&g.push("#",mn(w,yf)),g.join("")},Us.prototype.resolve=function(g){const x=Vt(this);let w=!!g.j;w?Pr(x,g.j):w=!!g.o,w?x.o=g.o:w=!!g.g,w?x.g=g.g:w=g.u!=null;var P=g.h;if(w)lo(x,g.u);else if(w=!!g.h){if(P.charAt(0)!="/")if(this.g&&!this.h)P="/"+P;else{var Q=x.h.lastIndexOf("/");Q!=-1&&(P=x.h.slice(0,Q+1)+P)}if(Q=P,Q==".."||Q==".")P="";else if(Q.indexOf("./")!=-1||Q.indexOf("/.")!=-1){P=Q.lastIndexOf("/",0)==0,Q=Q.split("/");const te=[];for(let ge=0;ge<Q.length;){const Le=Q[ge++];Le=="."?P&&ge==Q.length&&te.push(""):Le==".."?((te.length>1||te.length==1&&te[0]!="")&&te.pop(),P&&ge==Q.length&&te.push("")):(te.push(Le),P=!0)}P=te.join("/")}else P=Q}return w?x.h=P:w=g.i.toString()!=="",w?Vr(x,vf(g.i)):w=!!g.m,w&&(x.m=g.m),x};function Vt(g){return new Us(g)}function Pr(g,x,w){g.j=w?co(x,!0):x,g.j&&(g.j=g.j.replace(/:$/,""))}function lo(g,x){if(x){if(x=Number(x),isNaN(x)||x<0)throw Error("Bad port number "+x);g.u=x}else g.u=null}function Vr(g,x,w){x instanceof Ts?(g.i=x,Cu(g.i,g.l)):(w||(x=mn(x,_f)),g.i=new Ts(x,g.l))}function gt(g,x,w){g.i.set(x,w)}function ji(g){return gt(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function co(g,x){return g?x?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function mn(g,x,w){return typeof g=="string"?(g=encodeURI(g).replace(x,wu),w&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function wu(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Su=/[#\/\?@]/g,Au=/[#\?:]/g,Lr=/[#\?]/g,_f=/[#\?@]/g,yf=/#/g;function Ts(g,x){this.h=this.g=null,this.i=g||null,this.j=!!x}function Ui(g){g.g||(g.g=new Map,g.h=0,g.i&&i_(g.i,function(x,w){g.add(decodeURIComponent(x.replace(/\+/g," ")),w)}))}n=Ts.prototype,n.add=function(g,x){Ui(this),this.i=null,g=Bs(this,g);let w=this.g.get(g);return w||this.g.set(g,w=[]),w.push(x),this.h+=1,this};function Iu(g,x){Ui(g),x=Bs(g,x),g.g.has(x)&&(g.i=null,g.h-=g.g.get(x).length,g.g.delete(x))}function Ru(g,x){return Ui(g),x=Bs(g,x),g.g.has(x)}n.forEach=function(g,x){Ui(this),this.g.forEach(function(w,P){w.forEach(function(Q){g.call(x,Q,P,this)},this)},this)};function Ml(g,x){Ui(g);let w=[];if(typeof x=="string")Ru(g,x)&&(w=w.concat(g.g.get(Bs(g,x))));else for(g=Array.from(g.g.values()),x=0;x<g.length;x++)w=w.concat(g[x]);return w}n.set=function(g,x){return Ui(this),this.i=null,g=Bs(this,g),Ru(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[x]),this.h+=1,this},n.get=function(g,x){return g?(g=Ml(this,g),g.length>0?String(g[0]):x):x};function bf(g,x,w){Iu(g,x),w.length>0&&(g.i=null,g.g.set(Bs(g,x),T(w)),g.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],x=Array.from(this.g.keys());for(let P=0;P<x.length;P++){var w=x[P];const Q=no(w);w=Ml(this,w);for(let te=0;te<w.length;te++){let ge=Q;w[te]!==""&&(ge+="="+no(w[te])),g.push(ge)}}return this.i=g.join("&")};function vf(g){const x=new Ts;return x.i=g.i,g.g&&(x.g=new Map(g.g),x.h=g.h),x}function Bs(g,x){return x=String(x),g.j&&(x=x.toLowerCase()),x}function Cu(g,x){x&&!g.j&&(Ui(g),g.i=null,g.g.forEach(function(w,P){const Q=P.toLowerCase();P!=Q&&(Iu(this,P),bf(this,Q,w))},g)),g.j=x}function Du(g,x){const w=new Nr;if(l.Image){const P=new Image;P.onload=m(Hn,w,"TestLoadImage: loaded",!0,x,P),P.onerror=m(Hn,w,"TestLoadImage: error",!1,x,P),P.onabort=m(Hn,w,"TestLoadImage: abort",!1,x,P),P.ontimeout=m(Hn,w,"TestLoadImage: timeout",!1,x,P),l.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=g}else x(!1)}function jr(g,x){const w=new Nr,P=new AbortController,Q=setTimeout(()=>{P.abort(),Hn(w,"TestPingServer: timeout",!1,x)},1e4);fetch(g,{signal:P.signal}).then(te=>{clearTimeout(Q),te.ok?Hn(w,"TestPingServer: ok",!0,x):Hn(w,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(Q),Hn(w,"TestPingServer: error",!1,x)})}function Hn(g,x,w,P,Q){try{Q&&(Q.onload=null,Q.onerror=null,Q.onabort=null,Q.ontimeout=null),P(w)}catch{}}function xf(){this.g=new e_}function uo(g){this.i=g.Sb||null,this.h=g.ab||!1}_(uo,ff),uo.prototype.g=function(){return new ho(this.i,this.h)};function ho(g,x){sn.call(this),this.H=g,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}_(ho,sn),n=ho.prototype,n.open=function(g,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=x,this.readyState=1,Bi(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const x={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(x.body=g),(this.H||l).fetch(new Request(this.D,x)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,qn(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,Bi(this)),this.g&&(this.readyState=3,Bi(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ur(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ur(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var x=g.value?g.value:new Uint8Array(0);(x=this.B.decode(x,{stream:!g.done}))&&(this.response=this.responseText+=x)}g.done?qn(this):Bi(this),this.readyState==3&&Ur(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,qn(this))},n.Na=function(g){this.g&&(this.response=g,qn(this))},n.ga=function(){this.g&&qn(this)};function qn(g){g.readyState=4,g.l=null,g.j=null,g.B=null,Bi(g)}n.setRequestHeader=function(g,x){this.A.append(g,x)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],x=this.h.entries();for(var w=x.next();!w.done;)w=w.value,g.push(w[0]+": "+w[1]),w=x.next();return g.join(`\r
`)};function Bi(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(ho.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Br(g){let x="";return Ce(g,function(w,P){x+=P,x+=":",x+=w,x+=`\r
`}),x}function Es(g,x,w){e:{for(P in w){var P=!1;break e}P=!0}P||(w=Br(w),typeof g=="string"?w!=null&&no(w):gt(g,x,w))}function vt(g){sn.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}_(vt,sn);var Ol=/^https?$/i,Tf=["POST","PUT"];n=vt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,x,w,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);x=x?x.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Vi.g(),this.g.onreadystatechange=v(d(this.Ca,this));try{this.B=!0,this.g.open(x,String(g),!0),this.B=!1}catch(te){fo(this,te);return}if(g=w||"",w=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var Q in P)w.set(Q,P[Q]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const te of P.keys())w.set(te,P.get(te));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(w.keys()).find(te=>te.toLowerCase()=="content-type"),Q=l.FormData&&g instanceof l.FormData,!(Array.prototype.indexOf.call(Tf,x,void 0)>=0)||P||Q||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,ge]of w)this.g.setRequestHeader(te,ge);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(te){fo(this,te)}};function fo(g,x){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=x,g.o=5,mo(g),rn(g)}function mo(g){g.A||(g.A=!0,fn(g,"complete"),fn(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,fn(this,"complete"),fn(this,"abort"),rn(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),rn(this,!0)),vt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Nu(this):this.Xa())},n.Xa=function(){Nu(this)};function Nu(g){if(g.h&&typeof r<"u"){if(g.v&&Dn(g)==4)setTimeout(g.Ca.bind(g),0);else if(fn(g,"readystatechange"),Dn(g)==4){g.h=!1;try{const te=g.ca();e:switch(te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var w;if(!(w=x)){var P;if(P=te===0){let ge=String(g.D).match(kl)[1]||null;!ge&&l.self&&l.self.location&&(ge=l.self.location.protocol.slice(0,-1)),P=!Ol.test(ge?ge.toLowerCase():"")}w=P}if(w)fn(g,"complete"),fn(g,"success");else{g.o=6;try{var Q=Dn(g)>2?g.g.statusText:""}catch{Q=""}g.l=Q+" ["+g.ca()+"]",mo(g)}}finally{rn(g)}}}}function rn(g,x){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const w=g.g;g.g=null,x||fn(g,"ready");try{w.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Dn(g){return g.g?g.g.readyState:0}n.ca=function(){try{return Dn(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var x=this.g.responseText;return g&&x.indexOf(g)==0&&(x=x.substring(g.length)),zn(x)}};function go(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function po(g){const x={};g=(g.g&&Dn(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<g.length;P++){if(M(g[P]))continue;var w=n_(g[P]);const Q=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const te=x[Q]||[];x[Q]=te,te.push(w)}z(x,function(P){return P.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function _o(g,x,w){return w&&w.internalChannelParams&&w.internalChannelParams[g]||x}function Pl(g){this.za=0,this.i=[],this.j=new Nr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=_o("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=_o("baseRetryDelayMs",5e3,g),this.Za=_o("retryDelaySeedMs",1e4,g),this.Ta=_o("forwardChannelMaxRetries",2,g),this.va=_o("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new ro(g&&g.concurrentRequestLimit),this.Ba=new xf,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Pl.prototype,n.ka=8,n.I=1,n.connect=function(g,x,w,P){Ht(0),this.W=g,this.H=x||{},w&&P!==void 0&&(this.H.OSID=w,this.H.OAID=P),this.F=this.X,this.J=Rf(this,null,this.W),vo(this)};function yo(g){if(bo(g),g.I==3){var x=g.V++,w=Vt(g.J);if(gt(w,"SID",g.M),gt(w,"RID",x),gt(w,"TYPE","terminate"),xo(g,w),x=new js(g,g.j,x),x.M=2,x.A=ji(Vt(w)),w=!1,l.navigator&&l.navigator.sendBeacon)try{w=l.navigator.sendBeacon(x.A.toString(),"")}catch{}!w&&l.Image&&(new Image().src=x.A,w=!0),w||(x.g=jl(x.j,null),x.g.ea(x.A)),x.F=Date.now(),so(x)}If(g)}function ci(g){g.g&&(Mu(g),g.g.cancel(),g.g=null)}function bo(g){ci(g),g.v&&(l.clearTimeout(g.v),g.v=null),Ll(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&l.clearTimeout(g.m),g.m=null)}function vo(g){if(!ao(g.h)&&!g.m){g.m=!0;var x=g.Ea;F||I(),U||(F(),U=!0),C.add(x,g),g.D=0}}function r_(g,x){return xs(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=x.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=Dr(d(g.Ea,g,x),Af(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const Q=new js(this,this.j,g);let te=this.o;if(this.U&&(te?(te=se(te),de(te,this.U)):te=this.U),this.u!==null||this.R||(Q.J=te,te=null),this.S)e:{for(var x=0,w=0;w<this.i.length;w++){t:{var P=this.i[w];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(x+=P,x>4096){x=w;break e}if(x===4096||w===this.i.length-1){x=w+1;break e}}x=1e3}else x=1e3;x=Vl(this,Q,x),w=Vt(this.J),gt(w,"RID",g),gt(w,"CVER",22),this.G&&gt(w,"X-HTTP-Session-Id",this.G),xo(this,w),te&&(this.R?x="headers="+no(Br(te))+"&"+x:this.u&&Es(w,this.u,te)),Dl(this.h,Q),this.Ra&&gt(w,"TYPE","init"),this.S?(gt(w,"$req",x),gt(w,"SID","null"),Q.U=!0,ri(Q,w,null)):ri(Q,w,x),this.I=2}}else this.I==3&&(g?Ef(this,g):this.i.length==0||ao(this.h)||Ef(this))};function Ef(g,x){var w;x?w=x.l:w=g.V++;const P=Vt(g.J);gt(P,"SID",g.M),gt(P,"RID",w),gt(P,"AID",g.K),xo(g,P),g.u&&g.o&&Es(P,g.u,g.o),w=new js(g,g.j,w,g.D+1),g.u===null&&(w.J=g.o),x&&(g.i=x.G.concat(g.i)),x=Vl(g,w,1e3),w.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),Dl(g.h,w),ri(w,P,x)}function xo(g,x){g.H&&Ce(g.H,function(w,P){gt(x,P,w)}),g.l&&Ce({},function(w,P){gt(x,P,w)})}function Vl(g,x,w){w=Math.min(g.i.length,w);const P=g.l?d(g.l.Ka,g.l,g):null;e:{var Q=g.i;let Le=-1;for(;;){const At=["count="+w];Le==-1?w>0?(Le=Q[0].g,At.push("ofs="+Le)):Le=0:At.push("ofs="+Le);let ct=!0;for(let $t=0;$t<w;$t++){var te=Q[$t].g;const as=Q[$t].map;if(te-=Le,te<0)Le=Math.max(0,Q[$t].g-100),ct=!1;else try{te="req"+te+"_"||"";try{var ge=as instanceof Map?as:Object.entries(as);for(const[ui,Fs]of ge){let zs=Fs;c(Fs)&&(zs=bs(Fs)),At.push(te+ui+"="+encodeURIComponent(zs))}}catch(ui){throw At.push(te+"type="+encodeURIComponent("_badmap")),ui}}catch{P&&P(as)}}if(ct){ge=At.join("&");break e}}ge=void 0}return g=g.i.splice(0,w),x.G=g,ge}function wf(g){if(!g.g&&!g.v){g.Y=1;var x=g.Da;F||I(),U||(F(),U=!0),C.add(x,g),g.A=0}}function ku(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=Dr(d(g.Da,g),Af(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,Sf(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=Dr(d(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ht(10),ci(this),Sf(this))};function Mu(g){g.B!=null&&(l.clearTimeout(g.B),g.B=null)}function Sf(g){g.g=new js(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var x=Vt(g.na);gt(x,"RID","rpc"),gt(x,"SID",g.M),gt(x,"AID",g.K),gt(x,"CI",g.F?"0":"1"),!g.F&&g.ia&&gt(x,"TO",g.ia),gt(x,"TYPE","xmlhttp"),xo(g,x),g.u&&g.o&&Es(x,g.u,g.o),g.O&&(g.g.H=g.O);var w=g.g;g=g.ba,w.M=1,w.A=ji(Vt(x)),w.u=null,w.R=!0,Mr(w,g)}n.Va=function(){this.C!=null&&(this.C=null,ci(this),ku(this),Ht(19))};function Ll(g){g.C!=null&&(l.clearTimeout(g.C),g.C=null)}function Ou(g,x){var w=null;if(g.g==x){Ll(g),Mu(g),g.g=null;var P=2}else if(oo(g.h,x))w=x.G,Li(g.h,x),P=1;else return;if(g.I!=0){if(x.o)if(P==1){w=x.u?x.u.length:0,x=Date.now()-x.F;var Q=g.D;P=Al(),fn(P,new gf(P,w)),vo(g)}else wf(g);else if(Q=x.m,Q==3||Q==0&&x.X>0||!(P==1&&r_(g,x)||P==2&&ku(g)))switch(w&&w.length>0&&(x=g.h,x.i=x.i.concat(w)),Q){case 1:Fi(g,5);break;case 4:Fi(g,10);break;case 3:Fi(g,6);break;default:Fi(g,2)}}}function Af(g,x){let w=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(w*=2),w*x}function Fi(g,x){if(g.j.info("Error code "+x),x==2){var w=d(g.bb,g),P=g.Ua;const Q=!P;P=new Us(P||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Pr(P,"https"),ji(P),Q?Du(P.toString(),w):jr(P.toString(),w)}else Ht(2);g.I=0,g.l&&g.l.pa(x),If(g),bo(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),Ht(2)):(this.j.info("Failed to ping google.com"),Ht(1))};function If(g){if(g.I=0,g.ja=[],g.l){const x=Nl(g.h);(x.length!=0||g.i.length!=0)&&(S(g.ja,x),S(g.ja,g.i),g.h.i.length=0,T(g.i),g.i.length=0),g.l.oa()}}function Rf(g,x,w){var P=w instanceof Us?Vt(w):new Us(w);if(P.g!="")x&&(P.g=x+"."+P.g),lo(P,P.u);else{var Q=l.location;P=Q.protocol,x=x?x+"."+Q.hostname:Q.hostname,Q=+Q.port;const te=new Us(null);P&&Pr(te,P),x&&(te.g=x),Q&&lo(te,Q),w&&(te.h=w),P=te}return w=g.G,x=g.wa,w&&x&&gt(P,w,x),gt(P,"VER",g.ka),xo(g,P),P}function jl(g,x,w){if(x&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return x=g.Aa&&!g.ma?new vt(new uo({ab:w})):new vt(g.ma),x.Fa(g.L),x}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Cf(){}n=Cf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ul(){}Ul.prototype.g=function(g,x){return new Gn(g,x)};function Gn(g,x){sn.call(this),this.g=new Pl(x),this.l=g,this.h=x&&x.messageUrlParams||null,g=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(g?g["X-WebChannel-Content-Type"]=x.messageContentType:g={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.sa&&(g?g["X-WebChannel-Client-Profile"]=x.sa:g={"X-WebChannel-Client-Profile":x.sa}),this.g.U=g,(g=x&&x.Qb)&&!M(g)&&(this.g.u=g),this.A=x&&x.supportsCrossDomainXhr||!1,this.v=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!M(x)&&(this.g.G=x,g=this.h,g!==null&&x in g&&(g=this.h,x in g&&delete g[x])),this.j=new Fr(this)}_(Gn,sn),Gn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Gn.prototype.close=function(){yo(this.g)},Gn.prototype.o=function(g){var x=this.g;if(typeof g=="string"){var w={};w.__data__=g,g=w}else this.v&&(w={},w.__data__=bs(g),g=w);x.i.push(new s_(x.Ya++,g)),x.I==3&&vo(x)},Gn.prototype.N=function(){this.g.l=null,delete this.j,yo(this.g),delete this.g,Gn.Z.N.call(this)};function Pu(g){Ir.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var x=g.__sm__;if(x){e:{for(const w in x){g=w;break e}g=void 0}(this.i=g)&&(g=this.i,x=x!==null&&g in x?x[g]:void 0),this.data=x}else this.data=g}_(Pu,Ir);function Df(){Ls.call(this),this.status=1}_(Df,Ls);function Fr(g){this.g=g}_(Fr,Cf),Fr.prototype.ra=function(){fn(this.g,"a")},Fr.prototype.qa=function(g){fn(this.g,new Pu(g))},Fr.prototype.pa=function(g){fn(this.g,new Df)},Fr.prototype.oa=function(){fn(this.g,"b")},Ul.prototype.createWebChannel=Ul.prototype.g,Gn.prototype.send=Gn.prototype.o,Gn.prototype.open=Gn.prototype.m,Gn.prototype.close=Gn.prototype.close,PR=function(){return new Ul},OR=function(){return Al()},MR=vs,z0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},qt.NO_ERROR=0,qt.TIMEOUT=8,qt.HTTP_ERROR=6,ig=qt,xn.COMPLETE="complete",kR=xn,mf.EventType=ni,ni.OPEN="a",ni.CLOSE="b",ni.ERROR="c",ni.MESSAGE="d",sn.prototype.listen=sn.prototype.J,Lh=mf,vt.prototype.listenOnce=vt.prototype.K,vt.prototype.getLastError=vt.prototype.Ha,vt.prototype.getLastErrorCode=vt.prototype.ya,vt.prototype.getStatus=vt.prototype.ca,vt.prototype.getResponseJson=vt.prototype.La,vt.prototype.getResponseText=vt.prototype.la,vt.prototype.send=vt.prototype.ea,vt.prototype.setWithCredentials=vt.prototype.Fa,NR=vt}).apply(typeof km<"u"?km:typeof self<"u"?self:typeof window<"u"?window:{});const RS="@firebase/firestore",CS="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}bn.UNAUTHENTICATED=new bn(null),bn.GOOGLE_CREDENTIALS=new bn("google-credentials-uid"),bn.FIRST_PARTY=new bn("first-party-uid"),bn.MOCK_USER=new bn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hu="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pa=new fp("@firebase/firestore");function Tc(){return Pa.logLevel}function ZL(n){Pa.setLogLevel(n)}function ce(n,...e){if(Pa.logLevel<=Ye.DEBUG){const t=e.map(iv);Pa.debug(`Firestore (${hu}): ${n}`,...t)}}function Kt(n,...e){if(Pa.logLevel<=Ye.ERROR){const t=e.map(iv);Pa.error(`Firestore (${hu}): ${n}`,...t)}}function Ci(n,...e){if(Pa.logLevel<=Ye.WARN){const t=e.map(iv);Pa.warn(`Firestore (${hu}): ${n}`,...t)}}function iv(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xe(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,VR(n,s,t)}function VR(n,e,t){let s=`FIRESTORE (${hu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw Kt(s),new Error(s)}function we(n,e,t,s){let i="Unexpected state";typeof t=="string"?i=t:s=t,n||VR(e,i,s)}function JL(n,e){n||xe(57014,e)}function ve(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class le extends Ni{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LR{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class e4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(bn.UNAUTHENTICATED)))}shutdown(){}}class t4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class n4{constructor(e){this.t=e,this.currentUser=bn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){we(this.o===void 0,42304);let s=this.i;const i=h=>this.i!==s?(s=this.i,t(h)):Promise.resolve();let r=new Rn;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Rn,e.enqueueRetryable((()=>i(this.currentUser)))};const l=()=>{const h=r;e.enqueueRetryable((async()=>{await h.promise,await i(this.currentUser)}))},c=h=>{ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((h=>c(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?c(h):(ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Rn)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(we(typeof s.accessToken=="string",31837,{l:s}),new LR(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return we(e===null||typeof e=="string",2055,{h:e}),new bn(e)}}class s4{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=bn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class i4{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new s4(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(bn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class DS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class r4{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ks(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){we(this.o===void 0,3512);const s=r=>{r.error!=null&&ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const l=r.token!==this.m;return this.m=r.token,ce("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(r.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable((()=>s(r)))};const i=r=>{ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((r=>i(r))),setTimeout((()=>{if(!this.appCheck){const r=this.V.getImmediate({optional:!0});r?i(r):ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new DS(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(we(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new DS(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a4(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const i=a4(40);for(let r=0;r<i.length;++r)s.length<20&&i[r]<t&&(s+=e.charAt(i[r]%62))}return s}}function Ve(n,e){return n<e?-1:n>e?1:0}function H0(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const i=n.charAt(s),r=e.charAt(s);if(i!==r)return c0(i)===c0(r)?Ve(i,r):c0(i)?1:-1}return Ve(n.length,e.length)}const o4=55296,l4=57343;function c0(n){const e=n.charCodeAt(0);return e>=o4&&e<=l4}function Lc(n,e,t){return n.length===e.length&&n.every(((s,i)=>t(s,e[i])))}function jR(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS="__name__";class yi{constructor(e,t,s){t===void 0?t=0:t>e.length&&xe(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&xe(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return yi.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof yi?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let i=0;i<s;i++){const r=yi.compareSegments(e.get(i),t.get(i));if(r!==0)return r}return Ve(e.length,t.length)}static compareSegments(e,t){const s=yi.isNumericId(e),i=yi.isNumericId(t);return s&&!i?-1:!s&&i?1:s&&i?yi.extractNumericId(e).compare(yi.extractNumericId(t)):H0(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ia.fromString(e.substring(4,e.length-2))}}class Ke extends yi{construct(e,t,s){return new Ke(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new le(ee.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((i=>i.length>0)))}return new Ke(t)}static emptyPath(){return new Ke([])}}const c4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kt extends yi{construct(e,t,s){return new kt(e,t,s)}static isValidIdentifier(e){return c4.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===NS}static keyField(){return new kt([NS])}static fromServerFormat(e){const t=[];let s="",i=0;const r=()=>{if(s.length===0)throw new le(ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let l=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new le(ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new le(ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=h,i+=2}else c==="`"?(l=!l,i++):c!=="."||l?(s+=c,i++):(r(),i++)}if(r(),l)throw new le(ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new kt(t)}static emptyPath(){return new kt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.path=e}static fromPath(e){return new pe(Ke.fromString(e))}static fromName(e){return new pe(Ke.fromString(e).popFirst(5))}static empty(){return new pe(Ke.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ke.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ke.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new pe(new Ke(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function av(n,e,t){if(!t)throw new le(ee.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function UR(n,e,t,s){if(e===!0&&s===!0)throw new le(ee.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function kS(n){if(!pe.isDocumentKey(n))throw new le(ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function MS(n){if(pe.isDocumentKey(n))throw new le(ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function BR(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function yp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":xe(12329,{type:typeof n})}function at(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new le(ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=yp(n);throw new le(ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function FR(n,e){if(e<=0)throw new le(ee.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nn(n,e){const t={typeString:n};return e&&(t.value=e),t}function $d(n,e){if(!BR(n))throw new le(ee.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const i=e[s].typeString,r="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const l=n[s];if(i&&typeof l!==i){t=`JSON field '${s}' must be a ${i}.`;break}if(r!==void 0&&l!==r.value){t=`Expected '${s}' field to equal '${r.value}'`;break}}if(t)throw new le(ee.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS=-62135596800,PS=1e6;class lt{static now(){return lt.fromMillis(Date.now())}static fromDate(e){return lt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*PS);return new lt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new le(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new le(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<OS)throw new le(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new le(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/PS}_compareTo(e){return this.seconds===e.seconds?Ve(this.nanoseconds,e.nanoseconds):Ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:lt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if($d(e,lt._jsonSchema))return new lt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-OS;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}lt._jsonSchemaVersion="firestore/timestamp/1.0",lt._jsonSchema={type:nn("string",lt._jsonSchemaVersion),seconds:nn("number"),nanoseconds:nn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{static fromTimestamp(e){return new Re(e)}static min(){return new Re(new lt(0,0))}static max(){return new Re(new lt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jc=-1;class Mg{constructor(e,t,s,i){this.indexId=e,this.collectionGroup=t,this.fields=s,this.indexState=i}}function q0(n){return n.fields.find((e=>e.kind===2))}function Ho(n){return n.fields.filter((e=>e.kind!==2))}Mg.UNKNOWN_ID=-1;class rg{constructor(e,t){this.fieldPath=e,this.kind=t}}class md{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new md(0,_s.min())}}function zR(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,i=Re.fromTimestamp(s===1e9?new lt(t+1,0):new lt(t,s));return new _s(i,pe.empty(),e)}function HR(n){return new _s(n.readTime,n.key,jc)}class _s{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new _s(Re.min(),pe.empty(),jc)}static max(){return new _s(Re.max(),pe.empty(),jc)}}function ov(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=pe.comparator(n.documentKey,e.documentKey),t!==0?t:Ve(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class GR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ya(n){if(n.code!==ee.FAILED_PRECONDITION||n.message!==qR)throw n;ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&xe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new W(((s,i)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(s,i)},this.catchCallback=r=>{this.wrapFailure(t,r).next(s,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof W?t:W.resolve(t)}catch(t){return W.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):W.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):W.reject(t)}static resolve(e){return new W(((t,s)=>{t(e)}))}static reject(e){return new W(((t,s)=>{s(e)}))}static waitFor(e){return new W(((t,s)=>{let i=0,r=0,l=!1;e.forEach((c=>{++i,c.next((()=>{++r,l&&r===i&&t()}),(h=>s(h)))})),l=!0,r===i&&t()}))}static or(e){let t=W.resolve(!1);for(const s of e)t=t.next((i=>i?W.resolve(i):s()));return t}static forEach(e,t){const s=[];return e.forEach(((i,r)=>{s.push(t.call(this,i,r))})),this.waitFor(s)}static mapArray(e,t){return new W(((s,i)=>{const r=e.length,l=new Array(r);let c=0;for(let h=0;h<r;h++){const d=h;t(e[d]).next((m=>{l[d]=m,++c,c===r&&s(l)}),(m=>i(m)))}}))}static doWhile(e,t){return new W(((s,i)=>{const r=()=>{e()===!0?t().next((()=>{r()}),i):s()};r()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gs="SimpleDb";class bp{static open(e,t,s,i){try{return new bp(t,e.transaction(i,s))}catch(r){throw new Xh(t,r)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Rn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Xh(e,t.error)):this.S.resolve()},this.transaction.onerror=s=>{const i=lv(s.target.error);this.S.reject(new Xh(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ce(gs,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new h4(t)}}class Ei{static delete(e){return ce(gs,"Removing database:",e),Wo(Fb().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!F2())return!1;if(Ei.F())return!0;const e=hn(),t=Ei.M(e),s=0<t&&t<10,i=$R(e),r=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||r)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(s)}constructor(e,t,s){this.name=e,this.version=t,this.N=s,this.B=null,Ei.M(hn())===12.2&&Kt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ce(gs,"Opening database:",this.name),this.db=await new Promise(((t,s)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=r=>{const l=r.target.result;t(l)},i.onblocked=()=>{s(new Xh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=r=>{const l=r.target.error;l.name==="VersionError"?s(new le(ee.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?s(new le(ee.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):s(new Xh(e,l))},i.onupgradeneeded=r=>{ce(gs,'Database "'+this.name+'" requires upgrade from version:',r.oldVersion);const l=r.target.result;this.N.k(l,i.transaction,r.oldVersion,this.version).next((()=>{ce(gs,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,s,i){const r=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const c=bp.open(this.db,e,r?"readonly":"readwrite",s),h=i(c).next((d=>(c.C(),d))).catch((d=>(c.abort(d),W.reject(d)))).toPromise();return h.catch((()=>{})),await c.D,h}catch(c){const h=c,d=h.name!=="FirebaseError"&&l<3;if(ce(gs,"Transaction failed with error:",h.message,"Retrying:",d),this.close(),!d)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}function $R(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class u4{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Wo(this.U.delete())}}class Xh extends le{constructor(e,t){super(ee.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ka(n){return n.name==="IndexedDbTransactionError"}class h4{constructor(e){this.store=e}put(e,t){let s;return t!==void 0?(ce(gs,"PUT",this.store.name,e,t),s=this.store.put(t,e)):(ce(gs,"PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),Wo(s)}add(e){return ce(gs,"ADD",this.store.name,e,e),Wo(this.store.add(e))}get(e){return Wo(this.store.get(e)).next((t=>(t===void 0&&(t=null),ce(gs,"GET",this.store.name,e,t),t)))}delete(e){return ce(gs,"DELETE",this.store.name,e),Wo(this.store.delete(e))}count(){return ce(gs,"COUNT",this.store.name),Wo(this.store.count())}J(e,t){const s=this.options(e,t),i=s.index?this.store.index(s.index):this.store;if(typeof i.getAll=="function"){const r=i.getAll(s.range);return new W(((l,c)=>{r.onerror=h=>{c(h.target.error)},r.onsuccess=h=>{l(h.target.result)}}))}{const r=this.cursor(s),l=[];return this.H(r,((c,h)=>{l.push(h)})).next((()=>l))}}Y(e,t){const s=this.store.getAll(e,t===null?void 0:t);return new W(((i,r)=>{s.onerror=l=>{r(l.target.error)},s.onsuccess=l=>{i(l.target.result)}}))}Z(e,t){ce(gs,"DELETE ALL",this.store.name);const s=this.options(e,t);s.X=!1;const i=this.cursor(s);return this.H(i,((r,l,c)=>c.delete()))}ee(e,t){let s;t?s=e:(s={},t=e);const i=this.cursor(s);return this.H(i,t)}te(e){const t=this.cursor({});return new W(((s,i)=>{t.onerror=r=>{const l=lv(r.target.error);i(l)},t.onsuccess=r=>{const l=r.target.result;l?e(l.primaryKey,l.value).next((c=>{c?l.continue():s()})):s()}}))}H(e,t){const s=[];return new W(((i,r)=>{e.onerror=l=>{r(l.target.error)},e.onsuccess=l=>{const c=l.target.result;if(!c)return void i();const h=new u4(c),d=t(c.primaryKey,c.value,h);if(d instanceof W){const m=d.catch((_=>(h.done(),W.reject(_))));s.push(m)}h.isDone?i():h.G===null?c.continue():c.continue(h.G)}})).next((()=>W.waitFor(s)))}options(e,t){let s;return e!==void 0&&(typeof e=="string"?s=e:t=e),{index:s,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const s=this.store.index(e.index);return e.X?s.openKeyCursor(e.range,t):s.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Wo(n){return new W(((e,t)=>{n.onsuccess=s=>{const i=s.target.result;e(i)},n.onerror=s=>{const i=lv(s.target.error);t(i)}}))}let VS=!1;function lv(n){const e=Ei.M(hn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const s=new le("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return VS||(VS=!0,setTimeout((()=>{throw s}),0)),s}}return n}const Zh="IndexBackfiller";class d4{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ce(Zh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ce(Zh,`Documents written: ${t}`)}catch(t){Ka(t)?ce(Zh,"Ignoring IndexedDB error during index backfill: ",t):await Ya(t)}await this.re(6e4)}))}}class f4{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const s=new Set;let i=t,r=!0;return W.doWhile((()=>r===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!s.has(l))return ce(Zh,`Processing collection: ${l}`),this.oe(e,l,i).next((c=>{i-=c,s.add(l)}));r=!1})))).next((()=>t-i))}oe(e,t,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,s).next((r=>{const l=r.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(i,r))).next((c=>(ce(Zh,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c)))).next((()=>l.size))}))))}_e(e,t){let s=e;return t.changes.forEach(((i,r)=>{const l=HR(r);ov(l,s)>0&&(s=l)})),new _s(s.readTime,s.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ss.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra=-1;function Wd(n){return n==null}function gd(n){return n===0&&1/n==-1/0}function WR(n){return typeof n=="number"&&Number.isInteger(n)&&!gd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Og="";function Un(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=LS(e)),e=m4(n.get(t),e);return LS(e)}function m4(n,e){let t=e;const s=n.length;for(let i=0;i<s;i++){const r=n.charAt(i);switch(r){case"\0":t+="";break;case Og:t+="";break;default:t+=r}}return t}function LS(n){return n+Og+""}function vi(n){const e=n.length;if(we(e>=2,64408,{path:n}),e===2)return we(n.charAt(0)===Og&&n.charAt(1)==="",56145,{path:n}),Ke.emptyPath();const t=e-2,s=[];let i="";for(let r=0;r<e;){const l=n.indexOf(Og,r);switch((l<0||l>t)&&xe(50515,{path:n}),n.charAt(l+1)){case"":const c=n.substring(r,l);let h;i.length===0?h=c:(i+=c,h=i,i=""),s.push(h);break;case"":i+=n.substring(r,l),i+="\0";break;case"":i+=n.substring(r,l+1);break;default:xe(61167,{path:n})}r=l+2}return new Ke(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qo="remoteDocuments",Yd="owner",mc="owner",pd="mutationQueues",g4="userId",Ws="mutations",jS="batchId",Jo="userMutationsIndex",US=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ag(n,e){return[n,Un(e)]}function YR(n,e,t){return[n,Un(e),t]}const p4={},Uc="documentMutations",Pg="remoteDocumentsV14",_4=["prefixPath","collectionGroup","readTime","documentId"],og="documentKeyIndex",y4=["prefixPath","collectionGroup","documentId"],KR="collectionGroupIndex",b4=["collectionGroup","readTime","prefixPath","documentId"],_d="remoteDocumentGlobal",G0="remoteDocumentGlobalKey",Bc="targets",QR="queryTargetsIndex",v4=["canonicalId","targetId"],Fc="targetDocuments",x4=["targetId","path"],cv="documentTargetsIndex",T4=["path","targetId"],Vg="targetGlobalKey",rl="targetGlobal",yd="collectionParents",E4=["collectionId","parent"],zc="clientMetadata",w4="clientId",vp="bundles",S4="bundleId",xp="namedQueries",A4="name",uv="indexConfiguration",I4="indexId",$0="collectionGroupIndex",R4="collectionGroup",Jh="indexState",C4=["indexId","uid"],XR="sequenceNumberIndex",D4=["uid","sequenceNumber"],ed="indexEntries",N4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ZR="documentKeyIndex",k4=["indexId","uid","orderedDocumentKey"],Tp="documentOverlays",M4=["userId","collectionPath","documentId"],W0="collectionPathOverlayIndex",O4=["userId","collectionPath","largestBatchId"],JR="collectionGroupOverlayIndex",P4=["userId","collectionGroup","largestBatchId"],hv="globals",V4="name",eC=[pd,Ws,Uc,qo,Bc,Yd,rl,Fc,zc,_d,yd,vp,xp],L4=[...eC,Tp],tC=[pd,Ws,Uc,Pg,Bc,Yd,rl,Fc,zc,_d,yd,vp,xp,Tp],nC=tC,dv=[...nC,uv,Jh,ed],j4=dv,sC=[...dv,hv],U4=sC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0 extends GR{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function dn(n,e){const t=ve(n);return Ei.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BS(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Qa(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function iC(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,t){this.comparator=e,this.root=t||Sn.EMPTY}insert(e,t){return new St(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Sn.BLACK,null,null))}remove(e){return new St(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Sn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const i=this.comparator(e,s.key);if(i===0)return t+s.left.size;i<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Mm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Mm(this.root,e,this.comparator,!1)}getReverseIterator(){return new Mm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Mm(this.root,e,this.comparator,!0)}}class Mm{constructor(e,t,s,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?s(e.key,t):1,t&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(r===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Sn{constructor(e,t,s,i,r){this.key=e,this.value=t,this.color=s??Sn.RED,this.left=i??Sn.EMPTY,this.right=r??Sn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,i,r){return new Sn(e??this.key,t??this.value,s??this.color,i??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let i=this;const r=s(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,s),null):r===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,s)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Sn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Sn.EMPTY;s=i.right.min(),i=i.copy(s.key,s.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw xe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw xe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw xe(27949);return e+(this.isRed()?0:1)}}Sn.EMPTY=null,Sn.RED=!0,Sn.BLACK=!1;Sn.EMPTY=new class{constructor(){this.size=0}get key(){throw xe(57766)}get value(){throw xe(16141)}get color(){throw xe(16727)}get left(){throw xe(29726)}get right(){throw xe(36894)}copy(e,t,s,i,r){return this}insert(e,t,s){return new Sn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.comparator=e,this.data=new St(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const i=s.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new FS(this.data.getIterator())}getIteratorFrom(e){return new FS(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof mt)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,r=s.getNext().key;if(this.comparator(i,r)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new mt(this.comparator);return t.data=e,t}}class FS{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function gc(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e){this.fields=e,e.sort(kt.comparator)}static empty(){return new is([])}unionWith(e){let t=new mt(kt.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new is(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Lc(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B4(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new rC("Invalid base64 string: "+r):r}})(e);return new Ft(t)}static fromUint8Array(e){const t=(function(i){let r="";for(let l=0;l<i.length;++l)r+=String.fromCharCode(i[l]);return r})(e);return new Ft(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ft.EMPTY_BYTE_STRING=new Ft("");const F4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pr(n){if(we(!!n,39018),typeof n=="string"){let e=0;const t=F4.exec(n);if(we(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Nt(n.seconds),nanos:Nt(n.nanos)}}function Nt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function _r(n){return typeof n=="string"?Ft.fromBase64String(n):Ft.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aC="server_timestamp",oC="__type__",lC="__previous_value__",cC="__local_write_time__";function Ep(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[oC])==null?void 0:s.stringValue)===aC}function wp(n){const e=n.mapValue.fields[lC];return Ep(e)?wp(e):e}function bd(n){const e=pr(n.mapValue.fields[cC].timestampValue);return new lt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e,t,s,i,r,l,c,h,d,m){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=i,this.ssl=r,this.forceLongPolling=l,this.autoDetectLongPolling=c,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=m}}const Lg="(default)";class Va{constructor(e,t){this.projectId=e,this.database=t||Lg}static empty(){return new Va("","")}get isDefaultDatabase(){return this.database===Lg}isEqual(e){return e instanceof Va&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fv="__type__",uC="__max__",va={mapValue:{fields:{__type__:{stringValue:uC}}}},mv="__vector__",Hc="value",lg={nullValue:"NULL_VALUE"};function La(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ep(n)?4:hC(n)?9007199254740991:Sp(n)?10:11:xe(28295,{value:n})}function Di(n,e){if(n===e)return!0;const t=La(n);if(t!==La(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return bd(n).isEqual(bd(e));case 3:return(function(i,r){if(typeof i.timestampValue=="string"&&typeof r.timestampValue=="string"&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const l=pr(i.timestampValue),c=pr(r.timestampValue);return l.seconds===c.seconds&&l.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,r){return _r(i.bytesValue).isEqual(_r(r.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,r){return Nt(i.geoPointValue.latitude)===Nt(r.geoPointValue.latitude)&&Nt(i.geoPointValue.longitude)===Nt(r.geoPointValue.longitude)})(n,e);case 2:return(function(i,r){if("integerValue"in i&&"integerValue"in r)return Nt(i.integerValue)===Nt(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const l=Nt(i.doubleValue),c=Nt(r.doubleValue);return l===c?gd(l)===gd(c):isNaN(l)&&isNaN(c)}return!1})(n,e);case 9:return Lc(n.arrayValue.values||[],e.arrayValue.values||[],Di);case 10:case 11:return(function(i,r){const l=i.mapValue.fields||{},c=r.mapValue.fields||{};if(BS(l)!==BS(c))return!1;for(const h in l)if(l.hasOwnProperty(h)&&(c[h]===void 0||!Di(l[h],c[h])))return!1;return!0})(n,e);default:return xe(52216,{left:n})}}function vd(n,e){return(n.values||[]).find((t=>Di(t,e)))!==void 0}function ja(n,e){if(n===e)return 0;const t=La(n),s=La(e);if(t!==s)return Ve(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ve(n.booleanValue,e.booleanValue);case 2:return(function(r,l){const c=Nt(r.integerValue||r.doubleValue),h=Nt(l.integerValue||l.doubleValue);return c<h?-1:c>h?1:c===h?0:isNaN(c)?isNaN(h)?0:-1:1})(n,e);case 3:return zS(n.timestampValue,e.timestampValue);case 4:return zS(bd(n),bd(e));case 5:return H0(n.stringValue,e.stringValue);case 6:return(function(r,l){const c=_r(r),h=_r(l);return c.compareTo(h)})(n.bytesValue,e.bytesValue);case 7:return(function(r,l){const c=r.split("/"),h=l.split("/");for(let d=0;d<c.length&&d<h.length;d++){const m=Ve(c[d],h[d]);if(m!==0)return m}return Ve(c.length,h.length)})(n.referenceValue,e.referenceValue);case 8:return(function(r,l){const c=Ve(Nt(r.latitude),Nt(l.latitude));return c!==0?c:Ve(Nt(r.longitude),Nt(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return HS(n.arrayValue,e.arrayValue);case 10:return(function(r,l){var v,T,S,E;const c=r.fields||{},h=l.fields||{},d=(v=c[Hc])==null?void 0:v.arrayValue,m=(T=h[Hc])==null?void 0:T.arrayValue,_=Ve(((S=d==null?void 0:d.values)==null?void 0:S.length)||0,((E=m==null?void 0:m.values)==null?void 0:E.length)||0);return _!==0?_:HS(d,m)})(n.mapValue,e.mapValue);case 11:return(function(r,l){if(r===va.mapValue&&l===va.mapValue)return 0;if(r===va.mapValue)return 1;if(l===va.mapValue)return-1;const c=r.fields||{},h=Object.keys(c),d=l.fields||{},m=Object.keys(d);h.sort(),m.sort();for(let _=0;_<h.length&&_<m.length;++_){const v=H0(h[_],m[_]);if(v!==0)return v;const T=ja(c[h[_]],d[m[_]]);if(T!==0)return T}return Ve(h.length,m.length)})(n.mapValue,e.mapValue);default:throw xe(23264,{he:t})}}function zS(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ve(n,e);const t=pr(n),s=pr(e),i=Ve(t.seconds,s.seconds);return i!==0?i:Ve(t.nanos,s.nanos)}function HS(n,e){const t=n.values||[],s=e.values||[];for(let i=0;i<t.length&&i<s.length;++i){const r=ja(t[i],s[i]);if(r)return r}return Ve(t.length,s.length)}function qc(n){return K0(n)}function K0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=pr(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return _r(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return pe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",i=!0;for(const r of t.values||[])i?i=!1:s+=",",s+=K0(r);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let i="{",r=!0;for(const l of s)r?r=!1:i+=",",i+=`${l}:${K0(t.fields[l])}`;return i+"}"})(n.mapValue):xe(61005,{value:n})}function cg(n){switch(La(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=wp(n);return e?16+cg(e):16;case 5:return 2*n.stringValue.length;case 6:return _r(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((i,r)=>i+cg(r)),0)})(n.arrayValue);case 10:case 11:return(function(s){let i=0;return Qa(s.fields,((r,l)=>{i+=r.length+cg(l)})),i})(n.mapValue);default:throw xe(13486,{value:n})}}function cl(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Q0(n){return!!n&&"integerValue"in n}function xd(n){return!!n&&"arrayValue"in n}function qS(n){return!!n&&"nullValue"in n}function GS(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ug(n){return!!n&&"mapValue"in n}function Sp(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[fv])==null?void 0:s.stringValue)===mv}function td(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Qa(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=td(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=td(n.arrayValue.values[t]);return e}return{...n}}function hC(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===uC}const dC={mapValue:{fields:{[fv]:{stringValue:mv},[Hc]:{arrayValue:{}}}}};function H4(n){return"nullValue"in n?lg:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?cl(Va.empty(),pe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Sp(n)?dC:{mapValue:{}}:xe(35942,{value:n})}function q4(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?cl(Va.empty(),pe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?dC:"mapValue"in n?Sp(n)?{mapValue:{}}:va:xe(61959,{value:n})}function $S(n,e){const t=ja(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function WS(n,e){const t=ja(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e){this.value=e}static empty(){return new In({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!ug(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=td(t)}setAll(e){let t=kt.emptyPath(),s={},i=[];e.forEach(((l,c)=>{if(!t.isImmediateParentOf(c)){const h=this.getFieldsMap(t);this.applyChanges(h,s,i),s={},i=[],t=c.popLast()}l?s[c.lastSegment()]=td(l):i.push(c.lastSegment())}));const r=this.getFieldsMap(t);this.applyChanges(r,s,i)}delete(e){const t=this.field(e.popLast());ug(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Di(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let i=t.mapValue.fields[e.get(s)];ug(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,s){Qa(t,((i,r)=>e[i]=r));for(const i of s)delete e[i]}clone(){return new In(td(this.value))}}function fC(n){const e=[];return Qa(n.fields,((t,s)=>{const i=new kt([t]);if(ug(s)){const r=fC(s.mapValue).fields;if(r.length===0)e.push(i);else for(const l of r)e.push(i.child(l))}else e.push(i)})),new is(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e,t,s,i,r,l,c){this.key=e,this.documentType=t,this.version=s,this.readTime=i,this.createTime=r,this.data=l,this.documentState=c}static newInvalidDocument(e){return new It(e,0,Re.min(),Re.min(),Re.min(),In.empty(),0)}static newFoundDocument(e,t,s,i){return new It(e,1,t,Re.min(),s,i,0)}static newNoDocument(e,t){return new It(e,2,t,Re.min(),Re.min(),In.empty(),0)}static newUnknownDocument(e,t){return new It(e,3,t,Re.min(),Re.min(),In.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Re.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=In.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=In.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof It&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new It(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,t){this.position=e,this.inclusive=t}}function YS(n,e,t){let s=0;for(let i=0;i<n.position.length;i++){const r=e[i],l=n.position[i];if(r.field.isKeyField()?s=pe.comparator(pe.fromName(l.referenceValue),t.key):s=ja(l,t.data.field(r.field)),r.dir==="desc"&&(s*=-1),s!==0)break}return s}function KS(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Di(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(e,t="asc"){this.field=e,this.dir=t}}function G4(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{}class Xe extends mC{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new $4(e,t,s):t==="array-contains"?new K4(e,s):t==="in"?new vC(e,s):t==="not-in"?new Q4(e,s):t==="array-contains-any"?new X4(e,s):new Xe(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new W4(e,s):new Y4(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ja(t,this.value)):t!==null&&La(this.value)===La(t)&&this.matchesComparison(ja(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return xe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ft extends mC{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ft(e,t)}matches(e){return Gc(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Gc(n){return n.op==="and"}function X0(n){return n.op==="or"}function gv(n){return gC(n)&&Gc(n)}function gC(n){for(const e of n.filters)if(e instanceof ft)return!1;return!0}function Z0(n){if(n instanceof Xe)return n.field.canonicalString()+n.op.toString()+qc(n.value);if(gv(n))return n.filters.map((e=>Z0(e))).join(",");{const e=n.filters.map((t=>Z0(t))).join(",");return`${n.op}(${e})`}}function pC(n,e){return n instanceof Xe?(function(s,i){return i instanceof Xe&&s.op===i.op&&s.field.isEqual(i.field)&&Di(s.value,i.value)})(n,e):n instanceof ft?(function(s,i){return i instanceof ft&&s.op===i.op&&s.filters.length===i.filters.length?s.filters.reduce(((r,l,c)=>r&&pC(l,i.filters[c])),!0):!1})(n,e):void xe(19439)}function _C(n,e){const t=n.filters.concat(e);return ft.create(t,n.op)}function yC(n){return n instanceof Xe?(function(t){return`${t.field.canonicalString()} ${t.op} ${qc(t.value)}`})(n):n instanceof ft?(function(t){return t.op.toString()+" {"+t.getFilters().map(yC).join(" ,")+"}"})(n):"Filter"}class $4 extends Xe{constructor(e,t,s){super(e,t,s),this.key=pe.fromName(s.referenceValue)}matches(e){const t=pe.comparator(e.key,this.key);return this.matchesComparison(t)}}class W4 extends Xe{constructor(e,t){super(e,"in",t),this.keys=bC("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Y4 extends Xe{constructor(e,t){super(e,"not-in",t),this.keys=bC("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function bC(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((s=>pe.fromName(s.referenceValue)))}class K4 extends Xe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return xd(t)&&vd(t.arrayValue,this.value)}}class vC extends Xe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&vd(this.value.arrayValue,t)}}class Q4 extends Xe{constructor(e,t){super(e,"not-in",t)}matches(e){if(vd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!vd(this.value.arrayValue,t)}}class X4 extends Xe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!xd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>vd(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(e,t=null,s=[],i=[],r=null,l=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=i,this.limit=r,this.startAt=l,this.endAt=c,this.Te=null}}function J0(n,e=null,t=[],s=[],i=null,r=null,l=null){return new Z4(n,e,t,s,i,r,l)}function ul(n){const e=ve(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>Z0(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(r){return r.field.canonicalString()+r.dir})(s))).join(","),Wd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>qc(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>qc(s))).join(",")),e.Te=t}return e.Te}function Kd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!G4(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!pC(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!KS(n.startAt,e.startAt)&&KS(n.endAt,e.endAt)}function jg(n){return pe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Ug(n,e){return n.filters.filter((t=>t instanceof Xe&&t.field.isEqual(e)))}function QS(n,e,t){let s=lg,i=!0;for(const r of Ug(n,e)){let l=lg,c=!0;switch(r.op){case"<":case"<=":l=H4(r.value);break;case"==":case"in":case">=":l=r.value;break;case">":l=r.value,c=!1;break;case"!=":case"not-in":l=lg}$S({value:s,inclusive:i},{value:l,inclusive:c})<0&&(s=l,i=c)}if(t!==null){for(let r=0;r<n.orderBy.length;++r)if(n.orderBy[r].field.isEqual(e)){const l=t.position[r];$S({value:s,inclusive:i},{value:l,inclusive:t.inclusive})<0&&(s=l,i=t.inclusive);break}}return{value:s,inclusive:i}}function XS(n,e,t){let s=va,i=!0;for(const r of Ug(n,e)){let l=va,c=!0;switch(r.op){case">=":case">":l=q4(r.value),c=!1;break;case"==":case"in":case"<=":l=r.value;break;case"<":l=r.value,c=!1;break;case"!=":case"not-in":l=va}WS({value:s,inclusive:i},{value:l,inclusive:c})>0&&(s=l,i=c)}if(t!==null){for(let r=0;r<n.orderBy.length;++r)if(n.orderBy[r].field.isEqual(e)){const l=t.position[r];WS({value:s,inclusive:i},{value:l,inclusive:t.inclusive})>0&&(s=l,i=t.inclusive);break}}return{value:s,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e,t=null,s=[],i=[],r=null,l="F",c=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=i,this.limit=r,this.limitType=l,this.startAt=c,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function xC(n,e,t,s,i,r,l,c){return new br(n,e,t,s,i,r,l,c)}function du(n){return new br(n)}function ZS(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function pv(n){return n.collectionGroup!==null}function Nc(n){const e=ve(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const r of e.explicitOrderBy)e.Ie.push(r),t.add(r.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let c=new mt(kt.comparator);return l.filters.forEach((h=>{h.getFlattenedFilters().forEach((d=>{d.isInequality()&&(c=c.add(d.field))}))})),c})(e).forEach((r=>{t.has(r.canonicalString())||r.isKeyField()||e.Ie.push(new Td(r,s))})),t.has(kt.keyField().canonicalString())||e.Ie.push(new Td(kt.keyField(),s))}return e.Ie}function Kn(n){const e=ve(n);return e.Ee||(e.Ee=J4(e,Nc(n))),e.Ee}function J4(n,e){if(n.limitType==="F")return J0(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const r=i.dir==="desc"?"asc":"desc";return new Td(i.field,r)}));const t=n.endAt?new Ua(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Ua(n.startAt.position,n.startAt.inclusive):null;return J0(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function eb(n,e){const t=n.filters.concat([e]);return new br(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Bg(n,e,t){return new br(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Qd(n,e){return Kd(Kn(n),Kn(e))&&n.limitType===e.limitType}function TC(n){return`${ul(Kn(n))}|lt:${n.limitType}`}function Ec(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((i=>yC(i))).join(", ")}]`),Wd(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((i=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(i))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((i=>qc(i))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((i=>qc(i))).join(",")),`Target(${s})`})(Kn(n))}; limitType=${n.limitType})`}function Xd(n,e){return e.isFoundDocument()&&(function(s,i){const r=i.key.path;return s.collectionGroup!==null?i.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(r):pe.isDocumentKey(s.path)?s.path.isEqual(r):s.path.isImmediateParentOf(r)})(n,e)&&(function(s,i){for(const r of Nc(s))if(!r.field.isKeyField()&&i.data.field(r.field)===null)return!1;return!0})(n,e)&&(function(s,i){for(const r of s.filters)if(!r.matches(i))return!1;return!0})(n,e)&&(function(s,i){return!(s.startAt&&!(function(l,c,h){const d=YS(l,c,h);return l.inclusive?d<=0:d<0})(s.startAt,Nc(s),i)||s.endAt&&!(function(l,c,h){const d=YS(l,c,h);return l.inclusive?d>=0:d>0})(s.endAt,Nc(s),i))})(n,e)}function EC(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function wC(n){return(e,t)=>{let s=!1;for(const i of Nc(n)){const r=ej(i,e,t);if(r!==0)return r;s=s||i.field.isKeyField()}return 0}}function ej(n,e,t){const s=n.field.isKeyField()?pe.comparator(e.key,t.key):(function(r,l,c){const h=l.data.field(r),d=c.data.field(r);return h!==null&&d!==null?ja(h,d):xe(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return xe(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[i,r]of s)if(this.equalsFn(i,e))return r}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),i=this.inner[s];if(i===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return void(i[r]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return s.length===1?delete this.inner[t]:s.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Qa(this.inner,((t,s)=>{for(const[i,r]of s)e(i,r)}))}isEmpty(){return iC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tj=new St(pe.comparator);function rs(){return tj}const SC=new St(pe.comparator);function jh(...n){let e=SC;for(const t of n)e=e.insert(t.key,t);return e}function AC(n){let e=SC;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function xi(){return nd()}function IC(){return nd()}function nd(){return new vr((n=>n.toString()),((n,e)=>n.isEqual(e)))}const nj=new St(pe.comparator),sj=new mt(pe.comparator);function Fe(...n){let e=sj;for(const t of n)e=e.add(t);return e}const ij=new mt(Ve);function _v(){return ij}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gd(e)?"-0":e}}function RC(n){return{integerValue:""+n}}function CC(n,e){return WR(e)?RC(e):yv(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ap{constructor(){this._=void 0}}function rj(n,e,t){return n instanceof $c?(function(i,r){const l={fields:{[oC]:{stringValue:aC},[cC]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&Ep(r)&&(r=wp(r)),r&&(l.fields[lC]=r),{mapValue:l}})(t,e):n instanceof hl?NC(n,e):n instanceof dl?kC(n,e):(function(i,r){const l=DC(i,r),c=JS(l)+JS(i.Ae);return Q0(l)&&Q0(i.Ae)?RC(c):yv(i.serializer,c)})(n,e)}function aj(n,e,t){return n instanceof hl?NC(n,e):n instanceof dl?kC(n,e):t}function DC(n,e){return n instanceof Wc?(function(s){return Q0(s)||(function(r){return!!r&&"doubleValue"in r})(s)})(e)?e:{integerValue:0}:null}class $c extends Ap{}class hl extends Ap{constructor(e){super(),this.elements=e}}function NC(n,e){const t=MC(e);for(const s of n.elements)t.some((i=>Di(i,s)))||t.push(s);return{arrayValue:{values:t}}}class dl extends Ap{constructor(e){super(),this.elements=e}}function kC(n,e){let t=MC(e);for(const s of n.elements)t=t.filter((i=>!Di(i,s)));return{arrayValue:{values:t}}}class Wc extends Ap{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function JS(n){return Nt(n.integerValue||n.doubleValue)}function MC(n){return xd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(e,t){this.field=e,this.transform=t}}function oj(n,e){return n.field.isEqual(e.field)&&(function(s,i){return s instanceof hl&&i instanceof hl||s instanceof dl&&i instanceof dl?Lc(s.elements,i.elements,Di):s instanceof Wc&&i instanceof Wc?Di(s.Ae,i.Ae):s instanceof $c&&i instanceof $c})(n.transform,e.transform)}class lj{constructor(e,t){this.version=e,this.transformResults=t}}class Mt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Mt}static exists(e){return new Mt(void 0,e)}static updateTime(e){return new Mt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function hg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Ip{}function OC(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new mu(n.key,Mt.none()):new fu(n.key,n.data,Mt.none());{const t=n.data,s=In.empty();let i=new mt(kt.comparator);for(let r of e.fields)if(!i.has(r)){let l=t.field(r);l===null&&r.length>1&&(r=r.popLast(),l=t.field(r)),l===null?s.delete(r):s.set(r,l),i=i.add(r)}return new xr(n.key,s,new is(i.toArray()),Mt.none())}}function cj(n,e,t){n instanceof fu?(function(i,r,l){const c=i.value.clone(),h=tA(i.fieldTransforms,r,l.transformResults);c.setAll(h),r.convertToFoundDocument(l.version,c).setHasCommittedMutations()})(n,e,t):n instanceof xr?(function(i,r,l){if(!hg(i.precondition,r))return void r.convertToUnknownDocument(l.version);const c=tA(i.fieldTransforms,r,l.transformResults),h=r.data;h.setAll(PC(i)),h.setAll(c),r.convertToFoundDocument(l.version,h).setHasCommittedMutations()})(n,e,t):(function(i,r,l){r.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function sd(n,e,t,s){return n instanceof fu?(function(r,l,c,h){if(!hg(r.precondition,l))return c;const d=r.value.clone(),m=nA(r.fieldTransforms,h,l);return d.setAll(m),l.convertToFoundDocument(l.version,d).setHasLocalMutations(),null})(n,e,t,s):n instanceof xr?(function(r,l,c,h){if(!hg(r.precondition,l))return c;const d=nA(r.fieldTransforms,h,l),m=l.data;return m.setAll(PC(r)),m.setAll(d),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),c===null?null:c.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map((_=>_.field)))})(n,e,t,s):(function(r,l,c){return hg(r.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):c})(n,e,t)}function uj(n,e){let t=null;for(const s of n.fieldTransforms){const i=e.data.field(s.field),r=DC(s.transform,i||null);r!=null&&(t===null&&(t=In.empty()),t.set(s.field,r))}return t||null}function eA(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,i){return s===void 0&&i===void 0||!(!s||!i)&&Lc(s,i,((r,l)=>oj(r,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class fu extends Ip{constructor(e,t,s,i=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class xr extends Ip{constructor(e,t,s,i,r=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function PC(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function tA(n,e,t){const s=new Map;we(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const r=n[i],l=r.transform,c=e.data.field(r.field);s.set(r.field,aj(l,c,t[i]))}return s}function nA(n,e,t){const s=new Map;for(const i of n){const r=i.transform,l=t.data.field(i.field);s.set(i.field,rj(r,l,e))}return s}class mu extends Ip{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class bv extends Ip{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{constructor(e,t,s,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=i}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const r=this.mutations[i];r.key.isEqual(e.key)&&cj(r,e,s[i])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=sd(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=sd(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=IC();return this.mutations.forEach((i=>{const r=e.get(i.key),l=r.overlayedDocument;let c=this.applyToLocalView(l,r.mutatedFields);c=t.has(i.key)?null:c;const h=OC(l,c);h!==null&&s.set(i.key,h),l.isValidDocument()||l.convertToNoDocument(Re.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Fe())}isEqual(e){return this.batchId===e.batchId&&Lc(this.mutations,e.mutations,((t,s)=>eA(t,s)))&&Lc(this.baseMutations,e.baseMutations,((t,s)=>eA(t,s)))}}class xv{constructor(e,t,s,i){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=i}static from(e,t,s){we(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let i=(function(){return nj})();const r=e.mutations;for(let l=0;l<r.length;l++)i=i.insert(r[l].key,s[l].version);return new xv(e,t,s,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hj{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tn,et;function VC(n){switch(n){case ee.OK:return xe(64938);case ee.CANCELLED:case ee.UNKNOWN:case ee.DEADLINE_EXCEEDED:case ee.RESOURCE_EXHAUSTED:case ee.INTERNAL:case ee.UNAVAILABLE:case ee.UNAUTHENTICATED:return!1;case ee.INVALID_ARGUMENT:case ee.NOT_FOUND:case ee.ALREADY_EXISTS:case ee.PERMISSION_DENIED:case ee.FAILED_PRECONDITION:case ee.ABORTED:case ee.OUT_OF_RANGE:case ee.UNIMPLEMENTED:case ee.DATA_LOSS:return!0;default:return xe(15467,{code:n})}}function LC(n){if(n===void 0)return Kt("GRPC error has no .code"),ee.UNKNOWN;switch(n){case tn.OK:return ee.OK;case tn.CANCELLED:return ee.CANCELLED;case tn.UNKNOWN:return ee.UNKNOWN;case tn.DEADLINE_EXCEEDED:return ee.DEADLINE_EXCEEDED;case tn.RESOURCE_EXHAUSTED:return ee.RESOURCE_EXHAUSTED;case tn.INTERNAL:return ee.INTERNAL;case tn.UNAVAILABLE:return ee.UNAVAILABLE;case tn.UNAUTHENTICATED:return ee.UNAUTHENTICATED;case tn.INVALID_ARGUMENT:return ee.INVALID_ARGUMENT;case tn.NOT_FOUND:return ee.NOT_FOUND;case tn.ALREADY_EXISTS:return ee.ALREADY_EXISTS;case tn.PERMISSION_DENIED:return ee.PERMISSION_DENIED;case tn.FAILED_PRECONDITION:return ee.FAILED_PRECONDITION;case tn.ABORTED:return ee.ABORTED;case tn.OUT_OF_RANGE:return ee.OUT_OF_RANGE;case tn.UNIMPLEMENTED:return ee.UNIMPLEMENTED;case tn.DATA_LOSS:return ee.DATA_LOSS;default:return xe(39323,{code:n})}}(et=tn||(tn={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jC(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dj=new Ia([4294967295,4294967295],0);function sA(n){const e=jC().encode(n),t=new DR;return t.update(e),new Uint8Array(t.digest())}function iA(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),i=e.getUint32(8,!0),r=e.getUint32(12,!0);return[new Ia([t,s],0),new Ia([i,r],0)]}class Ev{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Uh(`Invalid padding: ${t}`);if(s<0)throw new Uh(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Uh(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Uh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ia.fromNumber(this.ge)}ye(e,t,s){let i=e.add(t.multiply(Ia.fromNumber(s)));return i.compare(dj)===1&&(i=new Ia([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=sA(e),[s,i]=iA(t);for(let r=0;r<this.hashCount;r++){const l=this.ye(s,i,r);if(!this.we(l))return!1}return!0}static create(e,t,s){const i=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),l=new Ev(r,i,t);return s.forEach((c=>l.insert(c))),l}insert(e){if(this.ge===0)return;const t=sA(e),[s,i]=iA(t);for(let r=0;r<this.hashCount;r++){const l=this.ye(s,i,r);this.Se(l)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Uh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(e,t,s,i,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const i=new Map;return i.set(e,ef.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new Jd(Re.min(),i,new St(Ve),rs(),Fe())}}class ef{constructor(e,t,s,i,r){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new ef(s,t,Fe(),Fe(),Fe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dg{constructor(e,t,s,i){this.be=e,this.removedTargetIds=t,this.key=s,this.De=i}}class UC{constructor(e,t){this.targetId=e,this.Ce=t}}class BC{constructor(e,t,s=Ft.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=i}}class rA{constructor(){this.ve=0,this.Fe=aA(),this.Me=Ft.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Fe(),t=Fe(),s=Fe();return this.Fe.forEach(((i,r)=>{switch(r){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:s=s.add(i);break;default:xe(38017,{changeType:r})}})),new ef(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=aA()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,we(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class fj{constructor(e){this.Ge=e,this.ze=new Map,this.je=rs(),this.Je=Om(),this.He=Om(),this.Ye=new St(Ve)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:xe(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((s,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,s=e.Ce.count,i=this.ot(t);if(i){const r=i.target;if(jg(r))if(s===0){const l=new pe(r.path);this.et(t,l,It.newNoDocument(l,Re.min()))}else we(s===1,20013,{expectedCount:s});else{const l=this._t(t);if(l!==s){const c=this.ut(e),h=c?this.ct(c,e,l):1;if(h!==0){this.it(t);const d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:i=0},hashCount:r=0}=t;let l,c;try{l=_r(s).toUint8Array()}catch(h){if(h instanceof rC)return Ci("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{c=new Ev(l,i,r)}catch(h){return Ci(h instanceof Uh?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return c.ge===0?null:c}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let i=0;return s.forEach((r=>{const l=this.Ge.ht(),c=`projects/${l.projectId}/databases/${l.database}/documents/${r.path.canonicalString()}`;e.mightContain(c)||(this.et(t,r,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((r,l)=>{const c=this.ot(l);if(c){if(r.current&&jg(c.target)){const h=new pe(c.target.path);this.It(h).has(l)||this.Et(l,h)||this.et(l,h,It.newNoDocument(h,e))}r.Be&&(t.set(l,r.ke()),r.qe())}}));let s=Fe();this.He.forEach(((r,l)=>{let c=!0;l.forEachWhile((h=>{const d=this.ot(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(s=s.add(r))})),this.je.forEach(((r,l)=>l.setReadTime(e)));const i=new Jd(e,t,this.Ye,this.je,s);return this.je=rs(),this.Je=Om(),this.He=Om(),this.Ye=new St(Ve),i}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new rA,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new mt(Ve),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new mt(Ve),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ce("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new rA),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Om(){return new St(pe.comparator)}function aA(){return new St(pe.comparator)}const mj={asc:"ASCENDING",desc:"DESCENDING"},gj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},pj={and:"AND",or:"OR"};class _j{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function tb(n,e){return n.useProto3Json||Wd(e)?e:{value:e}}function Yc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function FC(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function yj(n,e){return Yc(n,e.toTimestamp())}function Xt(n){return we(!!n,49232),Re.fromTimestamp((function(t){const s=pr(t);return new lt(s.seconds,s.nanos)})(n))}function wv(n,e){return nb(n,e).canonicalString()}function nb(n,e){const t=(function(i){return new Ke(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function zC(n){const e=Ke.fromString(n);return we(ZC(e),10190,{key:e.toString()}),e}function Ed(n,e){return wv(n.databaseId,e.path)}function wi(n,e){const t=zC(e);if(t.get(1)!==n.databaseId.projectId)throw new le(ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new le(ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new pe(GC(t))}function HC(n,e){return wv(n.databaseId,e)}function qC(n){const e=zC(n);return e.length===4?Ke.emptyPath():GC(e)}function sb(n){return new Ke(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function GC(n){return we(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function oA(n,e,t){return{name:Ed(n,e),fields:t.value.mapValue.fields}}function $C(n,e,t){const s=wi(n,e.name),i=Xt(e.updateTime),r=e.createTime?Xt(e.createTime):Re.min(),l=new In({mapValue:{fields:e.fields}}),c=It.newFoundDocument(s,i,r,l);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function bj(n,e){return"found"in e?(function(s,i){we(!!i.found,43571),i.found.name,i.found.updateTime;const r=wi(s,i.found.name),l=Xt(i.found.updateTime),c=i.found.createTime?Xt(i.found.createTime):Re.min(),h=new In({mapValue:{fields:i.found.fields}});return It.newFoundDocument(r,l,c,h)})(n,e):"missing"in e?(function(s,i){we(!!i.missing,3894),we(!!i.readTime,22933);const r=wi(s,i.missing),l=Xt(i.readTime);return It.newNoDocument(r,l)})(n,e):xe(7234,{result:e})}function vj(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:xe(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],r=(function(d,m){return d.useProto3Json?(we(m===void 0||typeof m=="string",58123),Ft.fromBase64String(m||"")):(we(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),Ft.fromUint8Array(m||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,c=l&&(function(d){const m=d.code===void 0?ee.UNKNOWN:LC(d.code);return new le(m,d.message||"")})(l);t=new BC(s,i,r,c||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const i=wi(n,s.document.name),r=Xt(s.document.updateTime),l=s.document.createTime?Xt(s.document.createTime):Re.min(),c=new In({mapValue:{fields:s.document.fields}}),h=It.newFoundDocument(i,r,l,c),d=s.targetIds||[],m=s.removedTargetIds||[];t=new dg(d,m,h.key,h)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const i=wi(n,s.document),r=s.readTime?Xt(s.readTime):Re.min(),l=It.newNoDocument(i,r),c=s.removedTargetIds||[];t=new dg([],c,l.key,l)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const i=wi(n,s.document),r=s.removedTargetIds||[];t=new dg([],r,i,null)}else{if(!("filter"in e))return xe(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:i=0,unchangedNames:r}=s,l=new hj(i,r),c=s.targetId;t=new UC(c,l)}}return t}function wd(n,e){let t;if(e instanceof fu)t={update:oA(n,e.key,e.value)};else if(e instanceof mu)t={delete:Ed(n,e.key)};else if(e instanceof xr)t={update:oA(n,e.key,e.data),updateMask:Aj(e.fieldMask)};else{if(!(e instanceof bv))return xe(16599,{Vt:e.type});t={verify:Ed(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(r,l){const c=l.transform;if(c instanceof $c)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof hl)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof dl)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Wc)return{fieldPath:l.field.canonicalString(),increment:c.Ae};throw xe(20930,{transform:l.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(i,r){return r.updateTime!==void 0?{updateTime:yj(i,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:xe(27497)})(n,e.precondition)),t}function ib(n,e){const t=e.currentDocument?(function(r){return r.updateTime!==void 0?Mt.updateTime(Xt(r.updateTime)):r.exists!==void 0?Mt.exists(r.exists):Mt.none()})(e.currentDocument):Mt.none(),s=e.updateTransforms?e.updateTransforms.map((i=>(function(l,c){let h=null;if("setToServerValue"in c)we(c.setToServerValue==="REQUEST_TIME",16630,{proto:c}),h=new $c;else if("appendMissingElements"in c){const m=c.appendMissingElements.values||[];h=new hl(m)}else if("removeAllFromArray"in c){const m=c.removeAllFromArray.values||[];h=new dl(m)}else"increment"in c?h=new Wc(l,c.increment):xe(16584,{proto:c});const d=kt.fromServerFormat(c.fieldPath);return new Zd(d,h)})(n,i))):[];if(e.update){e.update.name;const i=wi(n,e.update.name),r=new In({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(h){const d=h.fieldPaths||[];return new is(d.map((m=>kt.fromServerFormat(m))))})(e.updateMask);return new xr(i,r,l,t,s)}return new fu(i,r,t,s)}if(e.delete){const i=wi(n,e.delete);return new mu(i,t)}if(e.verify){const i=wi(n,e.verify);return new bv(i,t)}return xe(1463,{proto:e})}function xj(n,e){return n&&n.length>0?(we(e!==void 0,14353),n.map((t=>(function(i,r){let l=i.updateTime?Xt(i.updateTime):Xt(r);return l.isEqual(Re.min())&&(l=Xt(r)),new lj(l,i.transformResults||[])})(t,e)))):[]}function WC(n,e){return{documents:[HC(n,e.path)]}}function YC(n,e){const t={structuredQuery:{}},s=e.path;let i;e.collectionGroup!==null?(i=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=HC(n,i);const r=(function(d){if(d.length!==0)return XC(ft.create(d,"and"))})(e.filters);r&&(t.structuredQuery.where=r);const l=(function(d){if(d.length!==0)return d.map((m=>(function(v){return{field:wc(v.field),direction:Ej(v.dir)}})(m)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const c=tb(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function KC(n){let e=qC(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let i=null;if(s>0){we(s===1,65062);const m=t.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let r=[];t.where&&(r=(function(_){const v=QC(_);return v instanceof ft&&gv(v)?v.getFilters():[v]})(t.where));let l=[];t.orderBy&&(l=(function(_){return _.map((v=>(function(S){return new Td(Sc(S.field),(function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(v)))})(t.orderBy));let c=null;t.limit&&(c=(function(_){let v;return v=typeof _=="object"?_.value:_,Wd(v)?null:v})(t.limit));let h=null;t.startAt&&(h=(function(_){const v=!!_.before,T=_.values||[];return new Ua(T,v)})(t.startAt));let d=null;return t.endAt&&(d=(function(_){const v=!_.before,T=_.values||[];return new Ua(T,v)})(t.endAt)),xC(e,i,l,r,c,"F",h,d)}function Tj(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return xe(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function QC(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=Sc(t.unaryFilter.field);return Xe.create(s,"==",{doubleValue:NaN});case"IS_NULL":const i=Sc(t.unaryFilter.field);return Xe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Sc(t.unaryFilter.field);return Xe.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Sc(t.unaryFilter.field);return Xe.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return xe(61313);default:return xe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Xe.create(Sc(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return xe(58110);default:return xe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ft.create(t.compositeFilter.filters.map((s=>QC(s))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return xe(1026)}})(t.compositeFilter.op))})(n):xe(30097,{filter:n})}function Ej(n){return mj[n]}function wj(n){return gj[n]}function Sj(n){return pj[n]}function wc(n){return{fieldPath:n.canonicalString()}}function Sc(n){return kt.fromServerFormat(n.fieldPath)}function XC(n){return n instanceof Xe?(function(t){if(t.op==="=="){if(GS(t.value))return{unaryFilter:{field:wc(t.field),op:"IS_NAN"}};if(qS(t.value))return{unaryFilter:{field:wc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(GS(t.value))return{unaryFilter:{field:wc(t.field),op:"IS_NOT_NAN"}};if(qS(t.value))return{unaryFilter:{field:wc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:wc(t.field),op:wj(t.op),value:t.value}}})(n):n instanceof ft?(function(t){const s=t.getFilters().map((i=>XC(i)));return s.length===1?s[0]:{compositeFilter:{op:Sj(t.op),filters:s}}})(n):xe(54877,{filter:n})}function Aj(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function ZC(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(e,t,s,i,r=Re.min(),l=Re.min(),c=Ft.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=c,this.expectedCount=h}withSequenceNumber(e){return new lr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new lr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new lr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new lr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e){this.yt=e}}function Ij(n,e){let t;if(e.document)t=$C(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=pe.fromSegments(e.noDocument.path),i=ml(e.noDocument.readTime);t=It.newNoDocument(s,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return xe(56709);{const s=pe.fromSegments(e.unknownDocument.path),i=ml(e.unknownDocument.version);t=It.newUnknownDocument(s,i)}}return e.readTime&&t.setReadTime((function(i){const r=new lt(i[0],i[1]);return Re.fromTimestamp(r)})(e.readTime)),t}function lA(n,e){const t=e.key,s={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Fg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=(function(r,l){return{name:Ed(r,l.key),fields:l.data.value.mapValue.fields,updateTime:Yc(r,l.version.toTimestamp()),createTime:Yc(r,l.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())s.noDocument={path:t.path.toArray(),readTime:fl(e.version)};else{if(!e.isUnknownDocument())return xe(57904,{document:e});s.unknownDocument={path:t.path.toArray(),version:fl(e.version)}}return s}function Fg(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function fl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ml(n){const e=new lt(n.seconds,n.nanoseconds);return Re.fromTimestamp(e)}function Yo(n,e){const t=(e.baseMutations||[]).map((r=>ib(n.yt,r)));for(let r=0;r<e.mutations.length-1;++r){const l=e.mutations[r];if(r+1<e.mutations.length&&e.mutations[r+1].transform!==void 0){const c=e.mutations[r+1];l.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}const s=e.mutations.map((r=>ib(n.yt,r))),i=lt.fromMillis(e.localWriteTimeMs);return new vv(e.batchId,i,t,s)}function Bh(n){const e=ml(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ml(n.lastLimboFreeSnapshotVersion):Re.min();let s;return s=(function(r){return r.documents!==void 0})(n.query)?(function(r){const l=r.documents.length;return we(l===1,1966,{count:l}),Kn(du(qC(r.documents[0])))})(n.query):(function(r){return Kn(KC(r))})(n.query),new lr(s,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Ft.fromBase64String(n.resumeToken))}function eD(n,e){const t=fl(e.snapshotVersion),s=fl(e.lastLimboFreeSnapshotVersion);let i;i=jg(e.target)?WC(n.yt,e.target):YC(n.yt,e.target).ft;const r=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ul(e.target),readTime:t,resumeToken:r,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:i}}function Sv(n){const e=KC({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Bg(e,e.limit,"L"):e}function u0(n,e){return new Tv(e.largestBatchId,ib(n.yt,e.overlayMutation))}function cA(n,e){const t=e.path.lastSegment();return[n,Un(e.path.popLast()),t]}function uA(n,e,t,s){return{indexId:n,uid:e,sequenceNumber:t,readTime:fl(s.readTime),documentKey:Un(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rj{getBundleMetadata(e,t){return hA(e).get(t).next((s=>{if(s)return(function(r){return{id:r.bundleId,createTime:ml(r.createTime),version:r.version}})(s)}))}saveBundleMetadata(e,t){return hA(e).put((function(i){return{bundleId:i.id,createTime:fl(Xt(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return dA(e).get(t).next((s=>{if(s)return(function(r){return{name:r.name,query:Sv(r.bundledQuery),readTime:ml(r.readTime)}})(s)}))}saveNamedQuery(e,t){return dA(e).put((function(i){return{name:i.name,readTime:fl(Xt(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function hA(n){return dn(n,vp)}function dA(n){return dn(n,xp)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const s=t.uid||"";return new Rp(e,s)}getOverlay(e,t){return Ah(e).get(cA(this.userId,t)).next((s=>s?u0(this.serializer,s):null))}getOverlays(e,t){const s=xi();return W.forEach(t,(i=>this.getOverlay(e,i).next((r=>{r!==null&&s.set(i,r)})))).next((()=>s))}saveOverlays(e,t,s){const i=[];return s.forEach(((r,l)=>{const c=new Tv(t,l);i.push(this.St(e,c))})),W.waitFor(i)}removeOverlaysForBatchId(e,t,s){const i=new Set;t.forEach((l=>i.add(Un(l.getCollectionPath()))));const r=[];return i.forEach((l=>{const c=IDBKeyRange.bound([this.userId,l,s],[this.userId,l,s+1],!1,!0);r.push(Ah(e).Z(W0,c))})),W.waitFor(r)}getOverlaysForCollection(e,t,s){const i=xi(),r=Un(t),l=IDBKeyRange.bound([this.userId,r,s],[this.userId,r,Number.POSITIVE_INFINITY],!0);return Ah(e).J(W0,l).next((c=>{for(const h of c){const d=u0(this.serializer,h);i.set(d.getKey(),d)}return i}))}getOverlaysForCollectionGroup(e,t,s,i){const r=xi();let l;const c=IDBKeyRange.bound([this.userId,t,s],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Ah(e).ee({index:JR,range:c},((h,d,m)=>{const _=u0(this.serializer,d);r.size()<i||_.largestBatchId===l?(r.set(_.getKey(),_),l=_.largestBatchId):m.done()})).next((()=>r))}St(e,t){return Ah(e).put((function(i,r,l){const[c,h,d]=cA(r,l.mutation.key);return{userId:r,collectionPath:h,documentId:d,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:wd(i.yt,l.mutation)}})(this.serializer,this.userId,t))}}function Ah(n){return dn(n,Tp)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{bt(e){return dn(e,hv)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const s=t==null?void 0:t.value;return s?Ft.fromUint8Array(s):Ft.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Nt(e.integerValue));else if("doubleValue"in e){const s=Nt(e.doubleValue);isNaN(s)?this.Ft(t,13):(this.Ft(t,15),gd(s)?t.Mt(0):t.Mt(s))}else if("timestampValue"in e){let s=e.timestampValue;this.Ft(t,20),typeof s=="string"&&(s=pr(s)),t.xt(`${s.seconds||""}`),t.Mt(s.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(_r(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const s=e.geoPointValue;this.Ft(t,45),t.Mt(s.latitude||0),t.Mt(s.longitude||0)}else"mapValue"in e?hC(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Sp(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):xe(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const s=e.fields||{};this.Ft(t,55);for(const i of Object.keys(s))this.Ot(i,t),this.Ct(s[i],t)}kt(e,t){var l,c;const s=e.fields||{};this.Ft(t,53);const i=Hc,r=((c=(l=s[i].arrayValue)==null?void 0:l.values)==null?void 0:c.length)||0;this.Ft(t,15),t.Mt(Nt(r)),this.Ot(i,t),this.Ct(s[i],t)}Qt(e,t){const s=e.values||[];this.Ft(t,50);for(const i of s)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),pe.fromName(e).path.forEach((s=>{this.Ft(t,60),this.Ut(s,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Ko.Kt=new Ko;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pc=255;function Dj(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function fA(n){const e=64-(function(s){let i=0;for(let r=0;r<8;++r){const l=Dj(255&s[r]);if(i+=l,l!==8)break}return i})(n);return Math.ceil(e/8)}class Nj{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Gt(s.value),s=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Jt(s.value),s=t.next();this.Ht()}Yt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Gt(s);else if(s<2048)this.Gt(960|s>>>6),this.Gt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Jt(s);else if(s<2048)this.Jt(960|s>>>6),this.Jt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),s=fA(t);this.tn(1+s),this.buffer[this.position++]=255&s;for(let i=t.length-s;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),s=fA(t);this.tn(1+s),this.buffer[this.position++]=~(255&s);for(let i=t.length-s;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(pc),this.sn(255)}_n(){this.an(pc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(r){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,r,!1),new Uint8Array(l.buffer)})(e),s=!!(128&t[0]);t[0]^=s?255:128;for(let i=1;i<t.length;++i)t[i]^=s?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===pc?(this.sn(pc),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===pc?(this.an(pc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let s=2*this.buffer.length;s<t&&(s=t);const i=new Uint8Array(s);i.set(this.buffer),this.buffer=i}}class kj{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class Mj{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Ih{constructor(){this.cn=new Nj,this.ln=new kj(this.cn),this.hn=new Mj(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(e,t,s,i){this.Tn=e,this.In=t,this.En=s,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,s=new Uint8Array(t);return s.set(this.dn,0),t!==e?s.set([0],this.dn.length):++s[s.length-1],new Qo(this.Tn,this.In,this.En,s)}Rn(e,t,s){return{indexId:this.Tn,uid:e,arrayValue:fg(this.En),directionalValue:fg(this.dn),orderedDocumentKey:fg(t),documentKey:s.path.toArray()}}Vn(e,t,s){const i=this.Rn(e,t,s);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function ua(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=mA(n.En,e.En),t!==0?t:(t=mA(n.dn,e.dn),t!==0?t:pe.comparator(n.In,e.In)))}function mA(n,e){for(let t=0;t<n.length&&t<e.length;++t){const s=n[t]-e[t];if(s!==0)return s}return n.length-e.length}function fg(n){return B2()?(function(t){let s="";for(let i=0;i<t.length;i++)s+=String.fromCharCode(t[i]);return s})(n):n}function gA(n){return typeof n!="string"?n:(function(t){const s=new Uint8Array(t.length);for(let i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return s})(n)}class pA{constructor(e){this.mn=new mt(((t,s)=>kt.comparator(t.field,s.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const s=t;s.isInequality()?this.mn=this.mn.add(s):this.gn.push(s)}}get pn(){return this.mn.size>1}yn(e){if(we(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=q0(e);if(t!==void 0&&!this.wn(t))return!1;const s=Ho(e);let i=new Set,r=0,l=0;for(;r<s.length&&this.wn(s[r]);++r)i=i.add(s[r].fieldPath.canonicalString());if(r===s.length)return!0;if(this.mn.size>0){const c=this.mn.getIterator().getNext();if(!i.has(c.field.canonicalString())){const h=s[r];if(!this.Sn(c,h)||!this.bn(this.fn[l++],h))return!1}++r}for(;r<s.length;++r){const c=s[r];if(l>=this.fn.length||!this.bn(this.fn[l++],c))return!1}return!0}Dn(){if(this.pn)return null;let e=new mt(kt.comparator);const t=[];for(const s of this.gn)if(!s.field.isKeyField())if(s.op==="array-contains"||s.op==="array-contains-any")t.push(new rg(s.field,2));else{if(e.has(s.field))continue;e=e.add(s.field),t.push(new rg(s.field,0))}for(const s of this.fn)s.field.isKeyField()||e.has(s.field)||(e=e.add(s.field),t.push(new rg(s.field,s.dir==="asc"?0:1)));return new Mg(Mg.UNKNOWN_ID,this.collectionId,t,md.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===s}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tD(n){var t,s;if(we(n instanceof Xe||n instanceof ft,20012),n instanceof Xe){if(n instanceof vC){const i=((s=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:s.map((r=>Xe.create(n.field,"==",r))))||[];return ft.create(i,"or")}return n}const e=n.filters.map((i=>tD(i)));return ft.create(e,n.op)}function Oj(n){if(n.getFilters().length===0)return[];const e=ob(tD(n));return we(nD(e),7391),rb(e)||ab(e)?[e]:e.getFilters()}function rb(n){return n instanceof Xe}function ab(n){return n instanceof ft&&gv(n)}function nD(n){return rb(n)||ab(n)||(function(t){if(t instanceof ft&&X0(t)){for(const s of t.getFilters())if(!rb(s)&&!ab(s))return!1;return!0}return!1})(n)}function ob(n){if(we(n instanceof Xe||n instanceof ft,34018),n instanceof Xe)return n;if(n.filters.length===1)return ob(n.filters[0]);const e=n.filters.map((s=>ob(s)));let t=ft.create(e,n.op);return t=zg(t),nD(t)?t:(we(t instanceof ft,64498),we(Gc(t),40251),we(t.filters.length>1,57927),t.filters.reduce(((s,i)=>Av(s,i))))}function Av(n,e){let t;return we(n instanceof Xe||n instanceof ft,38388),we(e instanceof Xe||e instanceof ft,25473),t=n instanceof Xe?e instanceof Xe?(function(i,r){return ft.create([i,r],"and")})(n,e):_A(n,e):e instanceof Xe?_A(e,n):(function(i,r){if(we(i.filters.length>0&&r.filters.length>0,48005),Gc(i)&&Gc(r))return _C(i,r.getFilters());const l=X0(i)?i:r,c=X0(i)?r:i,h=l.filters.map((d=>Av(d,c)));return ft.create(h,"or")})(n,e),zg(t)}function _A(n,e){if(Gc(e))return _C(e,n.getFilters());{const t=e.filters.map((s=>Av(n,s)));return ft.create(t,"or")}}function zg(n){if(we(n instanceof Xe||n instanceof ft,11850),n instanceof Xe)return n;const e=n.getFilters();if(e.length===1)return zg(e[0]);if(gC(n))return n;const t=e.map((i=>zg(i))),s=[];return t.forEach((i=>{i instanceof Xe?s.push(i):i instanceof ft&&(i.op===n.op?s.push(...i.filters):s.push(i))})),s.length===1?s[0]:ft.create(s,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pj{constructor(){this.Cn=new Iv}addToCollectionParentIndex(e,t){return this.Cn.add(t),W.resolve()}getCollectionParents(e,t){return W.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return W.resolve()}deleteFieldIndex(e,t){return W.resolve()}deleteAllFieldIndexes(e){return W.resolve()}createTargetIndexes(e,t){return W.resolve()}getDocumentsMatchingTarget(e,t){return W.resolve(null)}getIndexType(e,t){return W.resolve(0)}getFieldIndexes(e,t){return W.resolve([])}getNextCollectionGroupToUpdate(e){return W.resolve(null)}getMinOffset(e,t){return W.resolve(_s.min())}getMinOffsetFromCollectionGroup(e,t){return W.resolve(_s.min())}updateCollectionGroup(e,t,s){return W.resolve()}updateIndexEntries(e,t){return W.resolve()}}class Iv{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),i=this.index[t]||new mt(Ke.comparator),r=!i.has(s);return this.index[t]=i.add(s),r}has(e){const t=e.lastSegment(),s=e.popLast(),i=this.index[t];return i&&i.has(s)}getEntries(e){return(this.index[e]||new mt(Ke.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yA="IndexedDbIndexManager",Pm=new Uint8Array(0);class Vj{constructor(e,t){this.databaseId=t,this.vn=new Iv,this.Fn=new vr((s=>ul(s)),((s,i)=>Kd(s,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const s=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const r={collectionId:s,parent:Un(i)};return bA(e).put(r)}return W.resolve()}getCollectionParents(e,t){const s=[],i=IDBKeyRange.bound([t,""],[jR(t),""],!1,!0);return bA(e).J(i).next((r=>{for(const l of r){if(l.collectionId!==t)break;s.push(vi(l.parent))}return s}))}addFieldIndex(e,t){const s=Rh(e),i=(function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map((h=>[h.fieldPath.canonicalString(),h.kind]))}})(t);delete i.indexId;const r=s.add(i);if(t.indexState){const l=yc(e);return r.next((c=>{l.put(uA(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return r.next()}deleteFieldIndex(e,t){const s=Rh(e),i=yc(e),r=_c(e);return s.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Rh(e),s=_c(e),i=yc(e);return t.Z().next((()=>s.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return W.forEach(this.Mn(t),(s=>this.getIndexType(e,s).next((i=>{if(i===0||i===1){const r=new pA(s).Dn();if(r!=null)return this.addFieldIndex(e,r)}}))))}getDocumentsMatchingTarget(e,t){const s=_c(e);let i=!0;const r=new Map;return W.forEach(this.Mn(t),(l=>this.xn(e,l).next((c=>{i&&(i=!!c),r.set(l,c)})))).next((()=>{if(i){let l=Fe();const c=[];return W.forEach(r,((h,d)=>{ce(yA,`Using index ${(function(O){return`id=${O.indexId}|cg=${O.collectionGroup}|f=${O.fields.map((H=>`${H.fieldPath}:${H.kind}`)).join(",")}`})(h)} to execute ${ul(t)}`);const m=(function(O,H){const F=q0(H);if(F===void 0)return null;for(const U of Ug(O,F.fieldPath))switch(U.op){case"array-contains-any":return U.value.arrayValue.values||[];case"array-contains":return[U.value]}return null})(d,h),_=(function(O,H){const F=new Map;for(const U of Ho(H))for(const C of Ug(O,U.fieldPath))switch(C.op){case"==":case"in":F.set(U.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return F.set(U.fieldPath.canonicalString(),C.value),Array.from(F.values())}return null})(d,h),v=(function(O,H){const F=[];let U=!0;for(const C of Ho(H)){const I=C.kind===0?QS(O,C.fieldPath,O.startAt):XS(O,C.fieldPath,O.startAt);F.push(I.value),U&&(U=I.inclusive)}return new Ua(F,U)})(d,h),T=(function(O,H){const F=[];let U=!0;for(const C of Ho(H)){const I=C.kind===0?XS(O,C.fieldPath,O.endAt):QS(O,C.fieldPath,O.endAt);F.push(I.value),U&&(U=I.inclusive)}return new Ua(F,U)})(d,h),S=this.On(h,d,v),E=this.On(h,d,T),R=this.Nn(h,d,_),k=this.Bn(h.indexId,m,S,v.inclusive,E,T.inclusive,R);return W.forEach(k,(L=>s.Y(L,t.limit).next((O=>{O.forEach((H=>{const F=pe.fromSegments(H.documentKey);l.has(F)||(l=l.add(F),c.push(F))}))}))))})).next((()=>c))}return W.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=Oj(ft.create(e.filters,"and")).map((s=>J0(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,s,i,r,l,c){const h=(t!=null?t.length:1)*Math.max(s.length,r.length),d=h/(t!=null?t.length:1),m=[];for(let _=0;_<h;++_){const v=t?this.Ln(t[_/d]):Pm,T=this.kn(e,v,s[_%d],i),S=this.qn(e,v,r[_%d],l),E=c.map((R=>this.kn(e,v,R,!0)));m.push(...this.createRange(T,S,E))}return m}kn(e,t,s,i){const r=new Qo(e,pe.empty(),t,s);return i?r:r.An()}qn(e,t,s,i){const r=new Qo(e,pe.empty(),t,s);return i?r.An():r}xn(e,t){const s=new pA(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((r=>{let l=null;for(const c of r)s.yn(c)&&(!l||c.fields.length>l.fields.length)&&(l=c);return l}))}getIndexType(e,t){let s=2;const i=this.Mn(t);return W.forEach(i,(r=>this.xn(e,r).next((l=>{l?s!==0&&l.fields.length<(function(h){let d=new mt(kt.comparator),m=!1;for(const _ of h.filters)for(const v of _.getFlattenedFilters())v.field.isKeyField()||(v.op==="array-contains"||v.op==="array-contains-any"?m=!0:d=d.add(v.field));for(const _ of h.orderBy)_.field.isKeyField()||(d=d.add(_.field));return d.size+(m?1:0)})(r)&&(s=1):s=0})))).next((()=>(function(l){return l.limit!==null})(t)&&i.length>1&&s===2?1:s))}Qn(e,t){const s=new Ih;for(const i of Ho(e)){const r=t.data.field(i.fieldPath);if(r==null)return null;const l=s.Pn(i.kind);Ko.Kt.Dt(r,l)}return s.un()}Ln(e){const t=new Ih;return Ko.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const s=new Ih;return Ko.Kt.Dt(cl(this.databaseId,t),s.Pn((function(r){const l=Ho(r);return l.length===0?0:l[l.length-1].kind})(e))),s.un()}Nn(e,t,s){if(s===null)return[];let i=[];i.push(new Ih);let r=0;for(const l of Ho(e)){const c=s[r++];for(const h of i)if(this.Un(t,l.fieldPath)&&xd(c))i=this.Kn(i,l,c);else{const d=h.Pn(l.kind);Ko.Kt.Dt(c,d)}}return this.Wn(i)}On(e,t,s){return this.Nn(e,t,s.position)}Wn(e){const t=[];for(let s=0;s<e.length;++s)t[s]=e[s].un();return t}Kn(e,t,s){const i=[...e],r=[];for(const l of s.arrayValue.values||[])for(const c of i){const h=new Ih;h.seed(c.un()),Ko.Kt.Dt(l,h.Pn(t.kind)),r.push(h)}return r}Un(e,t){return!!e.filters.find((s=>s instanceof Xe&&s.field.isEqual(t)&&(s.op==="in"||s.op==="not-in")))}getFieldIndexes(e,t){const s=Rh(e),i=yc(e);return(t?s.J($0,IDBKeyRange.bound(t,t)):s.J()).next((r=>{const l=[];return W.forEach(r,(c=>i.get([c.indexId,this.uid]).next((h=>{l.push((function(m,_){const v=_?new md(_.sequenceNumber,new _s(ml(_.readTime),new pe(vi(_.documentKey)),_.largestBatchId)):md.empty(),T=m.fields.map((([S,E])=>new rg(kt.fromServerFormat(S),E)));return new Mg(m.indexId,m.collectionGroup,T,v)})(c,h))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((s,i)=>{const r=s.indexState.sequenceNumber-i.indexState.sequenceNumber;return r!==0?r:Ve(s.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,s){const i=Rh(e),r=yc(e);return this.Gn(e).next((l=>i.J($0,IDBKeyRange.bound(t,t)).next((c=>W.forEach(c,(h=>r.put(uA(h.indexId,this.uid,l,s))))))))}updateIndexEntries(e,t){const s=new Map;return W.forEach(t,((i,r)=>{const l=s.get(i.collectionGroup);return(l?W.resolve(l):this.getFieldIndexes(e,i.collectionGroup)).next((c=>(s.set(i.collectionGroup,c),W.forEach(c,(h=>this.zn(e,i,h).next((d=>{const m=this.jn(r,h);return d.isEqual(m)?W.resolve():this.Jn(e,r,h,d,m)})))))))}))}Hn(e,t,s,i){return _c(e).put(i.Rn(this.uid,this.$n(s,t.key),t.key))}Yn(e,t,s,i){return _c(e).delete(i.Vn(this.uid,this.$n(s,t.key),t.key))}zn(e,t,s){const i=_c(e);let r=new mt(ua);return i.ee({index:ZR,range:IDBKeyRange.only([s.indexId,this.uid,fg(this.$n(s,t))])},((l,c)=>{r=r.add(new Qo(s.indexId,t,gA(c.arrayValue),gA(c.directionalValue)))})).next((()=>r))}jn(e,t){let s=new mt(ua);const i=this.Qn(t,e);if(i==null)return s;const r=q0(t);if(r!=null){const l=e.data.field(r.fieldPath);if(xd(l))for(const c of l.arrayValue.values||[])s=s.add(new Qo(t.indexId,e.key,this.Ln(c),i))}else s=s.add(new Qo(t.indexId,e.key,Pm,i));return s}Jn(e,t,s,i,r){ce(yA,"Updating index entries for document '%s'",t.key);const l=[];return(function(h,d,m,_,v){const T=h.getIterator(),S=d.getIterator();let E=gc(T),R=gc(S);for(;E||R;){let k=!1,L=!1;if(E&&R){const O=m(E,R);O<0?L=!0:O>0&&(k=!0)}else E!=null?L=!0:k=!0;k?(_(R),R=gc(S)):L?(v(E),E=gc(T)):(E=gc(T),R=gc(S))}})(i,r,ua,(c=>{l.push(this.Hn(e,t,s,c))}),(c=>{l.push(this.Yn(e,t,s,c))})),W.waitFor(l)}Gn(e){let t=1;return yc(e).ee({index:XR,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((s,i,r)=>{r.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,s){s=s.sort(((l,c)=>ua(l,c))).filter(((l,c,h)=>!c||ua(l,h[c-1])!==0));const i=[];i.push(e);for(const l of s){const c=ua(l,e),h=ua(l,t);if(c===0)i[0]=e.An();else if(c>0&&h<0)i.push(l),i.push(l.An());else if(h>0)break}i.push(t);const r=[];for(let l=0;l<i.length;l+=2){if(this.Zn(i[l],i[l+1]))return[];const c=i[l].Vn(this.uid,Pm,pe.empty()),h=i[l+1].Vn(this.uid,Pm,pe.empty());r.push(IDBKeyRange.bound(c,h))}return r}Zn(e,t){return ua(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(vA)}getMinOffset(e,t){return W.mapArray(this.Mn(t),(s=>this.xn(e,s).next((i=>i||xe(44426))))).next(vA)}}function bA(n){return dn(n,yd)}function _c(n){return dn(n,ed)}function Rh(n){return dn(n,uv)}function yc(n){return dn(n,Jh)}function vA(n){we(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let s=1;s<n.length;s++){const i=n[s].indexState.offset;ov(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new _s(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},sD=41943040;class Pn{static withCacheSize(e){return new Pn(e,Pn.DEFAULT_COLLECTION_PERCENTILE,Pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iD(n,e,t){const s=n.store(Ws),i=n.store(Uc),r=[],l=IDBKeyRange.only(t.batchId);let c=0;const h=s.ee({range:l},((m,_,v)=>(c++,v.delete())));r.push(h.next((()=>{we(c===1,47070,{batchId:t.batchId})})));const d=[];for(const m of t.mutations){const _=YR(e,m.key.path,t.batchId);r.push(i.delete(_)),d.push(m.key)}return W.waitFor(r).next((()=>d))}function Hg(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw xe(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Pn.DEFAULT_COLLECTION_PERCENTILE=10,Pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pn.DEFAULT=new Pn(sD,Pn.DEFAULT_COLLECTION_PERCENTILE,Pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pn.DISABLED=new Pn(-1,0,0);class Cp{constructor(e,t,s,i){this.userId=e,this.serializer=t,this.indexManager=s,this.referenceDelegate=i,this.Xn={}}static wt(e,t,s,i){we(e.uid!=="",64387);const r=e.isAuthenticated()?e.uid:"";return new Cp(r,t,s,i)}checkEmpty(e){let t=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ha(e).ee({index:Jo,range:s},((i,r,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,s,i){const r=Ac(e),l=ha(e);return l.add({}).next((c=>{we(typeof c=="number",49019);const h=new vv(c,t,s,i),d=(function(T,S,E){const R=E.baseMutations.map((L=>wd(T.yt,L))),k=E.mutations.map((L=>wd(T.yt,L)));return{userId:S,batchId:E.batchId,localWriteTimeMs:E.localWriteTime.toMillis(),baseMutations:R,mutations:k}})(this.serializer,this.userId,h),m=[];let _=new mt(((v,T)=>Ve(v.canonicalString(),T.canonicalString())));for(const v of i){const T=YR(this.userId,v.key.path,c);_=_.add(v.key.path.popLast()),m.push(l.put(d)),m.push(r.put(T,p4))}return _.forEach((v=>{m.push(this.indexManager.addToCollectionParentIndex(e,v))})),e.addOnCommittedListener((()=>{this.Xn[c]=h.keys()})),W.waitFor(m).next((()=>h))}))}lookupMutationBatch(e,t){return ha(e).get(t).next((s=>s?(we(s.userId===this.userId,48,"Unexpected user for mutation batch",{userId:s.userId,batchId:t}),Yo(this.serializer,s)):null))}er(e,t){return this.Xn[t]?W.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((s=>{if(s){const i=s.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,i=IDBKeyRange.lowerBound([this.userId,s]);let r=null;return ha(e).ee({index:Jo,range:i},((l,c,h)=>{c.userId===this.userId&&(we(c.batchId>=s,47524,{tr:s}),r=Yo(this.serializer,c)),h.done()})).next((()=>r))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=Ra;return ha(e).ee({index:Jo,range:t,reverse:!0},((i,r,l)=>{s=r.batchId,l.done()})).next((()=>s))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Ra],[this.userId,Number.POSITIVE_INFINITY]);return ha(e).J(Jo,t).next((s=>s.map((i=>Yo(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const s=ag(this.userId,t.path),i=IDBKeyRange.lowerBound(s),r=[];return Ac(e).ee({range:i},((l,c,h)=>{const[d,m,_]=l,v=vi(m);if(d===this.userId&&t.path.isEqual(v))return ha(e).get(_).next((T=>{if(!T)throw xe(61480,{nr:l,batchId:_});we(T.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:T.userId,batchId:_}),r.push(Yo(this.serializer,T))}));h.done()})).next((()=>r))}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new mt(Ve);const i=[];return t.forEach((r=>{const l=ag(this.userId,r.path),c=IDBKeyRange.lowerBound(l),h=Ac(e).ee({range:c},((d,m,_)=>{const[v,T,S]=d,E=vi(T);v===this.userId&&r.path.isEqual(E)?s=s.add(S):_.done()}));i.push(h)})),W.waitFor(i).next((()=>this.rr(e,s)))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,i=s.length+1,r=ag(this.userId,s),l=IDBKeyRange.lowerBound(r);let c=new mt(Ve);return Ac(e).ee({range:l},((h,d,m)=>{const[_,v,T]=h,S=vi(v);_===this.userId&&s.isPrefixOf(S)?S.length===i&&(c=c.add(T)):m.done()})).next((()=>this.rr(e,c)))}rr(e,t){const s=[],i=[];return t.forEach((r=>{i.push(ha(e).get(r).next((l=>{if(l===null)throw xe(35274,{batchId:r});we(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:r}),s.push(Yo(this.serializer,l))})))})),W.waitFor(i).next((()=>s))}removeMutationBatch(e,t){return iD(e.le,this.userId,t).next((s=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),W.forEach(s,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return W.resolve();const s=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),i=[];return Ac(e).ee({range:s},((r,l,c)=>{if(r[0]===this.userId){const h=vi(r[1]);i.push(h)}else c.done()})).next((()=>{we(i.length===0,56720,{sr:i.map((r=>r.canonicalString()))})}))}))}containsKey(e,t){return rD(e,this.userId,t)}_r(e){return aD(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Ra,lastStreamToken:""}))}}function rD(n,e,t){const s=ag(e,t.path),i=s[1],r=IDBKeyRange.lowerBound(s);let l=!1;return Ac(n).ee({range:r,X:!0},((c,h,d)=>{const[m,_,v]=c;m===e&&_===i&&(l=!0),d.done()})).next((()=>l))}function ha(n){return dn(n,Ws)}function Ac(n){return dn(n,Uc)}function aD(n){return dn(n,pd)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new gl(0)}static cr(){return new gl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lj{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const s=new gl(t.highestTargetId);return t.highestTargetId=s.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Re.fromTimestamp(new lt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,s){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,s&&(i.lastRemoteSnapshotVersion=s.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((s=>(s.targetCount+=1,this.Tr(t,s),this.hr(e,s))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>bc(e).delete(t.targetId))).next((()=>this.lr(e))).next((s=>(we(s.targetCount>0,8065),s.targetCount-=1,this.hr(e,s))))}removeTargets(e,t,s){let i=0;const r=[];return bc(e).ee(((l,c)=>{const h=Bh(c);h.sequenceNumber<=t&&s.get(h.targetId)===null&&(i++,r.push(this.removeTargetData(e,h)))})).next((()=>W.waitFor(r))).next((()=>i))}forEachTarget(e,t){return bc(e).ee(((s,i)=>{const r=Bh(i);t(r)}))}lr(e){return TA(e).get(Vg).next((t=>(we(t!==null,2888),t)))}hr(e,t){return TA(e).put(Vg,t)}Pr(e,t){return bc(e).put(eD(this.serializer,t))}Tr(e,t){let s=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,s=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const s=ul(t),i=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let r=null;return bc(e).ee({range:i,index:QR},((l,c,h)=>{const d=Bh(c);Kd(t,d.target)&&(r=d,h.done())})).next((()=>r))}addMatchingKeys(e,t,s){const i=[],r=ba(e);return t.forEach((l=>{const c=Un(l.path);i.push(r.put({targetId:s,path:c})),i.push(this.referenceDelegate.addReference(e,s,l))})),W.waitFor(i)}removeMatchingKeys(e,t,s){const i=ba(e);return W.forEach(t,(r=>{const l=Un(r.path);return W.waitFor([i.delete([s,l]),this.referenceDelegate.removeReference(e,s,r)])}))}removeMatchingKeysForTargetId(e,t){const s=ba(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return s.delete(i)}getMatchingKeysForTargetId(e,t){const s=IDBKeyRange.bound([t],[t+1],!1,!0),i=ba(e);let r=Fe();return i.ee({range:s,X:!0},((l,c,h)=>{const d=vi(l[1]),m=new pe(d);r=r.add(m)})).next((()=>r))}containsKey(e,t){const s=Un(t.path),i=IDBKeyRange.bound([s],[jR(s)],!1,!0);let r=0;return ba(e).ee({index:cv,X:!0,range:i},(([l,c],h,d)=>{l!==0&&(r++,d.done())})).next((()=>r>0))}At(e,t){return bc(e).get(t).next((s=>s?Bh(s):null))}}function bc(n){return dn(n,Bc)}function TA(n){return dn(n,rl)}function ba(n){return dn(n,Fc)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EA="LruGarbageCollector",jj=1048576;function wA([n,e],[t,s]){const i=Ve(n,t);return i===0?Ve(e,s):i}class Uj{constructor(e){this.Ir=e,this.buffer=new mt(wA),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();wA(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class oD{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ce(EA,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ka(t)?ce(EA,"Ignoring IndexedDB error during garbage collection: ",t):await Ya(t)}await this.Vr(3e5)}))}}class Bj{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return W.resolve(ss.ce);const s=new Uj(t);return this.mr.forEachTarget(e,(i=>s.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>s.Ar(i))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ce("LruGarbageCollector","Garbage collection skipped; disabled"),W.resolve(xA)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),xA):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,i,r,l,c,h,d;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),i=this.params.maximumSequenceNumbersToCollect):i=_,l=Date.now(),this.nthSequenceNumber(e,i)))).next((_=>(s=_,c=Date.now(),this.removeTargets(e,s,t)))).next((_=>(r=_,h=Date.now(),this.removeOrphanedDocuments(e,s)))).next((_=>(d=Date.now(),Tc()<=Ye.DEBUG&&ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-m}ms
	Determined least recently used ${i} in `+(c-l)+`ms
	Removed ${r} targets in `+(h-c)+`ms
	Removed ${_} documents in `+(d-h)+`ms
Total Duration: ${d-m}ms`),W.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:r,documentsRemoved:_}))))}}function lD(n,e){return new Bj(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fj{constructor(e,t){this.db=e,this.garbageCollector=lD(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((s=>t.next((i=>s+i))))}wr(e){let t=0;return this.pr(e,(s=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((s,i)=>t(i)))}addReference(e,t,s){return Vm(e,s)}removeReference(e,t,s){return Vm(e,s)}removeTargets(e,t,s){return this.db.getTargetCache().removeTargets(e,t,s)}markPotentiallyOrphaned(e,t){return Vm(e,t)}br(e,t){return(function(i,r){let l=!1;return aD(i).te((c=>rD(i,c,r).next((h=>(h&&(l=!0),W.resolve(!h)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let r=0;return this.Sr(e,((l,c)=>{if(c<=t){const h=this.br(e,l).next((d=>{if(!d)return r++,s.getEntry(e,l).next((()=>(s.removeEntry(l,Re.min()),ba(e).delete((function(_){return[0,Un(_.path)]})(l)))))}));i.push(h)}})).next((()=>W.waitFor(i))).next((()=>s.apply(e))).next((()=>r))}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,t){return Vm(e,t)}Sr(e,t){const s=ba(e);let i,r=ss.ce;return s.ee({index:cv},(([l,c],{path:h,sequenceNumber:d})=>{l===0?(r!==ss.ce&&t(new pe(vi(i)),r),r=d,i=h):r=ss.ce})).next((()=>{r!==ss.ce&&t(new pe(vi(i)),r)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Vm(n,e){return ba(n).put((function(s,i){return{targetId:0,path:Un(s.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(){this.changes=new vr((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,It.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?W.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,s){return Lo(e).put(s)}removeEntry(e,t,s){return Lo(e).delete((function(r,l){const c=r.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],Fg(l),c[c.length-1]]})(t,s))}updateMetadata(e,t){return this.getMetadata(e).next((s=>(s.byteSize+=t,this.Dr(e,s))))}getEntry(e,t){let s=It.newInvalidDocument(t);return Lo(e).ee({index:og,range:IDBKeyRange.only(Ch(t))},((i,r)=>{s=this.Cr(t,r)})).next((()=>s))}vr(e,t){let s={size:0,document:It.newInvalidDocument(t)};return Lo(e).ee({index:og,range:IDBKeyRange.only(Ch(t))},((i,r)=>{s={document:this.Cr(t,r),size:Hg(r)}})).next((()=>s))}getEntries(e,t){let s=rs();return this.Fr(e,t,((i,r)=>{const l=this.Cr(i,r);s=s.insert(i,l)})).next((()=>s))}Mr(e,t){let s=rs(),i=new St(pe.comparator);return this.Fr(e,t,((r,l)=>{const c=this.Cr(r,l);s=s.insert(r,c),i=i.insert(r,Hg(l))})).next((()=>({documents:s,Or:i})))}Fr(e,t,s){if(t.isEmpty())return W.resolve();let i=new mt(IA);t.forEach((h=>i=i.add(h)));const r=IDBKeyRange.bound(Ch(i.first()),Ch(i.last())),l=i.getIterator();let c=l.getNext();return Lo(e).ee({index:og,range:r},((h,d,m)=>{const _=pe.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;c&&IA(c,_)<0;)s(c,null),c=l.getNext();c&&c.isEqual(_)&&(s(c,d),c=l.hasNext()?l.getNext():null),c?m.j(Ch(c)):m.done()})).next((()=>{for(;c;)s(c,null),c=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,s,i,r){const l=t.path,c=[l.popLast().toArray(),l.lastSegment(),Fg(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],h=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Lo(e).J(IDBKeyRange.bound(c,h,!0)).next((d=>{r==null||r.incrementDocumentReadCount(d.length);let m=rs();for(const _ of d){const v=this.Cr(pe.fromSegments(_.prefixPath.concat(_.collectionGroup,_.documentId)),_);v.isFoundDocument()&&(Xd(t,v)||i.has(v.key))&&(m=m.insert(v.key,v))}return m}))}getAllFromCollectionGroup(e,t,s,i){let r=rs();const l=AA(t,s),c=AA(t,_s.max());return Lo(e).ee({index:KR,range:IDBKeyRange.bound(l,c,!0)},((h,d,m)=>{const _=this.Cr(pe.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);r=r.insert(_.key,_),r.size===i&&m.done()})).next((()=>r))}newChangeBuffer(e){return new Hj(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return SA(e).get(G0).next((t=>(we(!!t,20021),t)))}Dr(e,t){return SA(e).put(G0,t)}Cr(e,t){if(t){const s=Ij(this.serializer,t);if(!(s.isNoDocument()&&s.version.isEqual(Re.min())))return s}return It.newInvalidDocument(e)}}function uD(n){return new zj(n)}class Hj extends cD{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new vr((s=>s.toString()),((s,i)=>s.isEqual(i)))}applyChanges(e){const t=[];let s=0,i=new mt(((r,l)=>Ve(r.canonicalString(),l.canonicalString())));return this.changes.forEach(((r,l)=>{const c=this.Br.get(r);if(t.push(this.Nr.removeEntry(e,r,c.readTime)),l.isValidDocument()){const h=lA(this.Nr.serializer,l);i=i.add(r.path.popLast());const d=Hg(h);s+=d-c.size,t.push(this.Nr.addEntry(e,r,h))}else if(s-=c.size,this.trackRemovals){const h=lA(this.Nr.serializer,l.convertToNoDocument(Re.min()));t.push(this.Nr.addEntry(e,r,h))}})),i.forEach((r=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,r))})),t.push(this.Nr.updateMetadata(e,s)),W.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((s=>(this.Br.set(t,{size:s.size,readTime:s.document.readTime}),s.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:s,Or:i})=>(i.forEach(((r,l)=>{this.Br.set(r,{size:l,readTime:s.get(r).readTime})})),s)))}}function SA(n){return dn(n,_d)}function Lo(n){return dn(n,Pg)}function Ch(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function AA(n,e){const t=e.documentKey.path.toArray();return[n,Fg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function IA(n,e){const t=n.path.toArray(),s=e.path.toArray();let i=0;for(let r=0;r<t.length-2&&r<s.length-2;++r)if(i=Ve(t[r],s[r]),i)return i;return i=Ve(t.length,s.length),i||(i=Ve(t[t.length-2],s[s.length-2]),i||Ve(t[t.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e,t,s,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=i}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(s=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(s!==null&&sd(s.mutation,i,is.empty(),lt.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,Fe()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=Fe()){const i=xi();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,s).next((r=>{let l=jh();return r.forEach(((c,h)=>{l=l.insert(c,h.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const s=xi();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,Fe())))}populateOverlays(e,t,s){const i=[];return s.forEach((r=>{t.has(r)||i.push(r)})),this.documentOverlayCache.getOverlays(e,i).next((r=>{r.forEach(((l,c)=>{t.set(l,c)}))}))}computeViews(e,t,s,i){let r=rs();const l=nd(),c=(function(){return nd()})();return t.forEach(((h,d)=>{const m=s.get(d.key);i.has(d.key)&&(m===void 0||m.mutation instanceof xr)?r=r.insert(d.key,d):m!==void 0?(l.set(d.key,m.mutation.getFieldMask()),sd(m.mutation,d,m.mutation.getFieldMask(),lt.now())):l.set(d.key,is.empty())})),this.recalculateAndSaveOverlays(e,r).next((h=>(h.forEach(((d,m)=>l.set(d,m))),t.forEach(((d,m)=>c.set(d,new qj(m,l.get(d)??null)))),c)))}recalculateAndSaveOverlays(e,t){const s=nd();let i=new St(((l,c)=>l-c)),r=Fe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const c of l)c.keys().forEach((h=>{const d=t.get(h);if(d===null)return;let m=s.get(h)||is.empty();m=c.applyToLocalView(d,m),s.set(h,m);const _=(i.get(c.batchId)||Fe()).add(h);i=i.insert(c.batchId,_)}))})).next((()=>{const l=[],c=i.getReverseIterator();for(;c.hasNext();){const h=c.getNext(),d=h.key,m=h.value,_=IC();m.forEach((v=>{if(!r.has(v)){const T=OC(t.get(v),s.get(v));T!==null&&_.set(v,T),r=r.add(v)}})),l.push(this.documentOverlayCache.saveOverlays(e,d,_))}return W.waitFor(l)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,i){return(function(l){return pe.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):pv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,i):this.getDocumentsMatchingCollectionQuery(e,t,s,i)}getNextDocuments(e,t,s,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,i).next((r=>{const l=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,i-r.size):W.resolve(xi());let c=jc,h=r;return l.next((d=>W.forEach(d,((m,_)=>(c<_.largestBatchId&&(c=_.largestBatchId),r.get(m)?W.resolve():this.remoteDocumentCache.getEntry(e,m).next((v=>{h=h.insert(m,v)}))))).next((()=>this.populateOverlays(e,d,r))).next((()=>this.computeViews(e,h,d,Fe()))).next((m=>({batchId:c,changes:AC(m)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new pe(t)).next((s=>{let i=jh();return s.isFoundDocument()&&(i=i.insert(s.key,s)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,i){const r=t.collectionGroup;let l=jh();return this.indexManager.getCollectionParents(e,r).next((c=>W.forEach(c,(h=>{const d=(function(_,v){return new br(v,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,h.child(r));return this.getDocumentsMatchingCollectionQuery(e,d,s,i).next((m=>{m.forEach(((_,v)=>{l=l.insert(_,v)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,s,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((l=>(r=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,r,i)))).next((l=>{r.forEach(((h,d)=>{const m=d.getKey();l.get(m)===null&&(l=l.insert(m,It.newInvalidDocument(m)))}));let c=jh();return l.forEach(((h,d)=>{const m=r.get(h);m!==void 0&&sd(m.mutation,d,is.empty(),lt.now()),Xd(t,d)&&(c=c.insert(h,d))})),c}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gj{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return W.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Xt(i.createTime)}})(t)),W.resolve()}getNamedQuery(e,t){return W.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:Sv(i.bundledQuery),readTime:Xt(i.readTime)}})(t)),W.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $j{constructor(){this.overlays=new St(pe.comparator),this.qr=new Map}getOverlay(e,t){return W.resolve(this.overlays.get(t))}getOverlays(e,t){const s=xi();return W.forEach(t,(i=>this.getOverlay(e,i).next((r=>{r!==null&&s.set(i,r)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((i,r)=>{this.St(e,t,r)})),W.resolve()}removeOverlaysForBatchId(e,t,s){const i=this.qr.get(s);return i!==void 0&&(i.forEach((r=>this.overlays=this.overlays.remove(r))),this.qr.delete(s)),W.resolve()}getOverlaysForCollection(e,t,s){const i=xi(),r=t.length+1,l=new pe(t.child("")),c=this.overlays.getIteratorFrom(l);for(;c.hasNext();){const h=c.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===r&&h.largestBatchId>s&&i.set(h.getKey(),h)}return W.resolve(i)}getOverlaysForCollectionGroup(e,t,s,i){let r=new St(((d,m)=>d-m));const l=this.overlays.getIterator();for(;l.hasNext();){const d=l.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>s){let m=r.get(d.largestBatchId);m===null&&(m=xi(),r=r.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const c=xi(),h=r.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((d,m)=>c.set(d,m))),!(c.size()>=i)););return W.resolve(c)}St(e,t,s){const i=this.overlays.get(s.key);if(i!==null){const l=this.qr.get(i.largestBatchId).delete(s.key);this.qr.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(s.key,new Tv(t,s));let r=this.qr.get(t);r===void 0&&(r=Fe(),this.qr.set(t,r)),this.qr.set(t,r.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wj{constructor(){this.sessionToken=Ft.EMPTY_BYTE_STRING}getSessionToken(e){return W.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,W.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(){this.Qr=new mt(yn.$r),this.Ur=new mt(yn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new yn(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Gr(new yn(e,t))}zr(e,t){e.forEach((s=>this.removeReference(s,t)))}jr(e){const t=new pe(new Ke([])),s=new yn(t,e),i=new yn(t,e+1),r=[];return this.Ur.forEachInRange([s,i],(l=>{this.Gr(l),r.push(l.key)})),r}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new pe(new Ke([])),s=new yn(t,e),i=new yn(t,e+1);let r=Fe();return this.Ur.forEachInRange([s,i],(l=>{r=r.add(l.key)})),r}containsKey(e){const t=new yn(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class yn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return pe.comparator(e.key,t.key)||Ve(e.Yr,t.Yr)}static Kr(e,t){return Ve(e.Yr,t.Yr)||pe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yj{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new mt(yn.$r)}checkEmpty(e){return W.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,i){const r=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new vv(r,t,s,i);this.mutationQueue.push(l);for(const c of i)this.Zr=this.Zr.add(new yn(c.key,r)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return W.resolve(l)}lookupMutationBatch(e,t){return W.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,i=this.ei(s),r=i<0?0:i;return W.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return W.resolve(this.mutationQueue.length===0?Ra:this.tr-1)}getAllMutationBatches(e){return W.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new yn(t,0),i=new yn(t,Number.POSITIVE_INFINITY),r=[];return this.Zr.forEachInRange([s,i],(l=>{const c=this.Xr(l.Yr);r.push(c)})),W.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new mt(Ve);return t.forEach((i=>{const r=new yn(i,0),l=new yn(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([r,l],(c=>{s=s.add(c.Yr)}))})),W.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,i=s.length+1;let r=s;pe.isDocumentKey(r)||(r=r.child(""));const l=new yn(new pe(r),0);let c=new mt(Ve);return this.Zr.forEachWhile((h=>{const d=h.key.path;return!!s.isPrefixOf(d)&&(d.length===i&&(c=c.add(h.Yr)),!0)}),l),W.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((s=>{const i=this.Xr(s);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){we(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return W.forEach(t.mutations,(i=>{const r=new yn(i.key,t.batchId);return s=s.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=s}))}ir(e){}containsKey(e,t){const s=new yn(t,0),i=this.Zr.firstAfterOrEqual(s);return W.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,W.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kj{constructor(e){this.ri=e,this.docs=(function(){return new St(pe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,i=this.docs.get(s),r=i?i.size:0,l=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:l}),this.size+=l-r,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return W.resolve(s?s.document.mutableCopy():It.newInvalidDocument(t))}getEntries(e,t){let s=rs();return t.forEach((i=>{const r=this.docs.get(i);s=s.insert(i,r?r.document.mutableCopy():It.newInvalidDocument(i))})),W.resolve(s)}getDocumentsMatchingQuery(e,t,s,i){let r=rs();const l=t.path,c=new pe(l.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(c);for(;h.hasNext();){const{key:d,value:{document:m}}=h.getNext();if(!l.isPrefixOf(d.path))break;d.path.length>l.length+1||ov(HR(m),s)<=0||(i.has(m.key)||Xd(t,m))&&(r=r.insert(m.key,m.mutableCopy()))}return W.resolve(r)}getAllFromCollectionGroup(e,t,s,i){xe(9500)}ii(e,t){return W.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new Qj(this)}getSize(e){return W.resolve(this.size)}}class Qj extends cD{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((s,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(s)})),W.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xj{constructor(e){this.persistence=e,this.si=new vr((t=>ul(t)),Kd),this.lastRemoteSnapshotVersion=Re.min(),this.highestTargetId=0,this.oi=0,this._i=new Rv,this.targetCount=0,this.ai=gl.ur()}forEachTarget(e,t){return this.si.forEach(((s,i)=>t(i))),W.resolve()}getLastRemoteSnapshotVersion(e){return W.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return W.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),W.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),W.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new gl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,W.resolve()}updateTargetData(e,t){return this.Pr(t),W.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,W.resolve()}removeTargets(e,t,s){let i=0;const r=[];return this.si.forEach(((l,c)=>{c.sequenceNumber<=t&&s.get(c.targetId)===null&&(this.si.delete(l),r.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),W.waitFor(r).next((()=>i))}getTargetCount(e){return W.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return W.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),W.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const i=this.persistence.referenceDelegate,r=[];return i&&t.forEach((l=>{r.push(i.markPotentiallyOrphaned(e,l))})),W.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),W.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return W.resolve(s)}containsKey(e,t){return W.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(e,t){this.ui={},this.overlays={},this.ci=new ss(0),this.li=!1,this.li=!0,this.hi=new Wj,this.referenceDelegate=e(this),this.Pi=new Xj(this),this.indexManager=new Pj,this.remoteDocumentCache=(function(i){return new Kj(i)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new JC(t),this.Ii=new Gj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new $j,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new Yj(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){ce("MemoryPersistence","Starting transaction:",e);const i=new Zj(this.ci.next());return this.referenceDelegate.Ei(),s(i).next((r=>this.referenceDelegate.di(i).next((()=>r)))).toPromise().then((r=>(i.raiseOnCommittedEvent(),r)))}Ai(e,t){return W.or(Object.values(this.ui).map((s=>()=>s.containsKey(e,t))))}}class Zj extends GR{constructor(e){super(),this.currentSequenceNumber=e}}class Dp{constructor(e){this.persistence=e,this.Ri=new Rv,this.Vi=null}static mi(e){return new Dp(e)}get fi(){if(this.Vi)return this.Vi;throw xe(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),W.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),W.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),W.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((r=>this.fi.add(r.toString())))})).next((()=>s.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return W.forEach(this.fi,(s=>{const i=pe.fromPath(s);return this.gi(e,i).next((r=>{r||t.removeEntry(i,Re.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return W.or([()=>W.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class qg{constructor(e,t){this.persistence=e,this.pi=new vr((s=>Un(s.path)),((s,i)=>s.isEqual(i))),this.garbageCollector=lD(this,t)}static mi(e,t){return new qg(e,t)}Ei(){}di(e){return W.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((i=>s+i))))}wr(e){let t=0;return this.pr(e,(s=>{t++})).next((()=>t))}pr(e,t){return W.forEach(this.pi,((s,i)=>this.br(e,s,i).next((r=>r?W.resolve():t(i)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const i=this.persistence.getRemoteDocumentCache(),r=i.newChangeBuffer();return i.ii(e,(l=>this.br(e,l,t).next((c=>{c||(s++,r.removeEntry(l,Re.min()))})))).next((()=>r.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),W.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),W.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),W.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),W.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=cg(e.data.value)),t}br(e,t,s){return W.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return W.resolve(i!==void 0&&i>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jj{constructor(e){this.serializer=e}k(e,t,s,i){const r=new bp("createOrUpgrade",t);s<1&&i>=1&&((function(h){h.createObjectStore(Yd)})(e),(function(h){h.createObjectStore(pd,{keyPath:g4}),h.createObjectStore(Ws,{keyPath:jS,autoIncrement:!0}).createIndex(Jo,US,{unique:!0}),h.createObjectStore(Uc)})(e),RA(e),(function(h){h.createObjectStore(qo)})(e));let l=W.resolve();return s<3&&i>=3&&(s!==0&&((function(h){h.deleteObjectStore(Fc),h.deleteObjectStore(Bc),h.deleteObjectStore(rl)})(e),RA(e)),l=l.next((()=>(function(h){const d=h.store(rl),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Re.min().toTimestamp(),targetCount:0};return d.put(Vg,m)})(r)))),s<4&&i>=4&&(s!==0&&(l=l.next((()=>(function(h,d){return d.store(Ws).J().next((_=>{h.deleteObjectStore(Ws),h.createObjectStore(Ws,{keyPath:jS,autoIncrement:!0}).createIndex(Jo,US,{unique:!0});const v=d.store(Ws),T=_.map((S=>v.put(S)));return W.waitFor(T)}))})(e,r)))),l=l.next((()=>{(function(h){h.createObjectStore(zc,{keyPath:w4})})(e)}))),s<5&&i>=5&&(l=l.next((()=>this.yi(r)))),s<6&&i>=6&&(l=l.next((()=>((function(h){h.createObjectStore(_d)})(e),this.wi(r))))),s<7&&i>=7&&(l=l.next((()=>this.Si(r)))),s<8&&i>=8&&(l=l.next((()=>this.bi(e,r)))),s<9&&i>=9&&(l=l.next((()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)}))),s<10&&i>=10&&(l=l.next((()=>this.Di(r)))),s<11&&i>=11&&(l=l.next((()=>{(function(h){h.createObjectStore(vp,{keyPath:S4})})(e),(function(h){h.createObjectStore(xp,{keyPath:A4})})(e)}))),s<12&&i>=12&&(l=l.next((()=>{(function(h){const d=h.createObjectStore(Tp,{keyPath:M4});d.createIndex(W0,O4,{unique:!1}),d.createIndex(JR,P4,{unique:!1})})(e)}))),s<13&&i>=13&&(l=l.next((()=>(function(h){const d=h.createObjectStore(Pg,{keyPath:_4});d.createIndex(og,y4),d.createIndex(KR,b4)})(e))).next((()=>this.Ci(e,r))).next((()=>e.deleteObjectStore(qo)))),s<14&&i>=14&&(l=l.next((()=>this.Fi(e,r)))),s<15&&i>=15&&(l=l.next((()=>(function(h){h.createObjectStore(uv,{keyPath:I4,autoIncrement:!0}).createIndex($0,R4,{unique:!1}),h.createObjectStore(Jh,{keyPath:C4}).createIndex(XR,D4,{unique:!1}),h.createObjectStore(ed,{keyPath:N4}).createIndex(ZR,k4,{unique:!1})})(e)))),s<16&&i>=16&&(l=l.next((()=>{t.objectStore(Jh).clear()})).next((()=>{t.objectStore(ed).clear()}))),s<17&&i>=17&&(l=l.next((()=>{(function(h){h.createObjectStore(hv,{keyPath:V4})})(e)}))),s<18&&i>=18&&B2()&&(l=l.next((()=>{t.objectStore(Jh).clear()})).next((()=>{t.objectStore(ed).clear()}))),l}wi(e){let t=0;return e.store(qo).ee(((s,i)=>{t+=Hg(i)})).next((()=>{const s={byteSize:t};return e.store(_d).put(G0,s)}))}yi(e){const t=e.store(pd),s=e.store(Ws);return t.J().next((i=>W.forEach(i,(r=>{const l=IDBKeyRange.bound([r.userId,Ra],[r.userId,r.lastAcknowledgedBatchId]);return s.J(Jo,l).next((c=>W.forEach(c,(h=>{we(h.userId===r.userId,18650,"Cannot process batch from unexpected user",{batchId:h.batchId});const d=Yo(this.serializer,h);return iD(e,r.userId,d).next((()=>{}))}))))}))))}Si(e){const t=e.store(Fc),s=e.store(qo);return e.store(rl).get(Vg).next((i=>{const r=[];return s.ee(((l,c)=>{const h=new Ke(l),d=(function(_){return[0,Un(_)]})(h);r.push(t.get(d).next((m=>m?W.resolve():(_=>t.put({targetId:0,path:Un(_),sequenceNumber:i.highestListenSequenceNumber}))(h))))})).next((()=>W.waitFor(r)))}))}bi(e,t){e.createObjectStore(yd,{keyPath:E4});const s=t.store(yd),i=new Iv,r=l=>{if(i.add(l)){const c=l.lastSegment(),h=l.popLast();return s.put({collectionId:c,parent:Un(h)})}};return t.store(qo).ee({X:!0},((l,c)=>{const h=new Ke(l);return r(h.popLast())})).next((()=>t.store(Uc).ee({X:!0},(([l,c,h],d)=>{const m=vi(c);return r(m.popLast())}))))}Di(e){const t=e.store(Bc);return t.ee(((s,i)=>{const r=Bh(i),l=eD(this.serializer,r);return t.put(l)}))}Ci(e,t){const s=t.store(qo),i=[];return s.ee(((r,l)=>{const c=t.store(Pg),h=(function(_){return _.document?new pe(Ke.fromString(_.document.name).popFirst(5)):_.noDocument?pe.fromSegments(_.noDocument.path):_.unknownDocument?pe.fromSegments(_.unknownDocument.path):xe(36783)})(l).path.toArray(),d={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(c.put(d))})).next((()=>W.waitFor(i)))}Fi(e,t){const s=t.store(Ws),i=uD(this.serializer),r=new Cv(Dp.mi,this.serializer.yt);return s.J().next((l=>{const c=new Map;return l.forEach((h=>{let d=c.get(h.userId)??Fe();Yo(this.serializer,h).keys().forEach((m=>d=d.add(m))),c.set(h.userId,d)})),W.forEach(c,((h,d)=>{const m=new bn(d),_=Rp.wt(this.serializer,m),v=r.getIndexManager(m),T=Cp.wt(m,this.serializer,v,r.referenceDelegate);return new hD(i,T,_,v).recalculateAndSaveOverlaysForDocumentKeys(new Y0(t,ss.ce),h).next()}))}))}}function RA(n){n.createObjectStore(Fc,{keyPath:x4}).createIndex(cv,T4,{unique:!0}),n.createObjectStore(Bc,{keyPath:"targetId"}).createIndex(QR,v4,{unique:!0}),n.createObjectStore(rl)}const da="IndexedDbPersistence",h0=18e5,d0=5e3,f0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",dD="main";class Dv{constructor(e,t,s,i,r,l,c,h,d,m,_=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=s,this.Mi=r,this.window=l,this.document=c,this.xi=d,this.Oi=m,this.Ni=_,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=v=>Promise.resolve(),!Dv.v())throw new le(ee.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Fj(this,i),this.$i=t+dD,this.serializer=new JC(h),this.Ui=new Ei(this.$i,this.Ni,new Jj(this.serializer)),this.hi=new Cj,this.Pi=new Lj(this.referenceDelegate,this.serializer),this.remoteDocumentCache=uD(this.serializer),this.Ii=new Rj,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,m===!1&&Kt(da,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new le(ee.FAILED_PRECONDITION,f0);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new ss(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Lm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ka(e))return ce(da,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ce(da,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Dh(e).get(mc).next((t=>W.resolve(this.es(t))))}ts(e){return Lm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,h0)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const s=dn(t,zc);return s.J().next((i=>{const r=this.ss(i,h0),l=i.filter((c=>r.indexOf(c)===-1));return W.forEach(l,(c=>s.delete(c.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?W.resolve(!0):Dh(e).get(mc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,d0)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new le(ee.FAILED_PRECONDITION,f0);return!1}}return!(!this.networkEnabled||!this.inForeground)||Lm(e).J().next((s=>this.ss(s,d0).find((i=>{if(this.clientId!==i.clientId){const r=!this.networkEnabled&&i.networkEnabled,l=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(r||l&&c)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ce(da,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Yd,zc],(e=>{const t=new Y0(e,ss.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((s=>this.rs(s.updateTimeMs,t)&&!this.us(s.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Lm(e).J().next((t=>this.ss(t,h0).map((s=>s.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Cp.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Vj(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Rp.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,s){ce(da,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",r=(function(h){return h===18?U4:h===17?sC:h===16?j4:h===15?dv:h===14?nC:h===13?tC:h===12?L4:h===11?eC:void xe(60245)})(this.Ni);let l;return this.Ui.runTransaction(e,i,r,(c=>(l=new Y0(c,this.ci?this.ci.next():ss.ce),t==="readwrite-primary"?this.Hi(l).next((h=>!!h||this.Yi(l))).next((h=>{if(!h)throw Kt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new le(ee.FAILED_PRECONDITION,qR);return s(l)})).next((h=>this.Xi(l).next((()=>h)))):this.Is(l).next((()=>s(l)))))).then((c=>(l.raiseOnCommittedEvent(),c)))}Is(e){return Dh(e).get(mc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,d0)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new le(ee.FAILED_PRECONDITION,f0)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Dh(e).put(mc,t)}static v(){return Ei.v()}Zi(e){const t=Dh(e);return t.get(mc).next((s=>this.es(s)?(ce(da,"Releasing primary lease."),t.delete(mc)):W.resolve()))}rs(e,t){const s=Date.now();return!(e<s-t)&&(!(e>s)||(Kt(`Detected an update time that is in the future: ${e} > ${s}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;U2()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const s=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return ce(da,`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return Kt(da,"Failed to get zombied client id.",s),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Kt("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Dh(n){return dn(n,Yd)}function Lm(n){return dn(n,zc)}function Nv(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{constructor(e,t,s,i){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=i}static As(e,t){let s=Fe(),i=Fe();for(const r of t.docChanges)switch(r.type){case 0:s=s.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new kv(e,t.fromCache,s,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return U2()?8:$R(hn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,i){const r={result:null};return this.ys(e,t).next((l=>{r.result=l})).next((()=>{if(!r.result)return this.ws(e,t,i,s).next((l=>{r.result=l}))})).next((()=>{if(r.result)return;const l=new e6;return this.Ss(e,t,l).next((c=>{if(r.result=c,this.Vs)return this.bs(e,t,l,c.size)}))})).next((()=>r.result))}bs(e,t,s,i){return s.documentReadCount<this.fs?(Tc()<=Ye.DEBUG&&ce("QueryEngine","SDK will not create cache indexes for query:",Ec(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),W.resolve()):(Tc()<=Ye.DEBUG&&ce("QueryEngine","Query:",Ec(t),"scans",s.documentReadCount,"local documents and returns",i,"documents as results."),s.documentReadCount>this.gs*i?(Tc()<=Ye.DEBUG&&ce("QueryEngine","The SDK decides to create cache indexes for query:",Ec(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Kn(t))):W.resolve())}ys(e,t){if(ZS(t))return W.resolve(null);let s=Kn(t);return this.indexManager.getIndexType(e,s).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=Bg(t,null,"F"),s=Kn(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((r=>{const l=Fe(...r);return this.ps.getDocuments(e,l).next((c=>this.indexManager.getMinOffset(e,s).next((h=>{const d=this.Ds(t,c);return this.Cs(t,d,l,h.readTime)?this.ys(e,Bg(t,null,"F")):this.vs(e,d,t,h)}))))})))))}ws(e,t,s,i){return ZS(t)||i.isEqual(Re.min())?W.resolve(null):this.ps.getDocuments(e,s).next((r=>{const l=this.Ds(t,r);return this.Cs(t,l,s,i)?W.resolve(null):(Tc()<=Ye.DEBUG&&ce("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ec(t)),this.vs(e,l,t,zR(i,jc)).next((c=>c)))}))}Ds(e,t){let s=new mt(wC(e));return t.forEach(((i,r)=>{Xd(e,r)&&(s=s.add(r))})),s}Cs(e,t,s,i){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const r=e.limitType==="F"?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Ss(e,t,s){return Tc()<=Ye.DEBUG&&ce("QueryEngine","Using full collection scan to execute query:",Ec(t)),this.ps.getDocumentsMatchingQuery(e,t,_s.min(),s)}vs(e,t,s,i){return this.ps.getDocumentsMatchingQuery(e,s,i).next((r=>(t.forEach((l=>{r=r.insert(l.key,l)})),r)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mv="LocalStore",t6=3e8;class n6{constructor(e,t,s,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new St(Ve),this.xs=new vr((r=>ul(r)),Kd),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function mD(n,e,t,s){return new n6(n,e,t,s)}async function gD(n,e){const t=ve(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let i;return t.mutationQueue.getAllMutationBatches(s).next((r=>(i=r,t.Bs(e),t.mutationQueue.getAllMutationBatches(s)))).next((r=>{const l=[],c=[];let h=Fe();for(const d of i){l.push(d.batchId);for(const m of d.mutations)h=h.add(m.key)}for(const d of r){c.push(d.batchId);for(const m of d.mutations)h=h.add(m.key)}return t.localDocuments.getDocuments(s,h).next((d=>({Ls:d,removedBatchIds:l,addedBatchIds:c})))}))}))}function s6(n,e){const t=ve(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const i=e.batch.keys(),r=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,h,d,m){const _=d.batch,v=_.keys();let T=W.resolve();return v.forEach((S=>{T=T.next((()=>m.getEntry(h,S))).next((E=>{const R=d.docVersions.get(S);we(R!==null,48541),E.version.compareTo(R)<0&&(_.applyToRemoteDocument(E,d),E.isValidDocument()&&(E.setReadTime(d.commitVersion),m.addEntry(E)))}))})),T.next((()=>c.mutationQueue.removeMutationBatch(h,_)))})(t,s,e,r).next((()=>r.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(c){let h=Fe();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(h=h.add(c.batch.mutations[d].key));return h})(e)))).next((()=>t.localDocuments.getDocuments(s,i)))}))}function pD(n){const e=ve(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function i6(n,e){const t=ve(n),s=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(r=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const c=[];e.targetChanges.forEach(((m,_)=>{const v=i.get(_);if(!v)return;c.push(t.Pi.removeMatchingKeys(r,m.removedDocuments,_).next((()=>t.Pi.addMatchingKeys(r,m.addedDocuments,_))));let T=v.withSequenceNumber(r.currentSequenceNumber);e.targetMismatches.get(_)!==null?T=T.withResumeToken(Ft.EMPTY_BYTE_STRING,Re.min()).withLastLimboFreeSnapshotVersion(Re.min()):m.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(m.resumeToken,s)),i=i.insert(_,T),(function(E,R,k){return E.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=t6?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0})(v,T,m)&&c.push(t.Pi.updateTargetData(r,T))}));let h=rs(),d=Fe();if(e.documentUpdates.forEach((m=>{e.resolvedLimboDocuments.has(m)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(r,m))})),c.push(_D(r,l,e.documentUpdates).next((m=>{h=m.ks,d=m.qs}))),!s.isEqual(Re.min())){const m=t.Pi.getLastRemoteSnapshotVersion(r).next((_=>t.Pi.setTargetsMetadata(r,r.currentSequenceNumber,s)));c.push(m)}return W.waitFor(c).next((()=>l.apply(r))).next((()=>t.localDocuments.getLocalViewOfDocuments(r,h,d))).next((()=>h))})).then((r=>(t.Ms=i,r)))}function _D(n,e,t){let s=Fe(),i=Fe();return t.forEach((r=>s=s.add(r))),e.getEntries(n,s).next((r=>{let l=rs();return t.forEach(((c,h)=>{const d=r.get(c);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),h.isNoDocument()&&h.version.isEqual(Re.min())?(e.removeEntry(c,h.readTime),l=l.insert(c,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),l=l.insert(c,h)):ce(Mv,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",h.version)})),{ks:l,qs:i}}))}function r6(n,e){const t=ve(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=Ra),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function Kc(n,e){const t=ve(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let i;return t.Pi.getTargetData(s,e).next((r=>r?(i=r,W.resolve(i)):t.Pi.allocateTargetId(s).next((l=>(i=new lr(e,l,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,i).next((()=>i)))))))})).then((s=>{const i=t.Ms.get(s.targetId);return(i===null||s.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s}))}async function Qc(n,e,t){const s=ve(n),i=s.Ms.get(e),r=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",r,(l=>s.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!Ka(l))throw l;ce(Mv,`Failed to update sequence numbers for target ${e}: ${l}`)}s.Ms=s.Ms.remove(e),s.xs.delete(i.target)}function Gg(n,e,t){const s=ve(n);let i=Re.min(),r=Fe();return s.persistence.runTransaction("Execute query","readwrite",(l=>(function(h,d,m){const _=ve(h),v=_.xs.get(m);return v!==void 0?W.resolve(_.Ms.get(v)):_.Pi.getTargetData(d,m)})(s,l,Kn(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(l,c.targetId).next((h=>{r=h}))})).next((()=>s.Fs.getDocumentsMatchingQuery(l,e,t?i:Re.min(),t?r:Fe()))).next((c=>(vD(s,EC(e),c),{documents:c,Qs:r})))))}function yD(n,e){const t=ve(n),s=ve(t.Pi),i=t.Ms.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",(r=>s.At(r,e).next((l=>l?l.target:null))))}function bD(n,e){const t=ve(n),s=t.Os.get(e)||Re.min();return t.persistence.runTransaction("Get new document changes","readonly",(i=>t.Ns.getAllFromCollectionGroup(i,e,zR(s,jc),Number.MAX_SAFE_INTEGER))).then((i=>(vD(t,e,i),i)))}function vD(n,e,t){let s=n.Os.get(e)||Re.min();t.forEach(((i,r)=>{r.readTime.compareTo(s)>0&&(s=r.readTime)})),n.Os.set(e,s)}async function a6(n,e,t,s){const i=ve(n);let r=Fe(),l=rs();for(const d of t){const m=e.$s(d.metadata.name);d.document&&(r=r.add(m));const _=e.Us(d);_.setReadTime(e.Ks(d.metadata.readTime)),l=l.insert(m,_)}const c=i.Ns.newChangeBuffer({trackRemovals:!0}),h=await Kc(i,(function(m){return Kn(du(Ke.fromString(`__bundle__/docs/${m}`)))})(s));return i.persistence.runTransaction("Apply bundle documents","readwrite",(d=>_D(d,c,l).next((m=>(c.apply(d),m))).next((m=>i.Pi.removeMatchingKeysForTargetId(d,h.targetId).next((()=>i.Pi.addMatchingKeys(d,r,h.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(d,m.ks,m.qs))).next((()=>m.ks))))))}async function o6(n,e,t=Fe()){const s=await Kc(n,Kn(Sv(e.bundledQuery))),i=ve(n);return i.persistence.runTransaction("Save named query","readwrite",(r=>{const l=Xt(e.readTime);if(s.snapshotVersion.compareTo(l)>=0)return i.Ii.saveNamedQuery(r,e);const c=s.withResumeToken(Ft.EMPTY_BYTE_STRING,l);return i.Ms=i.Ms.insert(c.targetId,c),i.Pi.updateTargetData(r,c).next((()=>i.Pi.removeMatchingKeysForTargetId(r,s.targetId))).next((()=>i.Pi.addMatchingKeys(r,t,s.targetId))).next((()=>i.Ii.saveNamedQuery(r,e)))}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xD="firestore_clients";function CA(n,e){return`${xD}_${n}_${e}`}const TD="firestore_mutations";function DA(n,e,t){let s=`${TD}_${n}_${t}`;return e.isAuthenticated()&&(s+=`_${e.uid}`),s}const ED="firestore_targets";function m0(n,e){return`${ED}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi="SharedClientState";class $g{constructor(e,t,s,i){this.user=e,this.batchId=t,this.state=s,this.error=i}static Ws(e,t,s){const i=JSON.parse(s);let r,l=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return l&&i.error&&(l=typeof i.error.message=="string"&&typeof i.error.code=="string",l&&(r=new le(i.error.code,i.error.message))),l?new $g(e,t,i.state,r):(Kt(bi,`Failed to parse mutation state for ID '${t}': ${s}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class id{constructor(e,t,s){this.targetId=e,this.state=t,this.error=s}static Ws(e,t){const s=JSON.parse(t);let i,r=typeof s=="object"&&["not-current","current","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return r&&s.error&&(r=typeof s.error.message=="string"&&typeof s.error.code=="string",r&&(i=new le(s.error.code,s.error.message))),r?new id(e,s.state,i):(Kt(bi,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Wg{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const s=JSON.parse(t);let i=typeof s=="object"&&s.activeTargetIds instanceof Array,r=_v();for(let l=0;i&&l<s.activeTargetIds.length;++l)i=WR(s.activeTargetIds[l]),r=r.add(s.activeTargetIds[l]);return i?new Wg(e,r):(Kt(bi,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Ov{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Ov(t.clientId,t.onlineState):(Kt(bi,`Failed to parse online state: ${e}`),null)}}class lb{constructor(){this.activeTargetIds=_v()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class g0{constructor(e,t,s,i,r){this.window=e,this.Mi=t,this.persistenceKey=s,this.Js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new St(Ve),this.started=!1,this.Xs=[];const l=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=r,this.eo=CA(this.persistenceKey,this.Js),this.no=(function(h){return`firestore_sequence_number_${h}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new lb),this.ro=new RegExp(`^${xD}_${l}_([^_]*)$`),this.io=new RegExp(`^${TD}_${l}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${ED}_${l}_(\\d+)$`),this.oo=(function(h){return`firestore_online_state_${h}`})(this.persistenceKey),this._o=(function(h){return`firestore_bundle_loaded_v2_${h}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const s of e){if(s===this.Js)continue;const i=this.getItem(CA(this.persistenceKey,s));if(i){const r=Wg.Ws(s,i);r&&(this.Zs=this.Zs.insert(r.clientId,r))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const s=this.uo(t);s&&this.co(s)}for(const s of this.Xs)this.Ys(s);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((s,i)=>{i.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,s){this.ho(e,t,s),this.Po(e)}addLocalQueryTarget(e,t=!0){let s="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(m0(this.persistenceKey,e));if(i){const r=id.Ws(e,i);r&&(s=r.state)}}return t&&this.To.zs(e),this.ao(),s}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(m0(this.persistenceKey,e))}updateQueryState(e,t,s){this.Io(e,t,s)}handleUserChange(e,t,s){t.forEach((i=>{this.Po(i)})),this.currentUser=e,s.forEach((i=>{this.addPendingMutation(i)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ce(bi,"READ",e,t),t}setItem(e,t){ce(bi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){ce(bi,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(ce(bi,"EVENT",t.key,t.newValue),t.key===this.eo)return void Kt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const s=this.Ro(t.key);return this.Vo(s,null)}{const s=this.mo(t.key,t.newValue);if(s)return this.Vo(s.clientId,s)}}else if(this.io.test(t.key)){if(t.newValue!==null){const s=this.fo(t.key,t.newValue);if(s)return this.po(s)}}else if(this.so.test(t.key)){if(t.newValue!==null){const s=this.yo(t.key,t.newValue);if(s)return this.wo(s)}}else if(t.key===this.oo){if(t.newValue!==null){const s=this.uo(t.newValue);if(s)return this.co(s)}}else if(t.key===this.no){const s=(function(r){let l=ss.ce;if(r!=null)try{const c=JSON.parse(r);we(typeof c=="number",30636,{So:r}),l=c}catch(c){Kt(bi,"Failed to read sequence number from WebStorage",c)}return l})(t.newValue);s!==ss.ce&&this.sequenceNumberHandler(s)}else if(t.key===this._o){const s=this.bo(t.newValue);await Promise.all(s.map((i=>this.syncEngine.Do(i))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,s){const i=new $g(this.currentUser,e,t,s),r=DA(this.persistenceKey,this.currentUser,e);this.setItem(r,i.Gs())}Po(e){const t=DA(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,s){const i=m0(this.persistenceKey,e),r=new id(e,t,s);this.setItem(i,r.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const s=this.Ro(e);return Wg.Ws(s,t)}fo(e,t){const s=this.io.exec(e),i=Number(s[1]),r=s[2]!==void 0?s[2]:null;return $g.Ws(new bn(r),i,t)}yo(e,t){const s=this.so.exec(e),i=Number(s[1]);return id.Ws(i,t)}uo(e){return Ov.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);ce(bi,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const s=t?this.Zs.insert(e,t):this.Zs.remove(e),i=this.lo(this.Zs),r=this.lo(s),l=[],c=[];return r.forEach((h=>{i.has(h)||l.push(h)})),i.forEach((h=>{r.has(h)||c.push(h)})),this.syncEngine.Fo(l,c).then((()=>{this.Zs=s}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=_v();return e.forEach(((s,i)=>{t=t.unionWith(i.activeTargetIds)})),t}}class wD{constructor(){this.Mo=new lb,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new lb,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA="ConnectivityMonitor";class kA{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ce(NA,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ce(NA,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jm=null;function cb(){return jm===null?jm=(function(){return 268435456+Math.round(2147483648*Math.random())})():jm++,"0x"+jm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p0="RestConnection",c6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class u6{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${i}`,this.Wo=this.databaseId.database===Lg?`project_id=${s}`:`project_id=${s}&database_id=${i}`}Go(e,t,s,i,r){const l=cb(),c=this.zo(e,t.toUriEncodedString());ce(p0,`Sending RPC '${e}' ${l}:`,c,s);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,i,r);const{host:d}=new URL(c),m=cu(d);return this.Jo(e,c,h,s,m).then((_=>(ce(p0,`Received RPC '${e}' ${l}: `,_),_)),(_=>{throw Ci(p0,`RPC '${e}' ${l} failed with error: `,_,"url: ",c,"request:",s),_}))}Ho(e,t,s,i,r,l){return this.Go(e,t,s,i,r)}jo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+hu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,r)=>e[r]=i)),s&&s.headers.forEach(((i,r)=>e[r]=i))}zo(e,t){const s=c6[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mn="WebChannelConnection";class d6 extends u6{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,i,r){const l=cb();return new Promise(((c,h)=>{const d=new NR;d.setWithCredentials(!0),d.listenOnce(kR.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case ig.NO_ERROR:const _=d.getResponseJson();ce(Mn,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(_)),c(_);break;case ig.TIMEOUT:ce(Mn,`RPC '${e}' ${l} timed out`),h(new le(ee.DEADLINE_EXCEEDED,"Request time out"));break;case ig.HTTP_ERROR:const v=d.getStatus();if(ce(Mn,`RPC '${e}' ${l} failed with status:`,v,"response text:",d.getResponseText()),v>0){let T=d.getResponseJson();Array.isArray(T)&&(T=T[0]);const S=T==null?void 0:T.error;if(S&&S.status&&S.message){const E=(function(k){const L=k.toLowerCase().replace(/_/g,"-");return Object.values(ee).indexOf(L)>=0?L:ee.UNKNOWN})(S.status);h(new le(E,S.message))}else h(new le(ee.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new le(ee.UNAVAILABLE,"Connection failed."));break;default:xe(9055,{l_:e,streamId:l,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{ce(Mn,`RPC '${e}' ${l} completed.`)}}));const m=JSON.stringify(i);ce(Mn,`RPC '${e}' ${l} sending request:`,i),d.send(t,"POST",m,s,15)}))}T_(e,t,s){const i=cb(),r=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=PR(),c=OR(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,t,s),h.encodeInitMessageHeaders=!0;const m=r.join("");ce(Mn,`Creating RPC '${e}' stream ${i}: ${m}`,h);const _=l.createWebChannel(m,h);this.I_(_);let v=!1,T=!1;const S=new h6({Yo:R=>{T?ce(Mn,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(v||(ce(Mn,`Opening RPC '${e}' stream ${i} transport.`),_.open(),v=!0),ce(Mn,`RPC '${e}' stream ${i} sending:`,R),_.send(R))},Zo:()=>_.close()}),E=(R,k,L)=>{R.listen(k,(O=>{try{L(O)}catch(H){setTimeout((()=>{throw H}),0)}}))};return E(_,Lh.EventType.OPEN,(()=>{T||(ce(Mn,`RPC '${e}' stream ${i} transport opened.`),S.o_())})),E(_,Lh.EventType.CLOSE,(()=>{T||(T=!0,ce(Mn,`RPC '${e}' stream ${i} transport closed`),S.a_(),this.E_(_))})),E(_,Lh.EventType.ERROR,(R=>{T||(T=!0,Ci(Mn,`RPC '${e}' stream ${i} transport errored. Name:`,R.name,"Message:",R.message),S.a_(new le(ee.UNAVAILABLE,"The operation could not be completed")))})),E(_,Lh.EventType.MESSAGE,(R=>{var k;if(!T){const L=R.data[0];we(!!L,16349);const O=L,H=(O==null?void 0:O.error)||((k=O[0])==null?void 0:k.error);if(H){ce(Mn,`RPC '${e}' stream ${i} received error:`,H);const F=H.status;let U=(function(N){const V=tn[N];if(V!==void 0)return LC(V)})(F),C=H.message;U===void 0&&(U=ee.INTERNAL,C="Unknown error status: "+F+" with message "+H.message),T=!0,S.a_(new le(U,C)),_.close()}else ce(Mn,`RPC '${e}' stream ${i} received:`,L),S.u_(L)}})),E(c,MR.STAT_EVENT,(R=>{R.stat===z0.PROXY?ce(Mn,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===z0.NOPROXY&&ce(Mn,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SD(){return typeof window<"u"?window:null}function mg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tf(n){return new _j(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(e,t,s=1e3,i=1.5,r=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=i,this.R_=r,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-s);i>0&&ce("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MA="PersistentStream";class AD{constructor(e,t,s,i,r,l,c,h){this.Mi=e,this.S_=s,this.b_=i,this.connection=r,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=c,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Pv(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ee.RESOURCE_EXHAUSTED?(Kt(t.toString()),Kt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,i])=>{this.D_===t&&this.G_(s,i)}),(s=>{e((()=>{const i=new le(ee.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(i)}))}))}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{s((()=>this.listener.Xo()))})),this.stream.t_((()=>{s((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{s((()=>this.z_(i)))})),this.stream.onMessage((i=>{s((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ce(MA,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ce(MA,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class f6 extends AD{constructor(e,t,s,i,r,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,i,l),this.serializer=r}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=vj(this.serializer,e),s=(function(r){if(!("targetChange"in r))return Re.min();const l=r.targetChange;return l.targetIds&&l.targetIds.length?Re.min():l.readTime?Xt(l.readTime):Re.min()})(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=sb(this.serializer),t.addTarget=(function(r,l){let c;const h=l.target;if(c=jg(h)?{documents:WC(r,h)}:{query:YC(r,h).ft},c.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){c.resumeToken=FC(r,l.resumeToken);const d=tb(r,l.expectedCount);d!==null&&(c.expectedCount=d)}else if(l.snapshotVersion.compareTo(Re.min())>0){c.readTime=Yc(r,l.snapshotVersion.toTimestamp());const d=tb(r,l.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,e);const s=Tj(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=sb(this.serializer),t.removeTarget=e,this.q_(t)}}class m6 extends AD{constructor(e,t,s,i,r,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,i,l),this.serializer=r}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return we(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,we(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){we(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=xj(e.writeResults,e.commitTime),s=Xt(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=sb(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>wd(this.serializer,s)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{}class p6 extends g6{constructor(e,t,s,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new le(ee.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,l])=>this.connection.Go(e,nb(t,s),i,r,l))).catch((r=>{throw r.name==="FirebaseError"?(r.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new le(ee.UNKNOWN,r.toString())}))}Ho(e,t,s,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Ho(e,nb(t,s),i,l,c,r))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new le(ee.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class _6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Kt(t),this.aa=!1):ce("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pl="RemoteStore";class y6{constructor(e,t,s,i,r){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=r,this.Aa.Oo((l=>{s.enqueueAndForget((async()=>{Xa(this)&&(ce(pl,"Restarting streams for network reachability change."),await(async function(h){const d=ve(h);d.Ea.add(4),await gu(d),d.Ra.set("Unknown"),d.Ea.delete(4),await nf(d)})(this))}))})),this.Ra=new _6(s,i)}}async function nf(n){if(Xa(n))for(const e of n.da)await e(!0)}async function gu(n){for(const e of n.da)await e(!1)}function Np(n,e){const t=ve(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),jv(t)?Lv(t):_u(t).O_()&&Vv(t,e))}function Xc(n,e){const t=ve(n),s=_u(t);t.Ia.delete(e),s.O_()&&ID(t,e),t.Ia.size===0&&(s.O_()?s.L_():Xa(t)&&t.Ra.set("Unknown"))}function Vv(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Re.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}_u(n).Y_(e)}function ID(n,e){n.Va.Ue(e),_u(n).Z_(e)}function Lv(n){n.Va=new fj({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),_u(n).start(),n.Ra.ua()}function jv(n){return Xa(n)&&!_u(n).x_()&&n.Ia.size>0}function Xa(n){return ve(n).Ea.size===0}function RD(n){n.Va=void 0}async function b6(n){n.Ra.set("Online")}async function v6(n){n.Ia.forEach(((e,t)=>{Vv(n,e)}))}async function x6(n,e){RD(n),jv(n)?(n.Ra.ha(e),Lv(n)):n.Ra.set("Unknown")}async function T6(n,e,t){if(n.Ra.set("Online"),e instanceof BC&&e.state===2&&e.cause)try{await(async function(i,r){const l=r.cause;for(const c of r.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,l),i.Ia.delete(c),i.Va.removeTarget(c))})(n,e)}catch(s){ce(pl,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Yg(n,s)}else if(e instanceof dg?n.Va.Ze(e):e instanceof UC?n.Va.st(e):n.Va.tt(e),!t.isEqual(Re.min()))try{const s=await pD(n.localStore);t.compareTo(s)>=0&&await(function(r,l){const c=r.Va.Tt(l);return c.targetChanges.forEach(((h,d)=>{if(h.resumeToken.approximateByteSize()>0){const m=r.Ia.get(d);m&&r.Ia.set(d,m.withResumeToken(h.resumeToken,l))}})),c.targetMismatches.forEach(((h,d)=>{const m=r.Ia.get(h);if(!m)return;r.Ia.set(h,m.withResumeToken(Ft.EMPTY_BYTE_STRING,m.snapshotVersion)),ID(r,h);const _=new lr(m.target,h,d,m.sequenceNumber);Vv(r,_)})),r.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(s){ce(pl,"Failed to raise snapshot:",s),await Yg(n,s)}}async function Yg(n,e,t){if(!Ka(e))throw e;n.Ea.add(1),await gu(n),n.Ra.set("Offline"),t||(t=()=>pD(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ce(pl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await nf(n)}))}function CD(n,e){return e().catch((t=>Yg(n,t,e)))}async function pu(n){const e=ve(n),t=Ba(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ra;for(;E6(e);)try{const i=await r6(e.localStore,s);if(i===null){e.Ta.length===0&&t.L_();break}s=i.batchId,w6(e,i)}catch(i){await Yg(e,i)}DD(e)&&ND(e)}function E6(n){return Xa(n)&&n.Ta.length<10}function w6(n,e){n.Ta.push(e);const t=Ba(n);t.O_()&&t.X_&&t.ea(e.mutations)}function DD(n){return Xa(n)&&!Ba(n).x_()&&n.Ta.length>0}function ND(n){Ba(n).start()}async function S6(n){Ba(n).ra()}async function A6(n){const e=Ba(n);for(const t of n.Ta)e.ea(t.mutations)}async function I6(n,e,t){const s=n.Ta.shift(),i=xv.from(s,e,t);await CD(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await pu(n)}async function R6(n,e){e&&Ba(n).X_&&await(async function(s,i){if((function(l){return VC(l)&&l!==ee.ABORTED})(i.code)){const r=s.Ta.shift();Ba(s).B_(),await CD(s,(()=>s.remoteSyncer.rejectFailedWrite(r.batchId,i))),await pu(s)}})(n,e),DD(n)&&ND(n)}async function OA(n,e){const t=ve(n);t.asyncQueue.verifyOperationInProgress(),ce(pl,"RemoteStore received new credentials");const s=Xa(t);t.Ea.add(3),await gu(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await nf(t)}async function ub(n,e){const t=ve(n);e?(t.Ea.delete(2),await nf(t)):e||(t.Ea.add(2),await gu(t),t.Ra.set("Unknown"))}function _u(n){return n.ma||(n.ma=(function(t,s,i){const r=ve(t);return r.sa(),new f6(s,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)})(n.datastore,n.asyncQueue,{Xo:b6.bind(null,n),t_:v6.bind(null,n),r_:x6.bind(null,n),H_:T6.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),jv(n)?Lv(n):n.Ra.set("Unknown")):(await n.ma.stop(),RD(n))}))),n.ma}function Ba(n){return n.fa||(n.fa=(function(t,s,i){const r=ve(t);return r.sa(),new m6(s,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:S6.bind(null,n),r_:R6.bind(null,n),ta:A6.bind(null,n),na:I6.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await pu(n)):(await n.fa.stop(),n.Ta.length>0&&(ce(pl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e,t,s,i,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=i,this.removalCallback=r,this.deferred=new Rn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,i,r){const l=Date.now()+s,c=new Uv(e,t,l,i,r);return c.start(s),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new le(ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function yu(n,e){if(Kt("AsyncQueue",`${e}: ${n}`),Ka(n))return new le(ee.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{static emptySet(e){return new kc(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||pe.comparator(t.key,s.key):(t,s)=>pe.comparator(t.key,s.key),this.keyedMap=jh(),this.sortedSet=new St(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof kc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,r=s.getNext().key;if(!i.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new kc;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(){this.ga=new St(pe.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):xe(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Zc{constructor(e,t,s,i,r,l,c,h,d){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=i,this.mutatedKeys=r,this.fromCache=l,this.syncStateChanged=c,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,s,i,r){const l=[];return t.forEach((c=>{l.push({type:0,doc:c})})),new Zc(e,t,kc.emptySet(t),l,s,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==s[i].type||!t[i].doc.isEqual(s[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class D6{constructor(){this.queries=VA(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const i=ve(t),r=i.queries;i.queries=VA(),r.forEach(((l,c)=>{for(const h of c.Sa)h.onError(s)}))})(this,new le(ee.ABORTED,"Firestore shutting down"))}}function VA(){return new vr((n=>TC(n)),Qd)}async function Bv(n,e){const t=ve(n);let s=3;const i=e.query;let r=t.queries.get(i);r?!r.ba()&&e.Da()&&(s=2):(r=new C6,s=e.Da()?0:1);try{switch(s){case 0:r.wa=await t.onListen(i,!0);break;case 1:r.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(l){const c=yu(l,`Initialization of query '${Ec(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,r),r.Sa.push(e),e.va(t.onlineState),r.wa&&e.Fa(r.wa)&&zv(t)}async function Fv(n,e){const t=ve(n),s=e.query;let i=3;const r=t.queries.get(s);if(r){const l=r.Sa.indexOf(e);l>=0&&(r.Sa.splice(l,1),r.Sa.length===0?i=e.Da()?0:1:!r.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function N6(n,e){const t=ve(n);let s=!1;for(const i of e){const r=i.query,l=t.queries.get(r);if(l){for(const c of l.Sa)c.Fa(i)&&(s=!0);l.wa=i}}s&&zv(t)}function k6(n,e,t){const s=ve(n),i=s.queries.get(e);if(i)for(const r of i.Sa)r.onError(t);s.queries.delete(e)}function zv(n){n.Ca.forEach((e=>{e.next()}))}var hb,LA;(LA=hb||(hb={})).Ma="default",LA.Cache="cache";class Hv{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const i of e.docChanges)i.type!==3&&s.push(i);e=new Zc(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Zc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==hb.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M6{constructor(e,t){this.Qa=e,this.byteLength=t}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(e){this.serializer=e}$s(e){return wi(this.serializer,e)}Us(e){return e.metadata.exists?$C(this.serializer,e.document,!1):It.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return Xt(e)}}class O6{constructor(e,t){this.Ua=e,this.serializer=t,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=kD(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++t;const s=Ke.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(s.get(s.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,s=new jA(this.serializer);for(const i of e)if(i.metadata.queries){const r=s.$s(i.metadata.name);for(const l of i.metadata.queries){const c=(t.get(l)||Fe()).add(r);t.set(l,c)}}return t}async ja(e){const t=await a6(e,new jA(this.serializer),this.Wa,this.Ua.id),s=this.za(this.documents);for(const i of this.Ka)await o6(e,i,s.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:t}}}function kD(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e){this.key=e}}class OD{constructor(e){this.key=e}}class PD{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Fe(),this.mutatedKeys=Fe(),this.eu=wC(e),this.tu=new kc(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new PA,i=t?t.tu:this.tu;let r=t?t.mutatedKeys:this.mutatedKeys,l=i,c=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((m,_)=>{const v=i.get(m),T=Xd(this.query,_)?_:null,S=!!v&&this.mutatedKeys.has(v.key),E=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let R=!1;v&&T?v.data.isEqual(T.data)?S!==E&&(s.track({type:3,doc:T}),R=!0):this.su(v,T)||(s.track({type:2,doc:T}),R=!0,(h&&this.eu(T,h)>0||d&&this.eu(T,d)<0)&&(c=!0)):!v&&T?(s.track({type:0,doc:T}),R=!0):v&&!T&&(s.track({type:1,doc:v}),R=!0,(h||d)&&(c=!0)),R&&(T?(l=l.add(T),r=E?r.add(m):r.delete(m)):(l=l.delete(m),r=r.delete(m)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const m=this.query.limitType==="F"?l.last():l.first();l=l.delete(m.key),r=r.delete(m.key),s.track({type:1,doc:m})}return{tu:l,iu:s,Cs:c,mutatedKeys:r}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,i){const r=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((m,_)=>(function(T,S){const E=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xe(20277,{Rt:R})}};return E(T)-E(S)})(m.type,_.type)||this.eu(m.doc,_.doc))),this.ou(s),i=i??!1;const c=t&&!i?this._u():[],h=this.Xa.size===0&&this.current&&!i?1:0,d=h!==this.Za;return this.Za=h,l.length!==0||d?{snapshot:new Zc(this.query,e.tu,r,l,e.mutatedKeys,h===0,d,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new PA,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Fe(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))}));const t=[];return e.forEach((s=>{this.Xa.has(s)||t.push(new OD(s))})),this.Xa.forEach((s=>{e.has(s)||t.push(new MD(s))})),t}cu(e){this.Ya=e.Qs,this.Xa=Fe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Zc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Za="SyncEngine";class P6{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class V6{constructor(e){this.key=e,this.hu=!1}}class L6{constructor(e,t,s,i,r,l){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new vr((c=>TC(c)),Qd),this.Iu=new Map,this.Eu=new Set,this.du=new St(pe.comparator),this.Au=new Map,this.Ru=new Rv,this.Vu={},this.mu=new Map,this.fu=gl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function j6(n,e,t=!0){const s=kp(n);let i;const r=s.Tu.get(e);return r?(s.sharedClientState.addLocalQueryTarget(r.targetId),i=r.view.lu()):i=await VD(s,e,t,!0),i}async function U6(n,e){const t=kp(n);await VD(t,e,!0,!1)}async function VD(n,e,t,s){const i=await Kc(n.localStore,Kn(e)),r=i.targetId,l=n.sharedClientState.addLocalQueryTarget(r,t);let c;return s&&(c=await qv(n,e,r,l==="current",i.resumeToken)),n.isPrimaryClient&&t&&Np(n.remoteStore,i),c}async function qv(n,e,t,s,i){n.pu=(_,v,T)=>(async function(E,R,k,L){let O=R.view.ru(k);O.Cs&&(O=await Gg(E.localStore,R.query,!1).then((({documents:C})=>R.view.ru(C,O))));const H=L&&L.targetChanges.get(R.targetId),F=L&&L.targetMismatches.get(R.targetId)!=null,U=R.view.applyChanges(O,E.isPrimaryClient,H,F);return db(E,R.targetId,U.au),U.snapshot})(n,_,v,T);const r=await Gg(n.localStore,e,!0),l=new PD(e,r.Qs),c=l.ru(r.documents),h=ef.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",i),d=l.applyChanges(c,n.isPrimaryClient,h);db(n,t,d.au);const m=new P6(e,t,l);return n.Tu.set(e,m),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function B6(n,e,t){const s=ve(n),i=s.Tu.get(e),r=s.Iu.get(i.targetId);if(r.length>1)return s.Iu.set(i.targetId,r.filter((l=>!Qd(l,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(i.targetId),s.sharedClientState.isActiveQueryTarget(i.targetId)||await Qc(s.localStore,i.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(i.targetId),t&&Xc(s.remoteStore,i.targetId),Jc(s,i.targetId)})).catch(Ya)):(Jc(s,i.targetId),await Qc(s.localStore,i.targetId,!0))}async function F6(n,e){const t=ve(n),s=t.Tu.get(e),i=t.Iu.get(s.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),Xc(t.remoteStore,s.targetId))}async function z6(n,e,t){const s=Yv(n);try{const i=await(function(l,c){const h=ve(l),d=lt.now(),m=c.reduce(((T,S)=>T.add(S.key)),Fe());let _,v;return h.persistence.runTransaction("Locally write mutations","readwrite",(T=>{let S=rs(),E=Fe();return h.Ns.getEntries(T,m).next((R=>{S=R,S.forEach(((k,L)=>{L.isValidDocument()||(E=E.add(k))}))})).next((()=>h.localDocuments.getOverlayedDocuments(T,S))).next((R=>{_=R;const k=[];for(const L of c){const O=uj(L,_.get(L.key).overlayedDocument);O!=null&&k.push(new xr(L.key,O,fC(O.value.mapValue),Mt.exists(!0)))}return h.mutationQueue.addMutationBatch(T,d,k,c)})).next((R=>{v=R;const k=R.applyToLocalDocumentSet(_,E);return h.documentOverlayCache.saveOverlays(T,R.batchId,k)}))})).then((()=>({batchId:v.batchId,changes:AC(_)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(i.batchId),(function(l,c,h){let d=l.Vu[l.currentUser.toKey()];d||(d=new St(Ve)),d=d.insert(c,h),l.Vu[l.currentUser.toKey()]=d})(s,i.batchId,t),await Tr(s,i.changes),await pu(s.remoteStore)}catch(i){const r=yu(i,"Failed to persist write");t.reject(r)}}async function LD(n,e){const t=ve(n);try{const s=await i6(t.localStore,e);e.targetChanges.forEach(((i,r)=>{const l=t.Au.get(r);l&&(we(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?l.hu=!0:i.modifiedDocuments.size>0?we(l.hu,14607):i.removedDocuments.size>0&&(we(l.hu,42227),l.hu=!1))})),await Tr(t,s,e)}catch(s){await Ya(s)}}function UA(n,e,t){const s=ve(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const i=[];s.Tu.forEach(((r,l)=>{const c=l.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(l,c){const h=ve(l);h.onlineState=c;let d=!1;h.queries.forEach(((m,_)=>{for(const v of _.Sa)v.va(c)&&(d=!0)})),d&&zv(h)})(s.eventManager,e),i.length&&s.Pu.H_(i),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function H6(n,e,t){const s=ve(n);s.sharedClientState.updateQueryState(e,"rejected",t);const i=s.Au.get(e),r=i&&i.key;if(r){let l=new St(pe.comparator);l=l.insert(r,It.newNoDocument(r,Re.min()));const c=Fe().add(r),h=new Jd(Re.min(),new Map,new St(Ve),l,c);await LD(s,h),s.du=s.du.remove(r),s.Au.delete(e),Wv(s)}else await Qc(s.localStore,e,!1).then((()=>Jc(s,e,t))).catch(Ya)}async function q6(n,e){const t=ve(n),s=e.batch.batchId;try{const i=await s6(t.localStore,e);$v(t,s,null),Gv(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Tr(t,i)}catch(i){await Ya(i)}}async function G6(n,e,t){const s=ve(n);try{const i=await(function(l,c){const h=ve(l);return h.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let m;return h.mutationQueue.lookupMutationBatch(d,c).next((_=>(we(_!==null,37113),m=_.keys(),h.mutationQueue.removeMutationBatch(d,_)))).next((()=>h.mutationQueue.performConsistencyCheck(d))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(d,m,c))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m))).next((()=>h.localDocuments.getDocuments(d,m)))}))})(s.localStore,e);$v(s,e,t),Gv(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Tr(s,i)}catch(i){await Ya(i)}}async function $6(n,e){const t=ve(n);Xa(t.remoteStore)||ce(Za,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const s=await(function(l){const c=ve(l);return c.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(h=>c.mutationQueue.getHighestUnacknowledgedBatchId(h)))})(t.localStore);if(s===Ra)return void e.resolve();const i=t.mu.get(s)||[];i.push(e),t.mu.set(s,i)}catch(s){const i=yu(s,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function Gv(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function $v(n,e,t){const s=ve(n);let i=s.Vu[s.currentUser.toKey()];if(i){const r=i.get(e);r&&(t?r.reject(t):r.resolve(),i=i.remove(e)),s.Vu[s.currentUser.toKey()]=i}}function Jc(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((s=>{n.Ru.containsKey(s)||jD(n,s)}))}function jD(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Xc(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Wv(n))}function db(n,e,t){for(const s of t)s instanceof MD?(n.Ru.addReference(s.key,e),W6(n,s)):s instanceof OD?(ce(Za,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||jD(n,s.key)):xe(19791,{wu:s})}function W6(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(ce(Za,"New document in limbo: "+t),n.Eu.add(s),Wv(n))}function Wv(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new pe(Ke.fromString(e)),s=n.fu.next();n.Au.set(s,new V6(t)),n.du=n.du.insert(t,s),Np(n.remoteStore,new lr(Kn(du(t.path)),s,"TargetPurposeLimboResolution",ss.ce))}}async function Tr(n,e,t){const s=ve(n),i=[],r=[],l=[];s.Tu.isEmpty()||(s.Tu.forEach(((c,h)=>{l.push(s.pu(h,e,t).then((d=>{var m;if((d||t)&&s.isPrimaryClient){const _=d?!d.fromCache:(m=t==null?void 0:t.targetChanges.get(h.targetId))==null?void 0:m.current;s.sharedClientState.updateQueryState(h.targetId,_?"current":"not-current")}if(d){i.push(d);const _=kv.As(h.targetId,d);r.push(_)}})))})),await Promise.all(l),s.Pu.H_(i),await(async function(h,d){const m=ve(h);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>W.forEach(d,(v=>W.forEach(v.Es,(T=>m.persistence.referenceDelegate.addReference(_,v.targetId,T))).next((()=>W.forEach(v.ds,(T=>m.persistence.referenceDelegate.removeReference(_,v.targetId,T)))))))))}catch(_){if(!Ka(_))throw _;ce(Mv,"Failed to update sequence numbers: "+_)}for(const _ of d){const v=_.targetId;if(!_.fromCache){const T=m.Ms.get(v),S=T.snapshotVersion,E=T.withLastLimboFreeSnapshotVersion(S);m.Ms=m.Ms.insert(v,E)}}})(s.localStore,r))}async function Y6(n,e){const t=ve(n);if(!t.currentUser.isEqual(e)){ce(Za,"User change. New user:",e.toKey());const s=await gD(t.localStore,e);t.currentUser=e,(function(r,l){r.mu.forEach((c=>{c.forEach((h=>{h.reject(new le(ee.CANCELLED,l))}))})),r.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Tr(t,s.Ls)}}function K6(n,e){const t=ve(n),s=t.Au.get(e);if(s&&s.hu)return Fe().add(s.key);{let i=Fe();const r=t.Iu.get(e);if(!r)return i;for(const l of r){const c=t.Tu.get(l);i=i.unionWith(c.view.nu)}return i}}async function Q6(n,e){const t=ve(n),s=await Gg(t.localStore,e.query,!0),i=e.view.cu(s);return t.isPrimaryClient&&db(t,e.targetId,i.au),i}async function X6(n,e){const t=ve(n);return bD(t.localStore,e).then((s=>Tr(t,s)))}async function Z6(n,e,t,s){const i=ve(n),r=await(function(c,h){const d=ve(c),m=ve(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",(_=>m.er(_,h).next((v=>v?d.localDocuments.getDocuments(_,v):W.resolve(null)))))})(i.localStore,e);r!==null?(t==="pending"?await pu(i.remoteStore):t==="acknowledged"||t==="rejected"?($v(i,e,s||null),Gv(i,e),(function(c,h){ve(ve(c).mutationQueue).ir(h)})(i.localStore,e)):xe(6720,"Unknown batchState",{Su:t}),await Tr(i,r)):ce(Za,"Cannot apply mutation batch with id: "+e)}async function J6(n,e){const t=ve(n);if(kp(t),Yv(t),e===!0&&t.gu!==!0){const s=t.sharedClientState.getAllActiveQueryTargets(),i=await BA(t,s.toArray());t.gu=!0,await ub(t.remoteStore,!0);for(const r of i)Np(t.remoteStore,r)}else if(e===!1&&t.gu!==!1){const s=[];let i=Promise.resolve();t.Iu.forEach(((r,l)=>{t.sharedClientState.isLocalQueryTarget(l)?s.push(l):i=i.then((()=>(Jc(t,l),Qc(t.localStore,l,!0)))),Xc(t.remoteStore,l)})),await i,await BA(t,s),(function(l){const c=ve(l);c.Au.forEach(((h,d)=>{Xc(c.remoteStore,d)})),c.Ru.Jr(),c.Au=new Map,c.du=new St(pe.comparator)})(t),t.gu=!1,await ub(t.remoteStore,!1)}}async function BA(n,e,t){const s=ve(n),i=[],r=[];for(const l of e){let c;const h=s.Iu.get(l);if(h&&h.length!==0){c=await Kc(s.localStore,Kn(h[0]));for(const d of h){const m=s.Tu.get(d),_=await Q6(s,m);_.snapshot&&r.push(_.snapshot)}}else{const d=await yD(s.localStore,l);c=await Kc(s.localStore,d),await qv(s,UD(d),l,!1,c.resumeToken)}i.push(c)}return s.Pu.H_(r),i}function UD(n){return xC(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function e3(n){return(function(t){return ve(ve(t).persistence).Ts()})(ve(n).localStore)}async function t3(n,e,t,s){const i=ve(n);if(i.gu)return void ce(Za,"Ignoring unexpected query state notification.");const r=i.Iu.get(e);if(r&&r.length>0)switch(t){case"current":case"not-current":{const l=await bD(i.localStore,EC(r[0])),c=Jd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ft.EMPTY_BYTE_STRING);await Tr(i,l,c);break}case"rejected":await Qc(i.localStore,e,!0),Jc(i,e,s);break;default:xe(64155,t)}}async function n3(n,e,t){const s=kp(n);if(s.gu){for(const i of e){if(s.Iu.has(i)&&s.sharedClientState.isActiveQueryTarget(i)){ce(Za,"Adding an already active target "+i);continue}const r=await yD(s.localStore,i),l=await Kc(s.localStore,r);await qv(s,UD(r),l.targetId,!1,l.resumeToken),Np(s.remoteStore,l)}for(const i of t)s.Iu.has(i)&&await Qc(s.localStore,i,!1).then((()=>{Xc(s.remoteStore,i),Jc(s,i)})).catch(Ya)}}function kp(n){const e=ve(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=LD.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=K6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=H6.bind(null,e),e.Pu.H_=N6.bind(null,e.eventManager),e.Pu.yu=k6.bind(null,e.eventManager),e}function Yv(n){const e=ve(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=q6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=G6.bind(null,e),e}function s3(n,e,t){const s=ve(n);(async function(r,l,c){try{const h=await l.getMetadata();if(await(function(T,S){const E=ve(T),R=Xt(S.createTime);return E.persistence.runTransaction("hasNewerBundle","readonly",(k=>E.Ii.getBundleMetadata(k,S.id))).then((k=>!!k&&k.createTime.compareTo(R)>=0))})(r.localStore,h))return await l.close(),c._completeWith((function(T){return{taskState:"Success",documentsLoaded:T.totalDocuments,bytesLoaded:T.totalBytes,totalDocuments:T.totalDocuments,totalBytes:T.totalBytes}})(h)),Promise.resolve(new Set);c._updateProgress(kD(h));const d=new O6(h,l.serializer);let m=await l.bu();for(;m;){const v=await d.Ga(m);v&&c._updateProgress(v),m=await l.bu()}const _=await d.ja(r.localStore);return await Tr(r,_.Ha,void 0),await(function(T,S){const E=ve(T);return E.persistence.runTransaction("Save bundle","readwrite",(R=>E.Ii.saveBundleMetadata(R,S)))})(r.localStore,h),c._completeWith(_.progress),Promise.resolve(_.Ja)}catch(h){return Ci(Za,`Loading bundle failed with ${h}`),c._failWith(h),Promise.resolve(new Set)}})(s,e,t).then((i=>{s.sharedClientState.notifyBundleLoaded(i)}))}class Sd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=tf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return mD(this.persistence,new fD,e.initialUser,this.serializer)}Cu(e){return new Cv(Dp.mi,this.serializer)}Du(e){return new wD}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Sd.provider={build:()=>new Sd};class i3 extends Sd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){we(this.persistence.referenceDelegate instanceof qg,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new oD(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Pn.withCacheSize(this.cacheSizeBytes):Pn.DEFAULT;return new Cv((s=>qg.mi(s,t)),this.serializer)}}class BD extends Sd{constructor(e,t,s){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=s,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Yv(this.xu.syncEngine),await pu(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return mD(this.persistence,new fD,e.initialUser,this.serializer)}Fu(e,t){const s=this.persistence.referenceDelegate.garbageCollector;return new oD(s,e.asyncQueue,t)}Mu(e,t){const s=new f4(t,this.persistence);return new d4(e.asyncQueue,s)}Cu(e){const t=Nv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?Pn.withCacheSize(this.cacheSizeBytes):Pn.DEFAULT;return new Dv(this.synchronizeTabs,t,e.clientId,s,e.asyncQueue,SD(),mg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new wD}}class r3 extends BD{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof g0&&(this.sharedClientState.syncEngine={Co:Z6.bind(null,t),vo:t3.bind(null,t),Fo:n3.bind(null,t),Ts:e3.bind(null,t),Do:X6.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async s=>{await J6(this.xu.syncEngine,s),this.gcScheduler&&(s&&!this.gcScheduler.started?this.gcScheduler.start():s||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(s&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():s||this.indexBackfillerScheduler.stop())}))}Du(e){const t=SD();if(!g0.v(t))throw new le(ee.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=Nv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new g0(t,e.asyncQueue,s,e.clientId,e.initialUser)}}class Ad{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>UA(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=Y6.bind(null,this.syncEngine),await ub(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new D6})()}createDatastore(e){const t=tf(e.databaseInfo.databaseId),s=(function(r){return new d6(r)})(e.databaseInfo);return(function(r,l,c,h){return new p6(r,l,c,h)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,i,r,l,c){return new y6(s,i,r,l,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>UA(this.syncEngine,t,0)),(function(){return kA.v()?new kA:new l6})())}createSyncEngine(e,t){return(function(i,r,l,c,h,d,m){const _=new L6(i,r,l,c,h,d);return m&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(i){const r=ve(i);ce(pl,"RemoteStore shutting down."),r.Ea.add(5),await gu(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Ad.provider={build:()=>new Ad};function FA(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const s={value:n.slice(t,t+e),done:!1};return t+=e,s}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Kt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a3{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new Rn,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((s=>{s&&s.$a()?this.metadata.resolve(s.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(s==null?void 0:s.Qa)}`))}),(s=>this.metadata.reject(s)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const t=this.Lu.decode(e),s=Number(t);isNaN(s)&&this.Qu(`length string (${t}) is not valid number`);const i=await this.$u(s);return new M6(JSON.parse(i),e.length+s)}Uu(){return this.buffer.findIndex((e=>e===123))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o3{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new le(ee.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(i,r){const l=ve(i),c={documents:r.map((_=>Ed(l.serializer,_)))},h=await l.Ho("BatchGetDocuments",l.serializer.databaseId,Ke.emptyPath(),c,r.length),d=new Map;h.forEach((_=>{const v=bj(l.serializer,_);d.set(v.key.toString(),v)}));const m=[];return r.forEach((_=>{const v=d.get(_.toString());we(!!v,55234,{key:_}),m.push(v)})),m})(this.datastore,e);return t.forEach((s=>this.recordVersion(s))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(s){this.lastTransactionError=s}this.writtenDocs.add(e.toString())}delete(e){this.write(new mu(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,s)=>{const i=pe.fromPath(s);this.mutations.push(new bv(i,this.precondition(i)))})),await(async function(s,i){const r=ve(s),l={writes:i.map((c=>wd(r.serializer,c)))};await r.Go("Commit",r.serializer.databaseId,Ke.emptyPath(),l)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw xe(50498,{Gu:e.constructor.name});t=Re.min()}const s=this.readVersions.get(e.key.toString());if(s){if(!t.isEqual(s))throw new le(ee.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Re.min())?Mt.exists(!1):Mt.updateTime(t):Mt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Re.min()))throw new le(ee.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Mt.updateTime(t)}return Mt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l3{constructor(e,t,s,i,r){this.asyncQueue=e,this.datastore=t,this.options=s,this.updateFunction=i,this.deferred=r,this.zu=s.maxAttempts,this.M_=new Pv(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const e=new o3(this.datastore),t=this.Hu(e);t&&t.then((s=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(s)})).catch((i=>{this.Yu(i)}))))})).catch((s=>{this.Yu(s)}))}))}Hu(e){try{const t=this.updateFunction(e);return!Wd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(e)}Zu(e){if((e==null?void 0:e.name)==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!VC(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fa="FirestoreClient";class c3{constructor(e,t,s,i,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=i,this.user=bn.UNAUTHENTICATED,this.clientId=rv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(s,(async l=>{ce(Fa,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(s,(l=>(ce(Fa,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Rn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=yu(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function _0(n,e){n.asyncQueue.verifyOperationInProgress(),ce(Fa,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async i=>{s.isEqual(i)||(await gD(e.localStore,i),s=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function zA(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Kv(n);ce(Fa,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>OA(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,i)=>OA(e.remoteStore,i))),n._onlineComponents=e}async function Kv(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ce(Fa,"Using user provided OfflineComponentProvider");try{await _0(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===ee.FAILED_PRECONDITION||i.code===ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Ci("Error using user provided cache. Falling back to memory cache: "+t),await _0(n,new Sd)}}else ce(Fa,"Using default OfflineComponentProvider"),await _0(n,new i3(void 0));return n._offlineComponents}async function Op(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ce(Fa,"Using user provided OnlineComponentProvider"),await zA(n,n._uninitializedComponentsProvider._online)):(ce(Fa,"Using default OnlineComponentProvider"),await zA(n,new Ad))),n._onlineComponents}function FD(n){return Kv(n).then((e=>e.persistence))}function Qv(n){return Kv(n).then((e=>e.localStore))}function zD(n){return Op(n).then((e=>e.remoteStore))}function Xv(n){return Op(n).then((e=>e.syncEngine))}function u3(n){return Op(n).then((e=>e.datastore))}async function eu(n){const e=await Op(n),t=e.eventManager;return t.onListen=j6.bind(null,e.syncEngine),t.onUnlisten=B6.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=U6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=F6.bind(null,e.syncEngine),t}function h3(n){return n.asyncQueue.enqueue((async()=>{const e=await FD(n),t=await zD(n);return e.setNetworkEnabled(!0),(function(i){const r=ve(i);return r.Ea.delete(0),nf(r)})(t)}))}function d3(n){return n.asyncQueue.enqueue((async()=>{const e=await FD(n),t=await zD(n);return e.setNetworkEnabled(!1),(async function(i){const r=ve(i);r.Ea.add(0),await gu(r),r.Ra.set("Offline")})(t)}))}function f3(n,e){const t=new Rn;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,r,l){try{const c=await(function(d,m){const _=ve(d);return _.persistence.runTransaction("read document","readonly",(v=>_.localDocuments.getDocument(v,m)))})(i,r);c.isFoundDocument()?l.resolve(c):c.isNoDocument()?l.resolve(null):l.reject(new le(ee.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(c){const h=yu(c,`Failed to get document '${r} from cache`);l.reject(h)}})(await Qv(n),e,t))),t.promise}function HD(n,e,t={}){const s=new Rn;return n.asyncQueue.enqueueAndForget((async()=>(function(r,l,c,h,d){const m=new Mp({next:v=>{m.Nu(),l.enqueueAndForget((()=>Fv(r,_)));const T=v.docs.has(c);!T&&v.fromCache?d.reject(new le(ee.UNAVAILABLE,"Failed to get document because the client is offline.")):T&&v.fromCache&&h&&h.source==="server"?d.reject(new le(ee.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(v)},error:v=>d.reject(v)}),_=new Hv(du(c.path),m,{includeMetadataChanges:!0,qa:!0});return Bv(r,_)})(await eu(n),n.asyncQueue,e,t,s))),s.promise}function m3(n,e){const t=new Rn;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,r,l){try{const c=await Gg(i,r,!0),h=new PD(r,c.Qs),d=h.ru(c.documents),m=h.applyChanges(d,!1);l.resolve(m.snapshot)}catch(c){const h=yu(c,`Failed to execute query '${r} against cache`);l.reject(h)}})(await Qv(n),e,t))),t.promise}function qD(n,e,t={}){const s=new Rn;return n.asyncQueue.enqueueAndForget((async()=>(function(r,l,c,h,d){const m=new Mp({next:v=>{m.Nu(),l.enqueueAndForget((()=>Fv(r,_))),v.fromCache&&h.source==="server"?d.reject(new le(ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(v)},error:v=>d.reject(v)}),_=new Hv(c,m,{includeMetadataChanges:!0,qa:!0});return Bv(r,_)})(await eu(n),n.asyncQueue,e,t,s))),s.promise}function g3(n,e){const t=new Mp(e);return n.asyncQueue.enqueueAndForget((async()=>(function(i,r){ve(i).Ca.add(r),r.next()})(await eu(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(i,r){ve(i).Ca.delete(r)})(await eu(n),t)))}}function p3(n,e,t,s){const i=(function(l,c){let h;return h=typeof l=="string"?jC().encode(l):l,(function(m,_){return new a3(m,_)})((function(m,_){if(m instanceof Uint8Array)return FA(m,_);if(m instanceof ArrayBuffer)return FA(new Uint8Array(m),_);if(m instanceof ReadableStream)return m.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(h),c)})(t,tf(e));n.asyncQueue.enqueueAndForget((async()=>{s3(await Xv(n),i,s)}))}function _3(n,e){return n.asyncQueue.enqueue((async()=>(function(s,i){const r=ve(s);return r.persistence.runTransaction("Get named query","readonly",(l=>r.Ii.getNamedQuery(l,i)))})(await Qv(n),e)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GD(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HA=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $D="firestore.googleapis.com",qA=!0;class GA{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new le(ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=$D,this.ssl=qA}else this.host=e.host,this.ssl=e.ssl??qA;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=sD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<jj)throw new le(ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}UR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=GD(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new le(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new le(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new le(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,i){return s.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sf{constructor(e,t,s,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new GA({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new le(ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new le(ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new GA(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new e4;switch(s.type){case"firstParty":return new i4(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new le(ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=HA.get(t);s&&(ce("ComponentProvider","Removing Datastore"),HA.delete(t),s.terminate())})(this),Promise.resolve()}}function WD(n,e,t,s={}){var d;n=at(n,sf);const i=cu(e),r=n._getSettings(),l={...r,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;i&&(P2(`https://${c}`),V2("Firestore",!0)),r.host!==$D&&r.host!==c&&Ci("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...r,host:c,ssl:i,emulatorOptions:s};if(!dr(h,l)&&(n._setSettings(h),s.mockUserToken)){let m,_;if(typeof s.mockUserToken=="string")m=s.mockUserToken,_=bn.MOCK_USER;else{m=EO(s.mockUserToken,(d=n._app)==null?void 0:d.options.projectId);const v=s.mockUserToken.sub||s.mockUserToken.user_id;if(!v)throw new le(ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new bn(v)}n._authCredentials=new t4(new LR(m,_))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qn=class YD{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new YD(this.firestore,e,this._query)}},Et=class Fh{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ca(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Fh(this.firestore,e,this._key)}toJSON(){return{type:Fh._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if($d(t,Fh._jsonSchema))return new Fh(e,s||null,new pe(Ke.fromString(t.referencePath)))}};Et._jsonSchemaVersion="firestore/documentReference/1.0",Et._jsonSchema={type:nn("string",Et._jsonSchemaVersion),referencePath:nn("string")};let Ca=class KD extends Qn{constructor(e,t,s){super(e,t,du(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Et(this.firestore,null,new pe(e))}withConverter(e){return new KD(this.firestore,e,this._path)}};function Kg(n,e,...t){if(n=wt(n),av("collection","path",e),n instanceof sf){const s=Ke.fromString(e,...t);return MS(s),new Ca(n,null,s)}{if(!(n instanceof Et||n instanceof Ca))throw new le(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Ke.fromString(e,...t));return MS(s),new Ca(n.firestore,null,s)}}function y3(n,e){if(n=at(n,sf),av("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new le(ee.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Qn(n,null,(function(s){return new br(Ke.emptyPath(),s)})(e))}function Qg(n,e,...t){if(n=wt(n),arguments.length===1&&(e=rv.newId()),av("doc","path",e),n instanceof sf){const s=Ke.fromString(e,...t);return kS(s),new Et(n,null,new pe(s))}{if(!(n instanceof Et||n instanceof Ca))throw new le(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Ke.fromString(e,...t));return kS(s),new Et(n.firestore,n instanceof Ca?n.converter:null,new pe(s))}}function QD(n,e){return n=wt(n),e=wt(e),(n instanceof Et||n instanceof Ca)&&(e instanceof Et||e instanceof Ca)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function XD(n,e){return n=wt(n),e=wt(e),n instanceof Qn&&e instanceof Qn&&n.firestore===e.firestore&&Qd(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A="AsyncQueue";class WA{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Pv(this,"async_queue_retry"),this._c=()=>{const s=mg();s&&ce($A,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=mg();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=mg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Rn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ka(e))throw e;ce($A,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,Kt("INTERNAL UNHANDLED ERROR: ",YA(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=Uv.createAndSchedule(this,e,t,s,(r=>this.hc(r)));return this.tc.push(i),i}uc(){this.nc&&xe(47125,{Pc:YA(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function YA(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(n){return(function(t,s){if(typeof t!="object"||t===null)return!1;const i=t;for(const r of s)if(r in i&&typeof i[r]=="function")return!0;return!1})(n,["next","error","complete"])}class b3{constructor(){this._progressObserver={},this._taskCompletionResolver=new Rn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,s){this._progressObserver={next:e,error:t,complete:s}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v3=-1;let Zt=class extends sf{constructor(e,t,s,i){super(e,t,s,i),this.type="firestore",this._queue=new WA,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new WA(e),this._firestoreClient=void 0,await e}}};function x3(n,e){const t=typeof n=="object"?n:$b(),s=typeof n=="string"?n:Lg,i=zd(t,"firestore").getImmediate({identifier:s});if(!i._initialized){const r=xO("firestore");r&&WD(i,...r)}return i}function Fn(n){if(n._terminated)throw new le(ee.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||ZD(n),n._firestoreClient}function ZD(n){var s,i,r;const e=n._freezeSettings(),t=(function(c,h,d,m){return new z4(c,h,d,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,GD(m.experimentalLongPollingOptions),m.useFetchStreams,m.isUsingEmulator)})(n._databaseId,((s=n._app)==null?void 0:s.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((r=e.localCache)!=null&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new c3(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(c){const h=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(h),_online:h}})(n._componentsProvider))}function T3(n,e){Ci("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return JD(n,Ad.provider,{build:s=>new BD(s,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function E3(n){Ci("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();JD(n,Ad.provider,{build:t=>new r3(t,e.cacheSizeBytes)})}function JD(n,e,t){if((n=at(n,Zt))._firestoreClient||n._terminated)throw new le(ee.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new le(ee.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},ZD(n)}function w3(n){if(n._initialized&&!n._terminated)throw new le(ee.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Rn;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(s){if(!Ei.v())return Promise.resolve();const i=s+dD;await Ei.delete(i)})(Nv(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function S3(n){return(function(t){const s=new Rn;return t.asyncQueue.enqueueAndForget((async()=>$6(await Xv(t),s))),s.promise})(Fn(n=at(n,Zt)))}function A3(n){return h3(Fn(n=at(n,Zt)))}function I3(n){return d3(Fn(n=at(n,Zt)))}function R3(n,e){const t=Fn(n=at(n,Zt)),s=new b3;return p3(t,n._databaseId,e,s),s}function C3(n,e){return _3(Fn(n=at(n,Zt)),e).then((t=>t?new Qn(n,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ln(Ft.fromBase64String(e))}catch(t){throw new le(ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ln(Ft.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ln._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if($d(e,Ln._jsonSchema))return Ln.fromBase64String(e.bytes)}}Ln._jsonSchemaVersion="firestore/bytes/1.0",Ln._jsonSchema={type:nn("string",Ln._jsonSchemaVersion),bytes:nn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let za=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new le(ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tl=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new le(ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new le(ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ve(this._lat,e._lat)||Ve(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Xs._jsonSchemaVersion}}static fromJSON(e){if($d(e,Xs._jsonSchema))return new Xs(e.latitude,e.longitude)}}Xs._jsonSchemaVersion="firestore/geoPoint/1.0",Xs._jsonSchema={type:nn("string",Xs._jsonSchemaVersion),latitude:nn("number"),longitude:nn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,i){if(s.length!==i.length)return!1;for(let r=0;r<s.length;++r)if(s[r]!==i[r])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Si._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if($d(e,Si._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Si(e.vectorValues);throw new le(ee.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Si._jsonSchemaVersion="firestore/vectorValue/1.0",Si._jsonSchema={type:nn("string",Si._jsonSchemaVersion),vectorValues:nn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D3=/^__.*__$/;class N3{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new xr(e,this.data,this.fieldMask,t,this.fieldTransforms):new fu(e,this.data,t,this.fieldTransforms)}}class eN{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new xr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function tN(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xe(40011,{Ac:n})}}class Pp{constructor(e,t,s,i,r,l){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=i,r===void 0&&this.Rc(),this.fieldTransforms=r||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Pp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const t=(i=this.path)==null?void 0:i.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){var i;const t=(i=this.path)==null?void 0:i.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Xg(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(tN(this.Ac)&&D3.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class k3{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||tf(e)}Cc(e,t,s,i=!1){return new Pp({Ac:e,methodName:t,Dc:s,path:kt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function El(n){const e=n._freezeSettings(),t=tf(n._databaseId);return new k3(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Vp(n,e,t,s,i,r={}){const l=n.Cc(r.merge||r.mergeFields?2:0,e,t,i);ix("Data must be an object, but it was:",l,s);const c=iN(s,l);let h,d;if(r.merge)h=new is(l.fieldMask),d=l.fieldTransforms;else if(r.mergeFields){const m=[];for(const _ of r.mergeFields){const v=mb(e,_,t);if(!l.contains(v))throw new le(ee.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);aN(m,v)||m.push(v)}h=new is(m),d=l.fieldTransforms.filter((_=>h.covers(_.field)))}else h=null,d=l.fieldTransforms;return new N3(new In(c),h,d)}class rf extends Tl{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof rf}}function nN(n,e,t){return new Pp({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Zv extends Tl{_toFieldTransform(e){return new Zd(e.path,new $c)}isEqual(e){return e instanceof Zv}}class Jv extends Tl{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=nN(this,e,!0),s=this.vc.map((r=>wl(r,t))),i=new hl(s);return new Zd(e.path,i)}isEqual(e){return e instanceof Jv&&dr(this.vc,e.vc)}}class ex extends Tl{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=nN(this,e,!0),s=this.vc.map((r=>wl(r,t))),i=new dl(s);return new Zd(e.path,i)}isEqual(e){return e instanceof ex&&dr(this.vc,e.vc)}}class tx extends Tl{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Wc(e.serializer,CC(e.serializer,this.Fc));return new Zd(e.path,t)}isEqual(e){return e instanceof tx&&this.Fc===e.Fc}}function nx(n,e,t,s){const i=n.Cc(1,e,t);ix("Data must be an object, but it was:",i,s);const r=[],l=In.empty();Qa(s,((h,d)=>{const m=rx(e,h,t);d=wt(d);const _=i.yc(m);if(d instanceof rf)r.push(m);else{const v=wl(d,_);v!=null&&(r.push(m),l.set(m,v))}}));const c=new is(r);return new eN(l,c,i.fieldTransforms)}function sx(n,e,t,s,i,r){const l=n.Cc(1,e,t),c=[mb(e,s,t)],h=[i];if(r.length%2!=0)throw new le(ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<r.length;v+=2)c.push(mb(e,r[v])),h.push(r[v+1]);const d=[],m=In.empty();for(let v=c.length-1;v>=0;--v)if(!aN(d,c[v])){const T=c[v];let S=h[v];S=wt(S);const E=l.yc(T);if(S instanceof rf)d.push(T);else{const R=wl(S,E);R!=null&&(d.push(T),m.set(T,R))}}const _=new is(d);return new eN(m,_,l.fieldTransforms)}function sN(n,e,t,s=!1){return wl(t,n.Cc(s?4:3,e))}function wl(n,e){if(rN(n=wt(n)))return ix("Unsupported field value:",e,n),iN(n,e);if(n instanceof Tl)return(function(s,i){if(!tN(i.Ac))throw i.Sc(`${s._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${s._methodName}() is not currently supported inside arrays`);const r=s._toFieldTransform(i);r&&i.fieldTransforms.push(r)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(s,i){const r=[];let l=0;for(const c of s){let h=wl(c,i.wc(l));h==null&&(h={nullValue:"NULL_VALUE"}),r.push(h),l++}return{arrayValue:{values:r}}})(n,e)}return(function(s,i){if((s=wt(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return CC(i.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const r=lt.fromDate(s);return{timestampValue:Yc(i.serializer,r)}}if(s instanceof lt){const r=new lt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Yc(i.serializer,r)}}if(s instanceof Xs)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Ln)return{bytesValue:FC(i.serializer,s._byteString)};if(s instanceof Et){const r=i.databaseId,l=s.firestore._databaseId;if(!l.isEqual(r))throw i.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:wv(s.firestore._databaseId||i.databaseId,s._key.path)}}if(s instanceof Si)return(function(l,c){return{mapValue:{fields:{[fv]:{stringValue:mv},[Hc]:{arrayValue:{values:l.toArray().map((d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return yv(c.serializer,d)}))}}}}}})(s,i);throw i.Sc(`Unsupported field value: ${yp(s)}`)})(n,e)}function iN(n,e){const t={};return iC(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Qa(n,((s,i)=>{const r=wl(i,e.mc(s));r!=null&&(t[s]=r)})),{mapValue:{fields:t}}}function rN(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof lt||n instanceof Xs||n instanceof Ln||n instanceof Et||n instanceof Tl||n instanceof Si)}function ix(n,e,t){if(!rN(t)||!BR(t)){const s=yp(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function mb(n,e,t){if((e=wt(e))instanceof za)return e._internalPath;if(typeof e=="string")return rx(n,e);throw Xg("Field path arguments must be of type string or ",n,!1,void 0,t)}const M3=new RegExp("[~\\*/\\[\\]]");function rx(n,e,t){if(e.search(M3)>=0)throw Xg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new za(...e.split("."))._internalPath}catch{throw Xg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Xg(n,e,t,s,i){const r=s&&!s.isEmpty(),l=i!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let h="";return(r||l)&&(h+=" (found",r&&(h+=` in field ${s}`),l&&(h+=` in document ${i}`),h+=")"),new le(ee.INVALID_ARGUMENT,c+n+h)}function aN(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e,t,s,i,r){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Et(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new O3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Lp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class O3 extends Id{data(){return super.data()}}function Lp(n,e){return typeof e=="string"?rx(n,e):e instanceof za?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oN(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new le(ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ax{}class af extends ax{}function fa(n,e,...t){let s=[];e instanceof ax&&s.push(e),s=s.concat(t),(function(r){const l=r.filter((h=>h instanceof ox)).length,c=r.filter((h=>h instanceof jp)).length;if(l>1||l>0&&c>0)throw new le(ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const i of s)n=i._apply(n);return n}class jp extends af{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new jp(e,t,s)}_apply(e){const t=this._parse(e);return cN(e._query,t),new Qn(e.firestore,e.converter,eb(e._query,t))}_parse(e){const t=El(e.firestore);return(function(r,l,c,h,d,m,_){let v;if(d.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new le(ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){QA(_,m);const S=[];for(const E of _)S.push(KA(h,r,E));v={arrayValue:{values:S}}}else v=KA(h,r,_)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||QA(_,m),v=sN(c,l,_,m==="in"||m==="not-in");return Xe.create(d,m,v)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function P3(n,e,t){const s=e,i=Lp("where",n);return jp._create(i,s,t)}class ox extends ax{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new ox(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:ft.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,r){let l=i;const c=r.getFlattenedFilters();for(const h of c)cN(l,h),l=eb(l,h)})(e._query,t),new Qn(e.firestore,e.converter,eb(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class lx extends af{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new lx(e,t)}_apply(e){const t=(function(i,r,l){if(i.startAt!==null)throw new le(ee.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new le(ee.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Td(r,l)})(e._query,this._field,this._direction);return new Qn(e.firestore,e.converter,(function(i,r){const l=i.explicitOrderBy.concat([r]);return new br(i.path,i.collectionGroup,l,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}}function V3(n,e="asc"){const t=e,s=Lp("orderBy",n);return lx._create(s,t)}class Up extends af{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new Up(e,t,s)}_apply(e){return new Qn(e.firestore,e.converter,Bg(e._query,this._limit,this._limitType))}}function L3(n){return FR("limit",n),Up._create("limit",n,"F")}function j3(n){return FR("limitToLast",n),Up._create("limitToLast",n,"L")}class Bp extends af{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new Bp(e,t,s)}_apply(e){const t=lN(e,this.type,this._docOrFields,this._inclusive);return new Qn(e.firestore,e.converter,(function(i,r){return new br(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,r,i.endAt)})(e._query,t))}}function U3(...n){return Bp._create("startAt",n,!0)}function B3(...n){return Bp._create("startAfter",n,!1)}class Fp extends af{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new Fp(e,t,s)}_apply(e){const t=lN(e,this.type,this._docOrFields,this._inclusive);return new Qn(e.firestore,e.converter,(function(i,r){return new br(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,r)})(e._query,t))}}function F3(...n){return Fp._create("endBefore",n,!1)}function z3(...n){return Fp._create("endAt",n,!0)}function lN(n,e,t,s){if(t[0]=wt(t[0]),t[0]instanceof Id)return(function(r,l,c,h,d){if(!h)throw new le(ee.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);const m=[];for(const _ of Nc(r))if(_.field.isKeyField())m.push(cl(l,h.key));else{const v=h.data.field(_.field);if(Ep(v))throw new le(ee.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+_.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(v===null){const T=_.field.canonicalString();throw new le(ee.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${T}' (used as the orderBy) does not exist.`)}m.push(v)}return new Ua(m,d)})(n._query,n.firestore._databaseId,e,t[0]._document,s);{const i=El(n.firestore);return(function(l,c,h,d,m,_){const v=l.explicitOrderBy;if(m.length>v.length)throw new le(ee.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const T=[];for(let S=0;S<m.length;S++){const E=m[S];if(v[S].field.isKeyField()){if(typeof E!="string")throw new le(ee.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof E}`);if(!pv(l)&&E.indexOf("/")!==-1)throw new le(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${E}' contains a slash.`);const R=l.path.child(Ke.fromString(E));if(!pe.isDocumentKey(R))throw new le(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);const k=new pe(R);T.push(cl(c,k))}else{const R=sN(h,d,E);T.push(R)}}return new Ua(T,_)})(n._query,n.firestore._databaseId,i,e,t,s)}}function KA(n,e,t){if(typeof(t=wt(t))=="string"){if(t==="")throw new le(ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!pv(e)&&t.indexOf("/")!==-1)throw new le(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(Ke.fromString(t));if(!pe.isDocumentKey(s))throw new le(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return cl(n,new pe(s))}if(t instanceof Et)return cl(n,t._key);throw new le(ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${yp(t)}.`)}function QA(n,e){if(!Array.isArray(n)||n.length===0)throw new le(ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function cN(n,e){const t=(function(i,r){for(const l of i)for(const c of l.getFlattenedFilters())if(r.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new le(ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new le(ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class cx{convertValue(e,t="none"){switch(La(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(_r(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw xe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return Qa(e,((i,r)=>{s[i]=this.convertValue(r,t)})),s}convertVectorValue(e){var s,i,r;const t=(r=(i=(s=e.fields)==null?void 0:s[Hc].arrayValue)==null?void 0:i.values)==null?void 0:r.map((l=>Nt(l.doubleValue)));return new Si(t)}convertGeoPoint(e){return new Xs(Nt(e.latitude),Nt(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=wp(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(bd(e));default:return null}}convertTimestamp(e){const t=pr(e);return new lt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Ke.fromString(e);we(ZC(s),9688,{name:e});const i=new Va(s.get(1),s.get(3)),r=new pe(s.popFirst(5));return i.isEqual(t)||Kt(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zp(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class H3 extends cx{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ln(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Et(this.firestore,null,t)}}class el{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Ps=class uN extends Id{constructor(e,t,s,i,r,l){super(e,t,s,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new rd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Lp("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new le(ee.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=uN._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Ps._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ps._jsonSchema={type:nn("string",Ps._jsonSchemaVersion),bundleSource:nn("string","DocumentSnapshot"),bundleName:nn("string"),bundle:nn("string")};let rd=class extends Ps{data(e={}){return super.data(e)}},Zs=class hN{constructor(e,t,s,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new el(i.hasPendingWrites,i.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new rd(this._firestore,this._userDataWriter,s.key,s,new el(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new le(ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,r){if(i._snapshot.oldDocs.isEmpty()){let l=0;return i._snapshot.docChanges.map((c=>{const h=new rd(i._firestore,i._userDataWriter,c.doc.key,c.doc,new el(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:h,oldIndex:-1,newIndex:l++}}))}{let l=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>r||c.type!==3)).map((c=>{const h=new rd(i._firestore,i._userDataWriter,c.doc.key,c.doc,new el(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,m=-1;return c.type!==0&&(d=l.indexOf(c.doc.key),l=l.delete(c.doc.key)),c.type!==1&&(l=l.add(c.doc),m=l.indexOf(c.doc.key)),{type:q3(c.type),doc:h,oldIndex:d,newIndex:m}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new le(ee.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=hN._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=rv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],i=[];return this.docs.forEach((r=>{r._document!==null&&(t.push(r._document),s.push(this._userDataWriter.convertObjectMap(r._document.data.value.mapValue.fields,"previous")),i.push(r.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function q3(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xe(61501,{type:n})}}function dN(n,e){return n instanceof Ps&&e instanceof Ps?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Zs&&e instanceof Zs&&n._firestore===e._firestore&&XD(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G3(n){n=at(n,Et);const e=at(n.firestore,Zt);return HD(Fn(e),n._key).then((t=>ux(e,n,t)))}Zs._jsonSchemaVersion="firestore/querySnapshot/1.0",Zs._jsonSchema={type:nn("string",Zs._jsonSchemaVersion),bundleSource:nn("string","QuerySnapshot"),bundleName:nn("string"),bundle:nn("string")};class Sl extends cx{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ln(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Et(this.firestore,null,t)}}function $3(n){n=at(n,Et);const e=at(n.firestore,Zt),t=Fn(e),s=new Sl(e);return f3(t,n._key).then((i=>new Ps(e,s,n._key,i,new el(i!==null&&i.hasLocalMutations,!0),n.converter)))}function W3(n){n=at(n,Et);const e=at(n.firestore,Zt);return HD(Fn(e),n._key,{source:"server"}).then((t=>ux(e,n,t)))}function fN(n){n=at(n,Qn);const e=at(n.firestore,Zt),t=Fn(e),s=new Sl(e);return oN(n._query),qD(t,n._query).then((i=>new Zs(e,s,n,i)))}function Y3(n){n=at(n,Qn);const e=at(n.firestore,Zt),t=Fn(e),s=new Sl(e);return m3(t,n._query).then((i=>new Zs(e,s,n,i)))}function K3(n){n=at(n,Qn);const e=at(n.firestore,Zt),t=Fn(e),s=new Sl(e);return qD(t,n._query,{source:"server"}).then((i=>new Zs(e,s,n,i)))}function XA(n,e,t){n=at(n,Et);const s=at(n.firestore,Zt),i=zp(n.converter,e,t);return of(s,[Vp(El(s),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Mt.none())])}function ZA(n,e,t,...s){n=at(n,Et);const i=at(n.firestore,Zt),r=El(i);let l;return l=typeof(e=wt(e))=="string"||e instanceof za?sx(r,"updateDoc",n._key,e,t,s):nx(r,"updateDoc",n._key,e),of(i,[l.toMutation(n._key,Mt.exists(!0))])}function Q3(n){return of(at(n.firestore,Zt),[new mu(n._key,Mt.none())])}function mN(n,e){const t=at(n.firestore,Zt),s=Qg(n),i=zp(n.converter,e);return of(t,[Vp(El(n.firestore),"addDoc",s._key,i,n.converter!==null,{}).toMutation(s._key,Mt.exists(!1))]).then((()=>s))}function gN(n,...e){var h,d,m;n=wt(n);let t={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||fb(e[s])||(t=e[s++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(fb(e[s])){const _=e[s];e[s]=(h=_.next)==null?void 0:h.bind(_),e[s+1]=(d=_.error)==null?void 0:d.bind(_),e[s+2]=(m=_.complete)==null?void 0:m.bind(_)}let r,l,c;if(n instanceof Et)l=at(n.firestore,Zt),c=du(n._key.path),r={next:_=>{e[s]&&e[s](ux(l,n,_))},error:e[s+1],complete:e[s+2]};else{const _=at(n,Qn);l=at(_.firestore,Zt),c=_._query;const v=new Sl(l);r={next:T=>{e[s]&&e[s](new Zs(l,v,_,T))},error:e[s+1],complete:e[s+2]},oN(n._query)}return(function(v,T,S,E){const R=new Mp(E),k=new Hv(T,R,S);return v.asyncQueue.enqueueAndForget((async()=>Bv(await eu(v),k))),()=>{R.Nu(),v.asyncQueue.enqueueAndForget((async()=>Fv(await eu(v),k)))}})(Fn(l),c,i,r)}function X3(n,e){return g3(Fn(n=at(n,Zt)),fb(e)?e:{next:e})}function of(n,e){return(function(s,i){const r=new Rn;return s.asyncQueue.enqueueAndForget((async()=>z6(await Xv(s),i,r))),r.promise})(Fn(n),e)}function ux(n,e,t){const s=t.docs.get(e._key),i=new Sl(n);return new Ps(n,i,e._key,s,new el(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z3={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let J3=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=El(e)}set(e,t,s){this._verifyNotCommitted();const i=xa(e,this._firestore),r=zp(i.converter,t,s),l=Vp(this._dataReader,"WriteBatch.set",i._key,r,i.converter!==null,s);return this._mutations.push(l.toMutation(i._key,Mt.none())),this}update(e,t,s,...i){this._verifyNotCommitted();const r=xa(e,this._firestore);let l;return l=typeof(t=wt(t))=="string"||t instanceof za?sx(this._dataReader,"WriteBatch.update",r._key,t,s,i):nx(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(l.toMutation(r._key,Mt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=xa(e,this._firestore);return this._mutations=this._mutations.concat(new mu(t._key,Mt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new le(ee.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function xa(n,e){if((n=wt(n)).firestore!==e)throw new le(ee.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=El(e)}get(e){const t=xa(e,this._firestore),s=new H3(this._firestore);return this._transaction.lookup([t._key]).then((i=>{if(!i||i.length!==1)return xe(24041);const r=i[0];if(r.isFoundDocument())return new Id(this._firestore,s,r.key,r,t.converter);if(r.isNoDocument())return new Id(this._firestore,s,t._key,null,t.converter);throw xe(18433,{doc:r})}))}set(e,t,s){const i=xa(e,this._firestore),r=zp(i.converter,t,s),l=Vp(this._dataReader,"Transaction.set",i._key,r,i.converter!==null,s);return this._transaction.set(i._key,l),this}update(e,t,s,...i){const r=xa(e,this._firestore);let l;return l=typeof(t=wt(t))=="string"||t instanceof za?sx(this._dataReader,"Transaction.update",r._key,t,s,i):nx(this._dataReader,"Transaction.update",r._key,t),this._transaction.update(r._key,l),this}delete(e){const t=xa(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let t5=class extends e5{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=xa(e,this._firestore),s=new Sl(this._firestore);return super.get(e).then((i=>new Ps(this._firestore,s,t._key,i._document,new el(!1,!1),t.converter)))}};function n5(n,e,t){n=at(n,Zt);const s={...Z3,...t};return(function(r){if(r.maxAttempts<1)throw new le(ee.INVALID_ARGUMENT,"Max attempts must be at least 1")})(s),(function(r,l,c){const h=new Rn;return r.asyncQueue.enqueueAndForget((async()=>{const d=await u3(r);new l3(r.asyncQueue,d,c,l,h).ju()})),h.promise})(Fn(n),(i=>e(new t5(n,i))),s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s5(){return new rf("deleteField")}function i5(){return new Zv("serverTimestamp")}function r5(...n){return new Jv("arrayUnion",n)}function a5(...n){return new ex("arrayRemove",n)}function o5(n){return new tx("increment",n)}(function(e,t=!0){(function(i){hu=i})(Wa),Oa(new fr("firestore",((s,{instanceIdentifier:i,options:r})=>{const l=s.getProvider("app").getImmediate(),c=new Zt(new n4(s.getProvider("auth-internal")),new r4(l,s.getProvider("app-check-internal")),(function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new le(ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Va(d.options.projectId,m)})(l,i),l);return r={useFetchStreams:t,...r},c._setSettings(r),c}),"PUBLIC").setMultipleInstances(!0)),Os(RS,CS,e),Os(RS,CS,"esm2020")})();const l5={apiKey:"AIzaSyBzIuGIG4jmUe146rexK51UNvA2dn3xnT8",authDomain:"fir-f51b8.firebaseapp.com",projectId:"fir-f51b8",storageBucket:"fir-f51b8.firebasestorage.app",messagingSenderId:"904534740293",appId:"1:904534740293:web:c571f1f69b004c0b15022c",measurementId:"G-5WGVD478EE"},pN=mp(l5),ma=x3(pN),c5=QL(pN),u5=new rr,h5=()=>rL(c5,u5),d5=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),f5=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"})}),m5=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),g5=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),p5=n=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]}),_5=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),y5=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6H8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"})}),b5=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),v5=({page:n,currentPage:e,setCurrentPage:t,children:s,Icon:i})=>{const r=e===n;return y.jsxs("button",{onClick:()=>t(n),className:`flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200 ease-in-out ${r?"bg-white/15 text-white font-semibold":"text-indigo-100 hover:bg-white/10 hover:text-white"}`,children:[y.jsx(i,{className:"h-5 w-5 mr-2 flex-shrink-0"}),s]})},x5=({currentPage:n,setCurrentPage:e})=>{const[t,s]=ue.useState(!1),i=[{page:"dashboard",label:"首頁",icon:d5},{page:"data-manager",label:"資料管理",icon:f5},{page:"asset-management",label:"資產總覽",icon:m5},{page:"cashflow-management",label:"收支帳本",icon:g5},{page:"budget-missions",label:"預算檢視",icon:p5},{page:"investment-tracking",label:"投資追蹤",icon:_5},{page:"financial-goals",label:"目標進度",icon:y5},{page:"report-analysis",label:"報表分析",icon:b5}];return y.jsxs("nav",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 shadow-lg sticky top-0 z-40",children:[y.jsx("div",{className:"container mx-auto px-4 sm:px-6",children:y.jsxs("div",{className:"flex items-center justify-between h-16",children:[y.jsx("div",{className:"flex items-center",children:y.jsx("h1",{className:"text-xl font-bold text-white",children:"個人財務導航中心"})}),y.jsx("div",{className:"hidden md:block",children:y.jsx("div",{className:"ml-10 flex flex-wrap items-baseline justify-end gap-x-2 gap-y-1",children:i.map(r=>y.jsx(v5,{page:r.page,currentPage:n,setCurrentPage:e,Icon:r.icon,children:r.label},r.page))})}),y.jsx("div",{className:"-mr-2 flex md:hidden",children:y.jsxs("button",{onClick:()=>s(!t),type:"button",className:"bg-indigo-600 inline-flex items-center justify-center p-2 rounded-md text-indigo-200 hover:text-white hover:bg-indigo-500 focus:outline-none","aria-controls":"mobile-menu","aria-expanded":"false",children:[y.jsx("span",{className:"sr-only",children:"開啟主選單"}),t?y.jsx("svg",{className:"block h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}):y.jsx("svg",{className:"block h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})]})})]})}),t&&y.jsx("div",{className:"md:hidden",id:"mobile-menu",children:y.jsx("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3",children:i.map(r=>{const l=r.icon;return y.jsxs("button",{onClick:()=>{e(r.page),s(!1)},className:`w-full text-left flex items-center px-3 py-2 rounded-md text-base font-medium transition-colors duration-200 ${n===r.page?"bg-indigo-700 text-white":"text-indigo-200 hover:bg-indigo-600 hover:text-white"}`,children:[y.jsx(l,{className:"h-5 w-5 mr-3 flex-shrink-0"}),r.label]},r.page)})})})]})},T5=()=>y.jsx("footer",{className:"bg-gray-800 text-white p-4 mt-8",children:y.jsxs("div",{className:"container mx-auto text-center text-sm",children:["© ",new Date().getFullYear()," 個人財務導航中心。"]})}),E5=({notification:n})=>{if(!n.show)return null;const e="fixed top-5 right-5 text-white px-6 py-3 rounded-lg shadow-2xl z-50 transform transition-all duration-300",t=n.show?"translate-x-0 opacity-100":"translate-x-full opacity-0",s={success:"bg-green-500",error:"bg-red-500",info:"bg-blue-500"};return y.jsx("div",{className:`${e} ${s[n.type]} ${t}`,children:n.message})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function lf(n){return n+.5|0}const Ta=(n,e,t)=>Math.max(Math.min(n,t),e);function zh(n){return Ta(lf(n*2.55),0,255)}function Da(n){return Ta(lf(n*255),0,255)}function ir(n){return Ta(lf(n/2.55)/100,0,1)}function JA(n){return Ta(lf(n*100),0,100)}const Ns={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},gb=[..."0123456789ABCDEF"],w5=n=>gb[n&15],S5=n=>gb[(n&240)>>4]+gb[n&15],Um=n=>(n&240)>>4===(n&15),A5=n=>Um(n.r)&&Um(n.g)&&Um(n.b)&&Um(n.a);function I5(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&Ns[n[1]]*17,g:255&Ns[n[2]]*17,b:255&Ns[n[3]]*17,a:e===5?Ns[n[4]]*17:255}:(e===7||e===9)&&(t={r:Ns[n[1]]<<4|Ns[n[2]],g:Ns[n[3]]<<4|Ns[n[4]],b:Ns[n[5]]<<4|Ns[n[6]],a:e===9?Ns[n[7]]<<4|Ns[n[8]]:255})),t}const R5=(n,e)=>n<255?e(n):"";function C5(n){var e=A5(n)?w5:S5;return n?"#"+e(n.r)+e(n.g)+e(n.b)+R5(n.a,e):void 0}const D5=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function _N(n,e,t){const s=e*Math.min(t,1-t),i=(r,l=(r+n/30)%12)=>t-s*Math.max(Math.min(l-3,9-l,1),-1);return[i(0),i(8),i(4)]}function N5(n,e,t){const s=(i,r=(i+n/60)%6)=>t-t*e*Math.max(Math.min(r,4-r,1),0);return[s(5),s(3),s(1)]}function k5(n,e,t){const s=_N(n,1,.5);let i;for(e+t>1&&(i=1/(e+t),e*=i,t*=i),i=0;i<3;i++)s[i]*=1-e-t,s[i]+=e;return s}function M5(n,e,t,s,i){return n===i?(e-t)/s+(e<t?6:0):e===i?(t-n)/s+2:(n-e)/s+4}function hx(n){const t=n.r/255,s=n.g/255,i=n.b/255,r=Math.max(t,s,i),l=Math.min(t,s,i),c=(r+l)/2;let h,d,m;return r!==l&&(m=r-l,d=c>.5?m/(2-r-l):m/(r+l),h=M5(t,s,i,m,r),h=h*60+.5),[h|0,d||0,c]}function dx(n,e,t,s){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,s)).map(Da)}function fx(n,e,t){return dx(_N,n,e,t)}function O5(n,e,t){return dx(k5,n,e,t)}function P5(n,e,t){return dx(N5,n,e,t)}function yN(n){return(n%360+360)%360}function V5(n){const e=D5.exec(n);let t=255,s;if(!e)return;e[5]!==s&&(t=e[6]?zh(+e[5]):Da(+e[5]));const i=yN(+e[2]),r=+e[3]/100,l=+e[4]/100;return e[1]==="hwb"?s=O5(i,r,l):e[1]==="hsv"?s=P5(i,r,l):s=fx(i,r,l),{r:s[0],g:s[1],b:s[2],a:t}}function L5(n,e){var t=hx(n);t[0]=yN(t[0]+e),t=fx(t),n.r=t[0],n.g=t[1],n.b=t[2]}function j5(n){if(!n)return;const e=hx(n),t=e[0],s=JA(e[1]),i=JA(e[2]);return n.a<255?`hsla(${t}, ${s}%, ${i}%, ${ir(n.a)})`:`hsl(${t}, ${s}%, ${i}%)`}const e1={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},t1={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function U5(){const n={},e=Object.keys(t1),t=Object.keys(e1);let s,i,r,l,c;for(s=0;s<e.length;s++){for(l=c=e[s],i=0;i<t.length;i++)r=t[i],c=c.replace(r,e1[r]);r=parseInt(t1[l],16),n[c]=[r>>16&255,r>>8&255,r&255]}return n}let Bm;function B5(n){Bm||(Bm=U5(),Bm.transparent=[0,0,0,0]);const e=Bm[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const F5=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function z5(n){const e=F5.exec(n);let t=255,s,i,r;if(e){if(e[7]!==s){const l=+e[7];t=e[8]?zh(l):Ta(l*255,0,255)}return s=+e[1],i=+e[3],r=+e[5],s=255&(e[2]?zh(s):Ta(s,0,255)),i=255&(e[4]?zh(i):Ta(i,0,255)),r=255&(e[6]?zh(r):Ta(r,0,255)),{r:s,g:i,b:r,a:t}}}function H5(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${ir(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const y0=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,vc=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function q5(n,e,t){const s=vc(ir(n.r)),i=vc(ir(n.g)),r=vc(ir(n.b));return{r:Da(y0(s+t*(vc(ir(e.r))-s))),g:Da(y0(i+t*(vc(ir(e.g))-i))),b:Da(y0(r+t*(vc(ir(e.b))-r))),a:n.a+t*(e.a-n.a)}}function Fm(n,e,t){if(n){let s=hx(n);s[e]=Math.max(0,Math.min(s[e]+s[e]*t,e===0?360:1)),s=fx(s),n.r=s[0],n.g=s[1],n.b=s[2]}}function bN(n,e){return n&&Object.assign(e||{},n)}function n1(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=Da(n[3]))):(e=bN(n,{r:0,g:0,b:0,a:1}),e.a=Da(e.a)),e}function G5(n){return n.charAt(0)==="r"?z5(n):V5(n)}class Rd{constructor(e){if(e instanceof Rd)return e;const t=typeof e;let s;t==="object"?s=n1(e):t==="string"&&(s=I5(e)||B5(e)||G5(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=bN(this._rgb);return e&&(e.a=ir(e.a)),e}set rgb(e){this._rgb=n1(e)}rgbString(){return this._valid?H5(this._rgb):void 0}hexString(){return this._valid?C5(this._rgb):void 0}hslString(){return this._valid?j5(this._rgb):void 0}mix(e,t){if(e){const s=this.rgb,i=e.rgb;let r;const l=t===r?.5:t,c=2*l-1,h=s.a-i.a,d=((c*h===-1?c:(c+h)/(1+c*h))+1)/2;r=1-d,s.r=255&d*s.r+r*i.r+.5,s.g=255&d*s.g+r*i.g+.5,s.b=255&d*s.b+r*i.b+.5,s.a=l*s.a+(1-l)*i.a,this.rgb=s}return this}interpolate(e,t){return e&&(this._rgb=q5(this._rgb,e._rgb,t)),this}clone(){return new Rd(this.rgb)}alpha(e){return this._rgb.a=Da(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=lf(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Fm(this._rgb,2,e),this}darken(e){return Fm(this._rgb,2,-e),this}saturate(e){return Fm(this._rgb,1,e),this}desaturate(e){return Fm(this._rgb,1,-e),this}rotate(e){return L5(this._rgb,e),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function tr(){}const $5=(()=>{let n=0;return()=>n++})();function Qe(n){return n==null}function Ot(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Ze(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function Bt(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function ms(n,e){return Bt(n)?n:e}function Ue(n,e){return typeof n>"u"?e:n}const W5=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,vN=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function Tt(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function dt(n,e,t,s){let i,r,l;if(Ot(n))for(r=n.length,i=0;i<r;i++)e.call(t,n[i],i);else if(Ze(n))for(l=Object.keys(n),r=l.length,i=0;i<r;i++)e.call(t,n[l[i]],l[i])}function Zg(n,e){let t,s,i,r;if(!n||!e||n.length!==e.length)return!1;for(t=0,s=n.length;t<s;++t)if(i=n[t],r=e[t],i.datasetIndex!==r.datasetIndex||i.index!==r.index)return!1;return!0}function Jg(n){if(Ot(n))return n.map(Jg);if(Ze(n)){const e=Object.create(null),t=Object.keys(n),s=t.length;let i=0;for(;i<s;++i)e[t[i]]=Jg(n[t[i]]);return e}return n}function xN(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function Y5(n,e,t,s){if(!xN(n))return;const i=e[n],r=t[n];Ze(i)&&Ze(r)?Cd(i,r,s):e[n]=Jg(r)}function Cd(n,e,t){const s=Ot(e)?e:[e],i=s.length;if(!Ze(n))return n;t=t||{};const r=t.merger||Y5;let l;for(let c=0;c<i;++c){if(l=s[c],!Ze(l))continue;const h=Object.keys(l);for(let d=0,m=h.length;d<m;++d)r(h[d],n,l,t)}return n}function ad(n,e){return Cd(n,e,{merger:K5})}function K5(n,e,t){if(!xN(n))return;const s=e[n],i=t[n];Ze(s)&&Ze(i)?ad(s,i):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=Jg(i))}const s1={"":n=>n,x:n=>n.x,y:n=>n.y};function Q5(n){const e=n.split("."),t=[];let s="";for(const i of e)s+=i,s.endsWith("\\")?s=s.slice(0,-1)+".":(t.push(s),s="");return t}function X5(n){const e=Q5(n);return t=>{for(const s of e){if(s==="")break;t=t&&t[s]}return t}}function Ha(n,e){return(s1[e]||(s1[e]=X5(e)))(n)}function mx(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Dd=n=>typeof n<"u",qa=n=>typeof n=="function",i1=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function Z5(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const it=Math.PI,Rt=2*it,J5=Rt+it,ep=Number.POSITIVE_INFINITY,eU=it/180,Qt=it/2,jo=it/4,r1=it*2/3,Ea=Math.log10,Ai=Math.sign;function od(n,e,t){return Math.abs(n-e)<t}function a1(n){const e=Math.round(n);n=od(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(Ea(n))),s=n/t;return(s<=1?1:s<=2?2:s<=5?5:10)*t}function tU(n){const e=[],t=Math.sqrt(n);let s;for(s=1;s<t;s++)n%s===0&&(e.push(s),e.push(n/s));return t===(t|0)&&e.push(t),e.sort((i,r)=>i-r).pop(),e}function nU(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function tu(n){return!nU(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function sU(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function TN(n,e,t){let s,i,r;for(s=0,i=n.length;s<i;s++)r=n[s][t],isNaN(r)||(e.min=Math.min(e.min,r),e.max=Math.max(e.max,r))}function Ks(n){return n*(it/180)}function gx(n){return n*(180/it)}function o1(n){if(!Bt(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function EN(n,e){const t=e.x-n.x,s=e.y-n.y,i=Math.sqrt(t*t+s*s);let r=Math.atan2(s,t);return r<-.5*it&&(r+=Rt),{angle:r,distance:i}}function pb(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function iU(n,e){return(n-e+J5)%Rt-it}function Vn(n){return(n%Rt+Rt)%Rt}function Nd(n,e,t,s){const i=Vn(n),r=Vn(e),l=Vn(t),c=Vn(r-i),h=Vn(l-i),d=Vn(i-r),m=Vn(i-l);return i===r||i===l||s&&r===l||c>h&&d<m}function vn(n,e,t){return Math.max(e,Math.min(t,n))}function rU(n){return vn(n,-32768,32767)}function cr(n,e,t,s=1e-6){return n>=Math.min(e,t)-s&&n<=Math.max(e,t)+s}function px(n,e,t){t=t||(l=>n[l]<e);let s=n.length-1,i=0,r;for(;s-i>1;)r=i+s>>1,t(r)?i=r:s=r;return{lo:i,hi:s}}const ur=(n,e,t,s)=>px(n,t,s?i=>{const r=n[i][e];return r<t||r===t&&n[i+1][e]===t}:i=>n[i][e]<t),aU=(n,e,t)=>px(n,t,s=>n[s][e]>=t);function oU(n,e,t){let s=0,i=n.length;for(;s<i&&n[s]<e;)s++;for(;i>s&&n[i-1]>t;)i--;return s>0||i<n.length?n.slice(s,i):n}const wN=["push","pop","shift","splice","unshift"];function lU(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),wN.forEach(t=>{const s="_onData"+mx(t),i=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...r){const l=i.apply(this,r);return n._chartjs.listeners.forEach(c=>{typeof c[s]=="function"&&c[s](...r)}),l}})})}function l1(n,e){const t=n._chartjs;if(!t)return;const s=t.listeners,i=s.indexOf(e);i!==-1&&s.splice(i,1),!(s.length>0)&&(wN.forEach(r=>{delete n[r]}),delete n._chartjs)}function SN(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const AN=(function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame})();function IN(n,e){let t=[],s=!1;return function(...i){t=i,s||(s=!0,AN.call(window,()=>{s=!1,n.apply(e,t)}))}}function cU(n,e){let t;return function(...s){return e?(clearTimeout(t),t=setTimeout(n,e,s)):n.apply(this,s),e}}const _x=n=>n==="start"?"left":n==="end"?"right":"center",On=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,uU=(n,e,t,s)=>n===(s?"left":"right")?t:n==="center"?(e+t)/2:e;function RN(n,e,t){const s=e.length;let i=0,r=s;if(n._sorted){const{iScale:l,vScale:c,_parsed:h}=n,d=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,m=l.axis,{min:_,max:v,minDefined:T,maxDefined:S}=l.getUserBounds();if(T){if(i=Math.min(ur(h,m,_).lo,t?s:ur(e,m,l.getPixelForValue(_)).lo),d){const E=h.slice(0,i+1).reverse().findIndex(R=>!Qe(R[c.axis]));i-=Math.max(0,E)}i=vn(i,0,s-1)}if(S){let E=Math.max(ur(h,l.axis,v,!0).hi+1,t?0:ur(e,m,l.getPixelForValue(v),!0).hi+1);if(d){const R=h.slice(E-1).findIndex(k=>!Qe(k[c.axis]));E+=Math.max(0,R)}r=vn(E,i,s)-i}else r=s-i}return{start:i,count:r}}function CN(n){const{xScale:e,yScale:t,_scaleRanges:s}=n,i={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!s)return n._scaleRanges=i,!0;const r=s.xmin!==e.min||s.xmax!==e.max||s.ymin!==t.min||s.ymax!==t.max;return Object.assign(s,i),r}const zm=n=>n===0||n===1,c1=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*Rt/t)),u1=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*Rt/t)+1,ld={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*Qt)+1,easeOutSine:n=>Math.sin(n*Qt),easeInOutSine:n=>-.5*(Math.cos(it*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>zm(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>zm(n)?n:c1(n,.075,.3),easeOutElastic:n=>zm(n)?n:u1(n,.075,.3),easeInOutElastic(n){return zm(n)?n:n<.5?.5*c1(n*2,.1125,.45):.5+.5*u1(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-ld.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?ld.easeInBounce(n*2)*.5:ld.easeOutBounce(n*2-1)*.5+.5};function yx(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function h1(n){return yx(n)?n:new Rd(n)}function b0(n){return yx(n)?n:new Rd(n).saturate(.5).darken(.1).hexString()}const hU=["x","y","borderWidth","radius","tension"],dU=["color","borderColor","backgroundColor"];function fU(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:dU},numbers:{type:"number",properties:hU}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function mU(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const d1=new Map;function gU(n,e){e=e||{};const t=n+JSON.stringify(e);let s=d1.get(t);return s||(s=new Intl.NumberFormat(n,e),d1.set(t,s)),s}function cf(n,e,t){return gU(e,t).format(n)}const DN={values(n){return Ot(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const s=this.chart.options.locale;let i,r=n;if(t.length>1){const d=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(d<1e-4||d>1e15)&&(i="scientific"),r=pU(n,t)}const l=Ea(Math.abs(r)),c=isNaN(l)?1:Math.max(Math.min(-1*Math.floor(l),20),0),h={notation:i,minimumFractionDigits:c,maximumFractionDigits:c};return Object.assign(h,this.options.ticks.format),cf(n,s,h)},logarithmic(n,e,t){if(n===0)return"0";const s=t[e].significand||n/Math.pow(10,Math.floor(Ea(n)));return[1,2,3,5,10,15].includes(s)||e>.8*t.length?DN.numeric.call(this,n,e,t):""}};function pU(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var Hp={formatters:DN};function _U(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Hp.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const _l=Object.create(null),_b=Object.create(null);function cd(n,e){if(!e)return n;const t=e.split(".");for(let s=0,i=t.length;s<i;++s){const r=t[s];n=n[r]||(n[r]=Object.create(null))}return n}function v0(n,e,t){return typeof e=="string"?Cd(cd(n,e),t):Cd(cd(n,""),e)}class yU{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,i)=>b0(i.backgroundColor),this.hoverBorderColor=(s,i)=>b0(i.borderColor),this.hoverColor=(s,i)=>b0(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return v0(this,e,t)}get(e){return cd(this,e)}describe(e,t){return v0(_b,e,t)}override(e,t){return v0(_l,e,t)}route(e,t,s,i){const r=cd(this,e),l=cd(this,s),c="_"+t;Object.defineProperties(r,{[c]:{value:r[t],writable:!0},[t]:{enumerable:!0,get(){const h=this[c],d=l[i];return Ze(h)?Object.assign({},d,h):Ue(h,d)},set(h){this[c]=h}}})}apply(e){e.forEach(t=>t(this))}}var Pt=new yU({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[fU,mU,_U]);function bU(n){return!n||Qe(n.size)||Qe(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function tp(n,e,t,s,i){let r=e[i];return r||(r=e[i]=n.measureText(i).width,t.push(i)),r>s&&(s=r),s}function vU(n,e,t,s){s=s||{};let i=s.data=s.data||{},r=s.garbageCollect=s.garbageCollect||[];s.font!==e&&(i=s.data={},r=s.garbageCollect=[],s.font=e),n.save(),n.font=e;let l=0;const c=t.length;let h,d,m,_,v;for(h=0;h<c;h++)if(_=t[h],_!=null&&!Ot(_))l=tp(n,i,r,l,_);else if(Ot(_))for(d=0,m=_.length;d<m;d++)v=_[d],v!=null&&!Ot(v)&&(l=tp(n,i,r,l,v));n.restore();const T=r.length/2;if(T>t.length){for(h=0;h<T;h++)delete i[r[h]];r.splice(0,T)}return l}function Uo(n,e,t){const s=n.currentDevicePixelRatio,i=t!==0?Math.max(t/2,.5):0;return Math.round((e-i)*s)/s+i}function f1(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function yb(n,e,t,s){NN(n,e,t,s,null)}function NN(n,e,t,s,i){let r,l,c,h,d,m,_,v;const T=e.pointStyle,S=e.rotation,E=e.radius;let R=(S||0)*eU;if(T&&typeof T=="object"&&(r=T.toString(),r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]")){n.save(),n.translate(t,s),n.rotate(R),n.drawImage(T,-T.width/2,-T.height/2,T.width,T.height),n.restore();return}if(!(isNaN(E)||E<=0)){switch(n.beginPath(),T){default:i?n.ellipse(t,s,i/2,E,0,0,Rt):n.arc(t,s,E,0,Rt),n.closePath();break;case"triangle":m=i?i/2:E,n.moveTo(t+Math.sin(R)*m,s-Math.cos(R)*E),R+=r1,n.lineTo(t+Math.sin(R)*m,s-Math.cos(R)*E),R+=r1,n.lineTo(t+Math.sin(R)*m,s-Math.cos(R)*E),n.closePath();break;case"rectRounded":d=E*.516,h=E-d,l=Math.cos(R+jo)*h,_=Math.cos(R+jo)*(i?i/2-d:h),c=Math.sin(R+jo)*h,v=Math.sin(R+jo)*(i?i/2-d:h),n.arc(t-_,s-c,d,R-it,R-Qt),n.arc(t+v,s-l,d,R-Qt,R),n.arc(t+_,s+c,d,R,R+Qt),n.arc(t-v,s+l,d,R+Qt,R+it),n.closePath();break;case"rect":if(!S){h=Math.SQRT1_2*E,m=i?i/2:h,n.rect(t-m,s-h,2*m,2*h);break}R+=jo;case"rectRot":_=Math.cos(R)*(i?i/2:E),l=Math.cos(R)*E,c=Math.sin(R)*E,v=Math.sin(R)*(i?i/2:E),n.moveTo(t-_,s-c),n.lineTo(t+v,s-l),n.lineTo(t+_,s+c),n.lineTo(t-v,s+l),n.closePath();break;case"crossRot":R+=jo;case"cross":_=Math.cos(R)*(i?i/2:E),l=Math.cos(R)*E,c=Math.sin(R)*E,v=Math.sin(R)*(i?i/2:E),n.moveTo(t-_,s-c),n.lineTo(t+_,s+c),n.moveTo(t+v,s-l),n.lineTo(t-v,s+l);break;case"star":_=Math.cos(R)*(i?i/2:E),l=Math.cos(R)*E,c=Math.sin(R)*E,v=Math.sin(R)*(i?i/2:E),n.moveTo(t-_,s-c),n.lineTo(t+_,s+c),n.moveTo(t+v,s-l),n.lineTo(t-v,s+l),R+=jo,_=Math.cos(R)*(i?i/2:E),l=Math.cos(R)*E,c=Math.sin(R)*E,v=Math.sin(R)*(i?i/2:E),n.moveTo(t-_,s-c),n.lineTo(t+_,s+c),n.moveTo(t+v,s-l),n.lineTo(t-v,s+l);break;case"line":l=i?i/2:Math.cos(R)*E,c=Math.sin(R)*E,n.moveTo(t-l,s-c),n.lineTo(t+l,s+c);break;case"dash":n.moveTo(t,s),n.lineTo(t+Math.cos(R)*(i?i/2:E),s+Math.sin(R)*E);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function hr(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function qp(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function Gp(n){n.restore()}function xU(n,e,t,s,i){if(!e)return n.lineTo(t.x,t.y);if(i==="middle"){const r=(e.x+t.x)/2;n.lineTo(r,e.y),n.lineTo(r,t.y)}else i==="after"!=!!s?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function TU(n,e,t,s){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(s?e.cp1x:e.cp2x,s?e.cp1y:e.cp2y,s?t.cp2x:t.cp1x,s?t.cp2y:t.cp1y,t.x,t.y)}function EU(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),Qe(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function wU(n,e,t,s,i){if(i.strikethrough||i.underline){const r=n.measureText(s),l=e-r.actualBoundingBoxLeft,c=e+r.actualBoundingBoxRight,h=t-r.actualBoundingBoxAscent,d=t+r.actualBoundingBoxDescent,m=i.strikethrough?(h+d)/2:d;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=i.decorationWidth||2,n.moveTo(l,m),n.lineTo(c,m),n.stroke()}}function SU(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function yl(n,e,t,s,i,r={}){const l=Ot(e)?e:[e],c=r.strokeWidth>0&&r.strokeColor!=="";let h,d;for(n.save(),n.font=i.string,EU(n,r),h=0;h<l.length;++h)d=l[h],r.backdrop&&SU(n,r.backdrop),c&&(r.strokeColor&&(n.strokeStyle=r.strokeColor),Qe(r.strokeWidth)||(n.lineWidth=r.strokeWidth),n.strokeText(d,t,s,r.maxWidth)),n.fillText(d,t,s,r.maxWidth),wU(n,t,s,d,r),s+=Number(i.lineHeight);n.restore()}function kd(n,e){const{x:t,y:s,w:i,h:r,radius:l}=e;n.arc(t+l.topLeft,s+l.topLeft,l.topLeft,1.5*it,it,!0),n.lineTo(t,s+r-l.bottomLeft),n.arc(t+l.bottomLeft,s+r-l.bottomLeft,l.bottomLeft,it,Qt,!0),n.lineTo(t+i-l.bottomRight,s+r),n.arc(t+i-l.bottomRight,s+r-l.bottomRight,l.bottomRight,Qt,0,!0),n.lineTo(t+i,s+l.topRight),n.arc(t+i-l.topRight,s+l.topRight,l.topRight,0,-Qt,!0),n.lineTo(t+l.topLeft,s)}const AU=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,IU=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function RU(n,e){const t=(""+n).match(AU);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const CU=n=>+n||0;function bx(n,e){const t={},s=Ze(e),i=s?Object.keys(e):e,r=Ze(n)?s?l=>Ue(n[l],n[e[l]]):l=>n[l]:()=>n;for(const l of i)t[l]=CU(r(l));return t}function kN(n){return bx(n,{top:"y",right:"x",bottom:"y",left:"x"})}function al(n){return bx(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Bn(n){const e=kN(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function un(n,e){n=n||{},e=e||Pt.font;let t=Ue(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let s=Ue(n.style,e.style);s&&!(""+s).match(IU)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const i={family:Ue(n.family,e.family),lineHeight:RU(Ue(n.lineHeight,e.lineHeight),t),size:t,style:s,weight:Ue(n.weight,e.weight),string:""};return i.string=bU(i),i}function Hh(n,e,t,s){let i,r,l;for(i=0,r=n.length;i<r;++i)if(l=n[i],l!==void 0&&l!==void 0)return l}function DU(n,e,t){const{min:s,max:i}=n,r=vN(e,(i-s)/2),l=(c,h)=>t&&c===0?0:c+h;return{min:l(s,-Math.abs(r)),max:l(i,r)}}function Ja(n,e){return Object.assign(Object.create(n),e)}function vx(n,e=[""],t,s,i=()=>n[0]){const r=t||n;typeof s>"u"&&(s=VN("_fallback",n));const l={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:r,_fallback:s,_getTarget:i,override:c=>vx([c,...n],e,r,s)};return new Proxy(l,{deleteProperty(c,h){return delete c[h],delete c._keys,delete n[0][h],!0},get(c,h){return ON(c,h,()=>jU(h,e,n,c))},getOwnPropertyDescriptor(c,h){return Reflect.getOwnPropertyDescriptor(c._scopes[0],h)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(c,h){return g1(c).includes(h)},ownKeys(c){return g1(c)},set(c,h,d){const m=c._storage||(c._storage=i());return c[h]=m[h]=d,delete c._keys,!0}})}function nu(n,e,t,s){const i={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:MN(n,s),setContext:r=>nu(n,r,t,s),override:r=>nu(n.override(r),e,t,s)};return new Proxy(i,{deleteProperty(r,l){return delete r[l],delete n[l],!0},get(r,l,c){return ON(r,l,()=>kU(r,l,c))},getOwnPropertyDescriptor(r,l){return r._descriptors.allKeys?Reflect.has(n,l)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,l)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(r,l){return Reflect.has(n,l)},ownKeys(){return Reflect.ownKeys(n)},set(r,l,c){return n[l]=c,delete r[l],!0}})}function MN(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:s=e.indexable,_allKeys:i=e.allKeys}=n;return{allKeys:i,scriptable:t,indexable:s,isScriptable:qa(t)?t:()=>t,isIndexable:qa(s)?s:()=>s}}const NU=(n,e)=>n?n+mx(e):e,xx=(n,e)=>Ze(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function ON(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const s=t();return n[e]=s,s}function kU(n,e,t){const{_proxy:s,_context:i,_subProxy:r,_descriptors:l}=n;let c=s[e];return qa(c)&&l.isScriptable(e)&&(c=MU(e,c,n,t)),Ot(c)&&c.length&&(c=OU(e,c,n,l.isIndexable)),xx(e,c)&&(c=nu(c,i,r&&r[e],l)),c}function MU(n,e,t,s){const{_proxy:i,_context:r,_subProxy:l,_stack:c}=t;if(c.has(n))throw new Error("Recursion detected: "+Array.from(c).join("->")+"->"+n);c.add(n);let h=e(r,l||s);return c.delete(n),xx(n,h)&&(h=Tx(i._scopes,i,n,h)),h}function OU(n,e,t,s){const{_proxy:i,_context:r,_subProxy:l,_descriptors:c}=t;if(typeof r.index<"u"&&s(n))return e[r.index%e.length];if(Ze(e[0])){const h=e,d=i._scopes.filter(m=>m!==h);e=[];for(const m of h){const _=Tx(d,i,n,m);e.push(nu(_,r,l&&l[n],c))}}return e}function PN(n,e,t){return qa(n)?n(e,t):n}const PU=(n,e)=>n===!0?e:typeof n=="string"?Ha(e,n):void 0;function VU(n,e,t,s,i){for(const r of e){const l=PU(t,r);if(l){n.add(l);const c=PN(l._fallback,t,i);if(typeof c<"u"&&c!==t&&c!==s)return c}else if(l===!1&&typeof s<"u"&&t!==s)return null}return!1}function Tx(n,e,t,s){const i=e._rootScopes,r=PN(e._fallback,t,s),l=[...n,...i],c=new Set;c.add(s);let h=m1(c,l,t,r||t,s);return h===null||typeof r<"u"&&r!==t&&(h=m1(c,l,r,h,s),h===null)?!1:vx(Array.from(c),[""],i,r,()=>LU(e,t,s))}function m1(n,e,t,s,i){for(;t;)t=VU(n,e,t,s,i);return t}function LU(n,e,t){const s=n._getTarget();e in s||(s[e]={});const i=s[e];return Ot(i)&&Ze(t)?t:i||{}}function jU(n,e,t,s){let i;for(const r of e)if(i=VN(NU(r,n),t),typeof i<"u")return xx(n,i)?Tx(t,s,n,i):i}function VN(n,e){for(const t of e){if(!t)continue;const s=t[n];if(typeof s<"u")return s}}function g1(n){let e=n._keys;return e||(e=n._keys=UU(n._scopes)),e}function UU(n){const e=new Set;for(const t of n)for(const s of Object.keys(t).filter(i=>!i.startsWith("_")))e.add(s);return Array.from(e)}function LN(n,e,t,s){const{iScale:i}=n,{key:r="r"}=this._parsing,l=new Array(s);let c,h,d,m;for(c=0,h=s;c<h;++c)d=c+t,m=e[d],l[c]={r:i.parse(Ha(m,r),d)};return l}const BU=Number.EPSILON||1e-14,su=(n,e)=>e<n.length&&!n[e].skip&&n[e],jN=n=>n==="x"?"y":"x";function FU(n,e,t,s){const i=n.skip?e:n,r=e,l=t.skip?e:t,c=pb(r,i),h=pb(l,r);let d=c/(c+h),m=h/(c+h);d=isNaN(d)?0:d,m=isNaN(m)?0:m;const _=s*d,v=s*m;return{previous:{x:r.x-_*(l.x-i.x),y:r.y-_*(l.y-i.y)},next:{x:r.x+v*(l.x-i.x),y:r.y+v*(l.y-i.y)}}}function zU(n,e,t){const s=n.length;let i,r,l,c,h,d=su(n,0);for(let m=0;m<s-1;++m)if(h=d,d=su(n,m+1),!(!h||!d)){if(od(e[m],0,BU)){t[m]=t[m+1]=0;continue}i=t[m]/e[m],r=t[m+1]/e[m],c=Math.pow(i,2)+Math.pow(r,2),!(c<=9)&&(l=3/Math.sqrt(c),t[m]=i*l*e[m],t[m+1]=r*l*e[m])}}function HU(n,e,t="x"){const s=jN(t),i=n.length;let r,l,c,h=su(n,0);for(let d=0;d<i;++d){if(l=c,c=h,h=su(n,d+1),!c)continue;const m=c[t],_=c[s];l&&(r=(m-l[t])/3,c[`cp1${t}`]=m-r,c[`cp1${s}`]=_-r*e[d]),h&&(r=(h[t]-m)/3,c[`cp2${t}`]=m+r,c[`cp2${s}`]=_+r*e[d])}}function qU(n,e="x"){const t=jN(e),s=n.length,i=Array(s).fill(0),r=Array(s);let l,c,h,d=su(n,0);for(l=0;l<s;++l)if(c=h,h=d,d=su(n,l+1),!!h){if(d){const m=d[e]-h[e];i[l]=m!==0?(d[t]-h[t])/m:0}r[l]=c?d?Ai(i[l-1])!==Ai(i[l])?0:(i[l-1]+i[l])/2:i[l-1]:i[l]}zU(n,i,r),HU(n,r,e)}function Hm(n,e,t){return Math.max(Math.min(n,t),e)}function GU(n,e){let t,s,i,r,l,c=hr(n[0],e);for(t=0,s=n.length;t<s;++t)l=r,r=c,c=t<s-1&&hr(n[t+1],e),r&&(i=n[t],l&&(i.cp1x=Hm(i.cp1x,e.left,e.right),i.cp1y=Hm(i.cp1y,e.top,e.bottom)),c&&(i.cp2x=Hm(i.cp2x,e.left,e.right),i.cp2y=Hm(i.cp2y,e.top,e.bottom)))}function $U(n,e,t,s,i){let r,l,c,h;if(e.spanGaps&&(n=n.filter(d=>!d.skip)),e.cubicInterpolationMode==="monotone")qU(n,i);else{let d=s?n[n.length-1]:n[0];for(r=0,l=n.length;r<l;++r)c=n[r],h=FU(d,c,n[Math.min(r+1,l-(s?0:1))%l],e.tension),c.cp1x=h.previous.x,c.cp1y=h.previous.y,c.cp2x=h.next.x,c.cp2y=h.next.y,d=c}e.capBezierPoints&&GU(n,t)}function Ex(){return typeof window<"u"&&typeof document<"u"}function wx(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function np(n,e,t){let s;return typeof n=="string"?(s=parseInt(n,10),n.indexOf("%")!==-1&&(s=s/100*e.parentNode[t])):s=n,s}const $p=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function WU(n,e){return $p(n).getPropertyValue(e)}const YU=["top","right","bottom","left"];function ol(n,e,t){const s={};t=t?"-"+t:"";for(let i=0;i<4;i++){const r=YU[i];s[r]=parseFloat(n[e+"-"+r+t])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const KU=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function QU(n,e){const t=n.touches,s=t&&t.length?t[0]:n,{offsetX:i,offsetY:r}=s;let l=!1,c,h;if(KU(i,r,n.target))c=i,h=r;else{const d=e.getBoundingClientRect();c=s.clientX-d.left,h=s.clientY-d.top,l=!0}return{x:c,y:h,box:l}}function Go(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:s}=e,i=$p(t),r=i.boxSizing==="border-box",l=ol(i,"padding"),c=ol(i,"border","width"),{x:h,y:d,box:m}=QU(n,t),_=l.left+(m&&c.left),v=l.top+(m&&c.top);let{width:T,height:S}=e;return r&&(T-=l.width+c.width,S-=l.height+c.height),{x:Math.round((h-_)/T*t.width/s),y:Math.round((d-v)/S*t.height/s)}}function XU(n,e,t){let s,i;if(e===void 0||t===void 0){const r=n&&wx(n);if(!r)e=n.clientWidth,t=n.clientHeight;else{const l=r.getBoundingClientRect(),c=$p(r),h=ol(c,"border","width"),d=ol(c,"padding");e=l.width-d.width-h.width,t=l.height-d.height-h.height,s=np(c.maxWidth,r,"clientWidth"),i=np(c.maxHeight,r,"clientHeight")}}return{width:e,height:t,maxWidth:s||ep,maxHeight:i||ep}}const qm=n=>Math.round(n*10)/10;function ZU(n,e,t,s){const i=$p(n),r=ol(i,"margin"),l=np(i.maxWidth,n,"clientWidth")||ep,c=np(i.maxHeight,n,"clientHeight")||ep,h=XU(n,e,t);let{width:d,height:m}=h;if(i.boxSizing==="content-box"){const v=ol(i,"border","width"),T=ol(i,"padding");d-=T.width+v.width,m-=T.height+v.height}return d=Math.max(0,d-r.width),m=Math.max(0,s?d/s:m-r.height),d=qm(Math.min(d,l,h.maxWidth)),m=qm(Math.min(m,c,h.maxHeight)),d&&!m&&(m=qm(d/2)),(e!==void 0||t!==void 0)&&s&&h.height&&m>h.height&&(m=h.height,d=qm(Math.floor(m*s))),{width:d,height:m}}function p1(n,e,t){const s=e||1,i=Math.floor(n.height*s),r=Math.floor(n.width*s);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const l=n.canvas;return l.style&&(t||!l.style.height&&!l.style.width)&&(l.style.height=`${n.height}px`,l.style.width=`${n.width}px`),n.currentDevicePixelRatio!==s||l.height!==i||l.width!==r?(n.currentDevicePixelRatio=s,l.height=i,l.width=r,n.ctx.setTransform(s,0,0,s,0,0),!0):!1}const JU=(function(){let n=!1;try{const e={get passive(){return n=!0,!1}};Ex()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n})();function _1(n,e){const t=WU(n,e),s=t&&t.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function $o(n,e,t,s){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function eB(n,e,t,s){return{x:n.x+t*(e.x-n.x),y:s==="middle"?t<.5?n.y:e.y:s==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function tB(n,e,t,s){const i={x:n.cp2x,y:n.cp2y},r={x:e.cp1x,y:e.cp1y},l=$o(n,i,t),c=$o(i,r,t),h=$o(r,e,t),d=$o(l,c,t),m=$o(c,h,t);return $o(d,m,t)}const nB=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,s){return t-s},leftForLtr(t,s){return t-s}}},sB=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function Mc(n,e,t){return n?nB(e,t):sB()}function UN(n,e){let t,s;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,s=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=s)}function BN(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function FN(n){return n==="angle"?{between:Nd,compare:iU,normalize:Vn}:{between:cr,compare:(e,t)=>e-t,normalize:e=>e}}function y1({start:n,end:e,count:t,loop:s,style:i}){return{start:n%t,end:e%t,loop:s&&(e-n+1)%t===0,style:i}}function iB(n,e,t){const{property:s,start:i,end:r}=t,{between:l,normalize:c}=FN(s),h=e.length;let{start:d,end:m,loop:_}=n,v,T;if(_){for(d+=h,m+=h,v=0,T=h;v<T&&l(c(e[d%h][s]),i,r);++v)d--,m--;d%=h,m%=h}return m<d&&(m+=h),{start:d,end:m,loop:_,style:n.style}}function zN(n,e,t){if(!t)return[n];const{property:s,start:i,end:r}=t,l=e.length,{compare:c,between:h,normalize:d}=FN(s),{start:m,end:_,loop:v,style:T}=iB(n,e,t),S=[];let E=!1,R=null,k,L,O;const H=()=>h(i,O,k)&&c(i,O)!==0,F=()=>c(r,k)===0||h(r,O,k),U=()=>E||H(),C=()=>!E||F();for(let I=m,N=m;I<=_;++I)L=e[I%l],!L.skip&&(k=d(L[s]),k!==O&&(E=h(k,i,r),R===null&&U()&&(R=c(k,i)===0?I:N),R!==null&&C()&&(S.push(y1({start:R,end:I,loop:v,count:l,style:T})),R=null),N=I,O=k));return R!==null&&S.push(y1({start:R,end:_,loop:v,count:l,style:T})),S}function HN(n,e){const t=[],s=n.segments;for(let i=0;i<s.length;i++){const r=zN(s[i],n.points,e);r.length&&t.push(...r)}return t}function rB(n,e,t,s){let i=0,r=e-1;if(t&&!s)for(;i<e&&!n[i].skip;)i++;for(;i<e&&n[i].skip;)i++;for(i%=e,t&&(r+=i);r>i&&n[r%e].skip;)r--;return r%=e,{start:i,end:r}}function aB(n,e,t,s){const i=n.length,r=[];let l=e,c=n[e],h;for(h=e+1;h<=t;++h){const d=n[h%i];d.skip||d.stop?c.skip||(s=!1,r.push({start:e%i,end:(h-1)%i,loop:s}),e=l=d.stop?h:null):(l=h,c.skip&&(e=h)),c=d}return l!==null&&r.push({start:e%i,end:l%i,loop:s}),r}function oB(n,e){const t=n.points,s=n.options.spanGaps,i=t.length;if(!i)return[];const r=!!n._loop,{start:l,end:c}=rB(t,i,r,s);if(s===!0)return b1(n,[{start:l,end:c,loop:r}],t,e);const h=c<l?c+i:c,d=!!n._fullLoop&&l===0&&c===i-1;return b1(n,aB(t,l,h,d),t,e)}function b1(n,e,t,s){return!s||!s.setContext||!t?e:lB(n,e,t,s)}function lB(n,e,t,s){const i=n._chart.getContext(),r=v1(n.options),{_datasetIndex:l,options:{spanGaps:c}}=n,h=t.length,d=[];let m=r,_=e[0].start,v=_;function T(S,E,R,k){const L=c?-1:1;if(S!==E){for(S+=h;t[S%h].skip;)S-=L;for(;t[E%h].skip;)E+=L;S%h!==E%h&&(d.push({start:S%h,end:E%h,loop:R,style:k}),m=k,_=E%h)}}for(const S of e){_=c?_:S.start;let E=t[_%h],R;for(v=_+1;v<=S.end;v++){const k=t[v%h];R=v1(s.setContext(Ja(i,{type:"segment",p0:E,p1:k,p0DataIndex:(v-1)%h,p1DataIndex:v%h,datasetIndex:l}))),cB(R,m)&&T(_,v-1,S.loop,m),E=k,m=R}_<v-1&&T(_,v-1,S.loop,m)}return d}function v1(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function cB(n,e){if(!e)return!1;const t=[],s=function(i,r){return yx(r)?(t.includes(r)||t.push(r),t.indexOf(r)):r};return JSON.stringify(n,s)!==JSON.stringify(e,s)}function Gm(n,e,t){return n.options.clip?n[t]:e[t]}function uB(n,e){const{xScale:t,yScale:s}=n;return t&&s?{left:Gm(t,e,"left"),right:Gm(t,e,"right"),top:Gm(s,e,"top"),bottom:Gm(s,e,"bottom")}:e}function qN(n,e){const t=e._clip;if(t.disabled)return!1;const s=uB(e,n.chartArea);return{left:t.left===!1?0:s.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:s.right+(t.right===!0?0:t.right),top:t.top===!1?0:s.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:s.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class hB{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,s,i){const r=t.listeners[i],l=t.duration;r.forEach(c=>c({chart:e,initial:t.initial,numSteps:l,currentStep:Math.min(s-t.start,l)}))}_refresh(){this._request||(this._running=!0,this._request=AN.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((s,i)=>{if(!s.running||!s.items.length)return;const r=s.items;let l=r.length-1,c=!1,h;for(;l>=0;--l)h=r[l],h._active?(h._total>s.duration&&(s.duration=h._total),h.tick(e),c=!0):(r[l]=r[r.length-1],r.pop());c&&(i.draw(),this._notify(i,s,e,"progress")),r.length||(s.running=!1,this._notify(i,s,e,"complete"),s.initial=!1),t+=r.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let s=t.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,s)),s}listen(e,t,s){this._getAnims(e).listeners[t].push(s)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((s,i)=>Math.max(s,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const s=t.items;let i=s.length-1;for(;i>=0;--i)s[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var nr=new hB;const x1="transparent",dB={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const s=h1(n||x1),i=s.valid&&h1(e||x1);return i&&i.valid?i.mix(s,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class fB{constructor(e,t,s,i){const r=t[s];i=Hh([e.to,i,r,e.from]);const l=Hh([e.from,r,i]);this._active=!0,this._fn=e.fn||dB[e.type||typeof l],this._easing=ld[e.easing]||ld.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=s,this._from=l,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,s){if(this._active){this._notify(!1);const i=this._target[this._prop],r=s-this._start,l=this._duration-r;this._start=s,this._duration=Math.floor(Math.max(l,e.duration)),this._total+=r,this._loop=!!e.loop,this._to=Hh([e.to,t,i,e.from]),this._from=Hh([e.from,i,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,s=this._duration,i=this._prop,r=this._from,l=this._loop,c=this._to;let h;if(this._active=r!==c&&(l||t<s),!this._active){this._target[i]=c,this._notify(!0);return}if(t<0){this._target[i]=r;return}h=t/s%2,h=l&&h>1?2-h:h,h=this._easing(Math.min(1,Math.max(0,h))),this._target[i]=this._fn(r,c,h)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,s)=>{e.push({res:t,rej:s})})}_notify(e){const t=e?"res":"rej",s=this._promises||[];for(let i=0;i<s.length;i++)s[i][t]()}}class GN{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Ze(e))return;const t=Object.keys(Pt.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const r=e[i];if(!Ze(r))return;const l={};for(const c of t)l[c]=r[c];(Ot(r.properties)&&r.properties||[i]).forEach(c=>{(c===i||!s.has(c))&&s.set(c,l)})})}_animateOptions(e,t){const s=t.options,i=gB(e,s);if(!i)return[];const r=this._createAnimations(i,s);return s.$shared&&mB(e.options.$animations,s).then(()=>{e.options=s},()=>{}),r}_createAnimations(e,t){const s=this._properties,i=[],r=e.$animations||(e.$animations={}),l=Object.keys(t),c=Date.now();let h;for(h=l.length-1;h>=0;--h){const d=l[h];if(d.charAt(0)==="$")continue;if(d==="options"){i.push(...this._animateOptions(e,t));continue}const m=t[d];let _=r[d];const v=s.get(d);if(_)if(v&&_.active()){_.update(v,m,c);continue}else _.cancel();if(!v||!v.duration){e[d]=m;continue}r[d]=_=new fB(v,e,d,m),i.push(_)}return i}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const s=this._createAnimations(e,t);if(s.length)return nr.add(this._chart,s),!0}}function mB(n,e){const t=[],s=Object.keys(e);for(let i=0;i<s.length;i++){const r=n[s[i]];r&&r.active()&&t.push(r.wait())}return Promise.all(t)}function gB(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function T1(n,e){const t=n&&n.options||{},s=t.reverse,i=t.min===void 0?e:0,r=t.max===void 0?e:0;return{start:s?r:i,end:s?i:r}}function pB(n,e,t){if(t===!1)return!1;const s=T1(n,t),i=T1(e,t);return{top:i.end,right:s.end,bottom:i.start,left:s.start}}function _B(n){let e,t,s,i;return Ze(n)?(e=n.top,t=n.right,s=n.bottom,i=n.left):e=t=s=i=n,{top:e,right:t,bottom:s,left:i,disabled:n===!1}}function $N(n,e){const t=[],s=n._getSortedDatasetMetas(e);let i,r;for(i=0,r=s.length;i<r;++i)t.push(s[i].index);return t}function E1(n,e,t,s={}){const i=n.keys,r=s.mode==="single";let l,c,h,d;if(e===null)return;let m=!1;for(l=0,c=i.length;l<c;++l){if(h=+i[l],h===t){if(m=!0,s.all)continue;break}d=n.values[h],Bt(d)&&(r||e===0||Ai(e)===Ai(d))&&(e+=d)}return!m&&!s.all?0:e}function yB(n,e){const{iScale:t,vScale:s}=e,i=t.axis==="x"?"x":"y",r=s.axis==="x"?"x":"y",l=Object.keys(n),c=new Array(l.length);let h,d,m;for(h=0,d=l.length;h<d;++h)m=l[h],c[h]={[i]:m,[r]:n[m]};return c}function x0(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function bB(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function vB(n){const{min:e,max:t,minDefined:s,maxDefined:i}=n.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:i?t:Number.POSITIVE_INFINITY}}function xB(n,e,t){const s=n[e]||(n[e]={});return s[t]||(s[t]={})}function w1(n,e,t,s){for(const i of e.getMatchingVisibleMetas(s).reverse()){const r=n[i.index];if(t&&r>0||!t&&r<0)return i.index}return null}function S1(n,e){const{chart:t,_cachedMeta:s}=n,i=t._stacks||(t._stacks={}),{iScale:r,vScale:l,index:c}=s,h=r.axis,d=l.axis,m=bB(r,l,s),_=e.length;let v;for(let T=0;T<_;++T){const S=e[T],{[h]:E,[d]:R}=S,k=S._stacks||(S._stacks={});v=k[d]=xB(i,m,E),v[c]=R,v._top=w1(v,l,!0,s.type),v._bottom=w1(v,l,!1,s.type);const L=v._visualValues||(v._visualValues={});L[c]=R}}function T0(n,e){const t=n.scales;return Object.keys(t).filter(s=>t[s].axis===e).shift()}function TB(n,e){return Ja(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function EB(n,e,t){return Ja(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function Nh(n,e){const t=n.controller.index,s=n.vScale&&n.vScale.axis;if(s){e=e||n._parsed;for(const i of e){const r=i._stacks;if(!r||r[s]===void 0||r[s][t]===void 0)return;delete r[s][t],r[s]._visualValues!==void 0&&r[s]._visualValues[t]!==void 0&&delete r[s]._visualValues[t]}}}const E0=n=>n==="reset"||n==="none",A1=(n,e)=>e?n:Object.assign({},n),wB=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:$N(t,!0),values:null};class Js{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=x0(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Nh(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,s=this.getDataset(),i=(_,v,T,S)=>_==="x"?v:_==="r"?S:T,r=t.xAxisID=Ue(s.xAxisID,T0(e,"x")),l=t.yAxisID=Ue(s.yAxisID,T0(e,"y")),c=t.rAxisID=Ue(s.rAxisID,T0(e,"r")),h=t.indexAxis,d=t.iAxisID=i(h,r,l,c),m=t.vAxisID=i(h,l,r,c);t.xScale=this.getScaleForId(r),t.yScale=this.getScaleForId(l),t.rScale=this.getScaleForId(c),t.iScale=this.getScaleForId(d),t.vScale=this.getScaleForId(m)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&l1(this._data,this),e._stacked&&Nh(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),s=this._data;if(Ze(t)){const i=this._cachedMeta;this._data=yB(t,i)}else if(s!==t){if(s){l1(s,this);const i=this._cachedMeta;Nh(i),i._parsed=[]}t&&Object.isExtensible(t)&&lU(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,s=this.getDataset();let i=!1;this._dataCheck();const r=t._stacked;t._stacked=x0(t.vScale,t),t.stack!==s.stack&&(i=!0,Nh(t),t.stack=s.stack),this._resyncElements(e),(i||r!==t._stacked)&&(S1(this,t._parsed),t._stacked=x0(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:s,_data:i}=this,{iScale:r,_stacked:l}=s,c=r.axis;let h=e===0&&t===i.length?!0:s._sorted,d=e>0&&s._parsed[e-1],m,_,v;if(this._parsing===!1)s._parsed=i,s._sorted=!0,v=i;else{Ot(i[e])?v=this.parseArrayData(s,i,e,t):Ze(i[e])?v=this.parseObjectData(s,i,e,t):v=this.parsePrimitiveData(s,i,e,t);const T=()=>_[c]===null||d&&_[c]<d[c];for(m=0;m<t;++m)s._parsed[m+e]=_=v[m],h&&(T()&&(h=!1),d=_);s._sorted=h}l&&S1(this,v)}parsePrimitiveData(e,t,s,i){const{iScale:r,vScale:l}=e,c=r.axis,h=l.axis,d=r.getLabels(),m=r===l,_=new Array(i);let v,T,S;for(v=0,T=i;v<T;++v)S=v+s,_[v]={[c]:m||r.parse(d[S],S),[h]:l.parse(t[S],S)};return _}parseArrayData(e,t,s,i){const{xScale:r,yScale:l}=e,c=new Array(i);let h,d,m,_;for(h=0,d=i;h<d;++h)m=h+s,_=t[m],c[h]={x:r.parse(_[0],m),y:l.parse(_[1],m)};return c}parseObjectData(e,t,s,i){const{xScale:r,yScale:l}=e,{xAxisKey:c="x",yAxisKey:h="y"}=this._parsing,d=new Array(i);let m,_,v,T;for(m=0,_=i;m<_;++m)v=m+s,T=t[v],d[m]={x:r.parse(Ha(T,c),v),y:l.parse(Ha(T,h),v)};return d}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,s){const i=this.chart,r=this._cachedMeta,l=t[e.axis],c={keys:$N(i,!0),values:t._stacks[e.axis]._visualValues};return E1(c,l,r.index,{mode:s})}updateRangeFromParsed(e,t,s,i){const r=s[t.axis];let l=r===null?NaN:r;const c=i&&s._stacks[t.axis];i&&c&&(i.values=c,l=E1(i,r,this._cachedMeta.index)),e.min=Math.min(e.min,l),e.max=Math.max(e.max,l)}getMinMax(e,t){const s=this._cachedMeta,i=s._parsed,r=s._sorted&&e===s.iScale,l=i.length,c=this._getOtherScale(e),h=wB(t,s,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:m,max:_}=vB(c);let v,T;function S(){T=i[v];const E=T[c.axis];return!Bt(T[e.axis])||m>E||_<E}for(v=0;v<l&&!(!S()&&(this.updateRangeFromParsed(d,e,T,h),r));++v);if(r){for(v=l-1;v>=0;--v)if(!S()){this.updateRangeFromParsed(d,e,T,h);break}}return d}getAllParsedValues(e){const t=this._cachedMeta._parsed,s=[];let i,r,l;for(i=0,r=t.length;i<r;++i)l=t[i][e.axis],Bt(l)&&s.push(l);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,s=t.iScale,i=t.vScale,r=this.getParsed(e);return{label:s?""+s.getLabelForValue(r[s.axis]):"",value:i?""+i.getLabelForValue(r[i.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=_B(Ue(this.options.clip,pB(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,s=this._cachedMeta,i=s.data||[],r=t.chartArea,l=[],c=this._drawStart||0,h=this._drawCount||i.length-c,d=this.options.drawActiveElementsOnTop;let m;for(s.dataset&&s.dataset.draw(e,r,c,h),m=c;m<c+h;++m){const _=i[m];_.hidden||(_.active&&d?l.push(_):_.draw(e,r))}for(m=0;m<l.length;++m)l[m].draw(e,r)}getStyle(e,t){const s=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,t,s){const i=this.getDataset();let r;if(e>=0&&e<this._cachedMeta.data.length){const l=this._cachedMeta.data[e];r=l.$context||(l.$context=EB(this.getContext(),e,l)),r.parsed=this.getParsed(e),r.raw=i.data[e],r.index=r.dataIndex=e}else r=this.$context||(this.$context=TB(this.chart.getContext(),this.index)),r.dataset=i,r.index=r.datasetIndex=this.index;return r.active=!!t,r.mode=s,r}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",s){const i=t==="active",r=this._cachedDataOpts,l=e+"-"+t,c=r[l],h=this.enableOptionSharing&&Dd(s);if(c)return A1(c,h);const d=this.chart.config,m=d.datasetElementScopeKeys(this._type,e),_=i?[`${e}Hover`,"hover",e,""]:[e,""],v=d.getOptionScopes(this.getDataset(),m),T=Object.keys(Pt.elements[e]),S=()=>this.getContext(s,i,t),E=d.resolveNamedOptions(v,T,S,_);return E.$shared&&(E.$shared=h,r[l]=Object.freeze(A1(E,h))),E}_resolveAnimations(e,t,s){const i=this.chart,r=this._cachedDataOpts,l=`animation-${t}`,c=r[l];if(c)return c;let h;if(i.options.animation!==!1){const m=this.chart.config,_=m.datasetAnimationScopeKeys(this._type,t),v=m.getOptionScopes(this.getDataset(),_);h=m.createResolver(v,this.getContext(e,s,t))}const d=new GN(i,h&&h.animations);return h&&h._cacheable&&(r[l]=Object.freeze(d)),d}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||E0(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const s=this.resolveDataElementOptions(e,t),i=this._sharedOptions,r=this.getSharedOptions(s),l=this.includeOptions(t,r)||r!==i;return this.updateSharedOptions(r,t,s),{sharedOptions:r,includeOptions:l}}updateElement(e,t,s,i){E0(i)?Object.assign(e,s):this._resolveAnimations(t,i).update(e,s)}updateSharedOptions(e,t,s){e&&!E0(t)&&this._resolveAnimations(void 0,t).update(e,s)}_setStyle(e,t,s,i){e.active=i;const r=this.getStyle(t,i);this._resolveAnimations(t,s,i).update(e,{options:!i&&this.getSharedOptions(r)||r})}removeHoverStyle(e,t,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,t,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,s=this._cachedMeta.data;for(const[c,h,d]of this._syncList)this[c](h,d);this._syncList=[];const i=s.length,r=t.length,l=Math.min(r,i);l&&this.parse(0,l),r>i?this._insertElements(i,r-i,e):r<i&&this._removeElements(r,i-r)}_insertElements(e,t,s=!0){const i=this._cachedMeta,r=i.data,l=e+t;let c;const h=d=>{for(d.length+=t,c=d.length-1;c>=l;c--)d[c]=d[c-t]};for(h(r),c=e;c<l;++c)r[c]=new this.dataElementType;this._parsing&&h(i._parsed),this.parse(e,t),s&&this.updateElements(r,e,t,"reset")}updateElements(e,t,s,i){}_removeElements(e,t){const s=this._cachedMeta;if(this._parsing){const i=s._parsed.splice(e,t);s._stacked&&Nh(s,i)}s.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,s,i]=e;this[t](s,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}_e(Js,"defaults",{}),_e(Js,"datasetElementType",null),_e(Js,"dataElementType",null);function SB(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let s=[];for(let i=0,r=t.length;i<r;i++)s=s.concat(t[i].controller.getAllParsedValues(n));n._cache.$bar=SN(s.sort((i,r)=>i-r))}return n._cache.$bar}function AB(n){const e=n.iScale,t=SB(e,n.type);let s=e._length,i,r,l,c;const h=()=>{l===32767||l===-32768||(Dd(c)&&(s=Math.min(s,Math.abs(l-c)||s)),c=l)};for(i=0,r=t.length;i<r;++i)l=e.getPixelForValue(t[i]),h();for(c=void 0,i=0,r=e.ticks.length;i<r;++i)l=e.getPixelForTick(i),h();return s}function IB(n,e,t,s){const i=t.barThickness;let r,l;return Qe(i)?(r=e.min*t.categoryPercentage,l=t.barPercentage):(r=i*s,l=1),{chunk:r/s,ratio:l,start:e.pixels[n]-r/2}}function RB(n,e,t,s){const i=e.pixels,r=i[n];let l=n>0?i[n-1]:null,c=n<i.length-1?i[n+1]:null;const h=t.categoryPercentage;l===null&&(l=r-(c===null?e.end-e.start:c-r)),c===null&&(c=r+r-l);const d=r-(r-Math.min(l,c))/2*h;return{chunk:Math.abs(c-l)/2*h/s,ratio:t.barPercentage,start:d}}function CB(n,e,t,s){const i=t.parse(n[0],s),r=t.parse(n[1],s),l=Math.min(i,r),c=Math.max(i,r);let h=l,d=c;Math.abs(l)>Math.abs(c)&&(h=c,d=l),e[t.axis]=d,e._custom={barStart:h,barEnd:d,start:i,end:r,min:l,max:c}}function WN(n,e,t,s){return Ot(n)?CB(n,e,t,s):e[t.axis]=t.parse(n,s),e}function I1(n,e,t,s){const i=n.iScale,r=n.vScale,l=i.getLabels(),c=i===r,h=[];let d,m,_,v;for(d=t,m=t+s;d<m;++d)v=e[d],_={},_[i.axis]=c||i.parse(l[d],d),h.push(WN(v,_,r,d));return h}function w0(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function DB(n,e,t){return n!==0?Ai(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function NB(n){let e,t,s,i,r;return n.horizontal?(e=n.base>n.x,t="left",s="right"):(e=n.base<n.y,t="bottom",s="top"),e?(i="end",r="start"):(i="start",r="end"),{start:t,end:s,reverse:e,top:i,bottom:r}}function kB(n,e,t,s){let i=e.borderSkipped;const r={};if(!i){n.borderSkipped=r;return}if(i===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:l,end:c,reverse:h,top:d,bottom:m}=NB(n);i==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===s?i=d:(t._bottom||0)===s?i=m:(r[R1(m,l,c,h)]=!0,i=d)),r[R1(i,l,c,h)]=!0,n.borderSkipped=r}function R1(n,e,t,s){return s?(n=MB(n,e,t),n=C1(n,t,e)):n=C1(n,e,t),n}function MB(n,e,t){return n===e?t:n===t?e:n}function C1(n,e,t){return n==="start"?e:n==="end"?t:n}function OB(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class gg extends Js{parsePrimitiveData(e,t,s,i){return I1(e,t,s,i)}parseArrayData(e,t,s,i){return I1(e,t,s,i)}parseObjectData(e,t,s,i){const{iScale:r,vScale:l}=e,{xAxisKey:c="x",yAxisKey:h="y"}=this._parsing,d=r.axis==="x"?c:h,m=l.axis==="x"?c:h,_=[];let v,T,S,E;for(v=s,T=s+i;v<T;++v)E=t[v],S={},S[r.axis]=r.parse(Ha(E,d),v),_.push(WN(Ha(E,m),S,l,v));return _}updateRangeFromParsed(e,t,s,i){super.updateRangeFromParsed(e,t,s,i);const r=s._custom;r&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,r.min),e.max=Math.max(e.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:s,vScale:i}=t,r=this.getParsed(e),l=r._custom,c=w0(l)?"["+l.start+", "+l.end+"]":""+i.getLabelForValue(r[i.axis]);return{label:""+s.getLabelForValue(r[s.axis]),value:c}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,s,i){const r=i==="reset",{index:l,_cachedMeta:{vScale:c}}=this,h=c.getBasePixel(),d=c.isHorizontal(),m=this._getRuler(),{sharedOptions:_,includeOptions:v}=this._getSharedOptions(t,i);for(let T=t;T<t+s;T++){const S=this.getParsed(T),E=r||Qe(S[c.axis])?{base:h,head:h}:this._calculateBarValuePixels(T),R=this._calculateBarIndexPixels(T,m),k=(S._stacks||{})[c.axis],L={horizontal:d,base:E.base,enableBorderRadius:!k||w0(S._custom)||l===k._top||l===k._bottom,x:d?E.head:R.center,y:d?R.center:E.head,height:d?R.size:Math.abs(E.size),width:d?Math.abs(E.size):R.size};v&&(L.options=_||this.resolveDataElementOptions(T,e[T].active?"active":i));const O=L.options||e[T].options;kB(L,O,k,l),OB(L,O,m.ratio),this.updateElement(e[T],T,L,i)}}_getStacks(e,t){const{iScale:s}=this._cachedMeta,i=s.getMatchingVisibleMetas(this._type).filter(m=>m.controller.options.grouped),r=s.options.stacked,l=[],c=this._cachedMeta.controller.getParsed(t),h=c&&c[s.axis],d=m=>{const _=m._parsed.find(T=>T[s.axis]===h),v=_&&_[m.vScale.axis];if(Qe(v)||isNaN(v))return!0};for(const m of i)if(!(t!==void 0&&d(m))&&((r===!1||l.indexOf(m.stack)===-1||r===void 0&&m.stack===void 0)&&l.push(m.stack),m.index===e))break;return l.length||l.push(void 0),l}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(s=>e[s].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)e[Ue(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,s){const i=this._getStacks(e,s),r=t!==void 0?i.indexOf(t):-1;return r===-1?i.length-1:r}_getRuler(){const e=this.options,t=this._cachedMeta,s=t.iScale,i=[];let r,l;for(r=0,l=t.data.length;r<l;++r)i.push(s.getPixelForValue(this.getParsed(r)[s.axis],r));const c=e.barThickness;return{min:c||AB(t),pixels:i,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:c?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:s,index:i},options:{base:r,minBarLength:l}}=this,c=r||0,h=this.getParsed(e),d=h._custom,m=w0(d);let _=h[t.axis],v=0,T=s?this.applyStack(t,h,s):_,S,E;T!==_&&(v=T-_,T=_),m&&(_=d.barStart,T=d.barEnd-d.barStart,_!==0&&Ai(_)!==Ai(d.barEnd)&&(v=0),v+=_);const R=!Qe(r)&&!m?r:v;let k=t.getPixelForValue(R);if(this.chart.getDataVisibility(e)?S=t.getPixelForValue(v+T):S=k,E=S-k,Math.abs(E)<l){E=DB(E,t,c)*l,_===c&&(k-=E/2);const L=t.getPixelForDecimal(0),O=t.getPixelForDecimal(1),H=Math.min(L,O),F=Math.max(L,O);k=Math.max(Math.min(k,F),H),S=k+E,s&&!m&&(h._stacks[t.axis]._visualValues[i]=t.getValueForPixel(S)-t.getValueForPixel(k))}if(k===t.getPixelForValue(c)){const L=Ai(E)*t.getLineWidthForValue(c)/2;k+=L,E-=L}return{size:E,base:k,head:S,center:S+E/2}}_calculateBarIndexPixels(e,t){const s=t.scale,i=this.options,r=i.skipNull,l=Ue(i.maxBarThickness,1/0);let c,h;const d=this._getAxisCount();if(t.grouped){const m=r?this._getStackCount(e):t.stackCount,_=i.barThickness==="flex"?RB(e,t,i,m*d):IB(e,t,i,m*d),v=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,T=this._getAxis().indexOf(Ue(v,this.getFirstScaleIdForIndexAxis())),S=this._getStackIndex(this.index,this._cachedMeta.stack,r?e:void 0)+T;c=_.start+_.chunk*S+_.chunk/2,h=Math.min(l,_.chunk*_.ratio)}else c=s.getPixelForValue(this.getParsed(e)[s.axis],e),h=Math.min(l,t.min*t.ratio);return{base:c-h/2,head:c+h/2,center:c,size:h}}draw(){const e=this._cachedMeta,t=e.vScale,s=e.data,i=s.length;let r=0;for(;r<i;++r)this.getParsed(r)[t.axis]!==null&&!s[r].hidden&&s[r].draw(this._ctx)}}_e(gg,"id","bar"),_e(gg,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),_e(gg,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class pg extends Js{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,s,i){const r=super.parsePrimitiveData(e,t,s,i);for(let l=0;l<r.length;l++)r[l]._custom=this.resolveDataElementOptions(l+s).radius;return r}parseArrayData(e,t,s,i){const r=super.parseArrayData(e,t,s,i);for(let l=0;l<r.length;l++){const c=t[s+l];r[l]._custom=Ue(c[2],this.resolveDataElementOptions(l+s).radius)}return r}parseObjectData(e,t,s,i){const r=super.parseObjectData(e,t,s,i);for(let l=0;l<r.length;l++){const c=t[s+l];r[l]._custom=Ue(c&&c.r&&+c.r,this.resolveDataElementOptions(l+s).radius)}return r}getMaxOverflow(){const e=this._cachedMeta.data;let t=0;for(let s=e.length-1;s>=0;--s)t=Math.max(t,e[s].size(this.resolveDataElementOptions(s))/2);return t>0&&t}getLabelAndValue(e){const t=this._cachedMeta,s=this.chart.data.labels||[],{xScale:i,yScale:r}=t,l=this.getParsed(e),c=i.getLabelForValue(l.x),h=r.getLabelForValue(l.y),d=l._custom;return{label:s[e]||"",value:"("+c+", "+h+(d?", "+d:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,s,i){const r=i==="reset",{iScale:l,vScale:c}=this._cachedMeta,{sharedOptions:h,includeOptions:d}=this._getSharedOptions(t,i),m=l.axis,_=c.axis;for(let v=t;v<t+s;v++){const T=e[v],S=!r&&this.getParsed(v),E={},R=E[m]=r?l.getPixelForDecimal(.5):l.getPixelForValue(S[m]),k=E[_]=r?c.getBasePixel():c.getPixelForValue(S[_]);E.skip=isNaN(R)||isNaN(k),d&&(E.options=h||this.resolveDataElementOptions(v,T.active?"active":i),r&&(E.options.radius=0)),this.updateElement(T,v,E,i)}}resolveDataElementOptions(e,t){const s=this.getParsed(e);let i=super.resolveDataElementOptions(e,t);i.$shared&&(i=Object.assign({},i,{$shared:!1}));const r=i.radius;return t!=="active"&&(i.radius=0),i.radius+=Ue(s&&s._custom,r),i}}_e(pg,"id","bubble"),_e(pg,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),_e(pg,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function PB(n,e,t){let s=1,i=1,r=0,l=0;if(e<Rt){const c=n,h=c+e,d=Math.cos(c),m=Math.sin(c),_=Math.cos(h),v=Math.sin(h),T=(O,H,F)=>Nd(O,c,h,!0)?1:Math.max(H,H*t,F,F*t),S=(O,H,F)=>Nd(O,c,h,!0)?-1:Math.min(H,H*t,F,F*t),E=T(0,d,_),R=T(Qt,m,v),k=S(it,d,_),L=S(it+Qt,m,v);s=(E-k)/2,i=(R-L)/2,r=-(E+k)/2,l=-(R+L)/2}return{ratioX:s,ratioY:i,offsetX:r,offsetY:l}}class tl extends Js{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const s=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=s;else{let r=h=>+s[h];if(Ze(s[e])){const{key:h="value"}=this._parsing;r=d=>+Ha(s[d],h)}let l,c;for(l=e,c=e+t;l<c;++l)i._parsed[l]=r(l)}}_getRotation(){return Ks(this.options.rotation-90)}_getCircumference(){return Ks(this.options.circumference)}_getRotationExtents(){let e=Rt,t=-Rt;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const i=this.chart.getDatasetMeta(s).controller,r=i._getRotation(),l=i._getCircumference();e=Math.min(e,r),t=Math.max(t,r+l)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:s}=t,i=this._cachedMeta,r=i.data,l=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,c=Math.max((Math.min(s.width,s.height)-l)/2,0),h=Math.min(W5(this.options.cutout,c),1),d=this._getRingWeight(this.index),{circumference:m,rotation:_}=this._getRotationExtents(),{ratioX:v,ratioY:T,offsetX:S,offsetY:E}=PB(_,m,h),R=(s.width-l)/v,k=(s.height-l)/T,L=Math.max(Math.min(R,k)/2,0),O=vN(this.options.radius,L),H=Math.max(O*h,0),F=(O-H)/this._getVisibleDatasetWeightTotal();this.offsetX=S*O,this.offsetY=E*O,i.total=this.calculateTotal(),this.outerRadius=O-F*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-F*d,0),this.updateElements(r,0,r.length,e)}_circumference(e,t){const s=this.options,i=this._cachedMeta,r=this._getCircumference();return t&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||i._parsed[e]===null||i.data[e].hidden?0:this.calculateCircumference(i._parsed[e]*r/Rt)}updateElements(e,t,s,i){const r=i==="reset",l=this.chart,c=l.chartArea,d=l.options.animation,m=(c.left+c.right)/2,_=(c.top+c.bottom)/2,v=r&&d.animateScale,T=v?0:this.innerRadius,S=v?0:this.outerRadius,{sharedOptions:E,includeOptions:R}=this._getSharedOptions(t,i);let k=this._getRotation(),L;for(L=0;L<t;++L)k+=this._circumference(L,r);for(L=t;L<t+s;++L){const O=this._circumference(L,r),H=e[L],F={x:m+this.offsetX,y:_+this.offsetY,startAngle:k,endAngle:k+O,circumference:O,outerRadius:S,innerRadius:T};R&&(F.options=E||this.resolveDataElementOptions(L,H.active?"active":i)),k+=O,this.updateElement(H,L,F,i)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let s=0,i;for(i=0;i<t.length;i++){const r=e._parsed[i];r!==null&&!isNaN(r)&&this.chart.getDataVisibility(i)&&!t[i].hidden&&(s+=Math.abs(r))}return s}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Rt*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,s=this.chart,i=s.data.labels||[],r=cf(t._parsed[e],s.options.locale);return{label:i[e]||"",value:r}}getMaxBorderWidth(e){let t=0;const s=this.chart;let i,r,l,c,h;if(!e){for(i=0,r=s.data.datasets.length;i<r;++i)if(s.isDatasetVisible(i)){l=s.getDatasetMeta(i),e=l.data,c=l.controller;break}}if(!e)return 0;for(i=0,r=e.length;i<r;++i)h=c.resolveDataElementOptions(i),h.borderAlign!=="inner"&&(t=Math.max(t,h.borderWidth||0,h.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let s=0,i=e.length;s<i;++s){const r=this.resolveDataElementOptions(s);t=Math.max(t,r.offset||0,r.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(t+=this._getRingWeight(s));return t}_getRingWeight(e){return Math.max(Ue(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}_e(tl,"id","doughnut"),_e(tl,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),_e(tl,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),_e(tl,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:s,color:i}}=e.legend.options;return t.labels.map((r,l)=>{const h=e.getDatasetMeta(0).controller.getStyle(l);return{text:r,fillStyle:h.backgroundColor,strokeStyle:h.borderColor,fontColor:i,lineWidth:h.borderWidth,pointStyle:s,hidden:!e.getDataVisibility(l),index:l}})}return[]}},onClick(e,t,s){s.chart.toggleDataVisibility(t.index),s.chart.update()}}}});class _g extends Js{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:s,data:i=[],_dataset:r}=t,l=this.chart._animationsDisabled;let{start:c,count:h}=RN(t,i,l);this._drawStart=c,this._drawCount=h,CN(t)&&(c=0,h=i.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!r._decimated,s.points=i;const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0),d.segment=this.options.segment,this.updateElement(s,void 0,{animated:!l,options:d},e),this.updateElements(i,c,h,e)}updateElements(e,t,s,i){const r=i==="reset",{iScale:l,vScale:c,_stacked:h,_dataset:d}=this._cachedMeta,{sharedOptions:m,includeOptions:_}=this._getSharedOptions(t,i),v=l.axis,T=c.axis,{spanGaps:S,segment:E}=this.options,R=tu(S)?S:Number.POSITIVE_INFINITY,k=this.chart._animationsDisabled||r||i==="none",L=t+s,O=e.length;let H=t>0&&this.getParsed(t-1);for(let F=0;F<O;++F){const U=e[F],C=k?U:{};if(F<t||F>=L){C.skip=!0;continue}const I=this.getParsed(F),N=Qe(I[T]),V=C[v]=l.getPixelForValue(I[v],F),j=C[T]=r||N?c.getBasePixel():c.getPixelForValue(h?this.applyStack(c,I,h):I[T],F);C.skip=isNaN(V)||isNaN(j)||N,C.stop=F>0&&Math.abs(I[v]-H[v])>R,E&&(C.parsed=I,C.raw=d.data[F]),_&&(C.options=m||this.resolveDataElementOptions(F,U.active?"active":i)),k||this.updateElement(U,F,C,i),H=I}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,s=t.options&&t.options.borderWidth||0,i=e.data||[];if(!i.length)return s;const r=i[0].size(this.resolveDataElementOptions(0)),l=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(s,r,l)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}_e(_g,"id","line"),_e(_g,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),_e(_g,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class ud extends Js{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,s=this.chart,i=s.data.labels||[],r=cf(t._parsed[e].r,s.options.locale);return{label:i[e]||"",value:r}}parseObjectData(e,t,s,i){return LN.bind(this)(e,t,s,i)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((s,i)=>{const r=this.getParsed(i).r;!isNaN(r)&&this.chart.getDataVisibility(i)&&(r<t.min&&(t.min=r),r>t.max&&(t.max=r))}),t}_updateRadius(){const e=this.chart,t=e.chartArea,s=e.options,i=Math.min(t.right-t.left,t.bottom-t.top),r=Math.max(i/2,0),l=Math.max(s.cutoutPercentage?r/100*s.cutoutPercentage:1,0),c=(r-l)/e.getVisibleDatasetCount();this.outerRadius=r-c*this.index,this.innerRadius=this.outerRadius-c}updateElements(e,t,s,i){const r=i==="reset",l=this.chart,h=l.options.animation,d=this._cachedMeta.rScale,m=d.xCenter,_=d.yCenter,v=d.getIndexAngle(0)-.5*it;let T=v,S;const E=360/this.countVisibleElements();for(S=0;S<t;++S)T+=this._computeAngle(S,i,E);for(S=t;S<t+s;S++){const R=e[S];let k=T,L=T+this._computeAngle(S,i,E),O=l.getDataVisibility(S)?d.getDistanceFromCenterForValue(this.getParsed(S).r):0;T=L,r&&(h.animateScale&&(O=0),h.animateRotate&&(k=L=v));const H={x:m,y:_,innerRadius:0,outerRadius:O,startAngle:k,endAngle:L,options:this.resolveDataElementOptions(S,R.active?"active":i)};this.updateElement(R,S,H,i)}}countVisibleElements(){const e=this._cachedMeta;let t=0;return e.data.forEach((s,i)=>{!isNaN(this.getParsed(i).r)&&this.chart.getDataVisibility(i)&&t++}),t}_computeAngle(e,t,s){return this.chart.getDataVisibility(e)?Ks(this.resolveDataElementOptions(e,t).angle||s):0}}_e(ud,"id","polarArea"),_e(ud,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),_e(ud,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:s,color:i}}=e.legend.options;return t.labels.map((r,l)=>{const h=e.getDatasetMeta(0).controller.getStyle(l);return{text:r,fillStyle:h.backgroundColor,strokeStyle:h.borderColor,fontColor:i,lineWidth:h.borderWidth,pointStyle:s,hidden:!e.getDataVisibility(l),index:l}})}return[]}},onClick(e,t,s){s.chart.toggleDataVisibility(t.index),s.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class bb extends tl{}_e(bb,"id","pie"),_e(bb,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class yg extends Js{getLabelAndValue(e){const t=this._cachedMeta.vScale,s=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(s[t.axis])}}parseObjectData(e,t,s,i){return LN.bind(this)(e,t,s,i)}update(e){const t=this._cachedMeta,s=t.dataset,i=t.data||[],r=t.iScale.getLabels();if(s.points=i,e!=="resize"){const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0);const c={_loop:!0,_fullLoop:r.length===i.length,options:l};this.updateElement(s,void 0,c,e)}this.updateElements(i,0,i.length,e)}updateElements(e,t,s,i){const r=this._cachedMeta.rScale,l=i==="reset";for(let c=t;c<t+s;c++){const h=e[c],d=this.resolveDataElementOptions(c,h.active?"active":i),m=r.getPointPositionForValue(c,this.getParsed(c).r),_=l?r.xCenter:m.x,v=l?r.yCenter:m.y,T={x:_,y:v,angle:m.angle,skip:isNaN(_)||isNaN(v),options:d};this.updateElement(h,c,T,i)}}}_e(yg,"id","radar"),_e(yg,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),_e(yg,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class bg extends Js{getLabelAndValue(e){const t=this._cachedMeta,s=this.chart.data.labels||[],{xScale:i,yScale:r}=t,l=this.getParsed(e),c=i.getLabelForValue(l.x),h=r.getLabelForValue(l.y);return{label:s[e]||"",value:"("+c+", "+h+")"}}update(e){const t=this._cachedMeta,{data:s=[]}=t,i=this.chart._animationsDisabled;let{start:r,count:l}=RN(t,s,i);if(this._drawStart=r,this._drawCount=l,CN(t)&&(r=0,l=s.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:c,_dataset:h}=t;c._chart=this.chart,c._datasetIndex=this.index,c._decimated=!!h._decimated,c.points=s;const d=this.resolveDatasetElementOptions(e);d.segment=this.options.segment,this.updateElement(c,void 0,{animated:!i,options:d},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(s,r,l,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,s,i){const r=i==="reset",{iScale:l,vScale:c,_stacked:h,_dataset:d}=this._cachedMeta,m=this.resolveDataElementOptions(t,i),_=this.getSharedOptions(m),v=this.includeOptions(i,_),T=l.axis,S=c.axis,{spanGaps:E,segment:R}=this.options,k=tu(E)?E:Number.POSITIVE_INFINITY,L=this.chart._animationsDisabled||r||i==="none";let O=t>0&&this.getParsed(t-1);for(let H=t;H<t+s;++H){const F=e[H],U=this.getParsed(H),C=L?F:{},I=Qe(U[S]),N=C[T]=l.getPixelForValue(U[T],H),V=C[S]=r||I?c.getBasePixel():c.getPixelForValue(h?this.applyStack(c,U,h):U[S],H);C.skip=isNaN(N)||isNaN(V)||I,C.stop=H>0&&Math.abs(U[T]-O[T])>k,R&&(C.parsed=U,C.raw=d.data[H]),v&&(C.options=_||this.resolveDataElementOptions(H,F.active?"active":i)),L||this.updateElement(F,H,C,i),O=U}this.updateSharedOptions(_,i,m)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let c=0;for(let h=t.length-1;h>=0;--h)c=Math.max(c,t[h].size(this.resolveDataElementOptions(h))/2);return c>0&&c}const s=e.dataset,i=s.options&&s.options.borderWidth||0;if(!t.length)return i;const r=t[0].size(this.resolveDataElementOptions(0)),l=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(i,r,l)/2}}_e(bg,"id","scatter"),_e(bg,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),_e(bg,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var VB=Object.freeze({__proto__:null,BarController:gg,BubbleController:pg,DoughnutController:tl,LineController:_g,PieController:bb,PolarAreaController:ud,RadarController:yg,ScatterController:bg});function Bo(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Sx{constructor(e){_e(this,"options");this.options=e||{}}static override(e){Object.assign(Sx.prototype,e)}init(){}formats(){return Bo()}parse(){return Bo()}format(){return Bo()}add(){return Bo()}diff(){return Bo()}startOf(){return Bo()}endOf(){return Bo()}}var LB={_date:Sx};function jB(n,e,t,s){const{controller:i,data:r,_sorted:l}=n,c=i._cachedMeta.iScale,h=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(c&&e===c.axis&&e!=="r"&&l&&r.length){const d=c._reversePixels?aU:ur;if(s){if(i._sharedOptions){const m=r[0],_=typeof m.getRange=="function"&&m.getRange(e);if(_){const v=d(r,e,t-_),T=d(r,e,t+_);return{lo:v.lo,hi:T.hi}}}}else{const m=d(r,e,t);if(h){const{vScale:_}=i._cachedMeta,{_parsed:v}=n,T=v.slice(0,m.lo+1).reverse().findIndex(E=>!Qe(E[_.axis]));m.lo-=Math.max(0,T);const S=v.slice(m.hi).findIndex(E=>!Qe(E[_.axis]));m.hi+=Math.max(0,S)}return m}}return{lo:0,hi:r.length-1}}function Wp(n,e,t,s,i){const r=n.getSortedVisibleDatasetMetas(),l=t[e];for(let c=0,h=r.length;c<h;++c){const{index:d,data:m}=r[c],{lo:_,hi:v}=jB(r[c],e,l,i);for(let T=_;T<=v;++T){const S=m[T];S.skip||s(S,d,T)}}}function UB(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(s,i){const r=e?Math.abs(s.x-i.x):0,l=t?Math.abs(s.y-i.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(l,2))}}function S0(n,e,t,s,i){const r=[];return!i&&!n.isPointInArea(e)||Wp(n,t,e,function(c,h,d){!i&&!hr(c,n.chartArea,0)||c.inRange(e.x,e.y,s)&&r.push({element:c,datasetIndex:h,index:d})},!0),r}function BB(n,e,t,s){let i=[];function r(l,c,h){const{startAngle:d,endAngle:m}=l.getProps(["startAngle","endAngle"],s),{angle:_}=EN(l,{x:e.x,y:e.y});Nd(_,d,m)&&i.push({element:l,datasetIndex:c,index:h})}return Wp(n,t,e,r),i}function FB(n,e,t,s,i,r){let l=[];const c=UB(t);let h=Number.POSITIVE_INFINITY;function d(m,_,v){const T=m.inRange(e.x,e.y,i);if(s&&!T)return;const S=m.getCenterPoint(i);if(!(!!r||n.isPointInArea(S))&&!T)return;const R=c(e,S);R<h?(l=[{element:m,datasetIndex:_,index:v}],h=R):R===h&&l.push({element:m,datasetIndex:_,index:v})}return Wp(n,t,e,d),l}function A0(n,e,t,s,i,r){return!r&&!n.isPointInArea(e)?[]:t==="r"&&!s?BB(n,e,t,i):FB(n,e,t,s,i,r)}function D1(n,e,t,s,i){const r=[],l=t==="x"?"inXRange":"inYRange";let c=!1;return Wp(n,t,e,(h,d,m)=>{h[l]&&h[l](e[t],i)&&(r.push({element:h,datasetIndex:d,index:m}),c=c||h.inRange(e.x,e.y,i))}),s&&!c?[]:r}var zB={modes:{index(n,e,t,s){const i=Go(e,n),r=t.axis||"x",l=t.includeInvisible||!1,c=t.intersect?S0(n,i,r,s,l):A0(n,i,r,!1,s,l),h=[];return c.length?(n.getSortedVisibleDatasetMetas().forEach(d=>{const m=c[0].index,_=d.data[m];_&&!_.skip&&h.push({element:_,datasetIndex:d.index,index:m})}),h):[]},dataset(n,e,t,s){const i=Go(e,n),r=t.axis||"xy",l=t.includeInvisible||!1;let c=t.intersect?S0(n,i,r,s,l):A0(n,i,r,!1,s,l);if(c.length>0){const h=c[0].datasetIndex,d=n.getDatasetMeta(h).data;c=[];for(let m=0;m<d.length;++m)c.push({element:d[m],datasetIndex:h,index:m})}return c},point(n,e,t,s){const i=Go(e,n),r=t.axis||"xy",l=t.includeInvisible||!1;return S0(n,i,r,s,l)},nearest(n,e,t,s){const i=Go(e,n),r=t.axis||"xy",l=t.includeInvisible||!1;return A0(n,i,r,t.intersect,s,l)},x(n,e,t,s){const i=Go(e,n);return D1(n,i,"x",t.intersect,s)},y(n,e,t,s){const i=Go(e,n);return D1(n,i,"y",t.intersect,s)}}};const YN=["left","top","right","bottom"];function kh(n,e){return n.filter(t=>t.pos===e)}function N1(n,e){return n.filter(t=>YN.indexOf(t.pos)===-1&&t.box.axis===e)}function Mh(n,e){return n.sort((t,s)=>{const i=e?s:t,r=e?t:s;return i.weight===r.weight?i.index-r.index:i.weight-r.weight})}function HB(n){const e=[];let t,s,i,r,l,c;for(t=0,s=(n||[]).length;t<s;++t)i=n[t],{position:r,options:{stack:l,stackWeight:c=1}}=i,e.push({index:t,box:i,pos:r,horizontal:i.isHorizontal(),weight:i.weight,stack:l&&r+l,stackWeight:c});return e}function qB(n){const e={};for(const t of n){const{stack:s,pos:i,stackWeight:r}=t;if(!s||!YN.includes(i))continue;const l=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});l.count++,l.weight+=r}return e}function GB(n,e){const t=qB(n),{vBoxMaxWidth:s,hBoxMaxHeight:i}=e;let r,l,c;for(r=0,l=n.length;r<l;++r){c=n[r];const{fullSize:h}=c.box,d=t[c.stack],m=d&&c.stackWeight/d.weight;c.horizontal?(c.width=m?m*s:h&&e.availableWidth,c.height=i):(c.width=s,c.height=m?m*i:h&&e.availableHeight)}return t}function $B(n){const e=HB(n),t=Mh(e.filter(d=>d.box.fullSize),!0),s=Mh(kh(e,"left"),!0),i=Mh(kh(e,"right")),r=Mh(kh(e,"top"),!0),l=Mh(kh(e,"bottom")),c=N1(e,"x"),h=N1(e,"y");return{fullSize:t,leftAndTop:s.concat(r),rightAndBottom:i.concat(h).concat(l).concat(c),chartArea:kh(e,"chartArea"),vertical:s.concat(i).concat(h),horizontal:r.concat(l).concat(c)}}function k1(n,e,t,s){return Math.max(n[t],e[t])+Math.max(n[s],e[s])}function KN(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function WB(n,e,t,s){const{pos:i,box:r}=t,l=n.maxPadding;if(!Ze(i)){t.size&&(n[i]-=t.size);const _=s[t.stack]||{size:0,count:1};_.size=Math.max(_.size,t.horizontal?r.height:r.width),t.size=_.size/_.count,n[i]+=t.size}r.getPadding&&KN(l,r.getPadding());const c=Math.max(0,e.outerWidth-k1(l,n,"left","right")),h=Math.max(0,e.outerHeight-k1(l,n,"top","bottom")),d=c!==n.w,m=h!==n.h;return n.w=c,n.h=h,t.horizontal?{same:d,other:m}:{same:m,other:d}}function YB(n){const e=n.maxPadding;function t(s){const i=Math.max(e[s]-n[s],0);return n[s]+=i,i}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function KB(n,e){const t=e.maxPadding;function s(i){const r={left:0,top:0,right:0,bottom:0};return i.forEach(l=>{r[l]=Math.max(e[l],t[l])}),r}return s(n?["left","right"]:["top","bottom"])}function qh(n,e,t,s){const i=[];let r,l,c,h,d,m;for(r=0,l=n.length,d=0;r<l;++r){c=n[r],h=c.box,h.update(c.width||e.w,c.height||e.h,KB(c.horizontal,e));const{same:_,other:v}=WB(e,t,c,s);d|=_&&i.length,m=m||v,h.fullSize||i.push(c)}return d&&qh(i,e,t,s)||m}function $m(n,e,t,s,i){n.top=t,n.left=e,n.right=e+s,n.bottom=t+i,n.width=s,n.height=i}function M1(n,e,t,s){const i=t.padding;let{x:r,y:l}=e;for(const c of n){const h=c.box,d=s[c.stack]||{placed:0,weight:1},m=c.stackWeight/d.weight||1;if(c.horizontal){const _=e.w*m,v=d.size||h.height;Dd(d.start)&&(l=d.start),h.fullSize?$m(h,i.left,l,t.outerWidth-i.right-i.left,v):$m(h,e.left+d.placed,l,_,v),d.start=l,d.placed+=_,l=h.bottom}else{const _=e.h*m,v=d.size||h.width;Dd(d.start)&&(r=d.start),h.fullSize?$m(h,r,i.top,v,t.outerHeight-i.bottom-i.top):$m(h,r,e.top+d.placed,v,_),d.start=r,d.placed+=_,r=h.right}}e.x=r,e.y=l}var jn={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,s){if(!n)return;const i=Bn(n.options.layout.padding),r=Math.max(e-i.width,0),l=Math.max(t-i.height,0),c=$B(n.boxes),h=c.vertical,d=c.horizontal;dt(n.boxes,E=>{typeof E.beforeLayout=="function"&&E.beforeLayout()});const m=h.reduce((E,R)=>R.box.options&&R.box.options.display===!1?E:E+1,0)||1,_=Object.freeze({outerWidth:e,outerHeight:t,padding:i,availableWidth:r,availableHeight:l,vBoxMaxWidth:r/2/m,hBoxMaxHeight:l/2}),v=Object.assign({},i);KN(v,Bn(s));const T=Object.assign({maxPadding:v,w:r,h:l,x:i.left,y:i.top},i),S=GB(h.concat(d),_);qh(c.fullSize,T,_,S),qh(h,T,_,S),qh(d,T,_,S)&&qh(h,T,_,S),YB(T),M1(c.leftAndTop,T,_,S),T.x+=T.w,T.y+=T.h,M1(c.rightAndBottom,T,_,S),n.chartArea={left:T.left,top:T.top,right:T.left+T.w,bottom:T.top+T.h,height:T.h,width:T.w},dt(c.chartArea,E=>{const R=E.box;Object.assign(R,n.chartArea),R.update(T.w,T.h,{left:0,top:0,right:0,bottom:0})})}};class QN{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,s){}removeEventListener(e,t,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,s,i){return t=Math.max(0,t||e.width),s=s||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):s)}}isAttached(e){return!0}updateConfig(e){}}class QB extends QN{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const vg="$chartjs",XB={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},O1=n=>n===null||n==="";function ZB(n,e){const t=n.style,s=n.getAttribute("height"),i=n.getAttribute("width");if(n[vg]={initial:{height:s,width:i,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",O1(i)){const r=_1(n,"width");r!==void 0&&(n.width=r)}if(O1(s))if(n.style.height==="")n.height=n.width/(e||2);else{const r=_1(n,"height");r!==void 0&&(n.height=r)}return n}const XN=JU?{passive:!0}:!1;function JB(n,e,t){n&&n.addEventListener(e,t,XN)}function e9(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,XN)}function t9(n,e){const t=XB[n.type]||n.type,{x:s,y:i}=Go(n,e);return{type:t,chart:e,native:n,x:s!==void 0?s:null,y:i!==void 0?i:null}}function sp(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function n9(n,e,t){const s=n.canvas,i=new MutationObserver(r=>{let l=!1;for(const c of r)l=l||sp(c.addedNodes,s),l=l&&!sp(c.removedNodes,s);l&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}function s9(n,e,t){const s=n.canvas,i=new MutationObserver(r=>{let l=!1;for(const c of r)l=l||sp(c.removedNodes,s),l=l&&!sp(c.addedNodes,s);l&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}const Md=new Map;let P1=0;function ZN(){const n=window.devicePixelRatio;n!==P1&&(P1=n,Md.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function i9(n,e){Md.size||window.addEventListener("resize",ZN),Md.set(n,e)}function r9(n){Md.delete(n),Md.size||window.removeEventListener("resize",ZN)}function a9(n,e,t){const s=n.canvas,i=s&&wx(s);if(!i)return;const r=IN((c,h)=>{const d=i.clientWidth;t(c,h),d<i.clientWidth&&t()},window),l=new ResizeObserver(c=>{const h=c[0],d=h.contentRect.width,m=h.contentRect.height;d===0&&m===0||r(d,m)});return l.observe(i),i9(n,r),l}function I0(n,e,t){t&&t.disconnect(),e==="resize"&&r9(n)}function o9(n,e,t){const s=n.canvas,i=IN(r=>{n.ctx!==null&&t(t9(r,n))},n);return JB(s,e,i),i}class l9 extends QN{acquireContext(e,t){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(ZB(e,t),s):null}releaseContext(e){const t=e.canvas;if(!t[vg])return!1;const s=t[vg].initial;["height","width"].forEach(r=>{const l=s[r];Qe(l)?t.removeAttribute(r):t.setAttribute(r,l)});const i=s.style||{};return Object.keys(i).forEach(r=>{t.style[r]=i[r]}),t.width=t.width,delete t[vg],!0}addEventListener(e,t,s){this.removeEventListener(e,t);const i=e.$proxies||(e.$proxies={}),l={attach:n9,detach:s9,resize:a9}[t]||o9;i[t]=l(e,t,s)}removeEventListener(e,t){const s=e.$proxies||(e.$proxies={}),i=s[t];if(!i)return;({attach:I0,detach:I0,resize:I0}[t]||e9)(e,t,i),s[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,s,i){return ZU(e,t,s,i)}isAttached(e){const t=e&&wx(e);return!!(t&&t.isConnected)}}function c9(n){return!Ex()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?QB:l9}class ei{constructor(){_e(this,"x");_e(this,"y");_e(this,"active",!1);_e(this,"options");_e(this,"$animations")}tooltipPosition(e){const{x:t,y:s}=this.getProps(["x","y"],e);return{x:t,y:s}}hasValue(){return tu(this.x)&&tu(this.y)}getProps(e,t){const s=this.$animations;if(!t||!s)return this;const i={};return e.forEach(r=>{i[r]=s[r]&&s[r].active()?s[r]._to:this[r]}),i}}_e(ei,"defaults",{}),_e(ei,"defaultRoutes");function u9(n,e){const t=n.options.ticks,s=h9(n),i=Math.min(t.maxTicksLimit||s,s),r=t.major.enabled?f9(e):[],l=r.length,c=r[0],h=r[l-1],d=[];if(l>i)return m9(e,d,r,l/i),d;const m=d9(r,e,i);if(l>0){let _,v;const T=l>1?Math.round((h-c)/(l-1)):null;for(Wm(e,d,m,Qe(T)?0:c-T,c),_=0,v=l-1;_<v;_++)Wm(e,d,m,r[_],r[_+1]);return Wm(e,d,m,h,Qe(T)?e.length:h+T),d}return Wm(e,d,m),d}function h9(n){const e=n.options.offset,t=n._tickSize(),s=n._length/t+(e?0:1),i=n._maxLength/t;return Math.floor(Math.min(s,i))}function d9(n,e,t){const s=g9(n),i=e.length/t;if(!s)return Math.max(i,1);const r=tU(s);for(let l=0,c=r.length-1;l<c;l++){const h=r[l];if(h>i)return h}return Math.max(i,1)}function f9(n){const e=[];let t,s;for(t=0,s=n.length;t<s;t++)n[t].major&&e.push(t);return e}function m9(n,e,t,s){let i=0,r=t[0],l;for(s=Math.ceil(s),l=0;l<n.length;l++)l===r&&(e.push(n[l]),i++,r=t[i*s])}function Wm(n,e,t,s,i){const r=Ue(s,0),l=Math.min(Ue(i,n.length),n.length);let c=0,h,d,m;for(t=Math.ceil(t),i&&(h=i-s,t=h/Math.floor(h/t)),m=r;m<0;)c++,m=Math.round(r+c*t);for(d=Math.max(r,0);d<l;d++)d===m&&(e.push(n[d]),c++,m=Math.round(r+c*t))}function g9(n){const e=n.length;let t,s;if(e<2)return!1;for(s=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==s)return!1;return s}const p9=n=>n==="left"?"right":n==="right"?"left":n,V1=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,L1=(n,e)=>Math.min(e||n,n);function j1(n,e){const t=[],s=n.length/e,i=n.length;let r=0;for(;r<i;r+=s)t.push(n[Math.floor(r)]);return t}function _9(n,e,t){const s=n.ticks.length,i=Math.min(e,s-1),r=n._startPixel,l=n._endPixel,c=1e-6;let h=n.getPixelForTick(i),d;if(!(t&&(s===1?d=Math.max(h-r,l-h):e===0?d=(n.getPixelForTick(1)-h)/2:d=(h-n.getPixelForTick(i-1))/2,h+=i<e?d:-d,h<r-c||h>l+c)))return h}function y9(n,e){dt(n,t=>{const s=t.gc,i=s.length/2;let r;if(i>e){for(r=0;r<i;++r)delete t.data[s[r]];s.splice(0,i)}})}function Oh(n){return n.drawTicks?n.tickLength:0}function U1(n,e){if(!n.display)return 0;const t=un(n.font,e),s=Bn(n.padding);return(Ot(n.text)?n.text.length:1)*t.lineHeight+s.height}function b9(n,e){return Ja(n,{scale:e,type:"scale"})}function v9(n,e,t){return Ja(n,{tick:t,index:e,type:"tick"})}function x9(n,e,t){let s=_x(n);return(t&&e!=="right"||!t&&e==="right")&&(s=p9(s)),s}function T9(n,e,t,s){const{top:i,left:r,bottom:l,right:c,chart:h}=n,{chartArea:d,scales:m}=h;let _=0,v,T,S;const E=l-i,R=c-r;if(n.isHorizontal()){if(T=On(s,r,c),Ze(t)){const k=Object.keys(t)[0],L=t[k];S=m[k].getPixelForValue(L)+E-e}else t==="center"?S=(d.bottom+d.top)/2+E-e:S=V1(n,t,e);v=c-r}else{if(Ze(t)){const k=Object.keys(t)[0],L=t[k];T=m[k].getPixelForValue(L)-R+e}else t==="center"?T=(d.left+d.right)/2-R+e:T=V1(n,t,e);S=On(s,l,i),_=t==="left"?-Qt:Qt}return{titleX:T,titleY:S,maxWidth:v,rotation:_}}let uf=class JN extends ei{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:s,_suggestedMax:i}=this;return e=ms(e,Number.POSITIVE_INFINITY),t=ms(t,Number.NEGATIVE_INFINITY),s=ms(s,Number.POSITIVE_INFINITY),i=ms(i,Number.NEGATIVE_INFINITY),{min:ms(e,s),max:ms(t,i),minDefined:Bt(e),maxDefined:Bt(t)}}getMinMax(e){let{min:t,max:s,minDefined:i,maxDefined:r}=this.getUserBounds(),l;if(i&&r)return{min:t,max:s};const c=this.getMatchingVisibleMetas();for(let h=0,d=c.length;h<d;++h)l=c[h].controller.getMinMax(this,e),i||(t=Math.min(t,l.min)),r||(s=Math.max(s,l.max));return t=r&&t>s?s:t,s=i&&t>s?t:s,{min:ms(t,ms(s,t)),max:ms(s,ms(t,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Tt(this.options.beforeUpdate,[this])}update(e,t,s){const{beginAtZero:i,grace:r,ticks:l}=this.options,c=l.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=DU(this,r,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const h=c<this.ticks.length;this._convertTicksToLabels(h?j1(this.ticks,c):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),l.display&&(l.autoSkip||l.source==="auto")&&(this.ticks=u9(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),h&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,s;this.isHorizontal()?(t=this.left,s=this.right):(t=this.top,s=this.bottom,e=!e),this._startPixel=t,this._endPixel=s,this._reversePixels=e,this._length=s-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Tt(this.options.afterUpdate,[this])}beforeSetDimensions(){Tt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Tt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Tt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Tt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let s,i,r;for(s=0,i=e.length;s<i;s++)r=e[s],r.label=Tt(t.callback,[r.value,s,e],this)}afterTickToLabelConversion(){Tt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Tt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,s=L1(this.ticks.length,e.ticks.maxTicksLimit),i=t.minRotation||0,r=t.maxRotation;let l=i,c,h,d;if(!this._isVisible()||!t.display||i>=r||s<=1||!this.isHorizontal()){this.labelRotation=i;return}const m=this._getLabelSizes(),_=m.widest.width,v=m.highest.height,T=vn(this.chart.width-_,0,this.maxWidth);c=e.offset?this.maxWidth/s:T/(s-1),_+6>c&&(c=T/(s-(e.offset?.5:1)),h=this.maxHeight-Oh(e.grid)-t.padding-U1(e.title,this.chart.options.font),d=Math.sqrt(_*_+v*v),l=gx(Math.min(Math.asin(vn((m.highest.height+6)/c,-1,1)),Math.asin(vn(h/d,-1,1))-Math.asin(vn(v/d,-1,1)))),l=Math.max(i,Math.min(r,l))),this.labelRotation=l}afterCalculateLabelRotation(){Tt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Tt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:s,title:i,grid:r}}=this,l=this._isVisible(),c=this.isHorizontal();if(l){const h=U1(i,t.options.font);if(c?(e.width=this.maxWidth,e.height=Oh(r)+h):(e.height=this.maxHeight,e.width=Oh(r)+h),s.display&&this.ticks.length){const{first:d,last:m,widest:_,highest:v}=this._getLabelSizes(),T=s.padding*2,S=Ks(this.labelRotation),E=Math.cos(S),R=Math.sin(S);if(c){const k=s.mirror?0:R*_.width+E*v.height;e.height=Math.min(this.maxHeight,e.height+k+T)}else{const k=s.mirror?0:E*_.width+R*v.height;e.width=Math.min(this.maxWidth,e.width+k+T)}this._calculatePadding(d,m,R,E)}}this._handleMargins(),c?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,s,i){const{ticks:{align:r,padding:l},position:c}=this.options,h=this.labelRotation!==0,d=c!=="top"&&this.axis==="x";if(this.isHorizontal()){const m=this.getPixelForTick(0)-this.left,_=this.right-this.getPixelForTick(this.ticks.length-1);let v=0,T=0;h?d?(v=i*e.width,T=s*t.height):(v=s*e.height,T=i*t.width):r==="start"?T=t.width:r==="end"?v=e.width:r!=="inner"&&(v=e.width/2,T=t.width/2),this.paddingLeft=Math.max((v-m+l)*this.width/(this.width-m),0),this.paddingRight=Math.max((T-_+l)*this.width/(this.width-_),0)}else{let m=t.height/2,_=e.height/2;r==="start"?(m=0,_=e.height):r==="end"&&(m=t.height,_=0),this.paddingTop=m+l,this.paddingBottom=_+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Tt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,s;for(t=0,s=e.length;t<s;t++)Qe(e[t].label)&&(e.splice(t,1),s--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let s=this.ticks;t<s.length&&(s=j1(s,t)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,s){const{ctx:i,_longestTextCache:r}=this,l=[],c=[],h=Math.floor(t/L1(t,s));let d=0,m=0,_,v,T,S,E,R,k,L,O,H,F;for(_=0;_<t;_+=h){if(S=e[_].label,E=this._resolveTickFontOptions(_),i.font=R=E.string,k=r[R]=r[R]||{data:{},gc:[]},L=E.lineHeight,O=H=0,!Qe(S)&&!Ot(S))O=tp(i,k.data,k.gc,O,S),H=L;else if(Ot(S))for(v=0,T=S.length;v<T;++v)F=S[v],!Qe(F)&&!Ot(F)&&(O=tp(i,k.data,k.gc,O,F),H+=L);l.push(O),c.push(H),d=Math.max(O,d),m=Math.max(H,m)}y9(r,t);const U=l.indexOf(d),C=c.indexOf(m),I=N=>({width:l[N]||0,height:c[N]||0});return{first:I(0),last:I(t-1),widest:I(U),highest:I(C),widths:l,heights:c}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return rU(this._alignToPixels?Uo(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const s=t[e];return s.$context||(s.$context=v9(this.getContext(),e,s))}return this.$context||(this.$context=b9(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=Ks(this.labelRotation),s=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t)),r=this._getLabelSizes(),l=e.autoSkipPadding||0,c=r?r.widest.width+l:0,h=r?r.highest.height+l:0;return this.isHorizontal()?h*s>c*i?c/s:h/i:h*i<c*s?h/s:c/i}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,s=this.chart,i=this.options,{grid:r,position:l,border:c}=i,h=r.offset,d=this.isHorizontal(),_=this.ticks.length+(h?1:0),v=Oh(r),T=[],S=c.setContext(this.getContext()),E=S.display?S.width:0,R=E/2,k=function(Y){return Uo(s,Y,E)};let L,O,H,F,U,C,I,N,V,j,B,M;if(l==="top")L=k(this.bottom),C=this.bottom-v,N=L-R,j=k(e.top)+R,M=e.bottom;else if(l==="bottom")L=k(this.top),j=e.top,M=k(e.bottom)-R,C=L+R,N=this.top+v;else if(l==="left")L=k(this.right),U=this.right-v,I=L-R,V=k(e.left)+R,B=e.right;else if(l==="right")L=k(this.left),V=e.left,B=k(e.right)-R,U=L+R,I=this.left+v;else if(t==="x"){if(l==="center")L=k((e.top+e.bottom)/2+.5);else if(Ze(l)){const Y=Object.keys(l)[0],ae=l[Y];L=k(this.chart.scales[Y].getPixelForValue(ae))}j=e.top,M=e.bottom,C=L+R,N=C+v}else if(t==="y"){if(l==="center")L=k((e.left+e.right)/2);else if(Ze(l)){const Y=Object.keys(l)[0],ae=l[Y];L=k(this.chart.scales[Y].getPixelForValue(ae))}U=L-R,I=U-v,V=e.left,B=e.right}const ne=Ue(i.ticks.maxTicksLimit,_),be=Math.max(1,Math.ceil(_/ne));for(O=0;O<_;O+=be){const Y=this.getContext(O),ae=r.setContext(Y),me=c.setContext(Y),Ce=ae.lineWidth,z=ae.color,se=me.dash||[],he=me.dashOffset,de=ae.tickWidth,ye=ae.tickColor,Pe=ae.tickBorderDash||[],Ae=ae.tickBorderDashOffset;H=_9(this,O,h),H!==void 0&&(F=Uo(s,H,Ce),d?U=I=V=B=F:C=N=j=M=F,T.push({tx1:U,ty1:C,tx2:I,ty2:N,x1:V,y1:j,x2:B,y2:M,width:Ce,color:z,borderDash:se,borderDashOffset:he,tickWidth:de,tickColor:ye,tickBorderDash:Pe,tickBorderDashOffset:Ae}))}return this._ticksLength=_,this._borderValue=L,T}_computeLabelItems(e){const t=this.axis,s=this.options,{position:i,ticks:r}=s,l=this.isHorizontal(),c=this.ticks,{align:h,crossAlign:d,padding:m,mirror:_}=r,v=Oh(s.grid),T=v+m,S=_?-m:T,E=-Ks(this.labelRotation),R=[];let k,L,O,H,F,U,C,I,N,V,j,B,M="middle";if(i==="top")U=this.bottom-S,C=this._getXAxisLabelAlignment();else if(i==="bottom")U=this.top+S,C=this._getXAxisLabelAlignment();else if(i==="left"){const be=this._getYAxisLabelAlignment(v);C=be.textAlign,F=be.x}else if(i==="right"){const be=this._getYAxisLabelAlignment(v);C=be.textAlign,F=be.x}else if(t==="x"){if(i==="center")U=(e.top+e.bottom)/2+T;else if(Ze(i)){const be=Object.keys(i)[0],Y=i[be];U=this.chart.scales[be].getPixelForValue(Y)+T}C=this._getXAxisLabelAlignment()}else if(t==="y"){if(i==="center")F=(e.left+e.right)/2-T;else if(Ze(i)){const be=Object.keys(i)[0],Y=i[be];F=this.chart.scales[be].getPixelForValue(Y)}C=this._getYAxisLabelAlignment(v).textAlign}t==="y"&&(h==="start"?M="top":h==="end"&&(M="bottom"));const ne=this._getLabelSizes();for(k=0,L=c.length;k<L;++k){O=c[k],H=O.label;const be=r.setContext(this.getContext(k));I=this.getPixelForTick(k)+r.labelOffset,N=this._resolveTickFontOptions(k),V=N.lineHeight,j=Ot(H)?H.length:1;const Y=j/2,ae=be.color,me=be.textStrokeColor,Ce=be.textStrokeWidth;let z=C;l?(F=I,C==="inner"&&(k===L-1?z=this.options.reverse?"left":"right":k===0?z=this.options.reverse?"right":"left":z="center"),i==="top"?d==="near"||E!==0?B=-j*V+V/2:d==="center"?B=-ne.highest.height/2-Y*V+V:B=-ne.highest.height+V/2:d==="near"||E!==0?B=V/2:d==="center"?B=ne.highest.height/2-Y*V:B=ne.highest.height-j*V,_&&(B*=-1),E!==0&&!be.showLabelBackdrop&&(F+=V/2*Math.sin(E))):(U=I,B=(1-j)*V/2);let se;if(be.showLabelBackdrop){const he=Bn(be.backdropPadding),de=ne.heights[k],ye=ne.widths[k];let Pe=B-he.top,Ae=0-he.left;switch(M){case"middle":Pe-=de/2;break;case"bottom":Pe-=de;break}switch(C){case"center":Ae-=ye/2;break;case"right":Ae-=ye;break;case"inner":k===L-1?Ae-=ye:k>0&&(Ae-=ye/2);break}se={left:Ae,top:Pe,width:ye+he.width,height:de+he.height,color:be.backdropColor}}R.push({label:H,font:N,textOffset:B,options:{rotation:E,color:ae,strokeColor:me,strokeWidth:Ce,textAlign:z,textBaseline:M,translation:[F,U],backdrop:se}})}return R}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Ks(this.labelRotation))return e==="top"?"left":"right";let i="center";return t.align==="start"?i="left":t.align==="end"?i="right":t.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:s,mirror:i,padding:r}}=this.options,l=this._getLabelSizes(),c=e+r,h=l.widest.width;let d,m;return t==="left"?i?(m=this.right+r,s==="near"?d="left":s==="center"?(d="center",m+=h/2):(d="right",m+=h)):(m=this.right-c,s==="near"?d="right":s==="center"?(d="center",m-=h/2):(d="left",m=this.left)):t==="right"?i?(m=this.left+r,s==="near"?d="right":s==="center"?(d="center",m-=h/2):(d="left",m-=h)):(m=this.left+c,s==="near"?d="left":s==="center"?(d="center",m+=h/2):(d="right",m=this.right)):d="right",{textAlign:d,x:m}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:s,top:i,width:r,height:l}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(s,i,r,l),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const i=this.ticks.findIndex(r=>r.value===e);return i>=0?t.setContext(this.getContext(i)).lineWidth:0}drawGrid(e){const t=this.options.grid,s=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let r,l;const c=(h,d,m)=>{!m.width||!m.color||(s.save(),s.lineWidth=m.width,s.strokeStyle=m.color,s.setLineDash(m.borderDash||[]),s.lineDashOffset=m.borderDashOffset,s.beginPath(),s.moveTo(h.x,h.y),s.lineTo(d.x,d.y),s.stroke(),s.restore())};if(t.display)for(r=0,l=i.length;r<l;++r){const h=i[r];t.drawOnChartArea&&c({x:h.x1,y:h.y1},{x:h.x2,y:h.y2},h),t.drawTicks&&c({x:h.tx1,y:h.ty1},{x:h.tx2,y:h.ty2},{color:h.tickColor,width:h.tickWidth,borderDash:h.tickBorderDash,borderDashOffset:h.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:s,grid:i}}=this,r=s.setContext(this.getContext()),l=s.display?r.width:0;if(!l)return;const c=i.setContext(this.getContext(0)).lineWidth,h=this._borderValue;let d,m,_,v;this.isHorizontal()?(d=Uo(e,this.left,l)-l/2,m=Uo(e,this.right,c)+c/2,_=v=h):(_=Uo(e,this.top,l)-l/2,v=Uo(e,this.bottom,c)+c/2,d=m=h),t.save(),t.lineWidth=r.width,t.strokeStyle=r.color,t.beginPath(),t.moveTo(d,_),t.lineTo(m,v),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,i=this._computeLabelArea();i&&qp(s,i);const r=this.getLabelItems(e);for(const l of r){const c=l.options,h=l.font,d=l.label,m=l.textOffset;yl(s,d,0,m,h,c)}i&&Gp(s)}drawTitle(){const{ctx:e,options:{position:t,title:s,reverse:i}}=this;if(!s.display)return;const r=un(s.font),l=Bn(s.padding),c=s.align;let h=r.lineHeight/2;t==="bottom"||t==="center"||Ze(t)?(h+=l.bottom,Ot(s.text)&&(h+=r.lineHeight*(s.text.length-1))):h+=l.top;const{titleX:d,titleY:m,maxWidth:_,rotation:v}=T9(this,h,t,c);yl(e,s.text,0,0,r,{color:s.color,maxWidth:_,rotation:v,textAlign:x9(c,t,i),textBaseline:"middle",translation:[d,m]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,s=Ue(e.grid&&e.grid.z,-1),i=Ue(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==JN.prototype.draw?[{z:t,draw:r=>{this.draw(r)}}]:[{z:s,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:t,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",i=[];let r,l;for(r=0,l=t.length;r<l;++r){const c=t[r];c[s]===this.id&&(!e||c.type===e)&&i.push(c)}return i}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return un(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}};class Ym{constructor(e,t,s){this.type=e,this.scope=t,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let s;S9(t)&&(s=this.register(t));const i=this.items,r=e.id,l=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+e);return r in i||(i[r]=e,E9(e,l,s),this.override&&Pt.override(e.id,e.overrides)),l}get(e){return this.items[e]}unregister(e){const t=this.items,s=e.id,i=this.scope;s in t&&delete t[s],i&&s in Pt[i]&&(delete Pt[i][s],this.override&&delete _l[s])}}function E9(n,e,t){const s=Cd(Object.create(null),[t?Pt.get(t):{},Pt.get(e),n.defaults]);Pt.set(e,s),n.defaultRoutes&&w9(e,n.defaultRoutes),n.descriptors&&Pt.describe(e,n.descriptors)}function w9(n,e){Object.keys(e).forEach(t=>{const s=t.split("."),i=s.pop(),r=[n].concat(s).join("."),l=e[t].split("."),c=l.pop(),h=l.join(".");Pt.route(r,i,h,c)})}function S9(n){return"id"in n&&"defaults"in n}class A9{constructor(){this.controllers=new Ym(Js,"datasets",!0),this.elements=new Ym(ei,"elements"),this.plugins=new Ym(Object,"plugins"),this.scales=new Ym(uf,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,s){[...t].forEach(i=>{const r=s||this._getRegistryForType(i);s||r.isForType(i)||r===this.plugins&&i.id?this._exec(e,r,i):dt(i,l=>{const c=s||this._getRegistryForType(l);this._exec(e,c,l)})})}_exec(e,t,s){const i=mx(e);Tt(s["before"+i],[],s),t[e](s),Tt(s["after"+i],[],s)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const s=this._typedRegistries[t];if(s.isForType(e))return s}return this.plugins}_get(e,t,s){const i=t.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return i}}var _i=new A9;class I9{constructor(){this._init=[]}notify(e,t,s,i){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const r=i?this._descriptors(e).filter(i):this._descriptors(e),l=this._notify(r,e,t,s);return t==="afterDestroy"&&(this._notify(r,e,"stop"),this._notify(this._init,e,"uninstall")),l}_notify(e,t,s,i){i=i||{};for(const r of e){const l=r.plugin,c=l[s],h=[t,i,r.options];if(Tt(c,h,l)===!1&&i.cancelable)return!1}return!0}invalidate(){Qe(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const s=e&&e.config,i=Ue(s.options&&s.options.plugins,{}),r=R9(s);return i===!1&&!t?[]:D9(e,r,i,t)}_notifyStateChanges(e){const t=this._oldCache||[],s=this._cache,i=(r,l)=>r.filter(c=>!l.some(h=>c.plugin.id===h.plugin.id));this._notify(i(t,s),e,"stop"),this._notify(i(s,t),e,"start")}}function R9(n){const e={},t=[],s=Object.keys(_i.plugins.items);for(let r=0;r<s.length;r++)t.push(_i.getPlugin(s[r]));const i=n.plugins||[];for(let r=0;r<i.length;r++){const l=i[r];t.indexOf(l)===-1&&(t.push(l),e[l.id]=!0)}return{plugins:t,localIds:e}}function C9(n,e){return!e&&n===!1?null:n===!0?{}:n}function D9(n,{plugins:e,localIds:t},s,i){const r=[],l=n.getContext();for(const c of e){const h=c.id,d=C9(s[h],i);d!==null&&r.push({plugin:c,options:N9(n.config,{plugin:c,local:t[h]},d,l)})}return r}function N9(n,{plugin:e,local:t},s,i){const r=n.pluginScopeKeys(e),l=n.getOptionScopes(s,r);return t&&e.defaults&&l.push(e.defaults),n.createResolver(l,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function vb(n,e){const t=Pt.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function k9(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function M9(n,e){return n===e?"_index_":"_value_"}function B1(n){if(n==="x"||n==="y"||n==="r")return n}function O9(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function xb(n,...e){if(B1(n))return n;for(const t of e){const s=t.axis||O9(t.position)||n.length>1&&B1(n[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function F1(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function P9(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(s=>s.xAxisID===n||s.yAxisID===n);if(t.length)return F1(n,"x",t[0])||F1(n,"y",t[0])}return{}}function V9(n,e){const t=_l[n.type]||{scales:{}},s=e.scales||{},i=vb(n.type,e),r=Object.create(null);return Object.keys(s).forEach(l=>{const c=s[l];if(!Ze(c))return console.error(`Invalid scale configuration for scale: ${l}`);if(c._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${l}`);const h=xb(l,c,P9(l,n),Pt.scales[c.type]),d=M9(h,i),m=t.scales||{};r[l]=ad(Object.create(null),[{axis:h},c,m[h],m[d]])}),n.data.datasets.forEach(l=>{const c=l.type||n.type,h=l.indexAxis||vb(c,e),m=(_l[c]||{}).scales||{};Object.keys(m).forEach(_=>{const v=k9(_,h),T=l[v+"AxisID"]||v;r[T]=r[T]||Object.create(null),ad(r[T],[{axis:v},s[T],m[_]])})}),Object.keys(r).forEach(l=>{const c=r[l];ad(c,[Pt.scales[c.type],Pt.scale])}),r}function ek(n){const e=n.options||(n.options={});e.plugins=Ue(e.plugins,{}),e.scales=V9(n,e)}function tk(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function L9(n){return n=n||{},n.data=tk(n.data),ek(n),n}const z1=new Map,nk=new Set;function Km(n,e){let t=z1.get(n);return t||(t=e(),z1.set(n,t),nk.add(t)),t}const Ph=(n,e,t)=>{const s=Ha(e,t);s!==void 0&&n.add(s)};class j9{constructor(e){this._config=L9(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=tk(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),ek(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Km(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return Km(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return Km(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,s=this.type;return Km(`${s}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const s=this._scopeCache;let i=s.get(e);return(!i||t)&&(i=new Map,s.set(e,i)),i}getOptionScopes(e,t,s){const{options:i,type:r}=this,l=this._cachedScopes(e,s),c=l.get(t);if(c)return c;const h=new Set;t.forEach(m=>{e&&(h.add(e),m.forEach(_=>Ph(h,e,_))),m.forEach(_=>Ph(h,i,_)),m.forEach(_=>Ph(h,_l[r]||{},_)),m.forEach(_=>Ph(h,Pt,_)),m.forEach(_=>Ph(h,_b,_))});const d=Array.from(h);return d.length===0&&d.push(Object.create(null)),nk.has(t)&&l.set(t,d),d}chartOptionScopes(){const{options:e,type:t}=this;return[e,_l[t]||{},Pt.datasets[t]||{},{type:t},Pt,_b]}resolveNamedOptions(e,t,s,i=[""]){const r={$shared:!0},{resolver:l,subPrefixes:c}=H1(this._resolverCache,e,i);let h=l;if(B9(l,t)){r.$shared=!1,s=qa(s)?s():s;const d=this.createResolver(e,s,c);h=nu(l,s,d)}for(const d of t)r[d]=h[d];return r}createResolver(e,t,s=[""],i){const{resolver:r}=H1(this._resolverCache,e,s);return Ze(t)?nu(r,t,void 0,i):r}}function H1(n,e,t){let s=n.get(e);s||(s=new Map,n.set(e,s));const i=t.join();let r=s.get(i);return r||(r={resolver:vx(e,t),subPrefixes:t.filter(c=>!c.toLowerCase().includes("hover"))},s.set(i,r)),r}const U9=n=>Ze(n)&&Object.getOwnPropertyNames(n).some(e=>qa(n[e]));function B9(n,e){const{isScriptable:t,isIndexable:s}=MN(n);for(const i of e){const r=t(i),l=s(i),c=(l||r)&&n[i];if(r&&(qa(c)||U9(c))||l&&Ot(c))return!0}return!1}var F9="4.5.0";const z9=["top","bottom","left","right","chartArea"];function q1(n,e){return n==="top"||n==="bottom"||z9.indexOf(n)===-1&&e==="x"}function G1(n,e){return function(t,s){return t[n]===s[n]?t[e]-s[e]:t[n]-s[n]}}function $1(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Tt(t&&t.onComplete,[n],e)}function H9(n){const e=n.chart,t=e.options.animation;Tt(t&&t.onProgress,[n],e)}function sk(n){return Ex()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const xg={},W1=n=>{const e=sk(n);return Object.values(xg).filter(t=>t.canvas===e).pop()};function q9(n,e,t){const s=Object.keys(n);for(const i of s){const r=+i;if(r>=e){const l=n[i];delete n[i],(t>0||r>e)&&(n[r+t]=l)}}}function G9(n,e,t,s){return!t||n.type==="mouseout"?null:s?e:n}class An{static register(...e){_i.add(...e),Y1()}static unregister(...e){_i.remove(...e),Y1()}constructor(e,t){const s=this.config=new j9(t),i=sk(e),r=W1(i);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const l=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||c9(i)),this.platform.updateConfig(s);const c=this.platform.acquireContext(i,l.aspectRatio),h=c&&c.canvas,d=h&&h.height,m=h&&h.width;if(this.id=$5(),this.ctx=c,this.canvas=h,this.width=m,this.height=d,this._options=l,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new I9,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=cU(_=>this.update(_),l.resizeDelay||0),this._dataChanges=[],xg[this.id]=this,!c||!h){console.error("Failed to create chart: can't acquire context from the given item");return}nr.listen(this,"complete",$1),nr.listen(this,"progress",H9),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:s,height:i,_aspectRatio:r}=this;return Qe(e)?t&&r?r:i?s/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return _i}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():p1(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return f1(this.canvas,this.ctx),this}stop(){return nr.stop(this),this}resize(e,t){nr.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const s=this.options,i=this.canvas,r=s.maintainAspectRatio&&this.aspectRatio,l=this.platform.getMaximumSize(i,e,t,r),c=s.devicePixelRatio||this.platform.getDevicePixelRatio(),h=this.width?"resize":"attach";this.width=l.width,this.height=l.height,this._aspectRatio=this.aspectRatio,p1(this,c,!0)&&(this.notifyPlugins("resize",{size:l}),Tt(s.onResize,[this,l],this),this.attached&&this._doResize(h)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};dt(t,(s,i)=>{s.id=i})}buildOrUpdateScales(){const e=this.options,t=e.scales,s=this.scales,i=Object.keys(s).reduce((l,c)=>(l[c]=!1,l),{});let r=[];t&&(r=r.concat(Object.keys(t).map(l=>{const c=t[l],h=xb(l,c),d=h==="r",m=h==="x";return{options:c,dposition:d?"chartArea":m?"bottom":"left",dtype:d?"radialLinear":m?"category":"linear"}}))),dt(r,l=>{const c=l.options,h=c.id,d=xb(h,c),m=Ue(c.type,l.dtype);(c.position===void 0||q1(c.position,d)!==q1(l.dposition))&&(c.position=l.dposition),i[h]=!0;let _=null;if(h in s&&s[h].type===m)_=s[h];else{const v=_i.getScale(m);_=new v({id:h,type:m,ctx:this.ctx,chart:this}),s[_.id]=_}_.init(c,e)}),dt(i,(l,c)=>{l||delete s[c]}),dt(s,l=>{jn.configure(this,l,l.options),jn.addBox(this,l)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,s=e.length;if(e.sort((i,r)=>i.index-r.index),s>t){for(let i=t;i<s;++i)this._destroyDatasetMeta(i);e.splice(t,s-t)}this._sortedMetasets=e.slice(0).sort(G1("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((s,i)=>{t.filter(r=>r===s._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let s,i;for(this._removeUnreferencedMetasets(),s=0,i=t.length;s<i;s++){const r=t[s];let l=this.getDatasetMeta(s);const c=r.type||this.config.type;if(l.type&&l.type!==c&&(this._destroyDatasetMeta(s),l=this.getDatasetMeta(s)),l.type=c,l.indexAxis=r.indexAxis||vb(c,this.options),l.order=r.order||0,l.index=s,l.label=""+r.label,l.visible=this.isDatasetVisible(s),l.controller)l.controller.updateIndex(s),l.controller.linkScales();else{const h=_i.getController(c),{datasetElementType:d,dataElementType:m}=Pt.datasets[c];Object.assign(h,{dataElementType:_i.getElement(m),datasetElementType:d&&_i.getElement(d)}),l.controller=new h(this,s),e.push(l.controller)}}return this._updateMetasets(),e}_resetElements(){dt(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const s=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let l=0;for(let d=0,m=this.data.datasets.length;d<m;d++){const{controller:_}=this.getDatasetMeta(d),v=!i&&r.indexOf(_)===-1;_.buildOrUpdateElements(v),l=Math.max(+_.getMaxOverflow(),l)}l=this._minPadding=s.layout.autoPadding?l:0,this._updateLayout(l),i||dt(r,d=>{d.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(G1("z","_idx"));const{_active:c,_lastEvent:h}=this;h?this._eventHandler(h,!0):c.length&&this._updateHoverStyles(c,c,!0),this.render()}_updateScales(){dt(this.scales,e=>{jn.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!i1(t,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:s,start:i,count:r}of t){const l=s==="_removeElements"?-r:r;q9(e,i,l)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,s=r=>new Set(e.filter(l=>l[0]===r).map((l,c)=>c+","+l.splice(1).join(","))),i=s(0);for(let r=1;r<t;r++)if(!i1(i,s(r)))return;return Array.from(i).map(r=>r.split(",")).map(r=>({method:r[1],start:+r[2],count:+r[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;jn.update(this,this.width,this.height,e);const t=this.chartArea,s=t.width<=0||t.height<=0;this._layers=[],dt(this.boxes,i=>{s&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,r)=>{i._idx=r}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,s=this.data.datasets.length;t<s;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,s=this.data.datasets.length;t<s;++t)this._updateDataset(t,qa(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const s=this.getDatasetMeta(e),i={meta:s,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(s.controller._update(t),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(nr.has(this)?this.attached&&!nr.running(this)&&nr.start(this):(this.draw(),$1({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,s=[];let i,r;for(i=0,r=t.length;i<r;++i){const l=t[i];(!e||l.visible)&&s.push(l)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,s={meta:e,index:e.index,cancelable:!0},i=qN(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(i&&qp(t,i),e.controller.draw(),i&&Gp(t),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return hr(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,s,i){const r=zB.modes[t];return typeof r=="function"?r(this,e,s,i):[]}getDatasetMeta(e){const t=this.data.datasets[e],s=this._metasets;let i=s.filter(r=>r&&r._dataset===t).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},s.push(i)),i}getContext(){return this.$context||(this.$context=Ja(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!t.hidden}setDatasetVisibility(e,t){const s=this.getDatasetMeta(e);s.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,s){const i=s?"show":"hide",r=this.getDatasetMeta(e),l=r.controller._resolveAnimations(void 0,i);Dd(t)?(r.data[t].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),l.update(r,{visible:s}),this.update(c=>c.datasetIndex===e?i:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),nr.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),f1(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete xg[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,s=(r,l)=>{t.addEventListener(this,r,l),e[r]=l},i=(r,l,c)=>{r.offsetX=l,r.offsetY=c,this._eventHandler(r)};dt(this.options.events,r=>s(r,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,s=(h,d)=>{t.addEventListener(this,h,d),e[h]=d},i=(h,d)=>{e[h]&&(t.removeEventListener(this,h,d),delete e[h])},r=(h,d)=>{this.canvas&&this.resize(h,d)};let l;const c=()=>{i("attach",c),this.attached=!0,this.resize(),s("resize",r),s("detach",l)};l=()=>{this.attached=!1,i("resize",r),this._stop(),this._resize(0,0),s("attach",c)},t.isAttached(this.canvas)?c():l()}unbindEvents(){dt(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},dt(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,s){const i=s?"set":"remove";let r,l,c,h;for(t==="dataset"&&(r=this.getDatasetMeta(e[0].datasetIndex),r.controller["_"+i+"DatasetHoverStyle"]()),c=0,h=e.length;c<h;++c){l=e[c];const d=l&&this.getDatasetMeta(l.datasetIndex).controller;d&&d[i+"HoverStyle"](l.element,l.datasetIndex,l.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],s=e.map(({datasetIndex:r,index:l})=>{const c=this.getDatasetMeta(r);if(!c)throw new Error("No dataset found at index "+r);return{datasetIndex:r,element:c.data[l],index:l}});!Zg(s,t)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,t))}notifyPlugins(e,t,s){return this._plugins.notify(this,e,t,s)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,s){const i=this.options.hover,r=(h,d)=>h.filter(m=>!d.some(_=>m.datasetIndex===_.datasetIndex&&m.index===_.index)),l=r(t,e),c=s?e:r(e,t);l.length&&this.updateHoverStyle(l,i.mode,!1),c.length&&i.mode&&this.updateHoverStyle(c,i.mode,!0)}_eventHandler(e,t){const s={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},i=l=>(l.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,i)===!1)return;const r=this._handleEvent(e,t,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,i),(r||s.changed)&&this.render(),this}_handleEvent(e,t,s){const{_active:i=[],options:r}=this,l=t,c=this._getActiveElements(e,i,s,l),h=Z5(e),d=G9(e,this._lastEvent,s,h);s&&(this._lastEvent=null,Tt(r.onHover,[e,c,this],this),h&&Tt(r.onClick,[e,c,this],this));const m=!Zg(c,i);return(m||t)&&(this._active=c,this._updateHoverStyles(c,i,t)),this._lastEvent=d,m}_getActiveElements(e,t,s,i){if(e.type==="mouseout")return[];if(!s)return t;const r=this.options.hover;return this.getElementsAtEventForMode(e,r.mode,r,i)}}_e(An,"defaults",Pt),_e(An,"instances",xg),_e(An,"overrides",_l),_e(An,"registry",_i),_e(An,"version",F9),_e(An,"getChart",W1);function Y1(){return dt(An.instances,n=>n._plugins.invalidate())}function $9(n,e,t){const{startAngle:s,x:i,y:r,outerRadius:l,innerRadius:c,options:h}=e,{borderWidth:d,borderJoinStyle:m}=h,_=Math.min(d/l,Vn(s-t));if(n.beginPath(),n.arc(i,r,l-d/2,s+_/2,t-_/2),c>0){const v=Math.min(d/c,Vn(s-t));n.arc(i,r,c+d/2,t-v/2,s+v/2,!0)}else{const v=Math.min(d/2,l*Vn(s-t));if(m==="round")n.arc(i,r,v,t-it/2,s+it/2,!0);else if(m==="bevel"){const T=2*v*v,S=-T*Math.cos(t+it/2)+i,E=-T*Math.sin(t+it/2)+r,R=T*Math.cos(s+it/2)+i,k=T*Math.sin(s+it/2)+r;n.lineTo(S,E),n.lineTo(R,k)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function W9(n,e,t){const{startAngle:s,pixelMargin:i,x:r,y:l,outerRadius:c,innerRadius:h}=e;let d=i/c;n.beginPath(),n.arc(r,l,c,s-d,t+d),h>i?(d=i/h,n.arc(r,l,h,t+d,s-d,!0)):n.arc(r,l,i,t+Qt,s-Qt),n.closePath(),n.clip()}function Y9(n){return bx(n,["outerStart","outerEnd","innerStart","innerEnd"])}function K9(n,e,t,s){const i=Y9(n.options.borderRadius),r=(t-e)/2,l=Math.min(r,s*e/2),c=h=>{const d=(t-Math.min(r,h))*s/2;return vn(h,0,Math.min(r,d))};return{outerStart:c(i.outerStart),outerEnd:c(i.outerEnd),innerStart:vn(i.innerStart,0,l),innerEnd:vn(i.innerEnd,0,l)}}function xc(n,e,t,s){return{x:t+n*Math.cos(e),y:s+n*Math.sin(e)}}function ip(n,e,t,s,i,r){const{x:l,y:c,startAngle:h,pixelMargin:d,innerRadius:m}=e,_=Math.max(e.outerRadius+s+t-d,0),v=m>0?m+s+t+d:0;let T=0;const S=i-h;if(s){const be=m>0?m-s:0,Y=_>0?_-s:0,ae=(be+Y)/2,me=ae!==0?S*ae/(ae+s):S;T=(S-me)/2}const E=Math.max(.001,S*_-t/it)/_,R=(S-E)/2,k=h+R+T,L=i-R-T,{outerStart:O,outerEnd:H,innerStart:F,innerEnd:U}=K9(e,v,_,L-k),C=_-O,I=_-H,N=k+O/C,V=L-H/I,j=v+F,B=v+U,M=k+F/j,ne=L-U/B;if(n.beginPath(),r){const be=(N+V)/2;if(n.arc(l,c,_,N,be),n.arc(l,c,_,be,V),H>0){const Ce=xc(I,V,l,c);n.arc(Ce.x,Ce.y,H,V,L+Qt)}const Y=xc(B,L,l,c);if(n.lineTo(Y.x,Y.y),U>0){const Ce=xc(B,ne,l,c);n.arc(Ce.x,Ce.y,U,L+Qt,ne+Math.PI)}const ae=(L-U/v+(k+F/v))/2;if(n.arc(l,c,v,L-U/v,ae,!0),n.arc(l,c,v,ae,k+F/v,!0),F>0){const Ce=xc(j,M,l,c);n.arc(Ce.x,Ce.y,F,M+Math.PI,k-Qt)}const me=xc(C,k,l,c);if(n.lineTo(me.x,me.y),O>0){const Ce=xc(C,N,l,c);n.arc(Ce.x,Ce.y,O,k-Qt,N)}}else{n.moveTo(l,c);const be=Math.cos(N)*_+l,Y=Math.sin(N)*_+c;n.lineTo(be,Y);const ae=Math.cos(V)*_+l,me=Math.sin(V)*_+c;n.lineTo(ae,me)}n.closePath()}function Q9(n,e,t,s,i){const{fullCircles:r,startAngle:l,circumference:c}=e;let h=e.endAngle;if(r){ip(n,e,t,s,h,i);for(let d=0;d<r;++d)n.fill();isNaN(c)||(h=l+(c%Rt||Rt))}return ip(n,e,t,s,h,i),n.fill(),h}function X9(n,e,t,s,i){const{fullCircles:r,startAngle:l,circumference:c,options:h}=e,{borderWidth:d,borderJoinStyle:m,borderDash:_,borderDashOffset:v,borderRadius:T}=h,S=h.borderAlign==="inner";if(!d)return;n.setLineDash(_||[]),n.lineDashOffset=v,S?(n.lineWidth=d*2,n.lineJoin=m||"round"):(n.lineWidth=d,n.lineJoin=m||"bevel");let E=e.endAngle;if(r){ip(n,e,t,s,E,i);for(let R=0;R<r;++R)n.stroke();isNaN(c)||(E=l+(c%Rt||Rt))}S&&W9(n,e,E),h.selfJoin&&E-l>=it&&T===0&&m!=="miter"&&$9(n,e,E),r||(ip(n,e,t,s,E,i),n.stroke())}class Gh extends ei{constructor(t){super();_e(this,"circumference");_e(this,"endAngle");_e(this,"fullCircles");_e(this,"innerRadius");_e(this,"outerRadius");_e(this,"pixelMargin");_e(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,s,i){const r=this.getProps(["x","y"],i),{angle:l,distance:c}=EN(r,{x:t,y:s}),{startAngle:h,endAngle:d,innerRadius:m,outerRadius:_,circumference:v}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),T=(this.options.spacing+this.options.borderWidth)/2,S=Ue(v,d-h),E=Nd(l,h,d)&&h!==d,R=S>=Rt||E,k=cr(c,m+T,_+T);return R&&k}getCenterPoint(t){const{x:s,y:i,startAngle:r,endAngle:l,innerRadius:c,outerRadius:h}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:d,spacing:m}=this.options,_=(r+l)/2,v=(c+h+m+d)/2;return{x:s+Math.cos(_)*v,y:i+Math.sin(_)*v}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:s,circumference:i}=this,r=(s.offset||0)/4,l=(s.spacing||0)/2,c=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=i>Rt?Math.floor(i/Rt):0,i===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const h=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(h)*r,Math.sin(h)*r);const d=1-Math.sin(Math.min(it,i||0)),m=r*d;t.fillStyle=s.backgroundColor,t.strokeStyle=s.borderColor,Q9(t,this,m,l,c),X9(t,this,m,l,c),t.restore()}}_e(Gh,"id","arc"),_e(Gh,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),_e(Gh,"defaultRoutes",{backgroundColor:"backgroundColor"}),_e(Gh,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"});function ik(n,e,t=e){n.lineCap=Ue(t.borderCapStyle,e.borderCapStyle),n.setLineDash(Ue(t.borderDash,e.borderDash)),n.lineDashOffset=Ue(t.borderDashOffset,e.borderDashOffset),n.lineJoin=Ue(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=Ue(t.borderWidth,e.borderWidth),n.strokeStyle=Ue(t.borderColor,e.borderColor)}function Z9(n,e,t){n.lineTo(t.x,t.y)}function J9(n){return n.stepped?xU:n.tension||n.cubicInterpolationMode==="monotone"?TU:Z9}function rk(n,e,t={}){const s=n.length,{start:i=0,end:r=s-1}=t,{start:l,end:c}=e,h=Math.max(i,l),d=Math.min(r,c),m=i<l&&r<l||i>c&&r>c;return{count:s,start:h,loop:e.loop,ilen:d<h&&!m?s+d-h:d-h}}function eF(n,e,t,s){const{points:i,options:r}=e,{count:l,start:c,loop:h,ilen:d}=rk(i,t,s),m=J9(r);let{move:_=!0,reverse:v}=s||{},T,S,E;for(T=0;T<=d;++T)S=i[(c+(v?d-T:T))%l],!S.skip&&(_?(n.moveTo(S.x,S.y),_=!1):m(n,E,S,v,r.stepped),E=S);return h&&(S=i[(c+(v?d:0))%l],m(n,E,S,v,r.stepped)),!!h}function tF(n,e,t,s){const i=e.points,{count:r,start:l,ilen:c}=rk(i,t,s),{move:h=!0,reverse:d}=s||{};let m=0,_=0,v,T,S,E,R,k;const L=H=>(l+(d?c-H:H))%r,O=()=>{E!==R&&(n.lineTo(m,R),n.lineTo(m,E),n.lineTo(m,k))};for(h&&(T=i[L(0)],n.moveTo(T.x,T.y)),v=0;v<=c;++v){if(T=i[L(v)],T.skip)continue;const H=T.x,F=T.y,U=H|0;U===S?(F<E?E=F:F>R&&(R=F),m=(_*m+H)/++_):(O(),n.lineTo(H,F),S=U,_=0,E=R=F),k=F}O()}function Tb(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?tF:eF}function nF(n){return n.stepped?eB:n.tension||n.cubicInterpolationMode==="monotone"?tB:$o}function sF(n,e,t,s){let i=e._path;i||(i=e._path=new Path2D,e.path(i,t,s)&&i.closePath()),ik(n,e.options),n.stroke(i)}function iF(n,e,t,s){const{segments:i,options:r}=e,l=Tb(e);for(const c of i)ik(n,r,c.style),n.beginPath(),l(n,e,c,{start:t,end:t+s-1})&&n.closePath(),n.stroke()}const rF=typeof Path2D=="function";function aF(n,e,t,s){rF&&!e.options.segment?sF(n,e,t,s):iF(n,e,t,s)}class wa extends ei{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const i=s.spanGaps?this._loop:this._fullLoop;$U(this._points,s,e,i,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=oB(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,s=e.length;return s&&t[e[s-1].end]}interpolate(e,t){const s=this.options,i=e[t],r=this.points,l=HN(this,{property:t,start:i,end:i});if(!l.length)return;const c=[],h=nF(s);let d,m;for(d=0,m=l.length;d<m;++d){const{start:_,end:v}=l[d],T=r[_],S=r[v];if(T===S){c.push(T);continue}const E=Math.abs((i-T[t])/(S[t]-T[t])),R=h(T,S,E,s.stepped);R[t]=e[t],c.push(R)}return c.length===1?c[0]:c}pathSegment(e,t,s){return Tb(this)(e,this,t,s)}path(e,t,s){const i=this.segments,r=Tb(this);let l=this._loop;t=t||0,s=s||this.points.length-t;for(const c of i)l&=r(e,this,c,{start:t,end:t+s-1});return!!l}draw(e,t,s,i){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(e.save(),aF(e,this,s,i),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}_e(wa,"id","line"),_e(wa,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),_e(wa,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),_e(wa,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function K1(n,e,t,s){const i=n.options,{[t]:r}=n.getProps([t],s);return Math.abs(e-r)<i.radius+i.hitRadius}class Tg extends ei{constructor(t){super();_e(this,"parsed");_e(this,"skip");_e(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,s,i){const r=this.options,{x:l,y:c}=this.getProps(["x","y"],i);return Math.pow(t-l,2)+Math.pow(s-c,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(t,s){return K1(this,t,"x",s)}inYRange(t,s){return K1(this,t,"y",s)}getCenterPoint(t){const{x:s,y:i}=this.getProps(["x","y"],t);return{x:s,y:i}}size(t){t=t||this.options||{};let s=t.radius||0;s=Math.max(s,s&&t.hoverRadius||0);const i=s&&t.borderWidth||0;return(s+i)*2}draw(t,s){const i=this.options;this.skip||i.radius<.1||!hr(this,s,this.size(i)/2)||(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,yb(t,i,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}_e(Tg,"id","point"),_e(Tg,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),_e(Tg,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function ak(n,e){const{x:t,y:s,base:i,width:r,height:l}=n.getProps(["x","y","base","width","height"],e);let c,h,d,m,_;return n.horizontal?(_=l/2,c=Math.min(t,i),h=Math.max(t,i),d=s-_,m=s+_):(_=r/2,c=t-_,h=t+_,d=Math.min(s,i),m=Math.max(s,i)),{left:c,top:d,right:h,bottom:m}}function Sa(n,e,t,s){return n?0:vn(e,t,s)}function oF(n,e,t){const s=n.options.borderWidth,i=n.borderSkipped,r=kN(s);return{t:Sa(i.top,r.top,0,t),r:Sa(i.right,r.right,0,e),b:Sa(i.bottom,r.bottom,0,t),l:Sa(i.left,r.left,0,e)}}function lF(n,e,t){const{enableBorderRadius:s}=n.getProps(["enableBorderRadius"]),i=n.options.borderRadius,r=al(i),l=Math.min(e,t),c=n.borderSkipped,h=s||Ze(i);return{topLeft:Sa(!h||c.top||c.left,r.topLeft,0,l),topRight:Sa(!h||c.top||c.right,r.topRight,0,l),bottomLeft:Sa(!h||c.bottom||c.left,r.bottomLeft,0,l),bottomRight:Sa(!h||c.bottom||c.right,r.bottomRight,0,l)}}function cF(n){const e=ak(n),t=e.right-e.left,s=e.bottom-e.top,i=oF(n,t/2,s/2),r=lF(n,t/2,s/2);return{outer:{x:e.left,y:e.top,w:t,h:s,radius:r},inner:{x:e.left+i.l,y:e.top+i.t,w:t-i.l-i.r,h:s-i.t-i.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,r.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(i.b,i.r))}}}}function R0(n,e,t,s){const i=e===null,r=t===null,c=n&&!(i&&r)&&ak(n,s);return c&&(i||cr(e,c.left,c.right))&&(r||cr(t,c.top,c.bottom))}function uF(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function hF(n,e){n.rect(e.x,e.y,e.w,e.h)}function C0(n,e,t={}){const s=n.x!==t.x?-e:0,i=n.y!==t.y?-e:0,r=(n.x+n.w!==t.x+t.w?e:0)-s,l=(n.y+n.h!==t.y+t.h?e:0)-i;return{x:n.x+s,y:n.y+i,w:n.w+r,h:n.h+l,radius:n.radius}}class Eg extends ei{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:s,backgroundColor:i}}=this,{inner:r,outer:l}=cF(this),c=uF(l.radius)?kd:hF;e.save(),(l.w!==r.w||l.h!==r.h)&&(e.beginPath(),c(e,C0(l,t,r)),e.clip(),c(e,C0(r,-t,l)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),c(e,C0(r,t)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,t,s){return R0(this,e,t,s)}inXRange(e,t){return R0(this,e,null,t)}inYRange(e,t){return R0(this,null,e,t)}getCenterPoint(e){const{x:t,y:s,base:i,horizontal:r}=this.getProps(["x","y","base","horizontal"],e);return{x:r?(t+i)/2:t,y:r?s:(s+i)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}_e(Eg,"id","bar"),_e(Eg,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),_e(Eg,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var dF=Object.freeze({__proto__:null,ArcElement:Gh,BarElement:Eg,LineElement:wa,PointElement:Tg});const Eb=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],Q1=Eb.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function ok(n){return Eb[n%Eb.length]}function lk(n){return Q1[n%Q1.length]}function fF(n,e){return n.borderColor=ok(e),n.backgroundColor=lk(e),++e}function mF(n,e){return n.backgroundColor=n.data.map(()=>ok(e++)),e}function gF(n,e){return n.backgroundColor=n.data.map(()=>lk(e++)),e}function pF(n){let e=0;return(t,s)=>{const i=n.getDatasetMeta(s).controller;i instanceof tl?e=mF(t,e):i instanceof ud?e=gF(t,e):i&&(e=fF(t,e))}}function X1(n){let e;for(e in n)if(n[e].borderColor||n[e].backgroundColor)return!0;return!1}function _F(n){return n&&(n.borderColor||n.backgroundColor)}function yF(){return Pt.borderColor!=="rgba(0,0,0,0.1)"||Pt.backgroundColor!=="rgba(0,0,0,0.1)"}var bF={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,e,t){if(!t.enabled)return;const{data:{datasets:s},options:i}=n.config,{elements:r}=i,l=X1(s)||_F(i)||r&&X1(r)||yF();if(!t.forceOverride&&l)return;const c=pF(n);s.forEach(c)}};function vF(n,e,t,s,i){const r=i.samples||s;if(r>=t)return n.slice(e,e+t);const l=[],c=(t-2)/(r-2);let h=0;const d=e+t-1;let m=e,_,v,T,S,E;for(l[h++]=n[m],_=0;_<r-2;_++){let R=0,k=0,L;const O=Math.floor((_+1)*c)+1+e,H=Math.min(Math.floor((_+2)*c)+1,t)+e,F=H-O;for(L=O;L<H;L++)R+=n[L].x,k+=n[L].y;R/=F,k/=F;const U=Math.floor(_*c)+1+e,C=Math.min(Math.floor((_+1)*c)+1,t)+e,{x:I,y:N}=n[m];for(T=S=-1,L=U;L<C;L++)S=.5*Math.abs((I-R)*(n[L].y-N)-(I-n[L].x)*(k-N)),S>T&&(T=S,v=n[L],E=L);l[h++]=v,m=E}return l[h++]=n[d],l}function xF(n,e,t,s){let i=0,r=0,l,c,h,d,m,_,v,T,S,E;const R=[],k=e+t-1,L=n[e].x,H=n[k].x-L;for(l=e;l<e+t;++l){c=n[l],h=(c.x-L)/H*s,d=c.y;const F=h|0;if(F===m)d<S?(S=d,_=l):d>E&&(E=d,v=l),i=(r*i+c.x)/++r;else{const U=l-1;if(!Qe(_)&&!Qe(v)){const C=Math.min(_,v),I=Math.max(_,v);C!==T&&C!==U&&R.push({...n[C],x:i}),I!==T&&I!==U&&R.push({...n[I],x:i})}l>0&&U!==T&&R.push(n[U]),R.push(c),m=F,r=0,S=E=d,_=v=T=l}}return R}function ck(n){if(n._decimated){const e=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function Z1(n){n.data.datasets.forEach(e=>{ck(e)})}function TF(n,e){const t=e.length;let s=0,i;const{iScale:r}=n,{min:l,max:c,minDefined:h,maxDefined:d}=r.getUserBounds();return h&&(s=vn(ur(e,r.axis,l).lo,0,t-1)),d?i=vn(ur(e,r.axis,c).hi+1,s,t)-s:i=t-s,{start:s,count:i}}var EF={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,e,t)=>{if(!t.enabled){Z1(n);return}const s=n.width;n.data.datasets.forEach((i,r)=>{const{_data:l,indexAxis:c}=i,h=n.getDatasetMeta(r),d=l||i.data;if(Hh([c,n.options.indexAxis])==="y"||!h.controller.supportsDecimation)return;const m=n.scales[h.xAxisID];if(m.type!=="linear"&&m.type!=="time"||n.options.parsing)return;let{start:_,count:v}=TF(h,d);const T=t.threshold||4*s;if(v<=T){ck(i);return}Qe(l)&&(i._data=d,delete i.data,Object.defineProperty(i,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(E){this._data=E}}));let S;switch(t.algorithm){case"lttb":S=vF(d,_,v,s,t);break;case"min-max":S=xF(d,_,v,s);break;default:throw new Error(`Unsupported decimation algorithm '${t.algorithm}'`)}i._decimated=S})},destroy(n){Z1(n)}};function wF(n,e,t){const s=n.segments,i=n.points,r=e.points,l=[];for(const c of s){let{start:h,end:d}=c;d=Yp(h,d,i);const m=wb(t,i[h],i[d],c.loop);if(!e.segments){l.push({source:c,target:m,start:i[h],end:i[d]});continue}const _=HN(e,m);for(const v of _){const T=wb(t,r[v.start],r[v.end],v.loop),S=zN(c,i,T);for(const E of S)l.push({source:E,target:v,start:{[t]:J1(m,T,"start",Math.max)},end:{[t]:J1(m,T,"end",Math.min)}})}}return l}function wb(n,e,t,s){if(s)return;let i=e[n],r=t[n];return n==="angle"&&(i=Vn(i),r=Vn(r)),{property:n,start:i,end:r}}function SF(n,e){const{x:t=null,y:s=null}=n||{},i=e.points,r=[];return e.segments.forEach(({start:l,end:c})=>{c=Yp(l,c,i);const h=i[l],d=i[c];s!==null?(r.push({x:h.x,y:s}),r.push({x:d.x,y:s})):t!==null&&(r.push({x:t,y:h.y}),r.push({x:t,y:d.y}))}),r}function Yp(n,e,t){for(;e>n;e--){const s=t[e];if(!isNaN(s.x)&&!isNaN(s.y))break}return e}function J1(n,e,t,s){return n&&e?s(n[t],e[t]):n?n[t]:e?e[t]:0}function uk(n,e){let t=[],s=!1;return Ot(n)?(s=!0,t=n):t=SF(n,e),t.length?new wa({points:t,options:{tension:0},_loop:s,_fullLoop:s}):null}function eI(n){return n&&n.fill!==!1}function AF(n,e,t){let i=n[e].fill;const r=[e];let l;if(!t)return i;for(;i!==!1&&r.indexOf(i)===-1;){if(!Bt(i))return i;if(l=n[i],!l)return!1;if(l.visible)return i;r.push(i),i=l.fill}return!1}function IF(n,e,t){const s=NF(n);if(Ze(s))return isNaN(s.value)?!1:s;let i=parseFloat(s);return Bt(i)&&Math.floor(i)===i?RF(s[0],e,i,t):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function RF(n,e,t,s){return(n==="-"||n==="+")&&(t=e+t),t===e||t<0||t>=s?!1:t}function CF(n,e){let t=null;return n==="start"?t=e.bottom:n==="end"?t=e.top:Ze(n)?t=e.getPixelForValue(n.value):e.getBasePixel&&(t=e.getBasePixel()),t}function DF(n,e,t){let s;return n==="start"?s=t:n==="end"?s=e.options.reverse?e.min:e.max:Ze(n)?s=n.value:s=e.getBaseValue(),s}function NF(n){const e=n.options,t=e.fill;let s=Ue(t&&t.target,t);return s===void 0&&(s=!!e.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function kF(n){const{scale:e,index:t,line:s}=n,i=[],r=s.segments,l=s.points,c=MF(e,t);c.push(uk({x:null,y:e.bottom},s));for(let h=0;h<r.length;h++){const d=r[h];for(let m=d.start;m<=d.end;m++)OF(i,l[m],c)}return new wa({points:i,options:{}})}function MF(n,e){const t=[],s=n.getMatchingVisibleMetas("line");for(let i=0;i<s.length;i++){const r=s[i];if(r.index===e)break;r.hidden||t.unshift(r.dataset)}return t}function OF(n,e,t){const s=[];for(let i=0;i<t.length;i++){const r=t[i],{first:l,last:c,point:h}=PF(r,e,"x");if(!(!h||l&&c)){if(l)s.unshift(h);else if(n.push(h),!c)break}}n.push(...s)}function PF(n,e,t){const s=n.interpolate(e,t);if(!s)return{};const i=s[t],r=n.segments,l=n.points;let c=!1,h=!1;for(let d=0;d<r.length;d++){const m=r[d],_=l[m.start][t],v=l[m.end][t];if(cr(i,_,v)){c=i===_,h=i===v;break}}return{first:c,last:h,point:s}}class hk{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,s){const{x:i,y:r,radius:l}=this;return t=t||{start:0,end:Rt},e.arc(i,r,l,t.end,t.start,!0),!s.bounds}interpolate(e){const{x:t,y:s,radius:i}=this,r=e.angle;return{x:t+Math.cos(r)*i,y:s+Math.sin(r)*i,angle:r}}}function VF(n){const{chart:e,fill:t,line:s}=n;if(Bt(t))return LF(e,t);if(t==="stack")return kF(n);if(t==="shape")return!0;const i=jF(n);return i instanceof hk?i:uk(i,s)}function LF(n,e){const t=n.getDatasetMeta(e);return t&&n.isDatasetVisible(e)?t.dataset:null}function jF(n){return(n.scale||{}).getPointPositionForValue?BF(n):UF(n)}function UF(n){const{scale:e={},fill:t}=n,s=CF(t,e);if(Bt(s)){const i=e.isHorizontal();return{x:i?s:null,y:i?null:s}}return null}function BF(n){const{scale:e,fill:t}=n,s=e.options,i=e.getLabels().length,r=s.reverse?e.max:e.min,l=DF(t,e,r),c=[];if(s.grid.circular){const h=e.getPointPositionForValue(0,r);return new hk({x:h.x,y:h.y,radius:e.getDistanceFromCenterForValue(l)})}for(let h=0;h<i;++h)c.push(e.getPointPositionForValue(h,l));return c}function D0(n,e,t){const s=VF(e),{chart:i,index:r,line:l,scale:c,axis:h}=e,d=l.options,m=d.fill,_=d.backgroundColor,{above:v=_,below:T=_}=m||{},S=i.getDatasetMeta(r),E=qN(i,S);s&&l.points.length&&(qp(n,t),FF(n,{line:l,target:s,above:v,below:T,area:t,scale:c,axis:h,clip:E}),Gp(n))}function FF(n,e){const{line:t,target:s,above:i,below:r,area:l,scale:c,clip:h}=e,d=t._loop?"angle":e.axis;n.save();let m=r;r!==i&&(d==="x"?(tI(n,s,l.top),N0(n,{line:t,target:s,color:i,scale:c,property:d,clip:h}),n.restore(),n.save(),tI(n,s,l.bottom)):d==="y"&&(nI(n,s,l.left),N0(n,{line:t,target:s,color:r,scale:c,property:d,clip:h}),n.restore(),n.save(),nI(n,s,l.right),m=i)),N0(n,{line:t,target:s,color:m,scale:c,property:d,clip:h}),n.restore()}function tI(n,e,t){const{segments:s,points:i}=e;let r=!0,l=!1;n.beginPath();for(const c of s){const{start:h,end:d}=c,m=i[h],_=i[Yp(h,d,i)];r?(n.moveTo(m.x,m.y),r=!1):(n.lineTo(m.x,t),n.lineTo(m.x,m.y)),l=!!e.pathSegment(n,c,{move:l}),l?n.closePath():n.lineTo(_.x,t)}n.lineTo(e.first().x,t),n.closePath(),n.clip()}function nI(n,e,t){const{segments:s,points:i}=e;let r=!0,l=!1;n.beginPath();for(const c of s){const{start:h,end:d}=c,m=i[h],_=i[Yp(h,d,i)];r?(n.moveTo(m.x,m.y),r=!1):(n.lineTo(t,m.y),n.lineTo(m.x,m.y)),l=!!e.pathSegment(n,c,{move:l}),l?n.closePath():n.lineTo(t,_.y)}n.lineTo(t,e.first().y),n.closePath(),n.clip()}function N0(n,e){const{line:t,target:s,property:i,color:r,scale:l,clip:c}=e,h=wF(t,s,i);for(const{source:d,target:m,start:_,end:v}of h){const{style:{backgroundColor:T=r}={}}=d,S=s!==!0;n.save(),n.fillStyle=T,zF(n,l,c,S&&wb(i,_,v)),n.beginPath();const E=!!t.pathSegment(n,d);let R;if(S){E?n.closePath():sI(n,s,v,i);const k=!!s.pathSegment(n,m,{move:E,reverse:!0});R=E&&k,R||sI(n,s,_,i)}n.closePath(),n.fill(R?"evenodd":"nonzero"),n.restore()}}function zF(n,e,t,s){const i=e.chart.chartArea,{property:r,start:l,end:c}=s||{};if(r==="x"||r==="y"){let h,d,m,_;r==="x"?(h=l,d=i.top,m=c,_=i.bottom):(h=i.left,d=l,m=i.right,_=c),n.beginPath(),t&&(h=Math.max(h,t.left),m=Math.min(m,t.right),d=Math.max(d,t.top),_=Math.min(_,t.bottom)),n.rect(h,d,m-h,_-d),n.clip()}}function sI(n,e,t,s){const i=e.interpolate(t,s);i&&n.lineTo(i.x,i.y)}var HF={id:"filler",afterDatasetsUpdate(n,e,t){const s=(n.data.datasets||[]).length,i=[];let r,l,c,h;for(l=0;l<s;++l)r=n.getDatasetMeta(l),c=r.dataset,h=null,c&&c.options&&c instanceof wa&&(h={visible:n.isDatasetVisible(l),index:l,fill:IF(c,l,s),chart:n,axis:r.controller.options.indexAxis,scale:r.vScale,line:c}),r.$filler=h,i.push(h);for(l=0;l<s;++l)h=i[l],!(!h||h.fill===!1)&&(h.fill=AF(i,l,t.propagate))},beforeDraw(n,e,t){const s=t.drawTime==="beforeDraw",i=n.getSortedVisibleDatasetMetas(),r=n.chartArea;for(let l=i.length-1;l>=0;--l){const c=i[l].$filler;c&&(c.line.updateControlPoints(r,c.axis),s&&c.fill&&D0(n.ctx,c,r))}},beforeDatasetsDraw(n,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;const s=n.getSortedVisibleDatasetMetas();for(let i=s.length-1;i>=0;--i){const r=s[i].$filler;eI(r)&&D0(n.ctx,r,n.chartArea)}},beforeDatasetDraw(n,e,t){const s=e.meta.$filler;!eI(s)||t.drawTime!=="beforeDatasetDraw"||D0(n.ctx,s,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const iI=(n,e)=>{let{boxHeight:t=e,boxWidth:s=e}=n;return n.usePointStyle&&(t=Math.min(t,e),s=n.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:t,itemHeight:Math.max(e,t)}},qF=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class rI extends ei{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,s){this.maxWidth=e,this.maxHeight=t,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Tt(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(s=>e.filter(s,this.chart.data))),e.sort&&(t=t.sort((s,i)=>e.sort(s,i,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,i=un(s.font),r=i.size,l=this._computeTitleHeight(),{boxWidth:c,itemHeight:h}=iI(s,r);let d,m;t.font=i.string,this.isHorizontal()?(d=this.maxWidth,m=this._fitRows(l,r,c,h)+10):(m=this.maxHeight,d=this._fitCols(l,i,c,h)+10),this.width=Math.min(d,e.maxWidth||this.maxWidth),this.height=Math.min(m,e.maxHeight||this.maxHeight)}_fitRows(e,t,s,i){const{ctx:r,maxWidth:l,options:{labels:{padding:c}}}=this,h=this.legendHitBoxes=[],d=this.lineWidths=[0],m=i+c;let _=e;r.textAlign="left",r.textBaseline="middle";let v=-1,T=-m;return this.legendItems.forEach((S,E)=>{const R=s+t/2+r.measureText(S.text).width;(E===0||d[d.length-1]+R+2*c>l)&&(_+=m,d[d.length-(E>0?0:1)]=0,T+=m,v++),h[E]={left:0,top:T,row:v,width:R,height:i},d[d.length-1]+=R+c}),_}_fitCols(e,t,s,i){const{ctx:r,maxHeight:l,options:{labels:{padding:c}}}=this,h=this.legendHitBoxes=[],d=this.columnSizes=[],m=l-e;let _=c,v=0,T=0,S=0,E=0;return this.legendItems.forEach((R,k)=>{const{itemWidth:L,itemHeight:O}=GF(s,t,r,R,i);k>0&&T+O+2*c>m&&(_+=v+c,d.push({width:v,height:T}),S+=v+c,E++,v=T=0),h[k]={left:S,top:T,col:E,width:L,height:O},v=Math.max(v,L),T+=O+c}),_+=v,d.push({width:v,height:T}),_}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:s,labels:{padding:i},rtl:r}}=this,l=Mc(r,this.left,this.width);if(this.isHorizontal()){let c=0,h=On(s,this.left+i,this.right-this.lineWidths[c]);for(const d of t)c!==d.row&&(c=d.row,h=On(s,this.left+i,this.right-this.lineWidths[c])),d.top+=this.top+e+i,d.left=l.leftForLtr(l.x(h),d.width),h+=d.width+i}else{let c=0,h=On(s,this.top+e+i,this.bottom-this.columnSizes[c].height);for(const d of t)d.col!==c&&(c=d.col,h=On(s,this.top+e+i,this.bottom-this.columnSizes[c].height)),d.top=h,d.left+=this.left+i,d.left=l.leftForLtr(l.x(d.left),d.width),h+=d.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;qp(e,this),this._draw(),Gp(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:s,ctx:i}=this,{align:r,labels:l}=e,c=Pt.color,h=Mc(e.rtl,this.left,this.width),d=un(l.font),{padding:m}=l,_=d.size,v=_/2;let T;this.drawTitle(),i.textAlign=h.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=d.string;const{boxWidth:S,boxHeight:E,itemHeight:R}=iI(l,_),k=function(U,C,I){if(isNaN(S)||S<=0||isNaN(E)||E<0)return;i.save();const N=Ue(I.lineWidth,1);if(i.fillStyle=Ue(I.fillStyle,c),i.lineCap=Ue(I.lineCap,"butt"),i.lineDashOffset=Ue(I.lineDashOffset,0),i.lineJoin=Ue(I.lineJoin,"miter"),i.lineWidth=N,i.strokeStyle=Ue(I.strokeStyle,c),i.setLineDash(Ue(I.lineDash,[])),l.usePointStyle){const V={radius:E*Math.SQRT2/2,pointStyle:I.pointStyle,rotation:I.rotation,borderWidth:N},j=h.xPlus(U,S/2),B=C+v;NN(i,V,j,B,l.pointStyleWidth&&S)}else{const V=C+Math.max((_-E)/2,0),j=h.leftForLtr(U,S),B=al(I.borderRadius);i.beginPath(),Object.values(B).some(M=>M!==0)?kd(i,{x:j,y:V,w:S,h:E,radius:B}):i.rect(j,V,S,E),i.fill(),N!==0&&i.stroke()}i.restore()},L=function(U,C,I){yl(i,I.text,U,C+R/2,d,{strikethrough:I.hidden,textAlign:h.textAlign(I.textAlign)})},O=this.isHorizontal(),H=this._computeTitleHeight();O?T={x:On(r,this.left+m,this.right-s[0]),y:this.top+m+H,line:0}:T={x:this.left+m,y:On(r,this.top+H+m,this.bottom-t[0].height),line:0},UN(this.ctx,e.textDirection);const F=R+m;this.legendItems.forEach((U,C)=>{i.strokeStyle=U.fontColor,i.fillStyle=U.fontColor;const I=i.measureText(U.text).width,N=h.textAlign(U.textAlign||(U.textAlign=l.textAlign)),V=S+v+I;let j=T.x,B=T.y;h.setWidth(this.width),O?C>0&&j+V+m>this.right&&(B=T.y+=F,T.line++,j=T.x=On(r,this.left+m,this.right-s[T.line])):C>0&&B+F>this.bottom&&(j=T.x=j+t[T.line].width+m,T.line++,B=T.y=On(r,this.top+H+m,this.bottom-t[T.line].height));const M=h.x(j);if(k(M,B,U),j=uU(N,j+S+v,O?j+V:this.right,e.rtl),L(h.x(j),B,U),O)T.x+=V+m;else if(typeof U.text!="string"){const ne=d.lineHeight;T.y+=dk(U,ne)+m}else T.y+=F}),BN(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,s=un(t.font),i=Bn(t.padding);if(!t.display)return;const r=Mc(e.rtl,this.left,this.width),l=this.ctx,c=t.position,h=s.size/2,d=i.top+h;let m,_=this.left,v=this.width;if(this.isHorizontal())v=Math.max(...this.lineWidths),m=this.top+d,_=On(e.align,_,this.right-v);else{const S=this.columnSizes.reduce((E,R)=>Math.max(E,R.height),0);m=d+On(e.align,this.top,this.bottom-S-e.labels.padding-this._computeTitleHeight())}const T=On(c,_,_+v);l.textAlign=r.textAlign(_x(c)),l.textBaseline="middle",l.strokeStyle=t.color,l.fillStyle=t.color,l.font=s.string,yl(l,t.text,T,m,s)}_computeTitleHeight(){const e=this.options.title,t=un(e.font),s=Bn(e.padding);return e.display?t.lineHeight+s.height:0}_getLegendItemAt(e,t){let s,i,r;if(cr(e,this.left,this.right)&&cr(t,this.top,this.bottom)){for(r=this.legendHitBoxes,s=0;s<r.length;++s)if(i=r[s],cr(e,i.left,i.left+i.width)&&cr(t,i.top,i.top+i.height))return this.legendItems[s]}return null}handleEvent(e){const t=this.options;if(!YF(e.type,t))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const i=this._hoveredItem,r=qF(i,s);i&&!r&&Tt(t.onLeave,[e,i,this],this),this._hoveredItem=s,s&&!r&&Tt(t.onHover,[e,s,this],this)}else s&&Tt(t.onClick,[e,s,this],this)}}function GF(n,e,t,s,i){const r=$F(s,n,e,t),l=WF(i,s,e.lineHeight);return{itemWidth:r,itemHeight:l}}function $F(n,e,t,s){let i=n.text;return i&&typeof i!="string"&&(i=i.reduce((r,l)=>r.length>l.length?r:l)),e+t.size/2+s.measureText(i).width}function WF(n,e,t){let s=n;return typeof e.text!="string"&&(s=dk(e,t)),s}function dk(n,e){const t=n.text?n.text.length:0;return e*t}function YF(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var KF={id:"legend",_element:rI,start(n,e,t){const s=n.legend=new rI({ctx:n.ctx,options:t,chart:n});jn.configure(n,s,t),jn.addBox(n,s)},stop(n){jn.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const s=n.legend;jn.configure(n,s,t),s.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const s=e.datasetIndex,i=t.chart;i.isDatasetVisible(s)?(i.hide(s),e.hidden=!0):(i.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:s,textAlign:i,color:r,useBorderRadius:l,borderRadius:c}}=n.legend.options;return n._getSortedDatasetMetas().map(h=>{const d=h.controller.getStyle(t?0:void 0),m=Bn(d.borderWidth);return{text:e[h.index].label,fillStyle:d.backgroundColor,fontColor:r,hidden:!h.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(m.width+m.height)/4,strokeStyle:d.borderColor,pointStyle:s||d.pointStyle,rotation:d.rotation,textAlign:i||d.textAlign,borderRadius:l&&(c||d.borderRadius),datasetIndex:h.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class Ax extends ei{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const i=Ot(s.text)?s.text.length:1;this._padding=Bn(s.padding);const r=i*un(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:s,bottom:i,right:r,options:l}=this,c=l.align;let h=0,d,m,_;return this.isHorizontal()?(m=On(c,s,r),_=t+e,d=r-s):(l.position==="left"?(m=s+e,_=On(c,i,t),h=it*-.5):(m=r-e,_=On(c,t,i),h=it*.5),d=i-t),{titleX:m,titleY:_,maxWidth:d,rotation:h}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const s=un(t.font),r=s.lineHeight/2+this._padding.top,{titleX:l,titleY:c,maxWidth:h,rotation:d}=this._drawArgs(r);yl(e,t.text,0,0,s,{color:t.color,maxWidth:h,rotation:d,textAlign:_x(t.align),textBaseline:"middle",translation:[l,c]})}}function QF(n,e){const t=new Ax({ctx:n.ctx,options:e,chart:n});jn.configure(n,t,e),jn.addBox(n,t),n.titleBlock=t}var XF={id:"title",_element:Ax,start(n,e,t){QF(n,t)},stop(n){const e=n.titleBlock;jn.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,t){const s=n.titleBlock;jn.configure(n,s,t),s.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Qm=new WeakMap;var ZF={id:"subtitle",start(n,e,t){const s=new Ax({ctx:n.ctx,options:t,chart:n});jn.configure(n,s,t),jn.addBox(n,s),Qm.set(n,s)},stop(n){jn.removeBox(n,Qm.get(n)),Qm.delete(n)},beforeUpdate(n,e,t){const s=Qm.get(n);jn.configure(n,s,t),s.options=t},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const $h={average(n){if(!n.length)return!1;let e,t,s=new Set,i=0,r=0;for(e=0,t=n.length;e<t;++e){const c=n[e].element;if(c&&c.hasValue()){const h=c.tooltipPosition();s.add(h.x),i+=h.y,++r}}return r===0||s.size===0?!1:{x:[...s].reduce((c,h)=>c+h)/s.size,y:i/r}},nearest(n,e){if(!n.length)return!1;let t=e.x,s=e.y,i=Number.POSITIVE_INFINITY,r,l,c;for(r=0,l=n.length;r<l;++r){const h=n[r].element;if(h&&h.hasValue()){const d=h.getCenterPoint(),m=pb(e,d);m<i&&(i=m,c=h)}}if(c){const h=c.tooltipPosition();t=h.x,s=h.y}return{x:t,y:s}}};function pi(n,e){return e&&(Ot(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function sr(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function JF(n,e){const{element:t,datasetIndex:s,index:i}=e,r=n.getDatasetMeta(s).controller,{label:l,value:c}=r.getLabelAndValue(i);return{chart:n,label:l,parsed:r.getParsed(i),raw:n.data.datasets[s].data[i],formattedValue:c,dataset:r.getDataset(),dataIndex:i,datasetIndex:s,element:t}}function aI(n,e){const t=n.chart.ctx,{body:s,footer:i,title:r}=n,{boxWidth:l,boxHeight:c}=e,h=un(e.bodyFont),d=un(e.titleFont),m=un(e.footerFont),_=r.length,v=i.length,T=s.length,S=Bn(e.padding);let E=S.height,R=0,k=s.reduce((H,F)=>H+F.before.length+F.lines.length+F.after.length,0);if(k+=n.beforeBody.length+n.afterBody.length,_&&(E+=_*d.lineHeight+(_-1)*e.titleSpacing+e.titleMarginBottom),k){const H=e.displayColors?Math.max(c,h.lineHeight):h.lineHeight;E+=T*H+(k-T)*h.lineHeight+(k-1)*e.bodySpacing}v&&(E+=e.footerMarginTop+v*m.lineHeight+(v-1)*e.footerSpacing);let L=0;const O=function(H){R=Math.max(R,t.measureText(H).width+L)};return t.save(),t.font=d.string,dt(n.title,O),t.font=h.string,dt(n.beforeBody.concat(n.afterBody),O),L=e.displayColors?l+2+e.boxPadding:0,dt(s,H=>{dt(H.before,O),dt(H.lines,O),dt(H.after,O)}),L=0,t.font=m.string,dt(n.footer,O),t.restore(),R+=S.width,{width:R,height:E}}function ez(n,e){const{y:t,height:s}=e;return t<s/2?"top":t>n.height-s/2?"bottom":"center"}function tz(n,e,t,s){const{x:i,width:r}=s,l=t.caretSize+t.caretPadding;if(n==="left"&&i+r+l>e.width||n==="right"&&i-r-l<0)return!0}function nz(n,e,t,s){const{x:i,width:r}=t,{width:l,chartArea:{left:c,right:h}}=n;let d="center";return s==="center"?d=i<=(c+h)/2?"left":"right":i<=r/2?d="left":i>=l-r/2&&(d="right"),tz(d,n,e,t)&&(d="center"),d}function oI(n,e,t){const s=t.yAlign||e.yAlign||ez(n,t);return{xAlign:t.xAlign||e.xAlign||nz(n,e,t,s),yAlign:s}}function sz(n,e){let{x:t,width:s}=n;return e==="right"?t-=s:e==="center"&&(t-=s/2),t}function iz(n,e,t){let{y:s,height:i}=n;return e==="top"?s+=t:e==="bottom"?s-=i+t:s-=i/2,s}function lI(n,e,t,s){const{caretSize:i,caretPadding:r,cornerRadius:l}=n,{xAlign:c,yAlign:h}=t,d=i+r,{topLeft:m,topRight:_,bottomLeft:v,bottomRight:T}=al(l);let S=sz(e,c);const E=iz(e,h,d);return h==="center"?c==="left"?S+=d:c==="right"&&(S-=d):c==="left"?S-=Math.max(m,v)+i:c==="right"&&(S+=Math.max(_,T)+i),{x:vn(S,0,s.width-e.width),y:vn(E,0,s.height-e.height)}}function Xm(n,e,t){const s=Bn(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-s.right:n.x+s.left}function cI(n){return pi([],sr(n))}function rz(n,e,t){return Ja(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function uI(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const fk={beforeTitle:tr,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,s=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return t[e.dataIndex]}return""},afterTitle:tr,beforeBody:tr,beforeLabel:tr,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return Qe(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:tr,afterBody:tr,beforeFooter:tr,footer:tr,afterFooter:tr};function ts(n,e,t,s){const i=n[e].call(t,s);return typeof i>"u"?fk[e].call(t,s):i}class Sb extends ei{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,s=this.options.setContext(this.getContext()),i=s.enabled&&t.options.animation&&s.animations,r=new GN(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=rz(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:s}=t,i=ts(s,"beforeTitle",this,e),r=ts(s,"title",this,e),l=ts(s,"afterTitle",this,e);let c=[];return c=pi(c,sr(i)),c=pi(c,sr(r)),c=pi(c,sr(l)),c}getBeforeBody(e,t){return cI(ts(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:s}=t,i=[];return dt(e,r=>{const l={before:[],lines:[],after:[]},c=uI(s,r);pi(l.before,sr(ts(c,"beforeLabel",this,r))),pi(l.lines,ts(c,"label",this,r)),pi(l.after,sr(ts(c,"afterLabel",this,r))),i.push(l)}),i}getAfterBody(e,t){return cI(ts(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:s}=t,i=ts(s,"beforeFooter",this,e),r=ts(s,"footer",this,e),l=ts(s,"afterFooter",this,e);let c=[];return c=pi(c,sr(i)),c=pi(c,sr(r)),c=pi(c,sr(l)),c}_createItems(e){const t=this._active,s=this.chart.data,i=[],r=[],l=[];let c=[],h,d;for(h=0,d=t.length;h<d;++h)c.push(JF(this.chart,t[h]));return e.filter&&(c=c.filter((m,_,v)=>e.filter(m,_,v,s))),e.itemSort&&(c=c.sort((m,_)=>e.itemSort(m,_,s))),dt(c,m=>{const _=uI(e.callbacks,m);i.push(ts(_,"labelColor",this,m)),r.push(ts(_,"labelPointStyle",this,m)),l.push(ts(_,"labelTextColor",this,m))}),this.labelColors=i,this.labelPointStyles=r,this.labelTextColors=l,this.dataPoints=c,c}update(e,t){const s=this.options.setContext(this.getContext()),i=this._active;let r,l=[];if(!i.length)this.opacity!==0&&(r={opacity:0});else{const c=$h[s.position].call(this,i,this._eventPosition);l=this._createItems(s),this.title=this.getTitle(l,s),this.beforeBody=this.getBeforeBody(l,s),this.body=this.getBody(l,s),this.afterBody=this.getAfterBody(l,s),this.footer=this.getFooter(l,s);const h=this._size=aI(this,s),d=Object.assign({},c,h),m=oI(this.chart,s,d),_=lI(s,d,m,this.chart);this.xAlign=m.xAlign,this.yAlign=m.yAlign,r={opacity:1,x:_.x,y:_.y,width:h.width,height:h.height,caretX:c.x,caretY:c.y}}this._tooltipItems=l,this.$context=void 0,r&&this._resolveAnimations().update(this,r),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,s,i){const r=this.getCaretPosition(e,s,i);t.lineTo(r.x1,r.y1),t.lineTo(r.x2,r.y2),t.lineTo(r.x3,r.y3)}getCaretPosition(e,t,s){const{xAlign:i,yAlign:r}=this,{caretSize:l,cornerRadius:c}=s,{topLeft:h,topRight:d,bottomLeft:m,bottomRight:_}=al(c),{x:v,y:T}=e,{width:S,height:E}=t;let R,k,L,O,H,F;return r==="center"?(H=T+E/2,i==="left"?(R=v,k=R-l,O=H+l,F=H-l):(R=v+S,k=R+l,O=H-l,F=H+l),L=R):(i==="left"?k=v+Math.max(h,m)+l:i==="right"?k=v+S-Math.max(d,_)-l:k=this.caretX,r==="top"?(O=T,H=O-l,R=k-l,L=k+l):(O=T+E,H=O+l,R=k+l,L=k-l),F=O),{x1:R,x2:k,x3:L,y1:O,y2:H,y3:F}}drawTitle(e,t,s){const i=this.title,r=i.length;let l,c,h;if(r){const d=Mc(s.rtl,this.x,this.width);for(e.x=Xm(this,s.titleAlign,s),t.textAlign=d.textAlign(s.titleAlign),t.textBaseline="middle",l=un(s.titleFont),c=s.titleSpacing,t.fillStyle=s.titleColor,t.font=l.string,h=0;h<r;++h)t.fillText(i[h],d.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+c,h+1===r&&(e.y+=s.titleMarginBottom-c)}}_drawColorBox(e,t,s,i,r){const l=this.labelColors[s],c=this.labelPointStyles[s],{boxHeight:h,boxWidth:d}=r,m=un(r.bodyFont),_=Xm(this,"left",r),v=i.x(_),T=h<m.lineHeight?(m.lineHeight-h)/2:0,S=t.y+T;if(r.usePointStyle){const E={radius:Math.min(d,h)/2,pointStyle:c.pointStyle,rotation:c.rotation,borderWidth:1},R=i.leftForLtr(v,d)+d/2,k=S+h/2;e.strokeStyle=r.multiKeyBackground,e.fillStyle=r.multiKeyBackground,yb(e,E,R,k),e.strokeStyle=l.borderColor,e.fillStyle=l.backgroundColor,yb(e,E,R,k)}else{e.lineWidth=Ze(l.borderWidth)?Math.max(...Object.values(l.borderWidth)):l.borderWidth||1,e.strokeStyle=l.borderColor,e.setLineDash(l.borderDash||[]),e.lineDashOffset=l.borderDashOffset||0;const E=i.leftForLtr(v,d),R=i.leftForLtr(i.xPlus(v,1),d-2),k=al(l.borderRadius);Object.values(k).some(L=>L!==0)?(e.beginPath(),e.fillStyle=r.multiKeyBackground,kd(e,{x:E,y:S,w:d,h,radius:k}),e.fill(),e.stroke(),e.fillStyle=l.backgroundColor,e.beginPath(),kd(e,{x:R,y:S+1,w:d-2,h:h-2,radius:k}),e.fill()):(e.fillStyle=r.multiKeyBackground,e.fillRect(E,S,d,h),e.strokeRect(E,S,d,h),e.fillStyle=l.backgroundColor,e.fillRect(R,S+1,d-2,h-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,t,s){const{body:i}=this,{bodySpacing:r,bodyAlign:l,displayColors:c,boxHeight:h,boxWidth:d,boxPadding:m}=s,_=un(s.bodyFont);let v=_.lineHeight,T=0;const S=Mc(s.rtl,this.x,this.width),E=function(I){t.fillText(I,S.x(e.x+T),e.y+v/2),e.y+=v+r},R=S.textAlign(l);let k,L,O,H,F,U,C;for(t.textAlign=l,t.textBaseline="middle",t.font=_.string,e.x=Xm(this,R,s),t.fillStyle=s.bodyColor,dt(this.beforeBody,E),T=c&&R!=="right"?l==="center"?d/2+m:d+2+m:0,H=0,U=i.length;H<U;++H){for(k=i[H],L=this.labelTextColors[H],t.fillStyle=L,dt(k.before,E),O=k.lines,c&&O.length&&(this._drawColorBox(t,e,H,S,s),v=Math.max(_.lineHeight,h)),F=0,C=O.length;F<C;++F)E(O[F]),v=_.lineHeight;dt(k.after,E)}T=0,v=_.lineHeight,dt(this.afterBody,E),e.y-=r}drawFooter(e,t,s){const i=this.footer,r=i.length;let l,c;if(r){const h=Mc(s.rtl,this.x,this.width);for(e.x=Xm(this,s.footerAlign,s),e.y+=s.footerMarginTop,t.textAlign=h.textAlign(s.footerAlign),t.textBaseline="middle",l=un(s.footerFont),t.fillStyle=s.footerColor,t.font=l.string,c=0;c<r;++c)t.fillText(i[c],h.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+s.footerSpacing}}drawBackground(e,t,s,i){const{xAlign:r,yAlign:l}=this,{x:c,y:h}=e,{width:d,height:m}=s,{topLeft:_,topRight:v,bottomLeft:T,bottomRight:S}=al(i.cornerRadius);t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.beginPath(),t.moveTo(c+_,h),l==="top"&&this.drawCaret(e,t,s,i),t.lineTo(c+d-v,h),t.quadraticCurveTo(c+d,h,c+d,h+v),l==="center"&&r==="right"&&this.drawCaret(e,t,s,i),t.lineTo(c+d,h+m-S),t.quadraticCurveTo(c+d,h+m,c+d-S,h+m),l==="bottom"&&this.drawCaret(e,t,s,i),t.lineTo(c+T,h+m),t.quadraticCurveTo(c,h+m,c,h+m-T),l==="center"&&r==="left"&&this.drawCaret(e,t,s,i),t.lineTo(c,h+_),t.quadraticCurveTo(c,h,c+_,h),t.closePath(),t.fill(),i.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,s=this.$animations,i=s&&s.x,r=s&&s.y;if(i||r){const l=$h[e.position].call(this,this._active,this._eventPosition);if(!l)return;const c=this._size=aI(this,e),h=Object.assign({},l,this._size),d=oI(t,e,h),m=lI(e,h,d,t);(i._to!==m.x||r._to!==m.y)&&(this.xAlign=d.xAlign,this.yAlign=d.yAlign,this.width=c.width,this.height=c.height,this.caretX=l.x,this.caretY=l.y,this._resolveAnimations().update(this,m))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(t);const i={width:this.width,height:this.height},r={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const l=Bn(t.padding),c=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&c&&(e.save(),e.globalAlpha=s,this.drawBackground(r,e,i,t),UN(e,t.textDirection),r.y+=l.top,this.drawTitle(r,e,t),this.drawBody(r,e,t),this.drawFooter(r,e,t),BN(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const s=this._active,i=e.map(({datasetIndex:c,index:h})=>{const d=this.chart.getDatasetMeta(c);if(!d)throw new Error("Cannot find a dataset at index "+c);return{datasetIndex:c,element:d.data[h],index:h}}),r=!Zg(s,i),l=this._positionChanged(i,t);(r||l)&&(this._active=i,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,s=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,r=this._active||[],l=this._getActiveElements(e,r,t,s),c=this._positionChanged(l,e),h=t||!Zg(l,r)||c;return h&&(this._active=l,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),h}_getActiveElements(e,t,s,i){const r=this.options;if(e.type==="mouseout")return[];if(!i)return t.filter(c=>this.chart.data.datasets[c.datasetIndex]&&this.chart.getDatasetMeta(c.datasetIndex).controller.getParsed(c.index)!==void 0);const l=this.chart.getElementsAtEventForMode(e,r.mode,r,s);return r.reverse&&l.reverse(),l}_positionChanged(e,t){const{caretX:s,caretY:i,options:r}=this,l=$h[r.position].call(this,e,t);return l!==!1&&(s!==l.x||i!==l.y)}}_e(Sb,"positioners",$h);var az={id:"tooltip",_element:Sb,positioners:$h,afterInit(n,e,t){t&&(n.tooltip=new Sb({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:fk},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},oz=Object.freeze({__proto__:null,Colors:bF,Decimation:EF,Filler:HF,Legend:KF,SubTitle:ZF,Title:XF,Tooltip:az});const lz=(n,e,t,s)=>(typeof e=="string"?(t=n.push(e)-1,s.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function cz(n,e,t,s){const i=n.indexOf(e);if(i===-1)return lz(n,e,t,s);const r=n.lastIndexOf(e);return i!==r?t:i}const uz=(n,e)=>n===null?null:vn(Math.round(n),0,e);function hI(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class Ab extends uf{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const s=this.getLabels();for(const{index:i,label:r}of t)s[i]===r&&s.splice(i,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(Qe(e))return null;const s=this.getLabels();return t=isFinite(t)&&s[t]===e?t:cz(s,e,Ue(t,e),this._addedLabels),uz(t,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:s,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),t||(i=this.getLabels().length-1)),this.min=s,this.max=i}buildTicks(){const e=this.min,t=this.max,s=this.options.offset,i=[];let r=this.getLabels();r=e===0&&t===r.length-1?r:r.slice(e,t+1),this._valueRange=Math.max(r.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let l=e;l<=t;l++)i.push({value:l});return i}getLabelForValue(e){return hI.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}_e(Ab,"id","category"),_e(Ab,"defaults",{ticks:{callback:hI}});function hz(n,e){const t=[],{bounds:i,step:r,min:l,max:c,precision:h,count:d,maxTicks:m,maxDigits:_,includeBounds:v}=n,T=r||1,S=m-1,{min:E,max:R}=e,k=!Qe(l),L=!Qe(c),O=!Qe(d),H=(R-E)/(_+1);let F=a1((R-E)/S/T)*T,U,C,I,N;if(F<1e-14&&!k&&!L)return[{value:E},{value:R}];N=Math.ceil(R/F)-Math.floor(E/F),N>S&&(F=a1(N*F/S/T)*T),Qe(h)||(U=Math.pow(10,h),F=Math.ceil(F*U)/U),i==="ticks"?(C=Math.floor(E/F)*F,I=Math.ceil(R/F)*F):(C=E,I=R),k&&L&&r&&sU((c-l)/r,F/1e3)?(N=Math.round(Math.min((c-l)/F,m)),F=(c-l)/N,C=l,I=c):O?(C=k?l:C,I=L?c:I,N=d-1,F=(I-C)/N):(N=(I-C)/F,od(N,Math.round(N),F/1e3)?N=Math.round(N):N=Math.ceil(N));const V=Math.max(o1(F),o1(C));U=Math.pow(10,Qe(h)?V:h),C=Math.round(C*U)/U,I=Math.round(I*U)/U;let j=0;for(k&&(v&&C!==l?(t.push({value:l}),C<l&&j++,od(Math.round((C+j*F)*U)/U,l,dI(l,H,n))&&j++):C<l&&j++);j<N;++j){const B=Math.round((C+j*F)*U)/U;if(L&&B>c)break;t.push({value:B})}return L&&v&&I!==c?t.length&&od(t[t.length-1].value,c,dI(c,H,n))?t[t.length-1].value=c:t.push({value:c}):(!L||I===c)&&t.push({value:I}),t}function dI(n,e,{horizontal:t,minRotation:s}){const i=Ks(s),r=(t?Math.sin(i):Math.cos(i))||.001,l=.75*e*(""+n).length;return Math.min(e/r,l)}class rp extends uf{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return Qe(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:s}=this.getUserBounds();let{min:i,max:r}=this;const l=h=>i=t?i:h,c=h=>r=s?r:h;if(e){const h=Ai(i),d=Ai(r);h<0&&d<0?c(0):h>0&&d>0&&l(0)}if(i===r){let h=r===0?1:Math.abs(r*.05);c(r+h),e||l(i-h)}this.min=i,this.max=r}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:s}=e,i;return s?(i=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),t=t||11),t&&(i=Math.min(t,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const i={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},r=this._range||this,l=hz(i,r);return e.bounds==="ticks"&&TN(l,this,"value"),e.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}configure(){const e=this.ticks;let t=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const i=(s-t)/Math.max(e.length-1,1)/2;t-=i,s+=i}this._startValue=t,this._endValue=s,this._valueRange=s-t}getLabelForValue(e){return cf(e,this.chart.options.locale,this.options.ticks.format)}}class Ib extends rp{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Bt(e)?e:0,this.max=Bt(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,s=Ks(this.options.ticks.minRotation),i=(e?Math.sin(s):Math.cos(s))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,r.lineHeight/i))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}_e(Ib,"id","linear"),_e(Ib,"defaults",{ticks:{callback:Hp.formatters.numeric}});const Od=n=>Math.floor(Ea(n)),Fo=(n,e)=>Math.pow(10,Od(n)+e);function fI(n){return n/Math.pow(10,Od(n))===1}function mI(n,e,t){const s=Math.pow(10,t),i=Math.floor(n/s);return Math.ceil(e/s)-i}function dz(n,e){const t=e-n;let s=Od(t);for(;mI(n,e,s)>10;)s++;for(;mI(n,e,s)<10;)s--;return Math.min(s,Od(n))}function fz(n,{min:e,max:t}){e=ms(n.min,e);const s=[],i=Od(e);let r=dz(e,t),l=r<0?Math.pow(10,Math.abs(r)):1;const c=Math.pow(10,r),h=i>r?Math.pow(10,i):0,d=Math.round((e-h)*l)/l,m=Math.floor((e-h)/c/10)*c*10;let _=Math.floor((d-m)/Math.pow(10,r)),v=ms(n.min,Math.round((h+m+_*Math.pow(10,r))*l)/l);for(;v<t;)s.push({value:v,major:fI(v),significand:_}),_>=10?_=_<15?15:20:_++,_>=20&&(r++,_=2,l=r>=0?1:l),v=Math.round((h+m+_*Math.pow(10,r))*l)/l;const T=ms(n.max,v);return s.push({value:T,major:fI(T),significand:_}),s}class Rb extends uf{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const s=rp.prototype.parse.apply(this,[e,t]);if(s===0){this._zero=!0;return}return Bt(s)&&s>0?s:null}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Bt(e)?Math.max(0,e):null,this.max=Bt(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Bt(this._userMin)&&(this.min=e===Fo(this.min,0)?Fo(this.min,-1):Fo(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let s=this.min,i=this.max;const r=c=>s=e?s:c,l=c=>i=t?i:c;s===i&&(s<=0?(r(1),l(10)):(r(Fo(s,-1)),l(Fo(i,1)))),s<=0&&r(Fo(i,-1)),i<=0&&l(Fo(s,1)),this.min=s,this.max=i}buildTicks(){const e=this.options,t={min:this._userMin,max:this._userMax},s=fz(t,this);return e.bounds==="ticks"&&TN(s,this,"value"),e.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(e){return e===void 0?"0":cf(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=Ea(e),this._valueRange=Ea(this.max)-Ea(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(Ea(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}_e(Rb,"id","logarithmic"),_e(Rb,"defaults",{ticks:{callback:Hp.formatters.logarithmic,major:{enabled:!0}}});function Cb(n){const e=n.ticks;if(e.display&&n.display){const t=Bn(e.backdropPadding);return Ue(e.font&&e.font.size,Pt.font.size)+t.height}return 0}function mz(n,e,t){return t=Ot(t)?t:[t],{w:vU(n,e.string,t),h:t.length*e.lineHeight}}function gI(n,e,t,s,i){return n===s||n===i?{start:e-t/2,end:e+t/2}:n<s||n>i?{start:e-t,end:e}:{start:e,end:e+t}}function gz(n){const e={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},t=Object.assign({},e),s=[],i=[],r=n._pointLabels.length,l=n.options.pointLabels,c=l.centerPointLabels?it/r:0;for(let h=0;h<r;h++){const d=l.setContext(n.getPointLabelContext(h));i[h]=d.padding;const m=n.getPointPosition(h,n.drawingArea+i[h],c),_=un(d.font),v=mz(n.ctx,_,n._pointLabels[h]);s[h]=v;const T=Vn(n.getIndexAngle(h)+c),S=Math.round(gx(T)),E=gI(S,m.x,v.w,0,180),R=gI(S,m.y,v.h,90,270);pz(t,e,T,E,R)}n.setCenterPoint(e.l-t.l,t.r-e.r,e.t-t.t,t.b-e.b),n._pointLabelItems=bz(n,s,i)}function pz(n,e,t,s,i){const r=Math.abs(Math.sin(t)),l=Math.abs(Math.cos(t));let c=0,h=0;s.start<e.l?(c=(e.l-s.start)/r,n.l=Math.min(n.l,e.l-c)):s.end>e.r&&(c=(s.end-e.r)/r,n.r=Math.max(n.r,e.r+c)),i.start<e.t?(h=(e.t-i.start)/l,n.t=Math.min(n.t,e.t-h)):i.end>e.b&&(h=(i.end-e.b)/l,n.b=Math.max(n.b,e.b+h))}function _z(n,e,t){const s=n.drawingArea,{extra:i,additionalAngle:r,padding:l,size:c}=t,h=n.getPointPosition(e,s+i+l,r),d=Math.round(gx(Vn(h.angle+Qt))),m=Tz(h.y,c.h,d),_=vz(d),v=xz(h.x,c.w,_);return{visible:!0,x:h.x,y:m,textAlign:_,left:v,top:m,right:v+c.w,bottom:m+c.h}}function yz(n,e){if(!e)return!0;const{left:t,top:s,right:i,bottom:r}=n;return!(hr({x:t,y:s},e)||hr({x:t,y:r},e)||hr({x:i,y:s},e)||hr({x:i,y:r},e))}function bz(n,e,t){const s=[],i=n._pointLabels.length,r=n.options,{centerPointLabels:l,display:c}=r.pointLabels,h={extra:Cb(r)/2,additionalAngle:l?it/i:0};let d;for(let m=0;m<i;m++){h.padding=t[m],h.size=e[m];const _=_z(n,m,h);s.push(_),c==="auto"&&(_.visible=yz(_,d),_.visible&&(d=_))}return s}function vz(n){return n===0||n===180?"center":n<180?"left":"right"}function xz(n,e,t){return t==="right"?n-=e:t==="center"&&(n-=e/2),n}function Tz(n,e,t){return t===90||t===270?n-=e/2:(t>270||t<90)&&(n-=e),n}function Ez(n,e,t){const{left:s,top:i,right:r,bottom:l}=t,{backdropColor:c}=e;if(!Qe(c)){const h=al(e.borderRadius),d=Bn(e.backdropPadding);n.fillStyle=c;const m=s-d.left,_=i-d.top,v=r-s+d.width,T=l-i+d.height;Object.values(h).some(S=>S!==0)?(n.beginPath(),kd(n,{x:m,y:_,w:v,h:T,radius:h}),n.fill()):n.fillRect(m,_,v,T)}}function wz(n,e){const{ctx:t,options:{pointLabels:s}}=n;for(let i=e-1;i>=0;i--){const r=n._pointLabelItems[i];if(!r.visible)continue;const l=s.setContext(n.getPointLabelContext(i));Ez(t,l,r);const c=un(l.font),{x:h,y:d,textAlign:m}=r;yl(t,n._pointLabels[i],h,d+c.lineHeight/2,c,{color:l.color,textAlign:m,textBaseline:"middle"})}}function mk(n,e,t,s){const{ctx:i}=n;if(t)i.arc(n.xCenter,n.yCenter,e,0,Rt);else{let r=n.getPointPosition(0,e);i.moveTo(r.x,r.y);for(let l=1;l<s;l++)r=n.getPointPosition(l,e),i.lineTo(r.x,r.y)}}function Sz(n,e,t,s,i){const r=n.ctx,l=e.circular,{color:c,lineWidth:h}=e;!l&&!s||!c||!h||t<0||(r.save(),r.strokeStyle=c,r.lineWidth=h,r.setLineDash(i.dash||[]),r.lineDashOffset=i.dashOffset,r.beginPath(),mk(n,t,l,s),r.closePath(),r.stroke(),r.restore())}function Az(n,e,t){return Ja(n,{label:t,index:e,type:"pointLabel"})}class Wh extends rp{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=Bn(Cb(this.options)/2),t=this.width=this.maxWidth-e.width,s=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+s/2+e.top),this.drawingArea=Math.floor(Math.min(t,s)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=Bt(e)&&!isNaN(e)?e:0,this.max=Bt(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Cb(this.options))}generateTickLabels(e){rp.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((t,s)=>{const i=Tt(this.options.pointLabels.callback,[t,s],this);return i||i===0?i:""}).filter((t,s)=>this.chart.getDataVisibility(s))}fit(){const e=this.options;e.display&&e.pointLabels.display?gz(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,s,i){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((s-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,s,i))}getIndexAngle(e){const t=Rt/(this._pointLabels.length||1),s=this.options.startAngle||0;return Vn(e*t+Ks(s))}getDistanceFromCenterForValue(e){if(Qe(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(Qe(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const s=t[e];return Az(this.getContext(),e,s)}}getPointPosition(e,t,s=0){const i=this.getIndexAngle(e)-Qt+s;return{x:Math.cos(i)*t+this.xCenter,y:Math.sin(i)*t+this.yCenter,angle:i}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:s,right:i,bottom:r}=this._pointLabelItems[e];return{left:t,top:s,right:i,bottom:r}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const s=this.ctx;s.save(),s.beginPath(),mk(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),s.closePath(),s.fillStyle=e,s.fill(),s.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:s,grid:i,border:r}=t,l=this._pointLabels.length;let c,h,d;if(t.pointLabels.display&&wz(this,l),i.display&&this.ticks.forEach((m,_)=>{if(_!==0||_===0&&this.min<0){h=this.getDistanceFromCenterForValue(m.value);const v=this.getContext(_),T=i.setContext(v),S=r.setContext(v);Sz(this,T,h,l,S)}}),s.display){for(e.save(),c=l-1;c>=0;c--){const m=s.setContext(this.getPointLabelContext(c)),{color:_,lineWidth:v}=m;!v||!_||(e.lineWidth=v,e.strokeStyle=_,e.setLineDash(m.borderDash),e.lineDashOffset=m.borderDashOffset,h=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),d=this.getPointPosition(c,h),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(d.x,d.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,s=t.ticks;if(!s.display)return;const i=this.getIndexAngle(0);let r,l;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(i),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((c,h)=>{if(h===0&&this.min>=0&&!t.reverse)return;const d=s.setContext(this.getContext(h)),m=un(d.font);if(r=this.getDistanceFromCenterForValue(this.ticks[h].value),d.showLabelBackdrop){e.font=m.string,l=e.measureText(c.label).width,e.fillStyle=d.backdropColor;const _=Bn(d.backdropPadding);e.fillRect(-l/2-_.left,-r-m.size/2-_.top,l+_.width,m.size+_.height)}yl(e,c.label,0,-r,m,{color:d.color,strokeColor:d.textStrokeColor,strokeWidth:d.textStrokeWidth})}),e.restore()}drawTitle(){}}_e(Wh,"id","radialLinear"),_e(Wh,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Hp.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),_e(Wh,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),_e(Wh,"descriptors",{angleLines:{_fallback:"grid"}});const Kp={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},ns=Object.keys(Kp);function pI(n,e){return n-e}function _I(n,e){if(Qe(e))return null;const t=n._adapter,{parser:s,round:i,isoWeekday:r}=n._parseOpts;let l=e;return typeof s=="function"&&(l=s(l)),Bt(l)||(l=typeof s=="string"?t.parse(l,s):t.parse(l)),l===null?null:(i&&(l=i==="week"&&(tu(r)||r===!0)?t.startOf(l,"isoWeek",r):t.startOf(l,i)),+l)}function yI(n,e,t,s){const i=ns.length;for(let r=ns.indexOf(n);r<i-1;++r){const l=Kp[ns[r]],c=l.steps?l.steps:Number.MAX_SAFE_INTEGER;if(l.common&&Math.ceil((t-e)/(c*l.size))<=s)return ns[r]}return ns[i-1]}function Iz(n,e,t,s,i){for(let r=ns.length-1;r>=ns.indexOf(t);r--){const l=ns[r];if(Kp[l].common&&n._adapter.diff(i,s,l)>=e-1)return l}return ns[t?ns.indexOf(t):0]}function Rz(n){for(let e=ns.indexOf(n)+1,t=ns.length;e<t;++e)if(Kp[ns[e]].common)return ns[e]}function bI(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:s,hi:i}=px(t,e),r=t[s]>=e?t[s]:t[i];n[r]=!0}}function Cz(n,e,t,s){const i=n._adapter,r=+i.startOf(e[0].value,s),l=e[e.length-1].value;let c,h;for(c=r;c<=l;c=+i.add(c,1,s))h=t[c],h>=0&&(e[h].major=!0);return e}function vI(n,e,t){const s=[],i={},r=e.length;let l,c;for(l=0;l<r;++l)c=e[l],i[c]=l,s.push({value:c,major:!1});return r===0||!t?s:Cz(n,s,i,t)}class Pd extends uf{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const s=e.time||(e.time={}),i=this._adapter=new LB._date(e.adapters.date);i.init(t),ad(s.displayFormats,i.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:_I(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,s=e.time.unit||"day";let{min:i,max:r,minDefined:l,maxDefined:c}=this.getUserBounds();function h(d){!l&&!isNaN(d.min)&&(i=Math.min(i,d.min)),!c&&!isNaN(d.max)&&(r=Math.max(r,d.max))}(!l||!c)&&(h(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&h(this.getMinMax(!1))),i=Bt(i)&&!isNaN(i)?i:+t.startOf(Date.now(),s),r=Bt(r)&&!isNaN(r)?r:+t.endOf(Date.now(),s)+1,this.min=Math.min(i,r-1),this.max=Math.max(i+1,r)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],s=e[e.length-1]),{min:t,max:s}}buildTicks(){const e=this.options,t=e.time,s=e.ticks,i=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const r=this.min,l=this.max,c=oU(i,r,l);return this._unit=t.unit||(s.autoSkip?yI(t.minUnit,this.min,this.max,this._getLabelCapacity(r)):Iz(this,c.length,t.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:Rz(this._unit),this.initOffsets(i),e.reverse&&c.reverse(),vI(this,c,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,s=0,i,r;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?t=1-i:t=(this.getDecimalForValue(e[1])-i)/2,r=this.getDecimalForValue(e[e.length-1]),e.length===1?s=r:s=(r-this.getDecimalForValue(e[e.length-2]))/2);const l=e.length<3?.5:.25;t=vn(t,0,l),s=vn(s,0,l),this._offsets={start:t,end:s,factor:1/(t+1+s)}}_generate(){const e=this._adapter,t=this.min,s=this.max,i=this.options,r=i.time,l=r.unit||yI(r.minUnit,t,s,this._getLabelCapacity(t)),c=Ue(i.ticks.stepSize,1),h=l==="week"?r.isoWeekday:!1,d=tu(h)||h===!0,m={};let _=t,v,T;if(d&&(_=+e.startOf(_,"isoWeek",h)),_=+e.startOf(_,d?"day":l),e.diff(s,t,l)>1e5*c)throw new Error(t+" and "+s+" are too far apart with stepSize of "+c+" "+l);const S=i.ticks.source==="data"&&this.getDataTimestamps();for(v=_,T=0;v<s;v=+e.add(v,c,l),T++)bI(m,v,S);return(v===s||i.bounds==="ticks"||T===1)&&bI(m,v,S),Object.keys(m).sort(pI).map(E=>+E)}getLabelForValue(e){const t=this._adapter,s=this.options.time;return s.tooltipFormat?t.format(e,s.tooltipFormat):t.format(e,s.displayFormats.datetime)}format(e,t){const i=this.options.time.displayFormats,r=this._unit,l=t||i[r];return this._adapter.format(e,l)}_tickFormatFunction(e,t,s,i){const r=this.options,l=r.ticks.callback;if(l)return Tt(l,[e,t,s],this);const c=r.time.displayFormats,h=this._unit,d=this._majorUnit,m=h&&c[h],_=d&&c[d],v=s[t],T=d&&_&&v&&v.major;return this._adapter.format(e,i||(T?_:m))}generateTickLabels(e){let t,s,i;for(t=0,s=e.length;t<s;++t)i=e[t],i.label=this._tickFormatFunction(i.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+s)*t.factor)}getValueForPixel(e){const t=this._offsets,s=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,s=this.ctx.measureText(e).width,i=Ks(this.isHorizontal()?t.maxRotation:t.minRotation),r=Math.cos(i),l=Math.sin(i),c=this._resolveTickFontOptions(0).size;return{w:s*r+c*l,h:s*l+c*r}}_getLabelCapacity(e){const t=this.options.time,s=t.displayFormats,i=s[t.unit]||s.millisecond,r=this._tickFormatFunction(e,0,vI(this,[e],this._majorUnit),i),l=this._getLabelSize(r),c=Math.floor(this.isHorizontal()?this.width/l.w:this.height/l.h)-1;return c>0?c:1}getDataTimestamps(){let e=this._cache.data||[],t,s;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,s=i.length;t<s;++t)e=e.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,s;if(e.length)return e;const i=this.getLabels();for(t=0,s=i.length;t<s;++t)e.push(_I(this,i[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return SN(e.sort(pI))}}_e(Pd,"id","time"),_e(Pd,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Zm(n,e,t){let s=0,i=n.length-1,r,l,c,h;t?(e>=n[s].pos&&e<=n[i].pos&&({lo:s,hi:i}=ur(n,"pos",e)),{pos:r,time:c}=n[s],{pos:l,time:h}=n[i]):(e>=n[s].time&&e<=n[i].time&&({lo:s,hi:i}=ur(n,"time",e)),{time:r,pos:c}=n[s],{time:l,pos:h}=n[i]);const d=l-r;return d?c+(h-c)*(e-r)/d:c}class Db extends Pd{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=Zm(t,this.min),this._tableRange=Zm(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:s}=this,i=[],r=[];let l,c,h,d,m;for(l=0,c=e.length;l<c;++l)d=e[l],d>=t&&d<=s&&i.push(d);if(i.length<2)return[{time:t,pos:0},{time:s,pos:1}];for(l=0,c=i.length;l<c;++l)m=i[l+1],h=i[l-1],d=i[l],Math.round((m+h)/2)!==d&&r.push({time:d,pos:l/(c-1)});return r}_generate(){const e=this.min,t=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(t)||s.length===1)&&s.push(t),s.sort((i,r)=>i-r)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),s=this.getLabelTimestamps();return t.length&&s.length?e=this.normalize(t.concat(s)):e=t.length?t:s,e=this._cache.all=e,e}getDecimalForValue(e){return(Zm(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,s=this.getDecimalForPixel(e)/t.factor-t.end;return Zm(this._table,s*this._tableRange+this._minPos,!0)}}_e(Db,"id","timeseries"),_e(Db,"defaults",Pd.defaults);var Dz=Object.freeze({__proto__:null,CategoryScale:Ab,LinearScale:Ib,LogarithmicScale:Rb,RadialLinearScale:Wh,TimeScale:Pd,TimeSeriesScale:Db});const Nz=[VB,dF,oz,Dz];An.register(...Nz);const ap={income:["薪水","獎金","投資收益","副業收入","其他收入"],expense:["餐飲","交通","居住","娛樂","教育","醫療","購物","通訊","保險","其他支出"]},Vh={現金:"#4CAF50",ETF:"#2196F3",股票:"#FFC107",不動產:"#9C27B0",美元資產:"#FF5722"},kz=(n,e)=>n.map(t=>({...t,assets:(t.assets||[]).map(s=>{const i=parseFloat(String(s.currentValue))||0,r=parseFloat(String(s.cost))||0,l=parseFloat(String(s.units))||0,c=s.currency==="USD"?e:1,h=i*l*c,d=r*l*c,m=h-d;return{...s,currentValueTWD:h,costTWD:d,profitLossTWD:m}})})),Ix=n=>{let e=0,t=0;const s={現金:{value:0,color:Vh.現金},ETF:{value:0,color:Vh.ETF},股票:{value:0,color:Vh.股票},不動產:{value:0,color:Vh.不動產},美元資產:{value:0,color:Vh.美元資產}};n.forEach(r=>{(r.assets||[]).forEach(l=>{const c=l.currentValueTWD||0;e+=c,s[l.accountType]&&(s[l.accountType].value+=c),l.currency==="USD"&&(t+=c)})});const i=Object.keys(s).filter(r=>s[r].value>0).map(r=>({type:r,value:s[r].value,color:s[r].color}));return{total:e,breakdown:i,totalUsdAssetsInTwd:t}},Mz=(n,e)=>{var H,F;const{total:t,breakdown:s}=Ix(n);if(t===0)return{score:0,feedback:["請先新增您的資產以進行評分。"],level:"待加強",levelColor:"text-red-500"};let i=0;const r=[],l=e.filter(U=>U.type==="expense"),c=new Map;l.forEach(U=>{const C=U.date.slice(0,7);c.set(C,(c.get(C)||0)+U.amount)});const h=Array.from(c.values()).reduce((U,C)=>U+C,0),d=c.size>0?h/c.size:0,m=((H=s.find(U=>U.type==="現金"))==null?void 0:H.value)||0,_=d>0?m/d:0;d===0?(i+=10,r.push("尚無支出數據，無法評估緊急備用金。")):_>=3&&_<=6?(i+=40,r.push(`緊急備用金充足 (${_.toFixed(1)}個月)，財務基礎穩固。`)):_>6?(i+=25,r.push(`現金持有稍多 (${_.toFixed(1)}個月)，可考慮將部分資金用於投資。`)):_>=1?(i+=15,r.push(`緊急備用金 (${_.toFixed(1)}個月) 略顯不足，建議提升至3-6個月。`)):(i+=5,r.push(`緊急備用金嚴重不足 (${_.toFixed(1)}個月)，請優先儲蓄！`));const v=n.flatMap(U=>U.assets||[]).filter(U=>["股票","ETF"].includes(U.accountType)),T=v.reduce((U,C)=>U+(C.currentValueTWD||0),0),S=T>0?[...v].sort((U,C)=>(C.currentValueTWD??0)-(U.currentValueTWD??0))[0]:null,E=T>0&&S?(S.currentValueTWD??0)/T*100:0;E>50?(i+=5,r.push(`投資過度集中於「${S==null?void 0:S.code}」(${E.toFixed(1)}%)，風險極高。`)):E>30?(i+=15,r.push(`單一資產佔比較高 (${E.toFixed(1)}%)，建議分散投資。`)):(i+=30,r.push(`投資組合分散良好，最大持股佔比為 ${E.toFixed(1)}%。`));const R=((F=s.find(U=>U.type==="股票"))==null?void 0:F.value)||0,k=t>0?R/t*100:0;k>60?(i+=5,r.push(`個股佔總資產 ${k.toFixed(1)}%，風險配置過於激進。`)):k>35?(i+=15,r.push(`個股佔比 ${k.toFixed(1)}% 偏高，請留意風險。`)):(i+=30,r.push(`個股風險控制良好，佔總資產 ${k.toFixed(1)}%。`)),i=Math.round(i);let L,O;return i>=80?(L="優良",O="text-green-500"):i>=50?(L="中等",O="text-yellow-500"):(L="待加強",O="text-red-500"),{score:i,feedback:r,level:L,levelColor:O}},cn=({children:n,className:e=""})=>y.jsx("div",{className:`bg-white rounded-xl shadow-lg border border-gray-200/75 p-6 sm:p-8 ${e}`,children:n}),Er=({title:n,subtitle:e})=>y.jsxs("div",{className:"mb-8 border-b border-gray-200 pb-5",children:[y.jsx("h2",{className:"text-3xl font-semibold tracking-tight text-gray-900",children:n}),e&&y.jsx("p",{className:"mt-2 text-base text-gray-600",children:e})]}),hf=({Icon:n,title:e,message:t,children:s})=>y.jsxs("div",{className:"text-center flex flex-col items-center justify-center h-full text-gray-500 bg-gray-50 rounded-lg p-8 border-2 border-dashed",children:[y.jsx(n,{className:"h-16 w-16 text-gray-400 mb-4",strokeWidth:1}),y.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:e}),y.jsx("p",{className:"text-sm mt-1 max-w-sm mx-auto",children:t}),s&&y.jsx("div",{className:"mt-6",children:s})]}),Oz=n=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24",stroke:"currentColor",...n,children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]}),Pz=({score:n,level:e,color:t,feedback:s})=>{const i=2*Math.PI*52,r=i-n/100*i;return y.jsxs(cn,{className:"flex flex-col items-center justify-center",children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"財務健康分數"}),y.jsxs("div",{className:"relative w-40 h-40",children:[y.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 120 120",children:[y.jsx("circle",{cx:"60",cy:"60",r:"52",fill:"none",stroke:"#e6e6e6",strokeWidth:"8"}),y.jsx("circle",{cx:"60",cy:"60",r:"52",fill:"none",className:`stroke-current ${t.replace("text-","stroke-")}`,strokeWidth:"8",strokeDasharray:i,strokeDashoffset:r,strokeLinecap:"round",transform:"rotate(-90 60 60)",style:{transition:"stroke-dashoffset 0.8s ease-out"}})]}),y.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[y.jsx("span",{className:`text-4xl font-bold ${t}`,children:n}),y.jsx("span",{className:`text-sm font-semibold ${t}`,children:e})]})]}),y.jsx("div",{className:"text-center mt-3 text-xs text-gray-500 w-full",children:s.slice(0,1).map((l,c)=>y.jsx("p",{children:l},c))})]})},Vz=({assetAccounts:n})=>{const{total:e,breakdown:t}=Ix(n),i=(()=>{var v,T,S;if(e===0)return{title:"開始您的理財之旅",message:"您的資產組合目前是空的。請前往「資料管理」新增您的第一筆資產，開始追踪您的財務狀況！",icon:"🚀"};const r=(((v=t.find(E=>E.type==="現金"))==null?void 0:v.value)||0)/e,l=(((T=t.find(E=>E.type==="ETF"))==null?void 0:T.value)||0)/e,c=(((S=t.find(E=>E.type==="股票"))==null?void 0:S.value)||0)/e,h=n.flatMap(E=>E.assets||[]).filter(E=>["股票","ETF"].includes(E.accountType)),d=h.reduce((E,R)=>E+(R.currentValueTWD||0),0),m=d>0?[...h].sort((E,R)=>(R.currentValueTWD??0)-(E.currentValueTWD??0))[0]:null,_=d>0&&m?(m.currentValueTWD??0)/d*100:0;return r>.4?{title:"現金比例偏高",message:`您有超過 ${(r*100).toFixed(0)}% 的資產是現金。雖然保有流動性是好事，但考慮將部分閒置資金投入 ETF 或其他投資，可能會有更好的長期回報。`,icon:"💰"}:_>40?{title:"注意投資集中風險",message:`您在「${m==null?void 0:m.code}」上的投資佔了投資組合的 ${_.toFixed(1)}%。這可能會帶來較高的風險。建議您考慮增加其他標的，以達到更好的分散效果。`,icon:"⚠️"}:l<.3&&(c>0||r>.1)?{title:"建立穩健的投資核心",message:"您的 ETF 佔比目前較低。考慮增加指數型 ETF 的配置，這有助於建立一個分散風險、穩健增長的投資組合核心。",icon:"📈"}:{title:"資產配置均衡",message:"您的資產配置看起來相當均衡。請繼續保持定期檢視，並根據您的財務目標進行調整。做得很好！",icon:"👍"}})();return y.jsxs(cn,{children:[y.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center",children:[y.jsx("span",{className:"text-2xl mr-2",children:i.icon}),"投資組合洞察"]}),y.jsxs("div",{className:"text-gray-600 text-base leading-relaxed h-full flex flex-col justify-center",children:[y.jsx("p",{className:"font-semibold text-gray-700 mb-1",children:i.title}),y.jsx("p",{className:"text-sm",children:i.message})]})]})},xI=({userId:n,assetAccounts:e,cashflowRecords:t})=>{const s=ue.useRef(null),i=ue.useRef(null),r=ue.useMemo(()=>Ix(e),[e]),l=ue.useMemo(()=>Mz(e,t),[e,t]),{total:c,breakdown:h,totalUsdAssetsInTwd:d}=r,m=ue.useMemo(()=>{const _=new Date,v=new Date(_.getFullYear(),_.getMonth(),15),T=new Date(v);T.setMonth(T.getMonth()-1);const S=T.getFullYear(),E=T.getMonth(),R=`${S}-${String(E+1).padStart(2,"0")}`,k=t.filter(U=>U.date.startsWith(R)),L=k.filter(U=>U.type==="income").reduce((U,C)=>U+C.amount,0),O=k.filter(U=>U.type==="expense").reduce((U,C)=>U+C.amount,0),H=L-O,F=L>0?H/L*100:0;return{totalIncome:L,totalExpense:O,netSavings:H,savingsRate:F,monthLabel:`${S}年${E+1}月`}},[t]);return ue.useEffect(()=>{if(s.current&&c>0){i.current&&i.current.destroy();const _=s.current.getContext("2d");_&&(i.current=new An(_,{type:"pie",data:{labels:h.map(v=>v.type),datasets:[{data:h.map(v=>v.value),backgroundColor:h.map(v=>v.color),borderColor:"#fff",borderWidth:2,hoverOffset:8}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{font:{size:14,family:"Inter, sans-serif"},color:"#333",boxWidth:20}},title:{display:!0,text:"資產配置圓餅圖",font:{size:18,family:"Inter, sans-serif"},color:"#333"}}}}))}else i.current&&(i.current.destroy(),i.current=null);return()=>{i.current&&i.current.destroy()}},[c,h]),y.jsxs("div",{children:[y.jsx(Er,{title:"您的個人財務導航中心"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[y.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-indigo-600 p-6 rounded-xl shadow-lg text-white transform hover:scale-105 transition-transform duration-300 relative overflow-hidden",children:[y.jsx("div",{className:"absolute -top-4 -left-4 w-24 h-24 bg-white/10 rounded-full"}),y.jsxs("div",{className:"relative z-10",children:[y.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center",children:[y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-7 h-7 mr-2 opacity-75",children:[y.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"}),y.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),"總資產顯示"]}),y.jsxs("p",{className:"text-4xl font-bold mt-4",children:["$",c.toLocaleString(void 0,{maximumFractionDigits:0})]}),y.jsx("p",{className:"text-blue-200 text-sm mt-2",children:"包含所有帳戶資產"})]})]}),y.jsxs("div",{className:"bg-gradient-to-br from-emerald-500 to-teal-600 p-6 rounded-xl shadow-lg text-white transform hover:scale-105 transition-transform duration-300 relative overflow-hidden",children:[y.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-white/10 rounded-full"}),y.jsxs("div",{className:"relative z-10",children:[y.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center",children:[y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-7 h-7 mr-2 opacity-75",children:[y.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),y.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]}),"美元計價資產總值 (TWD)"]}),y.jsxs("p",{className:"text-4xl font-bold mt-4",children:["$",d.toLocaleString(void 0,{maximumFractionDigits:0})]}),y.jsx("p",{className:"text-emerald-100 text-sm mt-2",children:"已轉換為新台幣"})]})]}),y.jsx(Pz,{score:l.score,level:l.level,color:l.levelColor,feedback:l.feedback}),y.jsx(Vz,{assetAccounts:e})]}),y.jsxs("div",{className:"mb-8",children:[y.jsxs("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:[m.monthLabel," 財務摘要"]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[y.jsxs(cn,{className:"bg-green-50 border-green-200",children:[y.jsxs("h4",{className:"text-md font-semibold text-green-800 mb-2 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),"總收入"]}),y.jsxs("p",{className:"text-3xl font-bold text-green-900",children:["$",m.totalIncome.toLocaleString()]})]}),y.jsxs(cn,{className:"bg-red-50 border-red-200",children:[y.jsxs("h4",{className:"text-md font-semibold text-red-800 mb-2 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),"總支出"]}),y.jsxs("p",{className:"text-3xl font-bold text-red-900",children:["$",m.totalExpense.toLocaleString()]})]}),y.jsxs(cn,{className:"bg-blue-50 border-blue-200",children:[y.jsxs("h4",{className:"text-md font-semibold text-blue-800 mb-2 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})}),"淨儲蓄"]}),y.jsxs("p",{className:`text-3xl font-bold ${m.netSavings>=0?"text-blue-900":"text-red-900"}`,children:["$",m.netSavings.toLocaleString()]})]}),y.jsxs(cn,{className:"bg-purple-50 border-purple-200",children:[y.jsxs("h4",{className:"text-md font-semibold text-purple-800 mb-2 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),"儲蓄率"]}),y.jsxs("p",{className:"text-3xl font-bold text-purple-900",children:[m.savingsRate.toFixed(1),"%"]})]})]})]}),y.jsx(cn,{className:"h-[450px]",children:c>0?y.jsx("canvas",{ref:s}):y.jsx(hf,{Icon:Oz,title:"尚無資產數據",message:"新增您的第一個資產，開始視覺化您的財務狀況。"})})]})};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lz{constructor(e,t){this._delegate=e,this.firebase=t,hd(e,new fr("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Wb(this._delegate)))}_getService(e,t=ka){var i;this._delegate.checkDestroyed();const s=this._delegate.container.getProvider(e);return!s.isInitialized()&&((i=s.getComponent())==null?void 0:i.instantiationMode)==="EXPLICIT"&&s.initialize(),s.getImmediate({identifier:t})}_removeServiceInstance(e,t=ka){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){hd(this._delegate,e)}_addOrOverwriteComponent(e){W2(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jz={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},TI=new xl("app-compat","Firebase",jz);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uz(n){const e={},t={__esModule:!0,initializeApp:r,app:i,registerVersion:Os,setLogLevel:X2,onLog:Q2,apps:null,SDK_VERSION:Wa,INTERNAL:{registerComponent:c,removeApp:s,useAsService:h,modularAPIs:QP}};t.default=t,Object.defineProperty(t,"apps",{get:l});function s(d){delete e[d]}function i(d){if(d=d||ka,!tS(e,d))throw TI.create("no-app",{appName:d});return e[d]}i.App=n;function r(d,m={}){const _=mp(d,m);if(tS(e,_.name))return e[_.name];const v=new n(_,t);return e[_.name]=v,v}function l(){return Object.keys(e).map(d=>e[d])}function c(d){const m=d.name,_=m.replace("-compat","");if(Oa(d)&&d.type==="PUBLIC"){const v=(T=i())=>{if(typeof T[_]!="function")throw TI.create("invalid-app-argument",{appName:m});return T[_]()};d.serviceProps!==void 0&&Sg(v,d.serviceProps),t[_]=v,n.prototype[_]=function(...T){return this._getService.bind(this,m).apply(this,d.multipleInstances?T:[])}}return d.type==="PUBLIC"?t[_]:null}function h(d,m){return m==="serverAuth"?null:m}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gk(){const n=Uz(Lz);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:gk,extendNamespace:e,createSubscribe:z2,ErrorFactory:xl,deepExtend:Sg};function e(t){Sg(n,t)}return n}const Bz=gk();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EI=new fp("@firebase/app-compat"),Fz="@firebase/app-compat",zz="0.5.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hz(n){Os(Fz,zz,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=Fb();if(n.firebase!==void 0){EI.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&EI.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const qz=Bz;Hz();const Gz="@firebase/firestore-compat",$z="0.4.2";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rx(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new le("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wI(){if(typeof Uint8Array>"u")throw new le("unimplemented","Uint8Arrays are not available in this environment.")}function SI(){if(!B4())throw new le("unimplemented","Blobs are unavailable in Firestore in this environment.")}let pk=class Nb{constructor(e){this._delegate=e}static fromBase64String(e){return SI(),new Nb(Ln.fromBase64String(e))}static fromUint8Array(e){return wI(),new Nb(Ln.fromUint8Array(e))}toBase64(){return SI(),this._delegate.toBase64()}toUint8Array(){return wI(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kb(n){return Wz(n,["next","error","complete"])}function Wz(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const s of e)if(s in t&&typeof t[s]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yz{enableIndexedDbPersistence(e,t){return T3(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return E3(e._delegate)}clearIndexedDbPersistence(e){return w3(e._delegate)}}class _k{constructor(e,t,s){this._delegate=t,this._persistenceProvider=s,this.INTERNAL={delete:()=>this.terminate()},e instanceof Va||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Ci("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,s={}){WD(this._delegate,e,t,s)}enableNetwork(){return A3(this._delegate)}disableNetwork(){return I3(this._delegate)}enablePersistence(e){let t=!1,s=!1;return e&&(t=!!e.synchronizeTabs,s=!!e.experimentalForceOwningTab,UR("synchronizeTabs",t,"experimentalForceOwningTab",s)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,s)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return S3(this._delegate)}onSnapshotsInSync(e){return X3(this._delegate,e)}get app(){if(!this._appCompat)throw new le("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new iu(this,Kg(this._delegate,e))}catch(t){throw Yn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Ms(this,Qg(this._delegate,e))}catch(t){throw Yn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Wn(this,y3(this._delegate,e))}catch(t){throw Yn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return n5(this._delegate,t=>e(new yk(this,t)))}batch(){return Fn(this._delegate),new bk(new J3(this._delegate,e=>of(this._delegate,e)))}loadBundle(e){return R3(this._delegate,e)}namedQuery(e){return C3(this._delegate,e).then(t=>t?new Wn(this,t):null)}}class Qp extends cx{constructor(e){super(),this.firestore=e}convertBytes(e){return new pk(new Ln(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Ms.forKey(t,this.firestore,null)}}function Kz(n){ZL(n)}class yk{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Qp(e)}get(e){const t=nl(e);return this._delegate.get(t).then(s=>new Vd(this._firestore,new Ps(this._firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,t.converter)))}set(e,t,s){const i=nl(e);return s?(Rx("Transaction.set",s),this._delegate.set(i,t,s)):this._delegate.set(i,t),this}update(e,t,s,...i){const r=nl(e);return arguments.length===2?this._delegate.update(r,t):this._delegate.update(r,t,s,...i),this}delete(e){const t=nl(e);return this._delegate.delete(t),this}}class bk{constructor(e){this._delegate=e}set(e,t,s){const i=nl(e);return s?(Rx("WriteBatch.set",s),this._delegate.set(i,t,s)):this._delegate.set(i,t),this}update(e,t,s,...i){const r=nl(e);return arguments.length===2?this._delegate.update(r,t):this._delegate.update(r,t,s,...i),this}delete(e){const t=nl(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class bl{constructor(e,t,s){this._firestore=e,this._userDataWriter=t,this._delegate=s}fromFirestore(e,t){const s=new rd(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Ld(this._firestore,s),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const s=bl.INSTANCES;let i=s.get(e);i||(i=new WeakMap,s.set(e,i));let r=i.get(t);return r||(r=new bl(e,new Qp(e),t),i.set(t,r)),r}}bl.INSTANCES=new WeakMap;class Ms{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Qp(e)}static forPath(e,t,s){if(e.length%2!==0)throw new le("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Ms(t,new Et(t._delegate,s,new pe(e)))}static forKey(e,t,s){return new Ms(t,new Et(t._delegate,s,e))}get id(){return this._delegate.id}get parent(){return new iu(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new iu(this.firestore,Kg(this._delegate,e))}catch(t){throw Yn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=wt(e),e instanceof Et?QD(this._delegate,e):!1}set(e,t){t=Rx("DocumentReference.set",t);try{return t?XA(this._delegate,e,t):XA(this._delegate,e)}catch(s){throw Yn(s,"setDoc()","DocumentReference.set()")}}update(e,t,...s){try{return arguments.length===1?ZA(this._delegate,e):ZA(this._delegate,e,t,...s)}catch(i){throw Yn(i,"updateDoc()","DocumentReference.update()")}}delete(){return Q3(this._delegate)}onSnapshot(...e){const t=vk(e),s=xk(e,i=>new Vd(this.firestore,new Ps(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return gN(this._delegate,t,s)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=$3(this._delegate):(e==null?void 0:e.source)==="server"?t=W3(this._delegate):t=G3(this._delegate),t.then(s=>new Vd(this.firestore,new Ps(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)))}withConverter(e){return new Ms(this.firestore,e?this._delegate.withConverter(bl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Yn(n,e,t){return n.message=n.message.replace(e,t),n}function vk(n){for(const e of n)if(typeof e=="object"&&!kb(e))return e;return{}}function xk(n,e){var s,i;let t;return kb(n[0])?t=n[0]:kb(n[1])?t=n[1]:typeof n[0]=="function"?t={next:n[0],error:n[1],complete:n[2]}:t={next:n[1],error:n[2],complete:n[3]},{next:r=>{t.next&&t.next(e(r))},error:(s=t.error)==null?void 0:s.bind(t),complete:(i=t.complete)==null?void 0:i.bind(t)}}class Vd{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Ms(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return dN(this._delegate,e._delegate)}}class Ld extends Vd{data(e){const t=this._delegate.data(e);return this._delegate._converter||JL(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class Wn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Qp(e)}where(e,t,s){try{return new Wn(this.firestore,fa(this._delegate,P3(e,t,s)))}catch(i){throw Yn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Wn(this.firestore,fa(this._delegate,V3(e,t)))}catch(s){throw Yn(s,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Wn(this.firestore,fa(this._delegate,L3(e)))}catch(t){throw Yn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Wn(this.firestore,fa(this._delegate,j3(e)))}catch(t){throw Yn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Wn(this.firestore,fa(this._delegate,U3(...e)))}catch(t){throw Yn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Wn(this.firestore,fa(this._delegate,B3(...e)))}catch(t){throw Yn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Wn(this.firestore,fa(this._delegate,F3(...e)))}catch(t){throw Yn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Wn(this.firestore,fa(this._delegate,z3(...e)))}catch(t){throw Yn(t,"endAt()","Query.endAt()")}}isEqual(e){return XD(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=Y3(this._delegate):(e==null?void 0:e.source)==="server"?t=K3(this._delegate):t=fN(this._delegate),t.then(s=>new Mb(this.firestore,new Zs(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)))}onSnapshot(...e){const t=vk(e),s=xk(e,i=>new Mb(this.firestore,new Zs(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return gN(this._delegate,t,s)}withConverter(e){return new Wn(this.firestore,e?this._delegate.withConverter(bl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class Qz{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Ld(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Mb{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Wn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Ld(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Qz(this._firestore,t))}forEach(e,t){this._delegate.forEach(s=>{e.call(t,new Ld(this._firestore,s))})}isEqual(e){return dN(this._delegate,e._delegate)}}class iu extends Wn{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Ms(this.firestore,e):null}doc(e){try{return e===void 0?new Ms(this.firestore,Qg(this._delegate)):new Ms(this.firestore,Qg(this._delegate,e))}catch(t){throw Yn(t,"doc()","CollectionReference.doc()")}}add(e){return mN(this._delegate,e).then(t=>new Ms(this.firestore,t))}isEqual(e){return QD(this._delegate,e._delegate)}withConverter(e){return new iu(this.firestore,e?this._delegate.withConverter(bl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function nl(n){return at(n,Et)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(...e){this._delegate=new za(...e)}static documentId(){return new Cx(kt.keyField().canonicalString())}isEqual(e){return e=wt(e),e instanceof za?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{static serverTimestamp(){const e=i5();return e._methodName="FieldValue.serverTimestamp",new Xo(e)}static delete(){const e=s5();return e._methodName="FieldValue.delete",new Xo(e)}static arrayUnion(...e){const t=r5(...e);return t._methodName="FieldValue.arrayUnion",new Xo(t)}static arrayRemove(...e){const t=a5(...e);return t._methodName="FieldValue.arrayRemove",new Xo(t)}static increment(e){const t=o5(e);return t._methodName="FieldValue.increment",new Xo(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xz={Firestore:_k,GeoPoint:Xs,Timestamp:lt,Blob:pk,Transaction:yk,WriteBatch:bk,DocumentReference:Ms,DocumentSnapshot:Vd,Query:Wn,QueryDocumentSnapshot:Ld,QuerySnapshot:Mb,CollectionReference:iu,FieldPath:Cx,FieldValue:Xo,setLogLevel:Kz,CACHE_SIZE_UNLIMITED:v3};function Zz(n,e){n.INTERNAL.registerComponent(new fr("firestore-compat",t=>{const s=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(s,i)},"PUBLIC").setServiceProps({...Xz}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jz(n){Zz(n,(e,t)=>new _k(e,t,new Yz)),n.registerVersion(Gz,$z)}Jz(qz);const k0=25,e8=({userId:n,db:e,cashflowRecords:t,assetAccounts:s,settings:i,setNotification:r,appId:l,effectiveUsdToTwdRate:c})=>{const h={id:"",date:new Date().toISOString().split("T")[0],type:"expense",category:"",amount:"",currency:"TWD",description:"",isRecurring:!1,accountId:"",recurrenceDay:""},[d,m]=ue.useState(h),[_,v]=ue.useState(null),[T,S]=ue.useState(String(c)),[E,R]=ue.useState(""),[k,L]=ue.useState(""),[O,H]=ue.useState(1);ue.useEffect(()=>{S(String(c))},[c]),ue.useEffect(()=>{const ne=setTimeout(()=>{L(E),H(1)},300);return()=>{clearTimeout(ne)}},[E]);const F=ue.useMemo(()=>k?t.filter(ne=>{var be;return ne.category.toLowerCase().includes(k.toLowerCase())||ne.description.toLowerCase().includes(k.toLowerCase())||((be=ne.accountName)==null?void 0:be.toLowerCase().includes(k.toLowerCase()))||ne.amount.toString().includes(k)}):t,[t,k]),U=ue.useMemo(()=>{const ne=(O-1)*k0;return F.slice(ne,ne+k0)},[F,O]),C=Math.ceil(F.length/k0),I=ne=>{const{name:be,value:Y}=ne.target,ae=ne.target.checked;m(me=>({...me,[be]:ne.target.type==="checkbox"?ae:Y}))},N=async()=>{const ne=parseFloat(T);!isNaN(ne)&&ne>0?ne!==i.manualRate&&(await e.doc(`artifacts/${l}/users/${n}/settings/userSettings`).set({manualRate:ne},{merge:!0}),r({message:`匯率已更新為 ${ne}`,type:"info",show:!0})):T===""&&i.manualRate!==null&&(await e.doc(`artifacts/${l}/users/${n}/settings/userSettings`).set({manualRate:null},{merge:!0}),r({message:"手動匯率已清除，將使用系統預設值。",type:"info",show:!0}))},V=async ne=>{var me;if(ne.preventDefault(),!d.category||!d.amount||!d.accountId){r({message:"類別、金額和帳戶為必填項。",type:"error",show:!0});return}if(d.isRecurring&&(!d.recurrenceDay||Number(d.recurrenceDay)<1||Number(d.recurrenceDay)>31)){r({message:"請為定額項目設定有效的每月執行日期 (1-31)。",type:"error",show:!0});return}const be=`artifacts/${l}/users/${n}/cashflowRecords`,Y=((me=s.find(Ce=>Ce.id===d.accountId))==null?void 0:me.name)||"",ae={date:d.date,type:d.type,category:d.category,amount:parseFloat(d.amount)||0,currency:d.currency,description:d.description,isRecurring:d.isRecurring,accountId:d.accountId,accountName:Y};d.isRecurring&&(ae.recurrenceDay=Number(d.recurrenceDay));try{_?(await e.doc(`${be}/${_}`).set(ae),r({message:"收支紀錄更新成功！",type:"success",show:!0})):(await e.collection(be).add(ae),r({message:"收支紀錄新增成功！",type:"success",show:!0})),m(h),v(null)}catch(Ce){console.error("Error saving cashflow record:",Ce);const z=Ce instanceof Error?Ce.message:"An unknown error occurred.";r({message:`儲存失敗: ${z}`,type:"error",show:!0})}},j=ne=>{m({...h,...ne,amount:ne.amount.toString(),recurrenceDay:String(ne.recurrenceDay||"")}),v(ne.id),window.scrollTo({top:0,behavior:"smooth"})},B=async ne=>{window.confirm("您確定要刪除這筆紀錄嗎？")&&(await e.doc(`artifacts/${l}/users/${n}/cashflowRecords/${ne}`).delete(),r({message:"紀錄已刪除。",type:"success",show:!0}))},M=d.type==="income"?[...ap.income,...i.customIncome||[]]:[...ap.expense,...i.customExpense||[]];return y.jsxs("div",{children:[y.jsxs("form",{onSubmit:V,className:"mb-8 p-6 border rounded-lg bg-gray-50 shadow-sm",children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:_?"編輯收支紀錄":"新增收支紀錄"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"日期"}),y.jsx("input",{type:"date",name:"date",value:d.date,onChange:I,className:"mt-1 w-full p-2 border rounded-md shadow-sm"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"帳戶*"}),y.jsxs("select",{name:"accountId",value:d.accountId,onChange:I,className:"mt-1 w-full p-2 border rounded-md shadow-sm bg-white",children:[y.jsx("option",{value:"",children:"選擇帳戶"}),s.map(ne=>y.jsx("option",{value:ne.id,children:ne.name},ne.id))]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"類型"}),y.jsxs("select",{name:"type",value:d.type,onChange:I,className:"mt-1 w-full p-2 border rounded-md shadow-sm bg-white",children:[y.jsx("option",{value:"expense",children:"支出"}),y.jsx("option",{value:"income",children:"收入"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"類別*"}),y.jsxs("select",{name:"category",value:d.category,onChange:I,className:"mt-1 w-full p-2 border rounded-md shadow-sm bg-white",children:[y.jsx("option",{value:"",children:"選擇類別"}),M.map(ne=>y.jsx("option",{value:ne,children:ne},ne))]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"金額*"}),y.jsx("input",{type:"number",name:"amount",placeholder:"輸入金額",value:d.amount,onChange:I,className:"mt-1 w-full p-2 border rounded-md shadow-sm"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"幣別 & 匯率"}),y.jsxs("div",{className:"flex space-x-2 mt-1",children:[y.jsxs("select",{name:"currency",value:d.currency,onChange:I,className:`p-2 border rounded-md shadow-sm bg-white transition-all duration-200 ${d.currency==="USD"?"w-1/2":"w-full"}`,children:[y.jsx("option",{value:"TWD",children:"TWD"}),y.jsx("option",{value:"USD",children:"USD"})]}),d.currency==="USD"&&y.jsx("input",{type:"number",step:"0.01","aria-label":"USD to TWD Exchange Rate",placeholder:"匯率",value:T,onChange:ne=>S(ne.target.value),onBlur:N,className:"p-2 border rounded-md shadow-sm w-1/2"})]})]}),y.jsxs("div",{className:"md:col-span-2",children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"說明 (選填)"}),y.jsx("input",{type:"text",name:"description",placeholder:"例如：與同事的午餐",value:d.description,onChange:I,className:"mt-1 w-full p-2 border rounded-md shadow-sm"})]}),y.jsx("div",{className:"flex items-end",children:y.jsxs("div",{className:"p-3 border rounded-md bg-white shadow-sm w-full",children:[y.jsxs("div",{className:"flex items-center",children:[y.jsx("input",{type:"checkbox",id:"isRecurring",name:"isRecurring",checked:d.isRecurring,onChange:I,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),y.jsx("label",{htmlFor:"isRecurring",className:"ml-2 block text-sm text-gray-900",children:"設為定額項目"})]}),d.isRecurring&&y.jsxs("div",{className:"flex items-center mt-2",children:[y.jsx("label",{htmlFor:"recurrenceDay",className:"mr-2 text-sm text-gray-700",children:"每月"}),y.jsx("input",{type:"number",id:"recurrenceDay",name:"recurrenceDay",value:d.recurrenceDay,onChange:I,min:"1",max:"31",placeholder:"日",className:"p-1 border rounded-md shadow-sm w-20"}),y.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"日執行"})]})]})})]}),y.jsxs("div",{className:"mt-4 flex justify-end space-x-3",children:[_&&y.jsx("button",{type:"button",onClick:()=>{v(null),m(h)},className:"bg-gray-200 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-300 font-medium",children:"取消編輯"}),y.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 font-medium shadow-sm",children:_?"更新紀錄":"新增紀錄"})]})]}),y.jsx("div",{className:"mb-4",children:y.jsxs("div",{className:"relative",children:[y.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:y.jsx("svg",{className:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),y.jsx("input",{type:"text",placeholder:"搜尋類別、說明、金額...",value:E,onChange:ne=>R(ne.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})}),y.jsxs("div",{className:"overflow-x-auto shadow-md rounded-lg",children:[y.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[y.jsx("thead",{className:"bg-gray-50",children:y.jsxs("tr",{children:[y.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"日期"}),y.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"帳戶"}),y.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"類型"}),y.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"類別"}),y.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"金額"}),y.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"說明"}),y.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),y.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:U.map((ne,be)=>y.jsxs("tr",{className:`transition-colors ${be%2===0?"bg-white":"bg-gray-50"} ${_===ne.id?"bg-blue-100":"hover:bg-yellow-50"}`,children:[y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:ne.date}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:ne.accountName}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:y.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ne.type==="income"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:ne.type==="income"?"收入":"支出"})}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:ne.category}),y.jsxs("td",{className:`px-6 py-4 whitespace-nowrap text-sm text-right font-medium ${ne.type==="income"?"text-green-700":"text-red-700"}`,children:[ne.amount.toLocaleString()," ",y.jsx("span",{className:"text-xs text-gray-400",children:ne.currency})]}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 truncate max-w-xs",title:ne.description||"-",children:ne.description||"-"}),y.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:[ne.isRecurring&&y.jsx("span",{title:`定額項目: 每月 ${ne.recurrenceDay} 日`,className:"mr-3 text-blue-500 cursor-help",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h5M5 12a7 7 0 0011.66 4.995M20 20v-5h-5"})})}),y.jsx("button",{onClick:()=>j(ne),className:"text-indigo-600 hover:text-indigo-900 mr-4",children:"編輯"}),y.jsx("button",{onClick:()=>B(ne.id),className:"text-red-600 hover:text-red-900",children:"刪除"})]})]},ne.id))})]}),C>1&&y.jsxs("div",{className:"flex justify-between items-center mt-4 p-2",children:[y.jsx("button",{onClick:()=>H(ne=>Math.max(1,ne-1)),disabled:O===1,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"上一頁"}),y.jsxs("span",{className:"text-sm text-gray-700",children:["第 ",O," 頁 / 共 ",C," 頁"]}),y.jsx("button",{onClick:()=>H(ne=>Math.min(C,ne+1)),disabled:O===C,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"下一頁"})]})]})]})},t8=({userId:n,db:e,assetAccounts:t,setNotification:s,appId:i})=>{var C;const[r,l]=ue.useState(""),[c,h]=ue.useState(""),d={code:"",accountType:"股票",units:0,cost:0,currentValue:0,currency:"TWD"},[m,_]=ue.useState(d),[v,T]=ue.useState(null);ue.useEffect(()=>{!c&&t.length>0&&h(t[0].id)},[t,c]);const S=async()=>{r.trim()&&(await e.collection(`artifacts/${i}/users/${n}/assetAccounts`).add({name:r,assets:[]}),l(""),s({message:"帳戶新增成功！",type:"success",show:!0}))},E=async I=>{window.confirm("您確定嗎？這將會刪除該帳戶及其中的所有資產。")&&(I===c&&h(""),await e.doc(`artifacts/${i}/users/${n}/assetAccounts/${I}`).delete(),s({message:"帳戶已刪除。",type:"success",show:!0}))},R=async I=>{I.preventDefault();const N=t.find(ae=>ae.id===c);if(!N)return;const V=Number(m.units)||0,j=Number(m.cost)||0,B=Number(m.currentValue)||0;let M;switch(m.accountType){case"現金":M={...m,units:1,cost:B,currentValue:B};break;case"不動產":case"美元資產":M={...m,units:1,cost:j,currentValue:B};break;default:M={...m,units:V,cost:j,currentValue:B};break}const{id:ne,...be}=M;let Y;if(v)Y=(N.assets||[]).map(ae=>ae.id===v?{...ae,...be}:ae);else{const ae={...be,id:Date.now().toString()};Y=[...N.assets||[],ae]}await e.doc(`artifacts/${i}/users/${n}/assetAccounts/${c}`).update({assets:Y}),_(d),T(null),s({message:`資產${v?"更新":"新增"}成功！`,type:"success",show:!0})},k=async()=>{s({message:"正在模擬抓取最新市價...",type:"info",show:!0});for(const I of t){if(!I.assets||I.assets.length===0)continue;const N=I.assets.map(V=>{if(V.accountType==="股票"||V.accountType==="ETF"){const j=(Math.random()-.45)*.1,B=parseFloat(String(V.currentValue))*(1+j);return{...V,currentValue:B}}return V});await e.doc(`artifacts/${i}/users/${n}/assetAccounts/${I.id}`).update({assets:N})}s({message:"所有投資標的市價已更新！",type:"success",show:!0})},L=I=>{_(I),T(I.id),window.scrollTo({top:0,behavior:"smooth"})},O=async I=>{const N=t.find(j=>j.id===c);if(!N)return;const V=N.assets.filter(j=>j.id!==I);await e.doc(`artifacts/${i}/users/${n}/assetAccounts/${c}`).update({assets:V}),s({message:"資產已刪除。",type:"success",show:!0})},H=I=>{const N=I.target.value;_({...d,accountType:N,currency:N==="美元資產"?"USD":"TWD"})},F=()=>{const I="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",N=(V,j,B,M,ne,be)=>y.jsxs("div",{children:[y.jsx("label",{htmlFor:V,className:"block text-sm font-medium text-gray-700 mb-1",children:j}),y.jsx("input",{id:V,name:be,type:B,placeholder:M,value:ne,onChange:Y=>_({...m,[be]:Y.target.value}),className:I,required:!0})]});switch(m.accountType){case"股票":case"ETF":return y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[N("asset-code","股票/ETF 代號*","text","例如: 2330, 0050, AAPL",m.code,"code"),N("asset-units","持有股數/單位數*","number","例如: 1000 (股) or 2 (張)",m.units,"units"),N("asset-cost","平均買入成本 (每股)*","number","例如: 650.5",m.cost,"cost"),N("asset-currentValue","目前市價 (每股)*","number","例如: 680",m.currentValue,"currentValue")]});case"現金":return y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[N("asset-code","現金項目名稱*","text","例如: 台幣活存、緊急備用金",m.code,"code"),N("asset-currentValue","現金總額*","number","例如: 500000",m.currentValue,"currentValue")]});case"不動產":return y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[N("asset-code","房產地址/名稱*","text","例如: 台北市信義區的房子",m.code,"code"),N("asset-cost","購入總成本*","number","例如: 30000000",m.cost,"cost"),N("asset-currentValue","目前估計市價*","number","例如: 45000000",m.currentValue,"currentValue")]});case"美元資產":return y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[N("asset-code","資產名稱*","text","例如: 美元定存, 美元計價基金",m.code,"code"),N("asset-cost","投入成本 (USD)*","number","例如: 10000",m.cost,"cost"),N("asset-currentValue","目前價值 (USD)*","number","例如: 10500",m.currentValue,"currentValue")]});default:return null}},U=((C=t.find(I=>I.id===c))==null?void 0:C.assets)||[];return y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"p-6 border rounded-lg bg-gray-50 shadow-sm",children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"1. 管理資產帳戶"}),y.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:[y.jsx("input",{type:"text",value:r,onChange:I=>l(I.target.value),placeholder:"新帳戶名稱 (例如: 富邦證券)",className:"p-2 border rounded-md shadow-sm flex-grow"}),y.jsx("button",{onClick:S,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 shadow-sm transition-colors",children:"新增帳戶"})]}),t.length>0&&y.jsxs("div",{className:"mt-4 space-y-2",children:[y.jsx("p",{className:"text-sm font-medium text-gray-600",children:"現有帳戶:"}),t.map(I=>y.jsxs("div",{className:"flex justify-between items-center p-2 bg-white rounded-md border group",children:[y.jsx("span",{className:"text-gray-800",children:I.name}),y.jsx("button",{onClick:()=>E(I.id),className:"text-red-500 hover:text-red-700 text-sm opacity-50 group-hover:opacity-100 transition-opacity",children:"刪除"})]},I.id))]})]}),y.jsxs("div",{className:"p-6 border rounded-lg bg-white shadow-sm",children:[y.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"2. 管理帳戶內的資產"}),y.jsx("button",{onClick:k,className:"bg-blue-500 text-white text-sm px-4 py-2 rounded-md hover:bg-blue-600 shadow-sm transition-colors w-full sm:w-auto",children:"模擬獲取最新市價"})]}),y.jsxs("div",{className:"mb-6",children:[y.jsx("label",{htmlFor:"managing-account-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"選擇要管理的帳戶:"}),y.jsxs("select",{id:"managing-account-select",value:c,onChange:I=>h(I.target.value),className:"w-full p-2 border rounded-md shadow-sm bg-white",disabled:t.length===0,children:[y.jsx("option",{value:"",children:t.length>0?"— 請選擇 —":"請先新增一個帳戶"}),t.map(I=>y.jsx("option",{value:I.id,children:I.name},I.id))]})]}),c&&y.jsxs(y.Fragment,{children:[y.jsxs("form",{onSubmit:R,className:"mb-6 p-4 border rounded-lg bg-gray-50 space-y-4",children:[y.jsx("h4",{className:"font-semibold text-gray-700",children:v?"編輯資產":"新增資產"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"asset-type",className:"block text-sm font-medium text-gray-700 mb-1",children:"資產類型*"}),y.jsxs("select",{id:"asset-type",value:m.accountType,onChange:H,className:"w-full p-2 border border-gray-300 rounded-md bg-white shadow-sm focus:ring-indigo-500 focus:border-indigo-500",children:[y.jsx("option",{value:"股票",children:"股票 (Stock)"}),y.jsx("option",{value:"ETF",children:"ETF"}),y.jsx("option",{value:"現金",children:"現金 (Cash)"}),y.jsx("option",{value:"不動產",children:"不動產 (Real Estate)"}),y.jsx("option",{value:"美元資產",children:"其他美元計價資產"})]})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"asset-currency",className:"block text-sm font-medium text-gray-700 mb-1",children:"幣別*"}),y.jsxs("select",{id:"asset-currency",name:"currency",value:m.currency,disabled:m.accountType==="美元資產",onChange:I=>_({...m,currency:I.target.value}),className:"w-full p-2 border border-gray-300 rounded-md bg-white shadow-sm focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100",children:[y.jsx("option",{value:"TWD",children:"TWD"}),y.jsx("option",{value:"USD",children:"USD"})]})]})]}),F(),y.jsxs("div",{className:"col-span-full flex justify-end space-x-3 pt-2",children:[v&&y.jsx("button",{type:"button",onClick:()=>{T(null),_(d)},className:"bg-gray-200 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-300 font-medium",children:"取消編輯"}),y.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 font-medium shadow-sm",children:v?"更新資產":"新增資產"})]})]}),y.jsx("h4",{className:"text-md font-medium mb-3 text-gray-700",children:"帳戶資產列表"}),y.jsxs("div",{className:"overflow-x-auto shadow-md rounded-lg",children:[y.jsxs("table",{className:"min-w-full text-sm text-left text-gray-500",children:[y.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:y.jsxs("tr",{children:[y.jsx("th",{scope:"col",className:"px-4 py-3",children:"代號/名稱"}),y.jsx("th",{scope:"col",className:"px-4 py-3",children:"類型"}),y.jsx("th",{scope:"col",className:"px-4 py-3 text-right",children:"單位"}),y.jsx("th",{scope:"col",className:"px-4 py-3 text-right",children:"成本"}),y.jsx("th",{scope:"col",className:"px-4 py-3 text-right",children:"現價"}),y.jsx("th",{scope:"col",className:"px-4 py-3",children:"幣別"}),y.jsx("th",{scope:"col",className:"px-4 py-3 text-center",children:"操作"})]})}),y.jsx("tbody",{children:U.map(I=>y.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50 transition-colors",children:[y.jsx("td",{className:"px-4 py-2 font-medium text-gray-900 whitespace-nowrap",children:I.code}),y.jsx("td",{className:"px-4 py-2",children:I.accountType}),y.jsx("td",{className:"px-4 py-2 text-right",children:I.units.toLocaleString()}),y.jsx("td",{className:"px-4 py-2 text-right",children:I.cost.toLocaleString()}),y.jsx("td",{className:"px-4 py-2 text-right",children:I.currentValue.toLocaleString()}),y.jsx("td",{className:"px-4 py-2",children:I.currency}),y.jsxs("td",{className:"px-4 py-2 text-center",children:[y.jsx("button",{onClick:()=>L(I),className:"font-medium text-indigo-600 hover:text-indigo-900 mr-4",children:"編輯"}),y.jsx("button",{onClick:()=>O(I.id),className:"font-medium text-red-600 hover:text-red-900",children:"刪除"})]})]},I.id))})]}),U.length===0&&y.jsx("p",{className:"text-center text-gray-500 py-6 bg-white",children:"此帳戶尚無資產。"})]})]})]})]})},n8=({userId:n,db:e,budgets:t,cashflowRecords:s,settings:i,setNotification:r,appId:l})=>{const[c,h]=ue.useState(new Date().toISOString().slice(0,7)),[d,m]=ue.useState({}),_=[...ap.expense,...i.customExpense||[]];ue.useEffect(()=>{const L=t.filter(O=>O.month===c).reduce((O,H)=>({...O,[H.category]:String(H.amount)}),{});m(L)},[c,t]);const{monthlySpending:v,averageSpending:T}=ue.useMemo(()=>{const k={},L={};s.filter(C=>C.date.startsWith(c)&&C.type==="expense").forEach(C=>{k[C.category]=(k[C.category]||0)+C.amount});const O=new Date(c);O.setMonth(O.getMonth()-3);const H=O.toISOString().slice(0,7),F=s.filter(C=>C.type==="expense"&&C.date>=H&&C.date<c),U={};return F.forEach(C=>{const I=C.date.slice(0,7);U[I]||(U[I]={}),U[I][C.category]=(U[I][C.category]||0)+C.amount}),_.forEach(C=>{let I=0,N=0;Object.values(U).forEach(V=>{V[C]&&(I+=V[C],N++)}),N>0&&(L[C]=I/N)}),{monthlySpending:k,averageSpending:L}},[c,s,_]),S=(k,L)=>{m(O=>({...O,[k]:L}))},E=()=>{const k=new Date(c+"-02");k.setMonth(k.getMonth()-1);const L=k.toISOString().slice(0,7),O=t.filter(F=>F.month===L);if(O.length===0){r({message:"上個月沒有設定預算可供複製。",type:"info",show:!0});return}const H=O.reduce((F,U)=>({...F,[U.category]:String(U.amount)}),{});m(H),r({message:`已從 ${L} 複製 ${Object.keys(H).length} 個預算項目。請記得儲存變更。`,type:"success",show:!0})},R=async()=>{try{const k=e.batch(),L=`artifacts/${l}/users/${n}/budgets`;for(const O of _){const H=d[O],F=H?parseFloat(H):0,U=t.find(C=>C.month===c&&C.category===O);if(U)if(F>0){if(U.amount!==F){const C=e.doc(`${L}/${U.id}`);k.update(C,{amount:F})}}else{const C=e.doc(`${L}/${U.id}`);k.delete(C)}else if(F>0){const C=e.collection(L).doc();k.set(C,{month:c,category:O,amount:F})}}await k.commit(),r({message:"預算儲存成功！",type:"success",show:!0})}catch(k){console.error("Error saving budgets:",k),r({message:"儲存預算時發生錯誤。",type:"error",show:!0})}};return y.jsxs("div",{className:"p-6 border rounded-lg bg-gray-50 shadow-sm",children:[y.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center mb-6 gap-4",children:[y.jsxs("div",{className:"flex items-center space-x-4",children:[y.jsx("label",{htmlFor:"budget-month",className:"text-md font-medium text-gray-700",children:"選擇月份:"}),y.jsx("input",{type:"month",id:"budget-month",value:c,onChange:k=>h(k.target.value),className:"p-2 border rounded-md shadow-sm bg-white"})]}),y.jsxs("button",{onClick:E,className:"bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 shadow-sm transition-colors font-medium flex items-center justify-center text-sm",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2"})}),"從上個月複製"]}),y.jsx("button",{onClick:R,className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 shadow-sm transition-colors font-medium",children:"儲存所有預算"})]}),y.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-x-8 gap-y-4",children:_.map(k=>{const L=v[k]||0,O=parseFloat(d[k])||0,H=O-L,F=O>0,U=T[k];return y.jsxs("div",{className:"grid grid-cols-2 items-center gap-2",children:[y.jsxs("label",{className:"text-right font-medium text-gray-700",children:[k,":"]}),y.jsxs("div",{children:[y.jsxs("div",{className:"relative",children:[y.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:"$"}),y.jsx("input",{type:"number",value:d[k]||"",onChange:C=>S(k,C.target.value),placeholder:"設定預算",className:"p-2 pl-7 border rounded-md shadow-sm w-full"})]}),y.jsx("div",{className:"text-xs mt-1 text-right h-4",children:F?y.jsxs("p",{className:`${H>=0?"text-gray-500":"text-red-500 font-bold"}`,children:["已支出: ",L.toLocaleString(),", ",H>=0?`剩餘: ${H.toLocaleString()}`:`超支: ${Math.abs(H).toLocaleString()}`]}):L>0?y.jsxs("p",{className:"text-gray-500",children:["已支出: ",L.toLocaleString()]}):U&&y.jsxs("p",{className:"text-gray-400 italic",children:["近3個月平均: ",Math.round(U).toLocaleString()]})})]})]},k)})}),y.jsx("div",{className:"mt-6 flex justify-end",children:y.jsx("button",{onClick:R,className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 shadow-sm transition-colors font-medium",children:"儲存所有預算"})})]})},s8=({userId:n,db:e,goals:t,assetAccounts:s,setNotification:i,appId:r,effectiveUsdToTwdRate:l})=>{const c={name:"",targetAmount:"",currentAmount:"",targetDate:"",linkedAccountIds:[]},[h,d]=ue.useState(c),[m,_]=ue.useState(null),v=ue.useMemo(()=>s.map(O=>{const H=(O.assets||[]).reduce((F,U)=>{const C=U.currency==="USD"?l:1,I=parseFloat(String(U.currentValue))||0,N=parseFloat(String(U.units))||0;return F+I*N*C},0);return{id:O.id,name:O.name,totalValueTWD:H}}).sort((O,H)=>H.totalValueTWD-O.totalValueTWD),[s,l]);ue.useEffect(()=>{const O=(h.linkedAccountIds||[]).reduce((H,F)=>{const U=v.find(C=>C.id===F);return H+((U==null?void 0:U.totalValueTWD)||0)},0);h.linkedAccountIds.length>0&&d(H=>({...H,currentAmount:O.toFixed(0)}))},[h.linkedAccountIds,v]);const T=O=>{d(H=>{const F=H.linkedAccountIds||[],U=F.includes(O)?F.filter(C=>C!==O):[...F,O];return U.length===0?{...H,linkedAccountIds:[],currentAmount:""}:{...H,linkedAccountIds:U}})},S=O=>{const{name:H,value:F}=O.target;d(U=>({...U,[H]:F}))},E=async O=>{O.preventDefault();const H={name:h.name,targetAmount:parseFloat(h.targetAmount)||0,targetDate:h.targetDate,linkedAccountIds:h.linkedAccountIds||[]};H.linkedAccountIds.length===0&&(H.currentAmount=parseFloat(h.currentAmount)||0);const F=`artifacts/${r}/users/${n}/goals`;m?(await e.doc(`${F}/${m}`).set(H),i({message:"目標更新成功！",type:"success",show:!0})):(await e.collection(F).add(H),i({message:"目標新增成功！",type:"success",show:!0})),d(c),_(null)},R=O=>{d({name:O.name,targetAmount:String(O.targetAmount),currentAmount:String(O.currentAmount||0),targetDate:O.targetDate,linkedAccountIds:O.linkedAccountIds||[]}),_(O.id),window.scrollTo({top:0,behavior:"smooth"})},k=async O=>{window.confirm("您確定要刪除這個目標嗎？")&&(await e.doc(`artifacts/${r}/users/${n}/goals/${O}`).delete(),i({message:"目標已刪除。",type:"success",show:!0}))},L=h.linkedAccountIds&&h.linkedAccountIds.length>0;return y.jsxs("div",{children:[y.jsxs("form",{onSubmit:E,className:"mb-8 p-6 border rounded-lg bg-gray-50 space-y-4 shadow-sm",children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:m?"編輯財務目標":"新增財務目標"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"目標名稱*"}),y.jsx("input",{name:"name",value:h.name,onChange:S,placeholder:"例如: 購車基金",className:"mt-1 w-full p-2 border rounded-md shadow-sm",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"目標金額 (TWD)*"}),y.jsx("input",{type:"number",name:"targetAmount",value:h.targetAmount,onChange:S,placeholder:"例如: 500000",className:"mt-1 w-full p-2 border rounded-md shadow-sm",required:!0})]}),y.jsxs("div",{className:"md:col-span-2",children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"連結資產帳戶 (選填)"}),y.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"選擇一個或多個帳戶，將自動加總其目前價值作為已存金額。"}),y.jsx("div",{className:"p-2 border rounded-md bg-white shadow-sm max-h-32 overflow-y-auto space-y-1",children:v.map(O=>y.jsxs("div",{className:"flex items-center",children:[y.jsx("input",{type:"checkbox",id:`acc-${O.id}`,checked:(h.linkedAccountIds||[]).includes(O.id),onChange:()=>T(O.id),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),y.jsxs("label",{htmlFor:`acc-${O.id}`,className:"ml-2 text-sm text-gray-700",children:[O.name," ($",O.totalValueTWD.toLocaleString(void 0,{maximumFractionDigits:0}),")"]})]},O.id))})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:L?"目前已存金額 (自動計算)":"目前已存金額 (手動輸入)*"}),y.jsx("input",{type:"number",name:"currentAmount",value:h.currentAmount,onChange:S,placeholder:L?"由連結帳戶計算":"例如: 150000",className:"mt-1 w-full p-2 border rounded-md shadow-sm disabled:bg-gray-100 disabled:text-gray-500",required:!0,disabled:L})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"目標日期"}),y.jsx("input",{type:"date",name:"targetDate",value:h.targetDate,onChange:S,className:"mt-1 w-full p-2 border rounded-md shadow-sm"})]})]}),y.jsxs("div",{className:"flex justify-end space-x-3 pt-2",children:[m&&y.jsx("button",{type:"button",onClick:()=>{_(null),d(c)},className:"bg-gray-200 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-300 font-medium",children:"取消"}),y.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 font-medium shadow-sm",children:m?"更新目標":"新增目標"})]})]}),y.jsxs("div",{className:"space-y-4",children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"現有目標"}),t.map(O=>{const H=O.linkedAccountIds&&O.linkedAccountIds.length>0?(O.linkedAccountIds||[]).reduce((C,I)=>{const N=v.find(V=>V.id===I);return C+((N==null?void 0:N.totalValueTWD)||0)},0):O.currentAmount||0,F=Math.min(H/O.targetAmount*100,100),U=(O.linkedAccountIds||[]).map(C=>{var I;return(I=s.find(N=>N.id===C))==null?void 0:I.name}).filter(Boolean).join(", ");return y.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm transition-shadow hover:shadow-md",children:[y.jsxs("div",{className:"flex justify-between items-start mb-2",children:[y.jsxs("div",{children:[y.jsx("h4",{className:"font-bold text-gray-800",children:O.name}),y.jsxs("p",{className:"text-xs text-gray-500",children:["目標日期: ",O.targetDate||"未設定",U&&` | 連結帳戶: ${U}`]})]}),y.jsxs("div",{children:[y.jsx("button",{onClick:()=>R(O),className:"text-indigo-600 hover:text-indigo-900 mr-3 text-sm font-medium",children:"編輯"}),y.jsx("button",{onClick:()=>k(O.id),className:"text-red-600 hover:text-red-900 text-sm font-medium",children:"刪除"})]})]}),y.jsxs("p",{className:"text-gray-700 text-sm mt-3",children:["$",H.toLocaleString(void 0,{maximumFractionDigits:0})," / ",y.jsxs("span",{className:"font-medium",children:["$",O.targetAmount.toLocaleString()]})]}),y.jsxs("div",{className:"mt-1",children:[y.jsxs("div",{className:"flex justify-between mb-1",children:[y.jsx("span",{className:"text-xs font-medium text-blue-700",children:"進度"}),y.jsxs("span",{className:"text-sm font-medium text-blue-700",children:[F.toFixed(1),"%"]})]}),y.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:y.jsx("div",{className:"bg-gradient-to-r from-green-400 to-blue-500 h-2.5 rounded-full transition-all duration-1000 ease-out",style:{width:`${F}%`}})})]})]},O.id)}),t.length===0&&y.jsx("p",{className:"text-gray-500 text-center py-6",children:"尚未新增任何財務目標。"})]})]})},i8=n=>{const{userId:e,db:t,settings:s,setNotification:i,appId:r,assetAccounts:l,cashflowRecords:c,budgets:h,goals:d}=n,[m,_]=ue.useState(""),[v,T]=ue.useState(""),[S,E]=ue.useState(s.manualRate||""),[R,k]=ue.useState(""),[L,O]=ue.useState(""),[H,F]=ue.useState("financial_data.json"),[U,C]=ue.useState(null),[I,N]=ue.useState(!1),[V,j]=ue.useState("同步中...");ue.useEffect(()=>{E(s.manualRate||""),k(localStorage.getItem("githubToken")||""),O(localStorage.getItem("githubRepo")||""),F(localStorage.getItem("githubPath")||"financial_data.json"),C(localStorage.getItem("lastSync"))},[s.manualRate]);const B=()=>{localStorage.setItem("githubToken",R),localStorage.setItem("githubRepo",L),localStorage.setItem("githubPath",H),i({message:"GitHub settings saved locally in your browser.",type:"info",show:!0})},M=()=>({assetAccounts:l,cashflowRecords:c,budgets:h,goals:d,settings:s,backupTimestamp:new Date().toISOString()}),ne=()=>{N(!0),j("正在產生備份檔案..."),setTimeout(()=>{try{const z=M(),se=JSON.stringify(z,null,2),he=new Blob([se],{type:"application/json"}),de=URL.createObjectURL(he),ye=document.createElement("a");ye.href=de,ye.download="financial_data_backup.json",document.body.appendChild(ye),ye.click(),document.body.removeChild(ye),URL.revokeObjectURL(de),i({message:"備份檔案已成功下載！",type:"success",show:!0})}catch(z){console.error("Backup file generation error:",z);const se=z instanceof Error?z.message:"An unknown error occurred.";i({message:`產生備份檔案失敗: ${se}`,type:"error",show:!0})}finally{N(!1)}},50)},be=async()=>{if(!R||!L||!H){i({message:"請填寫完整的 GitHub 同步設定。",type:"error",show:!0});return}N(!0),j("正在同步至 GitHub...");const z=`https://api.github.com/repos/${L}/contents/${H}`,se={Authorization:`Bearer ${R}`,Accept:"application/vnd.github.v3+json"};try{let he;try{const zt=await fetch(z,{headers:se});if(zt.ok)he=(await zt.json()).sha;else if(zt.status!==404)throw new Error(`無法讀取 GitHub 檔案: ${zt.statusText}`)}catch(zt){console.warn("Could not fetch current file SHA, proceeding without it.",zt)}const de=M(),ye=JSON.stringify(de,null,2),Pe=btoa(unescape(encodeURIComponent(ye))),Ae=JSON.stringify({message:`Sync financial data: ${new Date().toISOString()}`,content:Pe,sha:he}),Ct=await fetch(z,{method:"PUT",headers:se,body:Ae});if(!Ct.ok)throw new Error(`GitHub API 錯誤: ${(await Ct.json()).message}`);const tt=new Date().toLocaleString();C(tt),localStorage.setItem("lastSync",tt),i({message:"資料已成功同步至 GitHub！",type:"success",show:!0})}catch(he){console.error("GitHub Sync Error:",he);const de=he instanceof Error?he.message:"An unknown error occurred.";i({message:`同步失敗: ${de}`,type:"error",show:!0})}finally{N(!1)}},Y=async()=>{if(!R||!L||!H){i({message:"請填寫完整的 GitHub 同步設定。",type:"error",show:!0});return}if(!window.confirm("您確定要從 GitHub 載入資料嗎？這將會覆寫您目前的所有本地資料！"))return;N(!0),j("正在從 GitHub 載入...");const z=`https://api.github.com/repos/${L}/contents/${H}`;try{const se=await fetch(z,{headers:{Authorization:`Bearer ${R}`,Accept:"application/vnd.github.v3+json"}});if(!se.ok)throw new Error(`無法讀取 GitHub 檔案: ${se.statusText}`);const he=await se.json(),de=decodeURIComponent(escape(atob(he.content))),ye=JSON.parse(de),Pe=[{name:"assetAccounts",data:ye.assetAccounts||[]},{name:"cashflowRecords",data:ye.cashflowRecords||[]},{name:"budgets",data:ye.budgets||[]},{name:"goals",data:ye.goals||[]}];j("正在寫入資料庫...");for(const Ae of Pe){const Ct=`artifacts/${r}/users/${e}/${Ae.name}`,tt=await t.collection(Ct).get(),zt=t.batch();tt.docs.forEach(ti=>zt.delete(ti.ref)),await zt.commit();const wr=t.batch();Ae.data.forEach(ti=>{const{id:ki,...Mi}=ti,Sr=ki?t.collection(Ct).doc(ki):t.collection(Ct).doc();wr.set(Sr,Mi)}),await wr.commit()}await t.doc(`artifacts/${r}/users/${e}/settings/userSettings`).set(ye.settings||{}),i({message:"資料已成功從 GitHub 載入並同步！",type:"success",show:!0})}catch(se){console.error("GitHub Load Error:",se);const he=se instanceof Error?se.message:"An unknown error occurred.";i({message:`載入失敗: ${he}`,type:"error",show:!0})}finally{N(!1)}},ae=async()=>{const z={...s,manualRate:parseFloat(String(S))||null};await t.doc(`artifacts/${r}/users/${e}/settings/userSettings`).set(z,{merge:!0}),i({message:"設定已儲存！",type:"success",show:!0})},me=async z=>{const se=z==="income"?m.trim():v.trim();if(!se)return;const he=z==="income"?"customIncome":"customExpense",de=s[he]||[];if(de.includes(se)){i({message:"類別已存在。",type:"error",show:!0});return}await t.doc(`artifacts/${r}/users/${e}/settings/userSettings`).set({[he]:[...de,se]},{merge:!0}),z==="income"?_(""):T(""),i({message:"類別新增成功！",type:"success",show:!0})},Ce=async(z,se)=>{if(window.confirm(`您確定要移除「${se}」這個類別嗎？`)){const he=z==="income"?"customIncome":"customExpense",de=(s[he]||[]).filter(ye=>ye!==se);await t.doc(`artifacts/${r}/users/${e}/settings/userSettings`).set({[he]:de},{merge:!0}),i({message:"類別已移除。",type:"success",show:!0})}};return y.jsxs("div",{className:"relative",children:[I&&y.jsxs("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center z-50 rounded-lg",children:[y.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600"}),y.jsx("p",{className:"text-lg text-gray-700 mt-4 font-semibold",children:V})]}),y.jsxs("div",{className:`space-y-8 max-w-3xl mx-auto ${I?"filter blur-sm":""}`,children:[y.jsxs("div",{className:"p-6 border rounded-xl bg-white shadow-lg",children:[y.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-2 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-3 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12s-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"GitHub 同步"]}),y.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"將您的財務資料安全地備份至私有 GitHub 儲存庫，實現跨裝置同步。"}),y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"GitHub Personal Access Token (PAT)"}),y.jsx("input",{type:"password",value:R,onChange:z=>k(z.target.value),onBlur:B,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm",placeholder:"ghp_xxxxxxxxxxxxxxxxxxxx"}),y.jsxs("div",{className:"mt-1 text-xs text-gray-500 p-2 bg-gray-50 rounded-md border",children:[y.jsxs("p",{children:["1. 前往您的 GitHub ",y.jsx("a",{href:"https://github.com/settings/tokens",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline font-semibold",children:"開發者設定"}),"。"]}),y.jsx("p",{children:'2. 點擊 "Generate new token" 並選擇 "Generate new token (classic)"。'}),y.jsxs("p",{children:["3. ",y.jsxs("strong",{children:["最重要的一步：請務必勾選授予 ",y.jsx("code",{className:"text-xs bg-gray-200 p-1 rounded",children:"repo"})," 權限"]}),"，以允許此應用程式讀寫您的儲存庫。"]}),y.jsx("strong",{className:"block text-red-600 mt-2",children:"警告：此金鑰將儲存在您的瀏覽器本地儲存空間中。請勿在公共或不信任的電腦上使用此功能。"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"儲存庫 (Repository)"}),y.jsx("input",{type:"text",value:L,onChange:z=>O(z.target.value),onBlur:B,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm",placeholder:"your_username/your_repo_name"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"檔案路徑 (File Path)"}),y.jsx("input",{type:"text",value:H,onChange:z=>F(z.target.value),onBlur:B,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm"})]})]}),y.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-4",children:[y.jsxs("button",{onClick:be,disabled:I,className:"flex-1 bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700 transition-colors shadow-sm flex items-center justify-center font-semibold disabled:bg-green-300",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),I?"同步中...":"儲存至 GitHub"]}),y.jsxs("button",{onClick:Y,disabled:I,className:"flex-1 bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors shadow-sm flex items-center justify-center font-semibold disabled:bg-blue-300",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),I?"載入中...":"從 GitHub 載入"]})]}),U&&y.jsxs("p",{className:"text-xs text-gray-500 mt-4 text-center",children:["上次同步時間: ",U]})]}),y.jsxs("div",{className:"p-6 border rounded-xl bg-white shadow-lg",children:[y.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-3 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"手動資料匯出 / 備份"]}),y.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"點擊按鈕將您的所有應用程式資料匯出為一個 JSON 檔案作為手動備份。"}),y.jsx("div",{className:"flex justify-center",children:y.jsxs("button",{onClick:ne,disabled:I,className:"w-full sm:w-auto bg-gray-600 text-white px-6 py-3 rounded-md hover:bg-gray-700 transition-colors shadow-sm flex items-center justify-center font-semibold disabled:bg-gray-400",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"下載手動備份"]})})]}),y.jsxs("div",{className:"p-6 border rounded-xl bg-white shadow-lg",children:[y.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-3 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 012-2h2a2 2 0 012 2v1m-6 0h6"})}),"自訂類別"]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[y.jsxs("div",{children:[y.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"收入類別"}),y.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[y.jsx("input",{value:m,onChange:z=>_(z.target.value),onKeyPress:z=>{z.key==="Enter"&&me("income")},placeholder:"新增收入類別",className:"flex-grow p-2 border rounded-md"}),y.jsx("button",{onClick:()=>me("income"),className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition-colors",children:"新增"})]}),y.jsx("ul",{className:"space-y-2",children:(s.customIncome||[]).map(z=>y.jsxs("li",{className:"flex justify-between items-center bg-gray-50 p-2 rounded-md group",children:[y.jsx("span",{className:"text-gray-700",children:z}),y.jsx("button",{onClick:()=>Ce("income",z),className:"text-gray-400 opacity-0 group-hover:opacity-100 h-t-r",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},z))})]}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"支出類別"}),y.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[y.jsx("input",{value:v,onChange:z=>T(z.target.value),onKeyPress:z=>{z.key==="Enter"&&me("expense")},placeholder:"新增支出類別",className:"flex-grow p-2 border rounded-md"}),y.jsx("button",{onClick:()=>me("expense"),className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition-colors",children:"新增"})]}),y.jsx("ul",{className:"space-y-2",children:(s.customExpense||[]).map(z=>y.jsxs("li",{className:"flex justify-between items-center bg-gray-50 p-2 rounded-md group",children:[y.jsx("span",{className:"text-gray-700",children:z}),y.jsx("button",{onClick:()=>Ce("expense",z),className:"text-gray-400 opacity-0 group-hover:opacity-100 h-t-r",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},z))})]})]})]}),y.jsxs("div",{className:"p-6 border rounded-xl bg-white shadow-lg",children:[y.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-3 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v.01"})}),"匯率設定"]}),y.jsxs("div",{className:"flex items-center space-x-4",children:[y.jsx("label",{className:"font-medium text-gray-700",children:"USD-TWD 手動匯率:"}),y.jsx("input",{type:"number",step:"any",value:S,onChange:z=>E(z.target.value),className:"p-2 border border-gray-300 rounded-md shadow-sm",placeholder:"例如: 32.5"})]}),y.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"* 留白則使用系統預設匯率。"})]}),y.jsx("div",{className:"flex justify-end pt-6 border-t mt-8",children:y.jsx("button",{onClick:ae,className:"bg-blue-600 text-white px-8 py-2.5 rounded-lg hover:bg-blue-700 shadow-md font-semibold transition-transform transform hover:scale-105",children:"儲存所有設定"})})]})]})},r8={cashflow:n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),assets:n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),budgets:n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M12 8h.01M15 8h.01M15 14h.01M18 17h.01M18 14h.01M18 11h.01M18 8h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),goals:n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6H8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"})}),settings:n=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})},a8=n=>{const[e,t]=ue.useState("cashflow"),s=()=>{switch(e){case"assets":return y.jsx(t8,{...n});case"cashflow":return y.jsx(e8,{...n});case"budgets":return y.jsx(n8,{...n});case"goals":return y.jsx(s8,{...n});case"settings":return y.jsx(i8,{...n});default:return null}},i=[{id:"cashflow",label:"收支管理"},{id:"assets",label:"資產管理"},{id:"budgets",label:"預算管理"},{id:"goals",label:"目標管理"},{id:"settings",label:"系統設定"}];return y.jsxs("div",{children:[y.jsx(Er,{title:"資料管理中心"}),y.jsx("div",{className:"border-b border-gray-200 mb-6",children:y.jsx("nav",{className:"-mb-px flex space-x-6 overflow-x-auto","aria-label":"Tabs",children:i.map(r=>{const l=r8[r.id];return y.jsxs("button",{onClick:()=>t(r.id),className:`${e===r.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm capitalize transition-colors duration-200`,children:[y.jsx(l,{className:"h-5 w-5 mr-2"}),r.label]},r.id)})})}),y.jsx("div",{className:"mt-6",children:s()})]})},o8=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),M0=15,l8=({assetAccounts:n})=>{const[e,t]=ue.useState(null),[s,i]=ue.useState({key:"currentValueTWD",direction:"descending"}),[r,l]=ue.useState(1);ue.useEffect(()=>{n.length>0&&!e||n.length>0&&!n.find(S=>S.id===e)?(t(n[0].id),l(1)):n.length===0&&t(null)},[n,e]);const c=n.find(S=>S.id===e),h=ue.useMemo(()=>!c||!c.assets?0:c.assets.reduce((S,E)=>S+(E.currentValueTWD||0),0),[c]),d=ue.useMemo(()=>{l(1);const S=c==null?void 0:c.assets;if(!S)return[];const E=[...S];return E.sort((R,k)=>{const L=R[s.key]??(s.key==="code"?"":0),O=k[s.key]??(s.key==="code"?"":0);return L<O?s.direction==="ascending"?-1:1:L>O?s.direction==="ascending"?1:-1:0}),E},[c,s]),m=ue.useMemo(()=>{const S=(r-1)*M0;return d.slice(S,S+M0)},[d,r]),_=Math.ceil(d.length/M0),v=S=>{let E="ascending";s.key===S&&s.direction==="ascending"&&(E="descending"),i({key:S,direction:E})},T=S=>s.key!==S?null:s.direction==="ascending"?" ▲":" ▼";return y.jsxs(cn,{children:[y.jsx(Er,{title:"資產總覽",subtitle:"此頁面為您的資產總覽。如需新增、編輯或刪除資產，請前往「資料管理」頁面。"}),n.length===0?y.jsx("div",{className:"mt-8",children:y.jsx(hf,{Icon:o8,title:"尚未建立任何資產帳戶",message:"請先至「資料管理」頁面的「資產管理」分頁新增您的第一個帳戶，再來此處查看總覽。"})}):y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"mb-6",children:[y.jsx("label",{htmlFor:"account-select",className:"block text-sm font-medium text-gray-700 mb-2",children:"選擇資產帳戶:"}),y.jsx("select",{id:"account-select",className:"mt-1 block w-full md:w-1/2 pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md shadow-sm",value:e||"",onChange:S=>t(S.target.value),children:n.map(S=>y.jsx("option",{value:S.id,children:S.name},S.id))})]}),c?y.jsxs("div",{className:"mt-8",children:[y.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center mb-4 p-4 bg-gray-50 rounded-lg border",children:[y.jsxs("h3",{className:"text-2xl font-semibold text-gray-800",children:[c.name," 的資產"]}),y.jsxs("div",{className:"text-right",children:[y.jsx("p",{className:"text-sm text-gray-600",children:"帳戶總價值 (TWD)"}),y.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["$",h.toLocaleString(void 0,{maximumFractionDigits:0})]})]})]}),c.assets&&c.assets.length>0?y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"overflow-x-auto relative shadow-md sm:rounded-lg mt-6",children:y.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[y.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:y.jsxs("tr",{children:[y.jsxs("th",{scope:"col",className:"py-3 px-6 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>v("code"),children:["代號/名稱",T("code")]}),y.jsx("th",{scope:"col",className:"py-3 px-6",children:"單位"}),y.jsx("th",{scope:"col",className:"py-3 px-6",children:"成本"}),y.jsx("th",{scope:"col",className:"py-3 px-6",children:"幣別"}),y.jsxs("th",{scope:"col",className:"py-3 px-6 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>v("currentValueTWD"),children:["當前價值 (TWD)",T("currentValueTWD")]}),y.jsxs("th",{scope:"col",className:"py-3 px-6 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>v("profitLossTWD"),children:["損益 (TWD)",T("profitLossTWD")]})]})}),y.jsx("tbody",{children:m.map((S,E)=>{const R=S.profitLossTWD||0;return y.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50",children:[y.jsx("td",{className:"py-4 px-6 font-medium text-gray-900 whitespace-nowrap",children:S.code}),y.jsx("td",{className:"py-4 px-6",children:S.units.toLocaleString()}),y.jsx("td",{className:"py-4 px-6",children:S.cost.toLocaleString()}),y.jsx("td",{className:"py-4 px-6",children:S.currency}),y.jsx("td",{className:"py-4 px-6",children:(S.currentValueTWD||0).toLocaleString(void 0,{maximumFractionDigits:0})}),y.jsx("td",{className:`py-4 px-6 font-semibold ${R>=0?"text-green-600":"text-red-600"}`,children:R.toLocaleString(void 0,{maximumFractionDigits:0})})]},S.id||E)})})]})}),_>1&&y.jsxs("div",{className:"flex justify-between items-center mt-4",children:[y.jsx("button",{onClick:()=>l(S=>Math.max(1,S-1)),disabled:r===1,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"上一頁"}),y.jsxs("span",{className:"text-sm text-gray-700",children:["第 ",r," 頁 / 共 ",_," 頁"]}),y.jsx("button",{onClick:()=>l(S=>Math.min(_,S+1)),disabled:r===_,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"下一頁"})]})]}):y.jsx("p",{className:"text-gray-500 text-center py-8",children:"此帳戶中沒有資產，快去「資料管理」新增吧！"})]}):y.jsx("p",{className:"text-center text-gray-500 py-12",children:"請選擇一個帳戶以查看其資產。"})]})]})},c8=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),O0=25,u8=({cashflowRecords:n})=>{const[e,t]=ue.useState({key:"date",direction:"descending"}),[s,i]=ue.useState(1),r=new Date().toISOString().slice(0,7),l=ue.useMemo(()=>{const v=n.filter(R=>R.date.startsWith(r)),T=v.filter(R=>R.type==="income").reduce((R,k)=>R+k.amount,0),S=v.filter(R=>R.type==="expense").reduce((R,k)=>R+k.amount,0),E=T-S;return{income:T,expense:S,net:E}},[n,r]),c=ue.useMemo(()=>{if(i(1),n.length===0)return[];let v=[...n];return v.sort((T,S)=>{const E=T[e.key],R=S[e.key];return E<R?e.direction==="ascending"?-1:1:E>R?e.direction==="ascending"?1:-1:0}),v},[n,e]),h=ue.useMemo(()=>{const v=(s-1)*O0;return c.slice(v,v+O0)},[c,s]),d=Math.ceil(c.length/O0),m=v=>{let T="ascending";e.key===v&&e.direction==="ascending"&&(T="descending"),t({key:v,direction:T})},_=[{key:"date",label:"日期"},{key:"type",label:"類型"},{key:"category",label:"類別"},{key:"amount",label:"金額"},{key:"currency",label:"幣別"},{key:"accountName",label:"帳戶"},{key:"description",label:"說明"}];return y.jsxs(cn,{children:[y.jsx(Er,{title:"收支管理 & 帳本",subtitle:"此頁面為您的收支記錄。如需新增、編輯或刪除記錄，請前往「資料管理」頁面。"}),y.jsxs("div",{className:"mb-8 p-4 bg-gray-50 rounded-lg border",children:[y.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:["本月 (",r,") 財務快照"]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center",children:[y.jsxs("div",{children:[y.jsx("p",{className:"text-sm font-medium text-green-600",children:"總收入"}),y.jsxs("p",{className:"text-2xl font-bold text-green-700",children:["$",l.income.toLocaleString()]})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-sm font-medium text-red-600",children:"總支出"}),y.jsxs("p",{className:"text-2xl font-bold text-red-700",children:["$",l.expense.toLocaleString()]})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-sm font-medium text-blue-600",children:"淨儲蓄"}),y.jsxs("p",{className:`text-2xl font-bold ${l.net>=0?"text-blue-700":"text-red-700"}`,children:["$",l.net.toLocaleString()]})]})]})]}),y.jsx("div",{className:"mt-8",children:n.length>0?y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"overflow-x-auto relative shadow-md sm:rounded-lg",children:y.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[y.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:y.jsx("tr",{children:_.map(({key:v,label:T})=>y.jsxs("th",{scope:"col",className:"py-3 px-6 cursor-pointer",onClick:()=>m(v),children:[T,e.key===v?e.direction==="ascending"?" ▲":" ▼":""]},v))})}),y.jsx("tbody",{children:h.map(v=>y.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50",children:[y.jsx("td",{className:"py-4 px-6",children:v.date}),y.jsx("td",{className:`py-4 px-6 font-medium ${v.type==="income"?"text-green-600":"text-red-600"}`,children:v.type==="income"?"收入":"支出"}),y.jsx("td",{className:"py-4 px-6",children:v.category}),y.jsx("td",{className:"py-4 px-6",children:v.amount.toLocaleString()}),y.jsx("td",{className:"py-4 px-6",children:v.currency||"TWD"}),y.jsx("td",{className:"py-4 px-6 text-gray-600",children:v.accountName||"N/A"}),y.jsx("td",{className:"py-4 px-6 max-w-xs truncate",title:v.description||"N/A",children:v.description||"N/A"})]},v.id))})]})}),d>1&&y.jsxs("div",{className:"flex justify-between items-center mt-4",children:[y.jsx("button",{onClick:()=>i(v=>Math.max(1,v-1)),disabled:s===1,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"上一頁"}),y.jsxs("span",{className:"text-sm text-gray-700",children:["第 ",s," 頁 / 共 ",d," 頁"]}),y.jsx("button",{onClick:()=>i(v=>Math.min(d,v+1)),disabled:s===d,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"下一頁"})]})]}):y.jsx(hf,{Icon:c8,title:"目前沒有收支記錄",message:"請前往「資料管理」頁面的「收支管理」分頁，開始記錄您的第一筆收入或支出。"})})]})},h8=({cashflowRecords:n,budgets:e,db:t,userId:s,appId:i,settings:r,setNotification:l})=>{const c=ue.useRef(null),h=ue.useRef(null),[d,m]=ue.useState(new Date().toISOString().slice(0,7)),[_,v]=ue.useState(!1),T={category:"",amount:""},[S,E]=ue.useState(T),R=[...ap.expense,...r.customExpense||[]],k=ue.useMemo(()=>{const U=n.filter(M=>M.date.startsWith(d)&&M.type==="expense"),C=e.filter(M=>M.month===d),I=U.reduce((M,ne)=>(M[ne.category]=(M[ne.category]||0)+ne.amount,M),{}),V=[...new Set([...C.map(M=>M.category),...Object.keys(I)])].map(M=>{var Y;const ne=((Y=C.find(ae=>ae.category===M))==null?void 0:Y.amount)||0,be=I[M]||0;return{category:M,budget:ne,spent:be,overBudget:be>ne}}),j=C.reduce((M,ne)=>M+ne.amount,0),B=Object.values(I).reduce((M,ne)=>M+Number(ne),0);return{combinedData:V,totalBudget:j,totalSpent:B}},[d,n,e]),L=()=>{E(T),v(!0)},O=async U=>{U.preventDefault();const{category:C,amount:I}=S,N=parseFloat(I);if(!C||isNaN(N)||N<=0){l({message:"請選擇一個類別並輸入有效的預算金額。",type:"error",show:!0});return}const V=`artifacts/${i}/users/${s}/budgets`,j=e.find(B=>B.month===d&&B.category===C);try{j?(await t.doc(`${V}/${j.id}`).update({amount:N}),l({message:"預算更新成功！",type:"success",show:!0})):(await t.collection(V).add({month:d,category:C,amount:N}),l({message:"預算新增成功！",type:"success",show:!0}))}catch(B){console.error("Error saving budget:",B),l({message:"儲存預算時發生錯誤。",type:"error",show:!0})}v(!1)};ue.useEffect(()=>{if(c.current&&k.combinedData.length>0){h.current&&h.current.destroy();const U=c.current.getContext("2d");if(U){const C=k.combinedData.map(M=>M.category),I=k.combinedData.map(M=>M.budget),N=k.combinedData.map(M=>M.spent),V=U.createLinearGradient(0,0,0,400);V.addColorStop(0,"rgba(59, 130, 246, 0.7)"),V.addColorStop(1,"rgba(59, 130, 246, 0.3)");const j=U.createLinearGradient(0,0,0,400);j.addColorStop(0,"rgba(16, 185, 129, 0.7)"),j.addColorStop(1,"rgba(16, 185, 129, 0.3)");const B=U.createLinearGradient(0,0,0,400);B.addColorStop(0,"rgba(239, 68, 68, 0.7)"),B.addColorStop(1,"rgba(239, 68, 68, 0.3)"),h.current=new An(U,{type:"bar",data:{labels:C,datasets:[{label:"預算金額",data:I,backgroundColor:V,borderColor:"rgba(59, 130, 246, 1)",borderWidth:1,borderRadius:5,hoverBackgroundColor:"rgba(59, 130, 246, 1)"},{label:"實際支出",data:N,backgroundColor:N.map((M,ne)=>M>I[ne]?B:j),borderColor:N.map((M,ne)=>M>I[ne]?"rgba(239, 68, 68, 1)":"rgba(16, 185, 129, 1)"),borderWidth:1,borderRadius:5,hoverBackgroundColor:N.map((M,ne)=>M>I[ne]?"rgba(239, 68, 68, 1)":"rgba(16, 185, 129, 1)")}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},scales:{y:{beginAtZero:!0,grid:{color:"rgba(200, 200, 200, 0.2)"},ticks:{callback:M=>`${Number(M)/1e3}k`}},x:{grid:{display:!1}}},plugins:{title:{display:!0,text:`${d} 預算 vs. 支出分析`,font:{size:16}},tooltip:{enabled:!0,backgroundColor:"rgba(30, 41, 59, 0.9)",titleColor:"#ffffff",bodyColor:"#ffffff",footerColor:"#ffffff",titleFont:{size:14,weight:"bold"},bodyFont:{size:12},footerFont:{size:12,weight:"bold"},padding:12,cornerRadius:8,displayColors:!0,callbacks:{label:function(M){let ne=M.dataset.label||"";return ne&&(ne+=": "),M.parsed.y!==null&&(ne+=new Intl.NumberFormat("en-US",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(M.parsed.y)),ne},footer:M=>{let ne=0,be=0;const Y=M.find(me=>me.dataset.label==="預算金額"),ae=M.find(me=>me.dataset.label==="實際支出");if(Y&&(ne=Y.raw),ae&&(be=ae.raw),ne>0){const me=ne-be;return me>=0?`剩餘額度: ${me.toLocaleString()} 元`:`超支金額: ${Math.abs(me).toLocaleString()} 元`}return""}}}}}})}}return()=>{h.current&&h.current.destroy()}},[k,d]);const H=ue.useMemo(()=>{const U=[],{combinedData:C,totalBudget:I,totalSpent:N}=k;I>0?U.push(N>I?{title:"超出總預算",message:`本月總支出已超出總預算 ${(N-I).toLocaleString()} 元。`,type:"warning"}:{title:"預算控制良好",message:`本月總支出仍在預算內，剩餘額度為 ${(I-N).toLocaleString()} 元。`,type:"success"}):U.push({title:"設定月度預算",message:"您尚未設定本月預算，可點擊上方按鈕快速新增或前往「資料管理」設定。",type:"info"});const V=C.filter(j=>j.overBudget&&j.budget>0);return V.length>0&&U.push({title:"注意超支項目",message:`您在「${V.map(j=>j.category).join(", ")}」等項目上已超支。`,type:"warning"}),U},[k]),F={success:"bg-green-50 border-green-500 text-green-800",warning:"bg-red-100 border-red-600 text-red-900",info:"bg-blue-50 border-blue-500 text-blue-800"};return y.jsxs(cn,{children:[y.jsx(Er,{title:"預算檢視 & 月任務卡",subtitle:"此頁面為您的預算檢視。點擊「快速新增預算」來為當前月份新增項目，或前往「資料管理」頁面進行更詳細的設定。"}),y.jsxs("div",{className:"flex justify-between items-center mb-6",children:[y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx("label",{htmlFor:"budget-month-select",className:"text-sm font-medium text-gray-700",children:"選擇月份:"}),y.jsx("input",{type:"month",id:"budget-month-select",value:d,onChange:U=>m(U.target.value),className:"p-2 border rounded-md shadow-sm"})]}),y.jsxs("button",{onClick:L,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 shadow-sm transition-colors flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"快速新增預算"]})]}),y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[y.jsx("div",{className:"lg:col-span-3 bg-gray-50 p-4 rounded-lg border h-96",children:k.combinedData.length>0?y.jsx("canvas",{ref:c}):y.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:"此月份無預算或支出數據可供分析。"})}),y.jsxs("div",{className:"lg:col-span-2",children:[y.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-800",children:"本月任務與洞察"}),y.jsx("div",{className:"space-y-4",children:H.map((U,C)=>y.jsxs("div",{className:`flex items-start p-4 ${U.type==="warning"?"border-l-8":"border-l-[5px]"} rounded-r-lg shadow-sm ${F[U.type]}`,children:[U.type==="warning"&&y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-3 flex-shrink-0 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),U.type==="success"&&y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-3 flex-shrink-0 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),U.type==="info"&&y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-3 flex-shrink-0 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-bold",children:U.title}),y.jsx("p",{className:"text-sm leading-tight",children:U.message})]})]},C))})]})]}),_&&y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 transition-opacity",onClick:()=>v(!1),children:y.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-md transform transition-all",onClick:U=>U.stopPropagation(),children:[y.jsxs("h3",{className:"text-xl font-semibold mb-4 text-gray-800",children:["為 ",d," 新增/更新預算"]}),y.jsxs("form",{onSubmit:O,className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"budget-category",className:"block text-sm font-medium text-gray-700",children:"支出類別"}),y.jsxs("select",{id:"budget-category",name:"category",value:S.category,onChange:U=>E(C=>({...C,category:U.target.value})),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",required:!0,children:[y.jsx("option",{value:"",disabled:!0,children:"-- 請選擇類別 --"}),R.map(U=>y.jsx("option",{value:U,children:U},U))]})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"budget-amount",className:"block text-sm font-medium text-gray-700",children:"預算金額 (TWD)"}),y.jsx("input",{type:"number",id:"budget-amount",name:"amount",value:S.amount,onChange:U=>E(C=>({...C,amount:U.target.value})),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:"例如: 5000",required:!0,min:"1"})]}),y.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[y.jsx("button",{type:"button",onClick:()=>v(!1),className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 font-medium",children:"取消"}),y.jsx("button",{type:"submit",className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 font-medium",children:"儲存預算"})]})]})]})})]})},d8=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),f8=({assetAccounts:n})=>{const[e,t]=ue.useState(null),s=ue.useRef(null),i=ue.useRef(null),r=e||n,l=ue.useMemo(()=>{const E=r.flatMap(B=>(B.assets||[]).map(M=>({...M,accountName:B.name}))).filter(B=>B.accountType==="股票"||B.accountType==="ETF");if(E.length===0)return{totalValue:0,totalCost:0,totalPNL:0,roi:0,assets:[],best:null,worst:null,concentration:0,topAsset:null,stockPercentage:0,numberOfAssets:0};const R=E.reduce((B,M)=>B+(M.currentValueTWD||0),0),k=E.reduce((B,M)=>B+(M.costTWD||0),0),L=R-k,O=k>0?L/k*100:0,H=E.map(B=>{const M=B.profitLossTWD||0,ne=B.costTWD||0,be=ne>0?M/ne*100:0;return{...B,pnl:M,roi:be}}).sort((B,M)=>M.pnl-B.pnl),F=H[0],U=H[H.length-1],C=[...H].sort((B,M)=>(M.currentValueTWD??0)-(B.currentValueTWD??0))[0],I=R>0&&C?(C.currentValueTWD??0)/R*100:0,N=E.filter(B=>B.accountType==="股票").reduce((B,M)=>B+(M.currentValueTWD||0),0),V=R>0?N/R*100:0,j=E.length;return{totalValue:R,totalCost:k,totalPNL:L,roi:O,assets:H,best:F,worst:U,topAsset:C,concentration:I,stockPercentage:V,numberOfAssets:j}},[r]),c=()=>{const R=JSON.parse(JSON.stringify(e||n)).map(k=>({...k,assets:(k.assets||[]).map(L=>{if(L.accountType==="股票"||L.accountType==="ETF"){const O=(Math.random()-.45)*.1,H=(L.currentValueTWD||0)*(1+O);return{...L,currentValueTWD:H,profitLossTWD:H-(L.costTWD||0)}}return L})}));t(R)},h=()=>{t(null)},d=()=>{const{best:E,worst:R,concentration:k,topAsset:L,stockPercentage:O,numberOfAssets:H}=l,F=[];return H===0?(F.push({title:"開始您的投資",message:"您尚未加入任何投資項目。前往「資料管理」新增您的股票或ETF，開始追蹤績效。",type:"info"}),F):(O>60?F.push({title:"風險等級: 偏高",message:`您的投資組合偏向高風險，個股佔比達 ${O.toFixed(1)}%。`,type:"warning"}):O<30?F.push({title:"風險等級: 穩健",message:`您的投資組合偏向穩健，個股佔比為 ${O.toFixed(1)}%。`,type:"success"}):F.push({title:"風險等級: 適中",message:`您的投資組合風險適中，個股佔比為 ${O.toFixed(1)}%。`,type:"info"}),k>40&&F.push({title:"風險集中警告",message:`您的資金過度集中於「${L==null?void 0:L.code}」，佔總投資額的 ${k.toFixed(1)}%。`,type:"warning"}),H<5&&F.push({title:"分散度提醒",message:`您目前僅持有 ${H} 項投資標的，可考慮增加持股以提高分散性。`,type:"info"}),E&&F.push({title:"最佳貢獻",message:`「${E.code}」是您目前獲利最高的資產，貢獻了 ${E.pnl.toLocaleString()} 元的收益。`,type:"info"}),R&&R.pnl<0&&F.push({title:"主要虧損來源",message:`「${R.code}」是您目前虧損最多的資產，虧損達 ${R.pnl.toLocaleString()} 元。`,type:"warning"}),F)},m=()=>{const{stockPercentage:E,concentration:R,topAsset:k,numberOfAssets:L}=l,O=[];let H=!1;return L===0?{suggestions:[],isBalanced:!1}:(E>60&&O.push("考慮增加指數型ETF的比重，以分散個股風險並降低波動性。"),R>40&&O.push(`建議適度減持「${k==null?void 0:k.code}」，並將資金分配到其他資產中。`),L<5&&O.push("研究並增加新的投資標的，以提高投資組合的多元性。"),O.length===0&&(H=!0,O.push("您的投資組合目前配置均衡，無需立即進行重大調整。繼續保持監控！")),{suggestions:O,isBalanced:H})};ue.useEffect(()=>{if(s.current&&l.assets.length>0){i.current&&i.current.destroy();const E=s.current.getContext("2d");if(E){const R=l.assets.reduce((k,L)=>{const O=L.code;return k[O]=(k[O]||0)+(L.currentValueTWD??0),k},{});i.current=new An(E,{type:"doughnut",data:{labels:Object.keys(R),datasets:[{data:Object.values(R),backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#E7E9ED"],borderColor:"#fff",borderWidth:2,hoverOffset:8}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{boxWidth:20}},title:{display:!0,text:"投資組合佔比"}}}})}}return()=>{i.current&&i.current.destroy()}},[l]);const _=d(),{suggestions:v,isBalanced:T}=m(),S={success:"bg-green-100 border-green-400 text-green-800",warning:"bg-yellow-100 border-yellow-400 text-yellow-800",info:"bg-blue-100 border-blue-400 text-blue-800"};return y.jsxs(cn,{children:[y.jsx(Er,{title:"投資追蹤 & 智慧分析"}),n.length===0||l.numberOfAssets===0?y.jsx(hf,{Icon:d8,title:"開始追蹤您的投資",message:"您尚未新增任何股票或ETF資產。請前往「資料管理」新增您的投資項目，即可在此查看詳細的績效分析與智慧建議。"}):y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[y.jsxs("div",{className:"p-4 bg-green-100 rounded-lg text-center shadow-sm",children:[y.jsx("h3",{className:"text-sm font-semibold text-green-800",children:"總投資價值 (TWD)"}),y.jsxs("p",{className:"text-2xl font-bold text-green-900",children:["$",l.totalValue.toLocaleString(void 0,{maximumFractionDigits:0})]})]}),y.jsxs("div",{className:`p-4 rounded-lg text-center shadow-sm ${l.totalPNL>=0?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:[y.jsx("h3",{className:"text-sm font-semibold",children:"總損益 (TWD)"}),y.jsx("p",{className:`text-2xl font-bold ${l.totalPNL>=0?"text-blue-900":"text-red-900"}`,children:l.totalPNL.toLocaleString(void 0,{maximumFractionDigits:0})})]}),y.jsxs("div",{className:"p-4 bg-purple-100 rounded-lg text-center shadow-sm",children:[y.jsx("h3",{className:"text-sm font-semibold text-purple-800",children:"總投資回報率"}),y.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:[l.roi.toFixed(2),"%"]})]})]}),y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[y.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[y.jsxs(cn,{className:"h-96 flex flex-col",children:[y.jsx("h3",{className:"text-xl font-semibold mb-2 text-gray-800 text-center",children:"投資組合分佈"}),y.jsx("div",{className:"relative flex-grow h-full",children:y.jsx("canvas",{ref:s})})]}),y.jsxs(cn,{children:[y.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-800",children:"資產詳細表現"}),y.jsx("div",{className:"overflow-x-auto max-h-96 shadow-inner rounded-lg bg-gray-50",children:y.jsxs("table",{className:"w-full text-sm text-left",children:[y.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-100 sticky top-0",children:y.jsxs("tr",{children:[y.jsx("th",{className:"py-2 px-4",children:"代號"}),y.jsx("th",{className:"py-2 px-4",children:"帳戶"}),y.jsx("th",{className:"py-2 px-4",children:"損益(TWD)"}),y.jsx("th",{className:"py-2 px-4",children:"回報率"})]})}),y.jsx("tbody",{children:l.assets.map(E=>y.jsxs("tr",{className:"bg-white border-b",children:[y.jsx("td",{className:"py-2 px-4 font-medium",children:E.code}),y.jsx("td",{className:"py-2 px-4 text-gray-600",children:E.accountName}),y.jsx("td",{className:`py-2 px-4 font-semibold ${E.pnl>=0?"text-green-600":"text-red-600"}`,children:E.pnl.toLocaleString(void 0,{maximumFractionDigits:0})}),y.jsxs("td",{className:`py-2 px-4 font-semibold ${E.roi>=0?"text-green-600":"text-red-600"}`,children:[E.roi.toFixed(2),"%"]})]},E.id))})]})})]})]}),y.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[y.jsxs(cn,{className:"bg-gray-50",children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-3",children:'"What-If" 壓力測試'}),y.jsx("p",{className:"text-xs text-gray-600 mb-4",children:"模擬市場波動對您投資組合的影響，此操作不會儲存。"}),y.jsxs("div",{className:"flex space-x-2",children:[y.jsxs("button",{onClick:c,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-lg font-semibold flex items-center justify-center text-sm",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"執行市場模擬"]}),e&&y.jsxs("button",{onClick:h,className:"w-full bg-gray-500 text-white py-2 px-4 rounded-lg hover:bg-gray-600 transition-colors shadow-lg font-semibold flex items-center justify-center text-sm",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h5M5 12a7 7 0 0011.66 4.995M20 20v-5h-5"})}),"重置為原始數據"]})]}),e&&y.jsx("p",{className:"text-center text-indigo-700 text-xs mt-3 font-semibold",children:"模擬模式已啟用"})]}),y.jsxs(cn,{children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-3",children:"投資組合洞察"}),y.jsx("div",{className:"space-y-3",children:_.map((E,R)=>y.jsxs("div",{className:`p-3 border-l-4 rounded-r-lg ${S[E.type]}`,children:[y.jsx("h4",{className:"font-bold text-sm",children:E.title}),y.jsx("p",{className:"text-xs",children:E.message})]},R))})]}),y.jsxs(cn,{className:"bg-teal-50 border border-teal-200",children:[y.jsxs("h3",{className:"text-xl font-semibold text-teal-800 mb-4 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"智慧再平衡建議"]}),T?y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3 text-green-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),y.jsx("p",{className:"text-green-900 text-sm font-medium",children:v[0]})]}):y.jsx("ul",{className:"space-y-3",children:v.map((E,R)=>y.jsxs("li",{className:"flex items-start",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3 mt-0.5 text-teal-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),y.jsx("span",{className:"text-teal-900 text-sm",children:E})]},R))})]})]})]})]})]})},m8=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6H8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"})}),g8=({goals:n,assetAccounts:e,cashflowRecords:t})=>{const s=ue.useMemo(()=>{const l=new Date;l.setMonth(l.getMonth()-6);const c=l.toISOString().slice(0,7),h={};t.filter(_=>_.date>=c).forEach(_=>{const v=_.date.slice(0,7);h[v]||(h[v]=0),h[v]+=_.type==="income"?_.amount:-_.amount});const d=Object.values(h);return d.length===0?0:d.reduce((_,v)=>_+v,0)/d.length},[t]),i=l=>(l||[]).map(c=>{var h;return(h=e.find(d=>d.id===c))==null?void 0:h.name}).filter(Boolean).join(", ")||"未連結",r=ue.useMemo(()=>n.map(l=>{const c=(l.linkedAccountIds||[]).reduce((d,m)=>{const _=e.find(T=>T.id===m),v=((_==null?void 0:_.assets)||[]).reduce((T,S)=>T+(S.currentValueTWD||0),0);return d+v},0),h=l.linkedAccountIds&&l.linkedAccountIds.length>0?c:l.currentAmount||0;return{...l,currentAmount:h}}),[n,e]);return y.jsxs(cn,{children:[y.jsx(Er,{title:"財務目標進度",subtitle:"此頁面為您的目標進度。如需新增或修改目標，請前往「資料管理」頁面。"}),r.length>0?y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(l=>{const c=Math.min(l.currentAmount/l.targetAmount*100,100),h=c>=100,d=Math.max(0,l.targetAmount-l.currentAmount);let m=null;if(!h&&s>0&&d>0){const _=Math.ceil(d/s),v=new Date;v.setMonth(v.getMonth()+_),m=`${_} 個月後 (${v.getFullYear()}/${v.getMonth()+1})`}return y.jsxs("div",{className:"p-5 border rounded-lg shadow-sm bg-white transition-transform transform hover:-translate-y-1 hover:shadow-lg flex flex-col",children:[y.jsxs("div",{className:"flex justify-between items-start mb-2",children:[y.jsxs("div",{children:[y.jsxs("h3",{className:"font-bold text-lg text-gray-800 flex items-center",children:[h&&y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-green-500",viewBox:"0 0 20 20",fill:"currentColor",children:y.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),l.name]}),y.jsxs("p",{className:"text-xs text-gray-500",children:["連結帳戶: ",i(l.linkedAccountIds)]})]}),y.jsx("span",{className:"text-sm text-gray-500 font-medium bg-gray-100 px-2 py-1 rounded",children:l.targetDate})]}),y.jsxs("p",{className:"text-gray-700 text-sm mt-4",children:["進度: $",l.currentAmount.toLocaleString(void 0,{maximumFractionDigits:0})," / ",y.jsxs("span",{className:"font-medium",children:["$",l.targetAmount.toLocaleString()]})]}),y.jsxs("div",{className:"mt-2 mb-4",children:[y.jsxs("div",{className:"flex justify-between mb-1",children:[y.jsx("span",{className:"text-xs font-medium text-blue-700",children:"進度"}),y.jsxs("span",{className:"text-sm font-medium text-blue-700",children:[c.toFixed(1),"%"]})]}),y.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 overflow-hidden",children:y.jsx("div",{className:"bg-gradient-to-r from-green-400 to-blue-500 h-4 rounded-full transition-all duration-1000 ease-out",style:{width:`${c}%`},"aria-valuenow":c,"aria-valuemin":0,"aria-valuemax":100,role:"progressbar","aria-label":`${l.name} progress`})})]}),y.jsx("div",{className:"mt-auto pt-4 border-t border-gray-100",children:h?y.jsx("div",{className:"text-center font-semibold text-green-600",children:"恭喜！目標已達成！"}):y.jsxs("div",{className:"text-xs text-gray-600",children:[y.jsxs("div",{className:"flex justify-between",children:[y.jsx("span",{children:"尚需金額:"}),y.jsxs("span",{className:"font-medium",children:["$",d.toLocaleString(void 0,{maximumFractionDigits:0})]})]}),y.jsxs("div",{className:"flex justify-between",children:[y.jsx("span",{children:"預計達成時間:"}),y.jsx("span",{className:"font-medium",children:m||"需正向儲蓄"})]})]})})]},l.id)})}):y.jsx(hf,{Icon:m8,title:"尚無財務目標",message:"設定您的第一個財務目標，例如「購車基金」或「房屋頭期款」，並開始追踪您的進度！"})]})},p8=({assetAccounts:n,onBack:e})=>{const[t,s]=ue.useState({key:"profitLossTWD",direction:"desc"}),{pnlData:i,totalValue:r,totalCost:l,totalPNL:c,overallROI:h,bestPerformer:d,topGainer:m}=ue.useMemo(()=>{const E=n.flatMap(C=>(C.assets||[]).map(I=>({...I,accountName:C.name}))).filter(C=>C.accountType==="股票"||C.accountType==="ETF"||C.accountType==="美元資產");if(E.length===0)return{pnlData:[],totalValue:0,totalCost:0,totalPNL:0,overallROI:0,bestPerformer:null,topGainer:null};const R=E.map(C=>{const I=C.costTWD||0,N=C.profitLossTWD||0,V=I>0?N/I*100:0;return{...C,pnlPercentage:V}}),k=[...R].sort((C,I)=>(I.profitLossTWD||0)-(C.profitLossTWD||0))[0],L=[...R].sort((C,I)=>I.pnlPercentage-C.pnlPercentage)[0],O=R.reduce((C,I)=>C+(I.currentValueTWD||0),0),H=R.reduce((C,I)=>C+(I.costTWD||0),0),F=O-H,U=H>0?F/H*100:0;return{pnlData:R,totalValue:O,totalCost:H,totalPNL:F,overallROI:U,bestPerformer:k,topGainer:L}},[n]),_=ue.useMemo(()=>[...i].sort((E,R)=>{const k=E[t.key]||(t.key==="code"?"":0),L=R[t.key]||(t.key==="code"?"":0);return k<L?t.direction==="asc"?-1:1:k>L?t.direction==="asc"?1:-1:0}),[i,t]),v=E=>{let R="asc";t.key===E&&t.direction==="asc"&&(R="desc"),s({key:E,direction:R})},T=E=>t.key!==E?null:t.direction==="asc"?" ▲":" ▼",S=[{key:"code",label:"資產代號"},{key:"accountType",label:"類型"},{key:"accountName",label:"帳戶"},{key:"costTWD",label:"總成本 (TWD)",className:"text-right"},{key:"currentValueTWD",label:"現值 (TWD)",className:"text-right"},{key:"profitLossTWD",label:"損益 (TWD)",className:"text-right"},{key:"pnlPercentage",label:"損益 (%)",className:"text-right"}];return y.jsxs(cn,{children:[y.jsxs("div",{className:"flex justify-between items-start mb-6",children:[y.jsx(Er,{title:"詳細投資損益表",subtitle:"此為您目前所有投資項目的總損益。注意：因缺乏歷史數據，尚不支援依日期範圍篩選。"}),y.jsx("button",{onClick:e,className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 font-medium h-fit whitespace-nowrap shadow-sm transition-colors",children:"← 返回總覽"})]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[y.jsxs("div",{className:`p-4 rounded-lg text-center shadow-sm ${c>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[y.jsx("h3",{className:`text-sm font-semibold ${c>=0?"text-green-800":"text-red-800"}`,children:"總損益 (TWD)"}),y.jsx("p",{className:`text-2xl font-bold ${c>=0?"text-green-900":"text-red-900"}`,children:c.toLocaleString(void 0,{maximumFractionDigits:0,signDisplay:"always"})})]}),y.jsxs("div",{className:`p-4 rounded-lg text-center shadow-sm ${h>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[y.jsx("h3",{className:`text-sm font-semibold ${h>=0?"text-green-800":"text-red-800"}`,children:"總投資回報率 (ROI)"}),y.jsxs("p",{className:`text-2xl font-bold ${h>=0?"text-green-900":"text-red-900"}`,children:[h.toFixed(2),"%"]})]}),y.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg text-center shadow-sm",children:[y.jsx("h3",{className:"text-sm font-semibold text-blue-800",children:"最佳貢獻 (依金額)"}),d?y.jsxs(y.Fragment,{children:[y.jsx("p",{className:"text-xl font-bold text-blue-900 truncate",children:d.code}),y.jsxs("p",{className:"text-sm font-medium text-green-600",children:["+",(d.profitLossTWD||0).toLocaleString(void 0,{maximumFractionDigits:0})," 元"]})]}):y.jsx("p",{className:"text-gray-500 pt-2",children:"-"})]}),y.jsxs("div",{className:"p-4 bg-indigo-50 border border-indigo-200 rounded-lg text-center shadow-sm",children:[y.jsx("h3",{className:"text-sm font-semibold text-indigo-800",children:"最高回報 (依 ROI)"}),m?y.jsxs(y.Fragment,{children:[y.jsx("p",{className:"text-xl font-bold text-indigo-900 truncate",children:m.code}),y.jsxs("p",{className:"text-sm font-medium text-green-600",children:["+",m.pnlPercentage.toFixed(2),"%"]})]}):y.jsx("p",{className:"text-gray-500 pt-2",children:"-"})]})]}),y.jsxs("div",{className:"overflow-x-auto",children:[y.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[y.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-100",children:y.jsx("tr",{children:S.map(E=>y.jsxs("th",{scope:"col",className:`py-3 px-6 cursor-pointer hover:bg-gray-200 transition-colors ${E.className||""}`,onClick:()=>v(E.key),children:[E.label," ",T(E.key)]},E.key))})}),y.jsx("tbody",{children:_.map((E,R)=>{const k=E.profitLossTWD||0,L=k>=0;return y.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50",children:[y.jsx("td",{className:"py-4 px-6 font-medium text-gray-900",children:E.code}),y.jsx("td",{className:"py-4 px-6 text-gray-600",children:E.accountType}),y.jsx("td",{className:"py-4 px-6 text-gray-600",children:E.accountName}),y.jsx("td",{className:"py-4 px-6 text-right",children:(E.costTWD||0).toLocaleString(void 0,{maximumFractionDigits:0})}),y.jsx("td",{className:"py-4 px-6 text-right",children:(E.currentValueTWD||0).toLocaleString(void 0,{maximumFractionDigits:0})}),y.jsx("td",{className:`py-4 px-6 text-right font-semibold ${L?"text-green-600":"text-red-600"}`,children:k.toLocaleString(void 0,{maximumFractionDigits:0,signDisplay:"always"})}),y.jsxs("td",{className:`py-4 px-6 text-right font-semibold ${L?"text-green-600":"text-red-600"}`,children:[E.pnlPercentage.toFixed(2),"%"]})]},E.id||R)})}),y.jsx("tfoot",{className:"bg-gray-100 border-t-2 border-gray-300",children:y.jsxs("tr",{className:"font-bold text-gray-800",children:[y.jsx("td",{className:"py-3 px-6",colSpan:3,children:"總計"}),y.jsx("td",{className:"py-3 px-6 text-right",children:l.toLocaleString(void 0,{maximumFractionDigits:0})}),y.jsx("td",{className:"py-3 px-6 text-right",children:r.toLocaleString(void 0,{maximumFractionDigits:0})}),y.jsx("td",{className:`py-3 px-6 text-right ${c>=0?"text-green-600":"text-red-600"}`,children:c.toLocaleString(void 0,{maximumFractionDigits:0,signDisplay:"always"})}),y.jsxs("td",{className:`py-3 px-6 text-right ${h>=0?"text-green-600":"text-red-600"}`,children:[h.toFixed(2),"%"]})]})})]}),_.length===0&&y.jsx("p",{className:"text-center text-gray-500 py-8",children:"無投資項目可供分析。"})]})]})},_8=({assetAccounts:n,cashflowRecords:e})=>{const[t,s]=ue.useState(new Date().toISOString().slice(0,7)),[i,r]=ue.useState("desc"),[l,c]=ue.useState("main"),h=ue.useRef(null),d=ue.useRef(null),m=ue.useRef(null),_=ue.useMemo(()=>{const T={},S=new Date;for(let V=11;V>=0;V--){const B=new Date(S.getFullYear(),S.getMonth()-V,1).toISOString().slice(0,7);T[B]={income:0,expense:0,net:0}}e.forEach(V=>{const j=V.date.slice(0,7);T[j]&&(V.type==="income"?T[j].income+=V.amount:T[j].expense+=V.amount)}),Object.keys(T).forEach(V=>{T[V].net=T[V].income-T[V].expense});const E=e.filter(V=>V.date.startsWith(t)&&V.type==="expense").reduce((V,j)=>(V[j.category]=(V[j.category]||0)+j.amount,V),{}),R=n.reduce((V,j)=>V+(j.assets||[]).reduce((B,M)=>B+(M.currentValueTWD||0),0),0),L=n.flatMap(V=>V.assets||[]).map(V=>{const j=V.costTWD||0,B=V.profitLossTWD||0,M=j>0?B/j*100:0;return{...V,pnlPercentage:M}}),O=Object.keys(T).sort((V,j)=>j.localeCompare(V)),F=L.reduce((V,j)=>V+(j.profitLossTWD||0),0)/12;let U=R;const C=[];for(const V of O)C.push({month:V,value:U}),U-=T[V].net+F;C.reverse();const I=T[t]||{income:0,expense:0},N=I.income>0?(I.income-I.expense)/I.income*100:0;return{monthlySummaries:T,expenseBreakdown:E,pnlReportData:L,netWorthTrendData:C,kpis:{savingsRate:N.toFixed(1)}}},[e,n,t]),v=ue.useMemo(()=>[..._.pnlReportData].sort((T,S)=>{const E=T.profitLossTWD||0,R=S.profitLossTWD||0;return i==="desc"?R-E:E-R}),[_.pnlReportData,i]);return ue.useEffect(()=>{if(l!=="main")return;const T=[],S={enabled:!0,backgroundColor:"rgba(30, 41, 59, 0.9)",titleColor:"#ffffff",bodyColor:"#ffffff",titleFont:{size:14,weight:"bold"},bodyFont:{size:12},padding:12,cornerRadius:8,displayColors:!1};if(h.current){const E=An.getChart(h.current);E&&E.destroy();const R=h.current.getContext("2d");if(R){const k=Object.keys(_.monthlySummaries),L=R.createLinearGradient(0,0,0,400);L.addColorStop(0,"rgba(59, 130, 246, 0.8)"),L.addColorStop(1,"rgba(59, 130, 246, 0.1)");const O=R.createLinearGradient(0,0,0,400);O.addColorStop(0,"rgba(239, 68, 68, 0.8)"),O.addColorStop(1,"rgba(239, 68, 68, 0.1)");const H=new An(h.current,{type:"bar",data:{labels:k,datasets:[{label:"總收入",data:k.map(F=>_.monthlySummaries[F].income),backgroundColor:L,borderColor:"rgba(59, 130, 246, 1)",hoverBackgroundColor:"rgba(59, 130, 246, 1)",borderWidth:1,borderRadius:5},{label:"總支出",data:k.map(F=>_.monthlySummaries[F].expense),backgroundColor:O,borderColor:"rgba(239, 68, 68, 1)",hoverBackgroundColor:"rgba(239, 68, 68, 1)",borderWidth:1,borderRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{title:{display:!0,text:"近12個月收支趨勢",font:{size:16}},tooltip:{...S,callbacks:{title:F=>F[0].label,label:F=>` ${F.dataset.label}: ${Number(F.raw).toLocaleString()} 元`}}},scales:{y:{beginAtZero:!0,ticks:{callback:F=>`${Number(F)/1e3}k`}},x:{grid:{display:!1}}}}});T.push(H)}}if(d.current){const E=An.getChart(d.current);E&&E.destroy();const R=Object.keys(_.expenseBreakdown),k=Object.values(_.expenseBreakdown),L=k.reduce((F,U)=>F+U,0),O=["#3B82F6","#10B981","#F59E0B","#8B5CF6","#EF4444","#EC4899","#6366F1","#F97316"],H=new An(d.current,{type:"doughnut",data:{labels:R,datasets:[{data:k,backgroundColor:O,borderColor:"#fff",borderWidth:3,hoverOffset:15,hoverBorderColor:"#fff"}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{title:{display:!1},legend:{position:"right"},tooltip:{...S,callbacks:{title:F=>F[0].label,label:F=>{const U=F.raw,C=L>0?(U/L*100).toFixed(1):0;return`金額: ${U.toLocaleString()} 元 (${C}%)`}}}}}});T.push(H)}if(m.current){const E=An.getChart(m.current);E&&E.destroy();const R=m.current.getContext("2d");if(R){const k=R.createLinearGradient(0,0,0,400);k.addColorStop(0,"rgba(139, 92, 246, 0.7)"),k.addColorStop(1,"rgba(139, 92, 246, 0.1)");const L=new An(m.current,{type:"line",data:{labels:_.netWorthTrendData.map(O=>O.month),datasets:[{label:"資產淨值趨勢 (TWD)",data:_.netWorthTrendData.map(O=>O.value),borderColor:"rgb(139, 92, 246)",backgroundColor:k,tension:.4,fill:!0,pointBackgroundColor:"rgb(139, 92, 246)",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgb(139, 92, 246)",pointRadius:4,pointHoverRadius:8,pointBorderWidth:2,pointHoverBorderWidth:3}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{title:{display:!0,text:"資產淨值趨勢 (含投資損益模擬)",font:{size:16}},tooltip:{...S,callbacks:{title:O=>`月份: ${O[0].label}`,label:O=>` 淨值: ${Number(O.raw).toLocaleString()} 元`}}},scales:{y:{ticks:{callback:O=>`${Number(O)/1e3}k`}},x:{grid:{display:!1}}}}});T.push(L)}}return()=>T.forEach(E=>E.destroy())},[_,l]),l==="pnl"?y.jsx(p8,{assetAccounts:n,onBack:()=>c("main")}):y.jsxs(cn,{children:[y.jsx(Er,{title:"財務報表與分析"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 items-center",children:[y.jsxs("div",{className:"md:col-span-2 flex items-center space-x-4 bg-gray-50 p-4 rounded-lg border",children:[y.jsx("label",{htmlFor:"analysis-month-select",className:"text-lg font-medium text-gray-700",children:"分析月份:"}),y.jsx("input",{id:"analysis-month-select",type:"month",value:t,onChange:T=>s(T.target.value),className:"p-2 border rounded-md shadow-sm","aria-label":"Select month for analysis"})]}),y.jsxs("div",{className:"p-4 bg-blue-100 rounded-lg shadow",children:[y.jsxs("h3",{className:"text-lg font-semibold text-blue-800",children:["儲蓄率 (",t,")"]}),y.jsxs("p",{className:"text-3xl font-bold text-blue-900",children:[_.kpis.savingsRate,"%"]}),y.jsx("p",{className:"text-xs text-blue-700",children:"(收入 - 支出) / 收入"})]})]}),y.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border mb-8",children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"近12個月收支趨勢"}),y.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"將滑鼠懸停在圖表上以查看詳細數據。"}),y.jsx("div",{className:"h-96",children:y.jsx("canvas",{ref:h})})]}),y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[y.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border h-96 flex flex-col",children:[y.jsxs("h3",{className:"text-xl font-semibold text-gray-800 text-center",children:[t," 支出分類"]}),y.jsx("p",{className:"text-xs text-gray-500 mb-2 text-center",children:"將滑鼠懸停在圓環圖上以查看百分比。"}),y.jsx("div",{className:"relative flex-grow h-full",children:y.jsx("canvas",{ref:d})})]}),y.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border h-96 flex flex-col",children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"資產淨值趨勢"}),y.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"將滑鼠懸停在圖表上以查看每月淨值。"}),y.jsx("div",{className:"relative flex-grow h-full",children:y.jsx("canvas",{ref:m})}),y.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"* 此圖表基於歷史收支淨額，並將總投資損益平均分配至過去12個月進行模擬。"})]})]}),y.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"資產損益總表"}),y.jsxs("button",{onClick:()=>c("pnl"),className:"text-sm bg-blue-500 text-white px-3 py-1.5 rounded-md hover:bg-blue-600 transition-colors shadow-sm font-semibold flex items-center",children:["查看詳細報表",y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})]}),y.jsxs("div",{className:"overflow-x-auto",children:[y.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[y.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-100",children:y.jsxs("tr",{children:[y.jsx("th",{scope:"col",className:"py-3 px-6",children:"資產代號"}),y.jsx("th",{scope:"col",className:"py-3 px-6",children:"類型"}),y.jsx("th",{scope:"col",className:"py-3 px-6 text-right",children:"現值 (TWD)"}),y.jsxs("th",{scope:"col",className:"py-3 px-6 text-right cursor-pointer",onClick:()=>r(T=>T==="asc"?"desc":"asc"),children:["損益 (TWD) ",i==="desc"?"▼":"▲"]}),y.jsx("th",{scope:"col",className:"py-3 px-6 text-right",children:"損益 (%)"})]})}),y.jsx("tbody",{children:v.slice(0,5).map((T,S)=>{const E=T.profitLossTWD||0,R=E>=0;return y.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50",children:[y.jsx("td",{className:"py-4 px-6 font-medium text-gray-900",children:T.code}),y.jsx("td",{className:"py-4 px-6",children:T.accountType}),y.jsx("td",{className:"py-4 px-6 text-right",children:(T.currentValueTWD||0).toLocaleString(void 0,{maximumFractionDigits:0})}),y.jsx("td",{className:`py-4 px-6 text-right font-semibold ${R?"text-green-600":"text-red-600"}`,children:E.toLocaleString(void 0,{maximumFractionDigits:0,signDisplay:"always"})}),y.jsxs("td",{className:`py-4 px-6 text-right font-semibold ${R?"text-green-600":"text-red-600"}`,children:[T.pnlPercentage.toFixed(2),"%"]})]},T.id||S)})})]}),v.length>5&&y.jsxs("p",{className:"text-center text-xs text-gray-500 pt-2",children:["...及其他 ",v.length-5," 項資產。請至詳細報表查看。"]})]})]})]})};var rt;(function(n){n.assertEqual=i=>{};function e(i){}n.assertIs=e;function t(i){throw new Error}n.assertNever=t,n.arrayToEnum=i=>{const r={};for(const l of i)r[l]=l;return r},n.getValidEnumValues=i=>{const r=n.objectKeys(i).filter(c=>typeof i[i[c]]!="number"),l={};for(const c of r)l[c]=i[c];return n.objectValues(l)},n.objectValues=i=>n.objectKeys(i).map(function(r){return i[r]}),n.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const r=[];for(const l in i)Object.prototype.hasOwnProperty.call(i,l)&&r.push(l);return r},n.find=(i,r)=>{for(const l of i)if(r(l))return l},n.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function s(i,r=" | "){return i.map(l=>typeof l=="string"?`'${l}'`:l).join(r)}n.joinValues=s,n.jsonStringifyReplacer=(i,r)=>typeof r=="bigint"?r.toString():r})(rt||(rt={}));var AI;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(AI||(AI={}));const Se=rt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ga=n=>{switch(typeof n){case"undefined":return Se.undefined;case"string":return Se.string;case"number":return Number.isNaN(n)?Se.nan:Se.number;case"boolean":return Se.boolean;case"function":return Se.function;case"bigint":return Se.bigint;case"symbol":return Se.symbol;case"object":return Array.isArray(n)?Se.array:n===null?Se.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?Se.promise:typeof Map<"u"&&n instanceof Map?Se.map:typeof Set<"u"&&n instanceof Set?Se.set:typeof Date<"u"&&n instanceof Date?Se.date:Se.object;default:return Se.unknown}},fe=rt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class yr extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(r){return r.message},s={_errors:[]},i=r=>{for(const l of r.issues)if(l.code==="invalid_union")l.unionErrors.map(i);else if(l.code==="invalid_return_type")i(l.returnTypeError);else if(l.code==="invalid_arguments")i(l.argumentsError);else if(l.path.length===0)s._errors.push(t(l));else{let c=s,h=0;for(;h<l.path.length;){const d=l.path[h];h===l.path.length-1?(c[d]=c[d]||{_errors:[]},c[d]._errors.push(t(l))):c[d]=c[d]||{_errors:[]},c=c[d],h++}}};return i(this),s}static assert(e){if(!(e instanceof yr))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,rt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},s=[];for(const i of this.issues)if(i.path.length>0){const r=i.path[0];t[r]=t[r]||[],t[r].push(e(i))}else s.push(e(i));return{formErrors:s,fieldErrors:t}}get formErrors(){return this.flatten()}}yr.create=n=>new yr(n);const Ob=(n,e)=>{let t;switch(n.code){case fe.invalid_type:n.received===Se.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case fe.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,rt.jsonStringifyReplacer)}`;break;case fe.unrecognized_keys:t=`Unrecognized key(s) in object: ${rt.joinValues(n.keys,", ")}`;break;case fe.invalid_union:t="Invalid input";break;case fe.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${rt.joinValues(n.options)}`;break;case fe.invalid_enum_value:t=`Invalid enum value. Expected ${rt.joinValues(n.options)}, received '${n.received}'`;break;case fe.invalid_arguments:t="Invalid function arguments";break;case fe.invalid_return_type:t="Invalid function return type";break;case fe.invalid_date:t="Invalid date";break;case fe.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:rt.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case fe.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case fe.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case fe.custom:t="Invalid input";break;case fe.invalid_intersection_types:t="Intersection results could not be merged";break;case fe.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case fe.not_finite:t="Number must be finite";break;default:t=e.defaultError,rt.assertNever(n)}return{message:t}};let y8=Ob;function b8(){return y8}const v8=n=>{const{data:e,path:t,errorMaps:s,issueData:i}=n,r=[...t,...i.path||[]],l={...i,path:r};if(i.message!==void 0)return{...i,path:r,message:i.message};let c="";const h=s.filter(d=>!!d).slice().reverse();for(const d of h)c=d(l,{data:e,defaultError:c}).message;return{...i,path:r,message:c}};function Te(n,e){const t=b8(),s=v8({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===Ob?void 0:Ob].filter(i=>!!i)});n.common.issues.push(s)}class ys{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const s=[];for(const i of t){if(i.status==="aborted")return je;i.status==="dirty"&&e.dirty(),s.push(i.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,t){const s=[];for(const i of t){const r=await i.key,l=await i.value;s.push({key:r,value:l})}return ys.mergeObjectSync(e,s)}static mergeObjectSync(e,t){const s={};for(const i of t){const{key:r,value:l}=i;if(r.status==="aborted"||l.status==="aborted")return je;r.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),r.value!=="__proto__"&&(typeof l.value<"u"||i.alwaysSet)&&(s[r.value]=l.value)}return{status:e.value,value:s}}}const je=Object.freeze({status:"aborted"}),Yh=n=>({status:"dirty",value:n}),Vs=n=>({status:"valid",value:n}),II=n=>n.status==="aborted",RI=n=>n.status==="dirty",ru=n=>n.status==="valid",op=n=>typeof Promise<"u"&&n instanceof Promise;var Ie;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Ie||(Ie={}));class Ga{constructor(e,t,s,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=s,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const CI=(n,e)=>{if(ru(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new yr(n.common.issues);return this._error=t,this._error}}};function Ge(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:s,description:i}=n;if(e&&(t||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(l,c)=>{const{message:h}=n;return l.code==="invalid_enum_value"?{message:h??c.defaultError}:typeof c.data>"u"?{message:h??s??c.defaultError}:l.code!=="invalid_type"?{message:c.defaultError}:{message:h??t??c.defaultError}},description:i}}class nt{get description(){return this._def.description}_getType(e){return ga(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:ga(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ys,ctx:{common:e.parent.common,data:e.data,parsedType:ga(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(op(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const s=this.safeParse(e,t);if(s.success)return s.data;throw s.error}safeParse(e,t){const s={common:{issues:[],async:(t==null?void 0:t.async)??!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ga(e)},i=this._parseSync({data:e,path:s.path,parent:s});return CI(s,i)}"~validate"(e){var s,i;const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ga(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:t});return ru(r)?{value:r.value}:{issues:t.common.issues}}catch(r){(i=(s=r==null?void 0:r.message)==null?void 0:s.toLowerCase())!=null&&i.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(r=>ru(r)?{value:r.value}:{issues:t.common.issues})}async parseAsync(e,t){const s=await this.safeParseAsync(e,t);if(s.success)return s.data;throw s.error}async safeParseAsync(e,t){const s={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ga(e)},i=this._parse({data:e,path:s.path,parent:s}),r=await(op(i)?i:Promise.resolve(i));return CI(s,r)}refine(e,t){const s=i=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,r)=>{const l=e(i),c=()=>r.addIssue({code:fe.custom,...s(i)});return typeof Promise<"u"&&l instanceof Promise?l.then(h=>h?!0:(c(),!1)):l?!0:(c(),!1)})}refinement(e,t){return this._refinement((s,i)=>e(s)?!0:(i.addIssue(typeof t=="function"?t(s,i):t),!1))}_refinement(e){return new ou({schema:this,typeName:Be.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Na.create(this,this._def)}nullable(){return lu.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ii.create(this)}promise(){return hp.create(this,this._def)}or(e){return cp.create([this,e],this._def)}and(e){return up.create(this,e,this._def)}transform(e){return new ou({...Ge(this._def),schema:this,typeName:Be.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Vb({...Ge(this._def),innerType:this,defaultValue:t,typeName:Be.ZodDefault})}brand(){return new H8({typeName:Be.ZodBranded,type:this,...Ge(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Lb({...Ge(this._def),innerType:this,catchValue:t,typeName:Be.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Dx.create(this,e)}readonly(){return jb.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const x8=/^c[^\s-]{8,}$/i,T8=/^[0-9a-z]+$/,E8=/^[0-9A-HJKMNP-TV-Z]{26}$/i,w8=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,S8=/^[a-z0-9_-]{21}$/i,A8=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,I8=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,R8=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,C8="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let P0;const D8=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,N8=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,k8=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,M8=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,O8=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,P8=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Tk="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",V8=new RegExp(`^${Tk}$`);function Ek(n){let e="[0-5]\\d";n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`);const t=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function L8(n){return new RegExp(`^${Ek(n)}$`)}function j8(n){let e=`${Tk}T${Ek(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function U8(n,e){return!!((e==="v4"||!e)&&D8.test(n)||(e==="v6"||!e)&&k8.test(n))}function B8(n,e){if(!A8.test(n))return!1;try{const[t]=n.split(".");if(!t)return!1;const s=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),i=JSON.parse(atob(s));return!(typeof i!="object"||i===null||"typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||e&&i.alg!==e)}catch{return!1}}function F8(n,e){return!!((e==="v4"||!e)&&N8.test(n)||(e==="v6"||!e)&&M8.test(n))}class sl extends nt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Se.string){const r=this._getOrReturnCtx(e);return Te(r,{code:fe.invalid_type,expected:Se.string,received:r.parsedType}),je}const s=new ys;let i;for(const r of this._def.checks)if(r.kind==="min")e.data.length<r.value&&(i=this._getOrReturnCtx(e,i),Te(i,{code:fe.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),s.dirty());else if(r.kind==="max")e.data.length>r.value&&(i=this._getOrReturnCtx(e,i),Te(i,{code:fe.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),s.dirty());else if(r.kind==="length"){const l=e.data.length>r.value,c=e.data.length<r.value;(l||c)&&(i=this._getOrReturnCtx(e,i),l?Te(i,{code:fe.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}):c&&Te(i,{code:fe.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}),s.dirty())}else if(r.kind==="email")R8.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"email",code:fe.invalid_string,message:r.message}),s.dirty());else if(r.kind==="emoji")P0||(P0=new RegExp(C8,"u")),P0.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"emoji",code:fe.invalid_string,message:r.message}),s.dirty());else if(r.kind==="uuid")w8.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"uuid",code:fe.invalid_string,message:r.message}),s.dirty());else if(r.kind==="nanoid")S8.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"nanoid",code:fe.invalid_string,message:r.message}),s.dirty());else if(r.kind==="cuid")x8.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"cuid",code:fe.invalid_string,message:r.message}),s.dirty());else if(r.kind==="cuid2")T8.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"cuid2",code:fe.invalid_string,message:r.message}),s.dirty());else if(r.kind==="ulid")E8.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"ulid",code:fe.invalid_string,message:r.message}),s.dirty());else if(r.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),Te(i,{validation:"url",code:fe.invalid_string,message:r.message}),s.dirty()}else r.kind==="regex"?(r.regex.lastIndex=0,r.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"regex",code:fe.invalid_string,message:r.message}),s.dirty())):r.kind==="trim"?e.data=e.data.trim():r.kind==="includes"?e.data.includes(r.value,r.position)||(i=this._getOrReturnCtx(e,i),Te(i,{code:fe.invalid_string,validation:{includes:r.value,position:r.position},message:r.message}),s.dirty()):r.kind==="toLowerCase"?e.data=e.data.toLowerCase():r.kind==="toUpperCase"?e.data=e.data.toUpperCase():r.kind==="startsWith"?e.data.startsWith(r.value)||(i=this._getOrReturnCtx(e,i),Te(i,{code:fe.invalid_string,validation:{startsWith:r.value},message:r.message}),s.dirty()):r.kind==="endsWith"?e.data.endsWith(r.value)||(i=this._getOrReturnCtx(e,i),Te(i,{code:fe.invalid_string,validation:{endsWith:r.value},message:r.message}),s.dirty()):r.kind==="datetime"?j8(r).test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{code:fe.invalid_string,validation:"datetime",message:r.message}),s.dirty()):r.kind==="date"?V8.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{code:fe.invalid_string,validation:"date",message:r.message}),s.dirty()):r.kind==="time"?L8(r).test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{code:fe.invalid_string,validation:"time",message:r.message}),s.dirty()):r.kind==="duration"?I8.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"duration",code:fe.invalid_string,message:r.message}),s.dirty()):r.kind==="ip"?U8(e.data,r.version)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"ip",code:fe.invalid_string,message:r.message}),s.dirty()):r.kind==="jwt"?B8(e.data,r.alg)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"jwt",code:fe.invalid_string,message:r.message}),s.dirty()):r.kind==="cidr"?F8(e.data,r.version)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"cidr",code:fe.invalid_string,message:r.message}),s.dirty()):r.kind==="base64"?O8.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"base64",code:fe.invalid_string,message:r.message}),s.dirty()):r.kind==="base64url"?P8.test(e.data)||(i=this._getOrReturnCtx(e,i),Te(i,{validation:"base64url",code:fe.invalid_string,message:r.message}),s.dirty()):rt.assertNever(r);return{status:s.value,value:e.data}}_regex(e,t,s){return this.refinement(i=>e.test(i),{validation:t,code:fe.invalid_string,...Ie.errToObj(s)})}_addCheck(e){return new sl({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Ie.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Ie.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Ie.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Ie.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Ie.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Ie.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Ie.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Ie.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Ie.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Ie.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Ie.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Ie.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Ie.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...Ie.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Ie.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Ie.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Ie.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...Ie.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Ie.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Ie.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Ie.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Ie.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Ie.errToObj(t)})}nonempty(e){return this.min(1,Ie.errToObj(e))}trim(){return new sl({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new sl({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new sl({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}sl.create=n=>new sl({checks:[],typeName:Be.ZodString,coerce:(n==null?void 0:n.coerce)??!1,...Ge(n)});function z8(n,e){const t=(n.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,i=t>s?t:s,r=Number.parseInt(n.toFixed(i).replace(".","")),l=Number.parseInt(e.toFixed(i).replace(".",""));return r%l/10**i}class jd extends nt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Se.number){const r=this._getOrReturnCtx(e);return Te(r,{code:fe.invalid_type,expected:Se.number,received:r.parsedType}),je}let s;const i=new ys;for(const r of this._def.checks)r.kind==="int"?rt.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),Te(s,{code:fe.invalid_type,expected:"integer",received:"float",message:r.message}),i.dirty()):r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(s=this._getOrReturnCtx(e,s),Te(s,{code:fe.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),i.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(s=this._getOrReturnCtx(e,s),Te(s,{code:fe.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),i.dirty()):r.kind==="multipleOf"?z8(e.data,r.value)!==0&&(s=this._getOrReturnCtx(e,s),Te(s,{code:fe.not_multiple_of,multipleOf:r.value,message:r.message}),i.dirty()):r.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),Te(s,{code:fe.not_finite,message:r.message}),i.dirty()):rt.assertNever(r);return{status:i.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Ie.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Ie.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Ie.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Ie.toString(t))}setLimit(e,t,s,i){return new jd({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:Ie.toString(i)}]})}_addCheck(e){return new jd({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Ie.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ie.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ie.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ie.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ie.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Ie.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Ie.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ie.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ie.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&rt.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(t===null||s.value>t)&&(t=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(t)&&Number.isFinite(e)}}jd.create=n=>new jd({checks:[],typeName:Be.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...Ge(n)});class Ud extends nt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Se.bigint)return this._getInvalidInput(e);let s;const i=new ys;for(const r of this._def.checks)r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(s=this._getOrReturnCtx(e,s),Te(s,{code:fe.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),i.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(s=this._getOrReturnCtx(e,s),Te(s,{code:fe.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),i.dirty()):r.kind==="multipleOf"?e.data%r.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),Te(s,{code:fe.not_multiple_of,multipleOf:r.value,message:r.message}),i.dirty()):rt.assertNever(r);return{status:i.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return Te(t,{code:fe.invalid_type,expected:Se.bigint,received:t.parsedType}),je}gte(e,t){return this.setLimit("min",e,!0,Ie.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Ie.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Ie.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Ie.toString(t))}setLimit(e,t,s,i){return new Ud({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:Ie.toString(i)}]})}_addCheck(e){return new Ud({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ie.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ie.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ie.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ie.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Ie.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Ud.create=n=>new Ud({checks:[],typeName:Be.ZodBigInt,coerce:(n==null?void 0:n.coerce)??!1,...Ge(n)});class DI extends nt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Se.boolean){const s=this._getOrReturnCtx(e);return Te(s,{code:fe.invalid_type,expected:Se.boolean,received:s.parsedType}),je}return Vs(e.data)}}DI.create=n=>new DI({typeName:Be.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...Ge(n)});class lp extends nt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Se.date){const r=this._getOrReturnCtx(e);return Te(r,{code:fe.invalid_type,expected:Se.date,received:r.parsedType}),je}if(Number.isNaN(e.data.getTime())){const r=this._getOrReturnCtx(e);return Te(r,{code:fe.invalid_date}),je}const s=new ys;let i;for(const r of this._def.checks)r.kind==="min"?e.data.getTime()<r.value&&(i=this._getOrReturnCtx(e,i),Te(i,{code:fe.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),s.dirty()):r.kind==="max"?e.data.getTime()>r.value&&(i=this._getOrReturnCtx(e,i),Te(i,{code:fe.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),s.dirty()):rt.assertNever(r);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new lp({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Ie.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Ie.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}lp.create=n=>new lp({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:Be.ZodDate,...Ge(n)});class NI extends nt{_parse(e){if(this._getType(e)!==Se.symbol){const s=this._getOrReturnCtx(e);return Te(s,{code:fe.invalid_type,expected:Se.symbol,received:s.parsedType}),je}return Vs(e.data)}}NI.create=n=>new NI({typeName:Be.ZodSymbol,...Ge(n)});class kI extends nt{_parse(e){if(this._getType(e)!==Se.undefined){const s=this._getOrReturnCtx(e);return Te(s,{code:fe.invalid_type,expected:Se.undefined,received:s.parsedType}),je}return Vs(e.data)}}kI.create=n=>new kI({typeName:Be.ZodUndefined,...Ge(n)});class MI extends nt{_parse(e){if(this._getType(e)!==Se.null){const s=this._getOrReturnCtx(e);return Te(s,{code:fe.invalid_type,expected:Se.null,received:s.parsedType}),je}return Vs(e.data)}}MI.create=n=>new MI({typeName:Be.ZodNull,...Ge(n)});class OI extends nt{constructor(){super(...arguments),this._any=!0}_parse(e){return Vs(e.data)}}OI.create=n=>new OI({typeName:Be.ZodAny,...Ge(n)});class PI extends nt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Vs(e.data)}}PI.create=n=>new PI({typeName:Be.ZodUnknown,...Ge(n)});class $a extends nt{_parse(e){const t=this._getOrReturnCtx(e);return Te(t,{code:fe.invalid_type,expected:Se.never,received:t.parsedType}),je}}$a.create=n=>new $a({typeName:Be.ZodNever,...Ge(n)});class VI extends nt{_parse(e){if(this._getType(e)!==Se.undefined){const s=this._getOrReturnCtx(e);return Te(s,{code:fe.invalid_type,expected:Se.void,received:s.parsedType}),je}return Vs(e.data)}}VI.create=n=>new VI({typeName:Be.ZodVoid,...Ge(n)});class Ii extends nt{_parse(e){const{ctx:t,status:s}=this._processInputParams(e),i=this._def;if(t.parsedType!==Se.array)return Te(t,{code:fe.invalid_type,expected:Se.array,received:t.parsedType}),je;if(i.exactLength!==null){const l=t.data.length>i.exactLength.value,c=t.data.length<i.exactLength.value;(l||c)&&(Te(t,{code:l?fe.too_big:fe.too_small,minimum:c?i.exactLength.value:void 0,maximum:l?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),s.dirty())}if(i.minLength!==null&&t.data.length<i.minLength.value&&(Te(t,{code:fe.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),s.dirty()),i.maxLength!==null&&t.data.length>i.maxLength.value&&(Te(t,{code:fe.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),s.dirty()),t.common.async)return Promise.all([...t.data].map((l,c)=>i.type._parseAsync(new Ga(t,l,t.path,c)))).then(l=>ys.mergeArray(s,l));const r=[...t.data].map((l,c)=>i.type._parseSync(new Ga(t,l,t.path,c)));return ys.mergeArray(s,r)}get element(){return this._def.type}min(e,t){return new Ii({...this._def,minLength:{value:e,message:Ie.toString(t)}})}max(e,t){return new Ii({...this._def,maxLength:{value:e,message:Ie.toString(t)}})}length(e,t){return new Ii({...this._def,exactLength:{value:e,message:Ie.toString(t)}})}nonempty(e){return this.min(1,e)}}Ii.create=(n,e)=>new Ii({type:n,minLength:null,maxLength:null,exactLength:null,typeName:Be.ZodArray,...Ge(e)});function Ic(n){if(n instanceof ln){const e={};for(const t in n.shape){const s=n.shape[t];e[t]=Na.create(Ic(s))}return new ln({...n._def,shape:()=>e})}else return n instanceof Ii?new Ii({...n._def,type:Ic(n.element)}):n instanceof Na?Na.create(Ic(n.unwrap())):n instanceof lu?lu.create(Ic(n.unwrap())):n instanceof vl?vl.create(n.items.map(e=>Ic(e))):n}class ln extends nt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=rt.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==Se.object){const d=this._getOrReturnCtx(e);return Te(d,{code:fe.invalid_type,expected:Se.object,received:d.parsedType}),je}const{status:s,ctx:i}=this._processInputParams(e),{shape:r,keys:l}=this._getCached(),c=[];if(!(this._def.catchall instanceof $a&&this._def.unknownKeys==="strip"))for(const d in i.data)l.includes(d)||c.push(d);const h=[];for(const d of l){const m=r[d],_=i.data[d];h.push({key:{status:"valid",value:d},value:m._parse(new Ga(i,_,i.path,d)),alwaysSet:d in i.data})}if(this._def.catchall instanceof $a){const d=this._def.unknownKeys;if(d==="passthrough")for(const m of c)h.push({key:{status:"valid",value:m},value:{status:"valid",value:i.data[m]}});else if(d==="strict")c.length>0&&(Te(i,{code:fe.unrecognized_keys,keys:c}),s.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const m of c){const _=i.data[m];h.push({key:{status:"valid",value:m},value:d._parse(new Ga(i,_,i.path,m)),alwaysSet:m in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const d=[];for(const m of h){const _=await m.key,v=await m.value;d.push({key:_,value:v,alwaysSet:m.alwaysSet})}return d}).then(d=>ys.mergeObjectSync(s,d)):ys.mergeObjectSync(s,h)}get shape(){return this._def.shape()}strict(e){return Ie.errToObj,new ln({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,s)=>{var r,l;const i=((l=(r=this._def).errorMap)==null?void 0:l.call(r,t,s).message)??s.defaultError;return t.code==="unrecognized_keys"?{message:Ie.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new ln({...this._def,unknownKeys:"strip"})}passthrough(){return new ln({...this._def,unknownKeys:"passthrough"})}extend(e){return new ln({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ln({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Be.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new ln({...this._def,catchall:e})}pick(e){const t={};for(const s of rt.objectKeys(e))e[s]&&this.shape[s]&&(t[s]=this.shape[s]);return new ln({...this._def,shape:()=>t})}omit(e){const t={};for(const s of rt.objectKeys(this.shape))e[s]||(t[s]=this.shape[s]);return new ln({...this._def,shape:()=>t})}deepPartial(){return Ic(this)}partial(e){const t={};for(const s of rt.objectKeys(this.shape)){const i=this.shape[s];e&&!e[s]?t[s]=i:t[s]=i.optional()}return new ln({...this._def,shape:()=>t})}required(e){const t={};for(const s of rt.objectKeys(this.shape))if(e&&!e[s])t[s]=this.shape[s];else{let r=this.shape[s];for(;r instanceof Na;)r=r._def.innerType;t[s]=r}return new ln({...this._def,shape:()=>t})}keyof(){return wk(rt.objectKeys(this.shape))}}ln.create=(n,e)=>new ln({shape:()=>n,unknownKeys:"strip",catchall:$a.create(),typeName:Be.ZodObject,...Ge(e)});ln.strictCreate=(n,e)=>new ln({shape:()=>n,unknownKeys:"strict",catchall:$a.create(),typeName:Be.ZodObject,...Ge(e)});ln.lazycreate=(n,e)=>new ln({shape:n,unknownKeys:"strip",catchall:$a.create(),typeName:Be.ZodObject,...Ge(e)});class cp extends nt{_parse(e){const{ctx:t}=this._processInputParams(e),s=this._def.options;function i(r){for(const c of r)if(c.result.status==="valid")return c.result;for(const c of r)if(c.result.status==="dirty")return t.common.issues.push(...c.ctx.common.issues),c.result;const l=r.map(c=>new yr(c.ctx.common.issues));return Te(t,{code:fe.invalid_union,unionErrors:l}),je}if(t.common.async)return Promise.all(s.map(async r=>{const l={...t,common:{...t.common,issues:[]},parent:null};return{result:await r._parseAsync({data:t.data,path:t.path,parent:l}),ctx:l}})).then(i);{let r;const l=[];for(const h of s){const d={...t,common:{...t.common,issues:[]},parent:null},m=h._parseSync({data:t.data,path:t.path,parent:d});if(m.status==="valid")return m;m.status==="dirty"&&!r&&(r={result:m,ctx:d}),d.common.issues.length&&l.push(d.common.issues)}if(r)return t.common.issues.push(...r.ctx.common.issues),r.result;const c=l.map(h=>new yr(h));return Te(t,{code:fe.invalid_union,unionErrors:c}),je}}get options(){return this._def.options}}cp.create=(n,e)=>new cp({options:n,typeName:Be.ZodUnion,...Ge(e)});function Pb(n,e){const t=ga(n),s=ga(e);if(n===e)return{valid:!0,data:n};if(t===Se.object&&s===Se.object){const i=rt.objectKeys(e),r=rt.objectKeys(n).filter(c=>i.indexOf(c)!==-1),l={...n,...e};for(const c of r){const h=Pb(n[c],e[c]);if(!h.valid)return{valid:!1};l[c]=h.data}return{valid:!0,data:l}}else if(t===Se.array&&s===Se.array){if(n.length!==e.length)return{valid:!1};const i=[];for(let r=0;r<n.length;r++){const l=n[r],c=e[r],h=Pb(l,c);if(!h.valid)return{valid:!1};i.push(h.data)}return{valid:!0,data:i}}else return t===Se.date&&s===Se.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class up extends nt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e),i=(r,l)=>{if(II(r)||II(l))return je;const c=Pb(r.value,l.value);return c.valid?((RI(r)||RI(l))&&t.dirty(),{status:t.value,value:c.data}):(Te(s,{code:fe.invalid_intersection_types}),je)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([r,l])=>i(r,l)):i(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}up.create=(n,e,t)=>new up({left:n,right:e,typeName:Be.ZodIntersection,...Ge(t)});class vl extends nt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==Se.array)return Te(s,{code:fe.invalid_type,expected:Se.array,received:s.parsedType}),je;if(s.data.length<this._def.items.length)return Te(s,{code:fe.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),je;!this._def.rest&&s.data.length>this._def.items.length&&(Te(s,{code:fe.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const r=[...s.data].map((l,c)=>{const h=this._def.items[c]||this._def.rest;return h?h._parse(new Ga(s,l,s.path,c)):null}).filter(l=>!!l);return s.common.async?Promise.all(r).then(l=>ys.mergeArray(t,l)):ys.mergeArray(t,r)}get items(){return this._def.items}rest(e){return new vl({...this._def,rest:e})}}vl.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new vl({items:n,typeName:Be.ZodTuple,rest:null,...Ge(e)})};class LI extends nt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==Se.map)return Te(s,{code:fe.invalid_type,expected:Se.map,received:s.parsedType}),je;const i=this._def.keyType,r=this._def.valueType,l=[...s.data.entries()].map(([c,h],d)=>({key:i._parse(new Ga(s,c,s.path,[d,"key"])),value:r._parse(new Ga(s,h,s.path,[d,"value"]))}));if(s.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const h of l){const d=await h.key,m=await h.value;if(d.status==="aborted"||m.status==="aborted")return je;(d.status==="dirty"||m.status==="dirty")&&t.dirty(),c.set(d.value,m.value)}return{status:t.value,value:c}})}else{const c=new Map;for(const h of l){const d=h.key,m=h.value;if(d.status==="aborted"||m.status==="aborted")return je;(d.status==="dirty"||m.status==="dirty")&&t.dirty(),c.set(d.value,m.value)}return{status:t.value,value:c}}}}LI.create=(n,e,t)=>new LI({valueType:e,keyType:n,typeName:Be.ZodMap,...Ge(t)});class Bd extends nt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==Se.set)return Te(s,{code:fe.invalid_type,expected:Se.set,received:s.parsedType}),je;const i=this._def;i.minSize!==null&&s.data.size<i.minSize.value&&(Te(s,{code:fe.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),i.maxSize!==null&&s.data.size>i.maxSize.value&&(Te(s,{code:fe.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());const r=this._def.valueType;function l(h){const d=new Set;for(const m of h){if(m.status==="aborted")return je;m.status==="dirty"&&t.dirty(),d.add(m.value)}return{status:t.value,value:d}}const c=[...s.data.values()].map((h,d)=>r._parse(new Ga(s,h,s.path,d)));return s.common.async?Promise.all(c).then(h=>l(h)):l(c)}min(e,t){return new Bd({...this._def,minSize:{value:e,message:Ie.toString(t)}})}max(e,t){return new Bd({...this._def,maxSize:{value:e,message:Ie.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Bd.create=(n,e)=>new Bd({valueType:n,minSize:null,maxSize:null,typeName:Be.ZodSet,...Ge(e)});class jI extends nt{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}jI.create=(n,e)=>new jI({getter:n,typeName:Be.ZodLazy,...Ge(e)});class UI extends nt{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return Te(t,{received:t.data,code:fe.invalid_literal,expected:this._def.value}),je}return{status:"valid",value:e.data}}get value(){return this._def.value}}UI.create=(n,e)=>new UI({value:n,typeName:Be.ZodLiteral,...Ge(e)});function wk(n,e){return new au({values:n,typeName:Be.ZodEnum,...Ge(e)})}class au extends nt{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),s=this._def.values;return Te(t,{expected:rt.joinValues(s),received:t.parsedType,code:fe.invalid_type}),je}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),s=this._def.values;return Te(t,{received:t.data,code:fe.invalid_enum_value,options:s}),je}return Vs(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return au.create(e,{...this._def,...t})}exclude(e,t=this._def){return au.create(this.options.filter(s=>!e.includes(s)),{...this._def,...t})}}au.create=wk;class BI extends nt{_parse(e){const t=rt.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==Se.string&&s.parsedType!==Se.number){const i=rt.objectValues(t);return Te(s,{expected:rt.joinValues(i),received:s.parsedType,code:fe.invalid_type}),je}if(this._cache||(this._cache=new Set(rt.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const i=rt.objectValues(t);return Te(s,{received:s.data,code:fe.invalid_enum_value,options:i}),je}return Vs(e.data)}get enum(){return this._def.values}}BI.create=(n,e)=>new BI({values:n,typeName:Be.ZodNativeEnum,...Ge(e)});class hp extends nt{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Se.promise&&t.common.async===!1)return Te(t,{code:fe.invalid_type,expected:Se.promise,received:t.parsedType}),je;const s=t.parsedType===Se.promise?t.data:Promise.resolve(t.data);return Vs(s.then(i=>this._def.type.parseAsync(i,{path:t.path,errorMap:t.common.contextualErrorMap})))}}hp.create=(n,e)=>new hp({type:n,typeName:Be.ZodPromise,...Ge(e)});class ou extends nt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Be.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:s}=this._processInputParams(e),i=this._def.effect||null,r={addIssue:l=>{Te(s,l),l.fatal?t.abort():t.dirty()},get path(){return s.path}};if(r.addIssue=r.addIssue.bind(r),i.type==="preprocess"){const l=i.transform(s.data,r);if(s.common.async)return Promise.resolve(l).then(async c=>{if(t.value==="aborted")return je;const h=await this._def.schema._parseAsync({data:c,path:s.path,parent:s});return h.status==="aborted"?je:h.status==="dirty"||t.value==="dirty"?Yh(h.value):h});{if(t.value==="aborted")return je;const c=this._def.schema._parseSync({data:l,path:s.path,parent:s});return c.status==="aborted"?je:c.status==="dirty"||t.value==="dirty"?Yh(c.value):c}}if(i.type==="refinement"){const l=c=>{const h=i.refinement(c,r);if(s.common.async)return Promise.resolve(h);if(h instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(s.common.async===!1){const c=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return c.status==="aborted"?je:(c.status==="dirty"&&t.dirty(),l(c.value),{status:t.value,value:c.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(c=>c.status==="aborted"?je:(c.status==="dirty"&&t.dirty(),l(c.value).then(()=>({status:t.value,value:c.value}))))}if(i.type==="transform")if(s.common.async===!1){const l=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!ru(l))return je;const c=i.transform(l.value,r);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:c}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(l=>ru(l)?Promise.resolve(i.transform(l.value,r)).then(c=>({status:t.value,value:c})):je);rt.assertNever(i)}}ou.create=(n,e,t)=>new ou({schema:n,typeName:Be.ZodEffects,effect:e,...Ge(t)});ou.createWithPreprocess=(n,e,t)=>new ou({schema:e,effect:{type:"preprocess",transform:n},typeName:Be.ZodEffects,...Ge(t)});class Na extends nt{_parse(e){return this._getType(e)===Se.undefined?Vs(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Na.create=(n,e)=>new Na({innerType:n,typeName:Be.ZodOptional,...Ge(e)});class lu extends nt{_parse(e){return this._getType(e)===Se.null?Vs(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}lu.create=(n,e)=>new lu({innerType:n,typeName:Be.ZodNullable,...Ge(e)});class Vb extends nt{_parse(e){const{ctx:t}=this._processInputParams(e);let s=t.data;return t.parsedType===Se.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Vb.create=(n,e)=>new Vb({innerType:n,typeName:Be.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ge(e)});class Lb extends nt{_parse(e){const{ctx:t}=this._processInputParams(e),s={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return op(i)?i.then(r=>({status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new yr(s.common.issues)},input:s.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new yr(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}Lb.create=(n,e)=>new Lb({innerType:n,typeName:Be.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ge(e)});class FI extends nt{_parse(e){if(this._getType(e)!==Se.nan){const s=this._getOrReturnCtx(e);return Te(s,{code:fe.invalid_type,expected:Se.nan,received:s.parsedType}),je}return{status:"valid",value:e.data}}}FI.create=n=>new FI({typeName:Be.ZodNaN,...Ge(n)});class H8 extends nt{_parse(e){const{ctx:t}=this._processInputParams(e),s=t.data;return this._def.type._parse({data:s,path:t.path,parent:t})}unwrap(){return this._def.type}}class Dx extends nt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{const r=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return r.status==="aborted"?je:r.status==="dirty"?(t.dirty(),Yh(r.value)):this._def.out._parseAsync({data:r.value,path:s.path,parent:s})})();{const i=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?je:i.status==="dirty"?(t.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:s.path,parent:s})}}static create(e,t){return new Dx({in:e,out:t,typeName:Be.ZodPipeline})}}class jb extends nt{_parse(e){const t=this._def.innerType._parse(e),s=i=>(ru(i)&&(i.value=Object.freeze(i.value)),i);return op(t)?t.then(i=>s(i)):s(t)}unwrap(){return this._def.innerType}}jb.create=(n,e)=>new jb({innerType:n,typeName:Be.ZodReadonly,...Ge(e)});var Be;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(Be||(Be={}));$a.create;const q8=Ii.create,G8=cp.create;up.create;vl.create;const $8=au.create;hp.create;Na.create;lu.create;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var zI;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(zI||(zI={}));var HI;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(HI||(HI={}));var qI;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(qI||(qI={}));var GI;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(GI||(GI={}));var $I;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})($I||($I={}));var WI;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT"})(WI||(WI={}));var YI;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(YI||(YI={}));var KI;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(KI||(KI={}));var QI;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY"})(QI||(QI={}));var XI;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(XI||(XI={}));var ZI;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(ZI||(ZI={}));var JI;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(JI||(JI={}));var e2;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(e2||(e2={}));var t2;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(t2||(t2={}));var n2;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(n2||(n2={}));var s2;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(s2||(s2={}));var i2;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(i2||(i2={}));var r2;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(r2||(r2={}));var a2;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(a2||(a2={}));var o2;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(o2||(o2={}));var l2;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(l2||(l2={}));var c2;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(c2||(c2={}));var u2;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(u2||(u2={}));var h2;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(h2||(h2={}));var d2;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi"})(d2||(d2={}));var f2;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(f2||(f2={}));var m2;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(m2||(m2={}));var g2;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(g2||(g2={}));var p2;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(p2||(p2={}));var _2;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(_2||(_2={}));var y2;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(y2||(y2={}));var b2;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(b2||(b2={}));var v2;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(v2||(v2={}));var x2;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(x2||(x2={}));var T2;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(T2||(T2={}));var E2;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(E2||(E2={}));var w2;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(w2||(w2={}));var S2;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(S2||(S2={}));var A2;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY"})(A2||(A2={}));var I2;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(I2||(I2={}));const R2=$8(["string","number","integer","object","array","boolean","null"]);G8([R2,q8(R2)]);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var C2;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(C2||(C2={}));const W8=({text:n})=>{const e=n.split(/(\*\*.*?\*\*)/g);return y.jsx(y.Fragment,{children:e.map((t,s)=>t.startsWith("**")&&t.endsWith("**")?y.jsx("strong",{children:t.slice(2,-2)},s):t)})},Y8=({isOpen:n,onClose:e,assetAccounts:t,cashflowRecords:s,budgets:i,goals:r})=>{const[l,c]=ue.useState([]),[h,d]=ue.useState(""),[m,_]=ue.useState(!1),v=ue.useRef(null),T=ue.useRef(null);ue.useEffect(()=>{if(n&&(setTimeout(()=>{var E;return(E=T.current)==null?void 0:E.focus()},100),l.length===0)){const E=t.reduce((k,L)=>k+(L.assets||[]).reduce((O,H)=>O+(H.currentValueTWD||0),0),0);let R="你好！我是您的個人財務助理 Navi。請問有什麼可以為您服務的嗎？";E>0?R=`你好！我是 Navi。我注意到您目前的總資產約為 **$${E.toLocaleString(void 0,{maximumFractionDigits:0})}**。

您可以問我：
* "分析我的資產配置"
* "我上個月的開銷如何？"
* "給我一些儲蓄建議"`:R=`你好！我是您的個人財務助理 Navi。很高興為您服務！

您可以從記錄您的第一筆資產或收支開始，然後向我提問以獲得財務建議。`,c([{role:"model",content:R}])}},[n,l.length,t]),ue.useEffect(()=>{var E;(E=v.current)==null||E.scrollIntoView({behavior:"smooth"})},[l,m]);const S=async E=>{if(E.preventDefault(),!h.trim()||m)return;const R={role:"user",content:h};c(k=>[...k,R]),d(""),_(!0);{setTimeout(()=>{const k={role:"model",content:"AI 助理未設定 API 金鑰，目前無法使用。"};c(L=>[...L,k]),_(!1)},500);return}};return n?y.jsxs("div",{className:"fixed bottom-6 right-6 w-full max-w-md h-[70vh] max-h-[600px] bg-white rounded-2xl shadow-2xl flex flex-col z-50 transition-all duration-300 ease-in-out transform origin-bottom-right",children:[y.jsxs("header",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-blue-600 to-indigo-700 text-white rounded-t-2xl shadow-md",children:[y.jsx("h3",{className:"text-lg font-bold",children:"AI 財務助理"}),y.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-white/20 transition-colors","aria-label":"Close chat",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),y.jsx("div",{className:"flex-1 p-4 overflow-y-auto bg-gray-50",children:y.jsxs("div",{className:"space-y-4",children:[l.map((E,R)=>y.jsx("div",{className:`flex ${E.role==="user"?"justify-end":"justify-start"}`,children:y.jsx("div",{className:`max-w-xs md:max-w-sm px-4 py-2 rounded-2xl shadow ${E.role==="user"?"bg-blue-500 text-white":"bg-gray-200 text-gray-800"}`,children:y.jsx("div",{className:"text-sm whitespace-pre-wrap",children:y.jsx(W8,{text:E.content})})})},R)),m&&y.jsx("div",{className:"flex justify-start",children:y.jsx("div",{className:"max-w-xs md:max-w-sm px-4 py-2 rounded-2xl shadow bg-gray-200 text-gray-800",children:y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-pulse"}),y.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-pulse delay-75"}),y.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-pulse delay-150"})]})})}),y.jsx("div",{ref:v})]})}),y.jsx("form",{onSubmit:S,className:"p-4 border-t border-gray-200 bg-white rounded-b-2xl",children:y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx("input",{ref:T,type:"text",value:h,onChange:E=>d(E.target.value),placeholder:"請在這裡輸入您的問題...",className:"flex-1 w-full px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:m,autoComplete:"off"}),y.jsx("button",{type:"submit",className:"bg-blue-600 text-white p-3 rounded-full hover:bg-blue-700 disabled:bg-blue-300 transition-colors shadow",disabled:m||!h.trim(),children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 transform rotate-90",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})]}):null},K8=(n,e,t)=>{const[s,i]=ue.useState([]),[r,l]=ue.useState([]),[c,h]=ue.useState([]),[d,m]=ue.useState([]),[_,v]=ue.useState({customIncome:[],customExpense:[],manualRate:null,lastRecurringCheck:null});return ue.useEffect(()=>{if(!n||!e||!t){i([]),l([]),h([]),m([]),v({customIncome:[],customExpense:[],manualRate:null,lastRecurringCheck:null});return}const T=`artifacts/${t}/users/${e}`,S=n.collection(`${T}/assetAccounts`).onSnapshot(O=>{i(O.docs.map(H=>({id:H.id,...H.data()})))}),E=n.collection(`${T}/cashflowRecords`).orderBy("date","desc").onSnapshot(O=>{l(O.docs.map(H=>({id:H.id,...H.data()})))}),R=n.collection(`${T}/budgets`).onSnapshot(O=>{h(O.docs.map(H=>({id:H.id,...H.data()})))}),k=n.collection(`${T}/goals`).orderBy("targetDate","asc").onSnapshot(O=>{m(O.docs.map(H=>({id:H.id,...H.data()})))}),L=n.doc(`${T}/settings/userSettings`).onSnapshot(O=>{O.exists?v(O.data()):v({customIncome:[],customExpense:[],manualRate:null,lastRecurringCheck:null})});return()=>{S(),E(),R(),k(),L()}},[n,e,t]),{assetAccounts:s,cashflowRecords:r,budgets:c,goals:d,settings:_}},Q8=async(n,e,t,s,i)=>{const r=n.doc(`artifacts/${i}/users/${e}/settings/userSettings`),l=new Date,c=s.lastRecurringCheck?new Date(s.lastRecurringCheck):new Date(l.getFullYear(),l.getMonth(),0);if(c.getMonth()===l.getMonth()&&c.getFullYear()===l.getFullYear())return!1;const h=t.filter(_=>_.isRecurring&&_.recurrenceDay);if(h.length===0)return await r.set({lastRecurringCheck:l.toISOString()},{merge:!0}),!1;let d=!1;const m=n.collection(`artifacts/${i}/users/${e}/cashflowRecords`);for(const _ of h){const v=Number(_.recurrenceDay);if(isNaN(v)||v<1||v>31)continue;const T=new Date(l.getFullYear(),l.getMonth()+1,0).getDate(),S=Math.min(v,T),E=new Date(l.getFullYear(),l.getMonth(),S).toISOString().slice(0,10);if(!t.some(k=>{var L;return k.date.startsWith(l.toISOString().slice(0,7))&&((L=k.description)==null?void 0:L.includes(_.description))&&k.amount===_.amount&&k.category===_.category})){const{id:k,isRecurring:L,recurrenceDay:O,...H}=_,F={...H,isRecurring:!1,date:E,description:_.description?`${_.description} (定額)`:"(定額)"};await m.add(F),d=!0}}return await r.set({lastRecurringCheck:l.toISOString()},{merge:!0}),d},Jm="finance-dashboard-v1",X8=()=>{const[n,e]=ue.useState("dashboard"),[t,s]=ue.useState({message:"",type:"info",show:!1}),[i,r]=ue.useState(null),[l,c]=ue.useState(32.5),[h,d]=ue.useState(!1),m=ue.useCallback((U,C)=>{s({message:U,type:C,show:!0}),setTimeout(()=>{s({message:"",type:"info",show:!1})},3e3)},[]),_=async()=>{try{const U=await h5();r(U.user.uid),m("登入成功！","success")}catch(U){console.error("登入失敗:",U),m("登入失敗，請再試一次。","error")}};ue.useEffect(()=>{const U=setTimeout(()=>c(32.8),2e3);return()=>clearTimeout(U)},[]);const{assetAccounts:v,cashflowRecords:T,budgets:S,goals:E,settings:R}=K8(ma,i||"",Jm);ue.useEffect(()=>{ma&&i&&R&&Q8(ma,i,T,R,Jm).then(U=>{U&&m("定額收支項目已自動建立。","info")}).catch(U=>{console.error("Error checking recurring transactions:",U),m("檢查定額項目時發生錯誤。","error")})},[ma,i,T,R,m]);const k=async()=>{if(!i){m("請先登入才能新增資料","error");return}await mN(Kg(ma,"testData"),{userId:i,text:"這是測試資料",createdAt:new Date}),m("成功新增一筆測試資料","success")},L=async()=>{(await fN(Kg(ma,"testData"))).forEach(C=>{console.log("讀取到資料:",C.id,C.data())}),m("已讀取 Firestore 資料，請看 console.log","info")},O=R.manualRate||l,H=kz(v,O),F=()=>{if(!i)return y.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[y.jsx("h1",{className:"text-xl mb-4",children:"請先登入 Firebase 帳號"}),y.jsx("button",{onClick:_,className:"bg-blue-600 text-white px-4 py-2 rounded",children:"使用 Google 登入"})]});switch(n){case"dashboard":return y.jsx(xI,{userId:i,assetAccounts:H,cashflowRecords:T});case"data-manager":return y.jsx(a8,{userId:i,db:ma,assetAccounts:v,cashflowRecords:T,budgets:S,goals:E,settings:R,setNotification:U=>m(U.message,U.type),appId:Jm,effectiveUsdToTwdRate:O});case"asset-management":return y.jsx(l8,{assetAccounts:H});case"cashflow-management":return y.jsx(u8,{cashflowRecords:T});case"budget-missions":return y.jsx(h8,{db:ma,userId:i,appId:Jm,cashflowRecords:T,budgets:S,settings:R,setNotification:U=>m(U.message,U.type)});case"investment-tracking":return y.jsx(f8,{assetAccounts:H});case"financial-goals":return y.jsx(g8,{goals:E,assetAccounts:v,cashflowRecords:T});case"report-analysis":return y.jsx(_8,{assetAccounts:H,cashflowRecords:T});default:return y.jsx(xI,{userId:i,assetAccounts:H,cashflowRecords:T})}};return y.jsxs("div",{className:"flex flex-col min-h-screen font-sans",children:[y.jsx(x5,{currentPage:n,setCurrentPage:e}),y.jsxs("main",{className:"flex-grow container mx-auto p-6 md:p-8",children:[F(),i&&y.jsxs("div",{className:"mt-6 space-x-4",children:[y.jsx("button",{onClick:k,className:"bg-green-600 text-white px-4 py-2 rounded",children:"新增測試資料"}),y.jsx("button",{onClick:L,className:"bg-indigo-600 text-white px-4 py-2 rounded",children:"讀取測試資料"})]})]}),y.jsx(E5,{notification:t}),y.jsx(T5,{}),y.jsx(Y8,{isOpen:h,onClose:()=>d(!1),assetAccounts:H,cashflowRecords:T,budgets:S,goals:E})]})},Sk=document.getElementById("root");if(!Sk)throw new Error("Could not find root element to mount to");const Z8=dO.createRoot(Sk);Z8.render(y.jsx(iO.StrictMode,{children:y.jsx(X8,{})}));
