var WC=Object.defineProperty;var YC=(n,t,e)=>t in n?WC(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var _t=(n,t,e)=>YC(n,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function e(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=e(i);fetch(i.href,a)}})();function i2(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var J_={exports:{}},Xu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kT;function KC(){if(kT)return Xu;kT=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(s,i,a){var l=null;if(a!==void 0&&(l=""+a),i.key!==void 0&&(l=""+i.key),"key"in i){a={};for(var u in i)u!=="key"&&(a[u]=i[u])}else a=i;return i=a.ref,{$$typeof:n,type:s,key:l,ref:i!==void 0?i:null,props:a}}return Xu.Fragment=t,Xu.jsx=e,Xu.jsxs=e,Xu}var VT;function QC(){return VT||(VT=1,J_.exports=KC()),J_.exports}var y=QC(),ty={exports:{}},Ut={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PT;function XC(){if(PT)return Ut;PT=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),_=Symbol.iterator;function x(U){return U===null||typeof U!="object"?null:(U=_&&U[_]||U["@@iterator"],typeof U=="function"?U:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,T={};function R(U,st,ht){this.props=U,this.context=st,this.refs=T,this.updater=ht||E}R.prototype.isReactComponent={},R.prototype.setState=function(U,st){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,st,"setState")},R.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function M(){}M.prototype=R.prototype;function L(U,st,ht){this.props=U,this.context=st,this.refs=T,this.updater=ht||E}var O=L.prototype=new M;O.constructor=L,S(O,R.prototype),O.isPureReactComponent=!0;var H=Array.isArray,B={H:null,A:null,T:null,S:null,V:null},z=Object.prototype.hasOwnProperty;function D(U,st,ht,dt,yt,kt){return ht=kt.ref,{$$typeof:n,type:U,key:st,ref:ht!==void 0?ht:null,props:kt}}function I(U,st){return D(U.type,st,void 0,void 0,void 0,U.props)}function C(U){return typeof U=="object"&&U!==null&&U.$$typeof===n}function P(U){var st={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(ht){return st[ht]})}var j=/\/+/g;function F(U,st){return typeof U=="object"&&U!==null&&U.key!=null?P(""+U.key):st.toString(36)}function k(){}function nt(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(k,k):(U.status="pending",U.then(function(st){U.status==="pending"&&(U.status="fulfilled",U.value=st)},function(st){U.status==="pending"&&(U.status="rejected",U.reason=st)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function bt(U,st,ht,dt,yt){var kt=typeof U;(kt==="undefined"||kt==="boolean")&&(U=null);var At=!1;if(U===null)At=!0;else switch(kt){case"bigint":case"string":case"number":At=!0;break;case"object":switch(U.$$typeof){case n:case t:At=!0;break;case m:return At=U._init,bt(At(U._payload),st,ht,dt,yt)}}if(At)return yt=yt(U),At=dt===""?"."+F(U,0):dt,H(yt)?(ht="",At!=null&&(ht=At.replace(j,"$&/")+"/"),bt(yt,st,ht,"",function(Fe){return Fe})):yt!=null&&(C(yt)&&(yt=I(yt,ht+(yt.key==null||U&&U.key===yt.key?"":(""+yt.key).replace(j,"$&/")+"/")+At)),st.push(yt)),1;At=0;var Ie=dt===""?".":dt+":";if(H(U))for(var te=0;te<U.length;te++)dt=U[te],kt=Ie+F(dt,te),At+=bt(dt,st,ht,kt,yt);else if(te=x(U),typeof te=="function")for(U=te.call(U),te=0;!(dt=U.next()).done;)dt=dt.value,kt=Ie+F(dt,te++),At+=bt(dt,st,ht,kt,yt);else if(kt==="object"){if(typeof U.then=="function")return bt(nt(U),st,ht,dt,yt);throw st=String(U),Error("Objects are not valid as a React child (found: "+(st==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":st)+"). If you meant to render a collection of children, use an array instead.")}return At}function Y(U,st,ht){if(U==null)return U;var dt=[],yt=0;return bt(U,dt,"","",function(kt){return st.call(ht,kt,yt++)}),dt}function at(U){if(U._status===-1){var st=U._result;st=st(),st.then(function(ht){(U._status===0||U._status===-1)&&(U._status=1,U._result=ht)},function(ht){(U._status===0||U._status===-1)&&(U._status=2,U._result=ht)}),U._status===-1&&(U._status=0,U._result=st)}if(U._status===1)return U._result.default;throw U._result}var mt=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var st=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(st))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)};function Dt(){}return Ut.Children={map:Y,forEach:function(U,st,ht){Y(U,function(){st.apply(this,arguments)},ht)},count:function(U){var st=0;return Y(U,function(){st++}),st},toArray:function(U){return Y(U,function(st){return st})||[]},only:function(U){if(!C(U))throw Error("React.Children.only expected to receive a single React element child.");return U}},Ut.Component=R,Ut.Fragment=e,Ut.Profiler=i,Ut.PureComponent=L,Ut.StrictMode=s,Ut.Suspense=h,Ut.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,Ut.__COMPILER_RUNTIME={__proto__:null,c:function(U){return B.H.useMemoCache(U)}},Ut.cache=function(U){return function(){return U.apply(null,arguments)}},Ut.cloneElement=function(U,st,ht){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var dt=S({},U.props),yt=U.key,kt=void 0;if(st!=null)for(At in st.ref!==void 0&&(kt=void 0),st.key!==void 0&&(yt=""+st.key),st)!z.call(st,At)||At==="key"||At==="__self"||At==="__source"||At==="ref"&&st.ref===void 0||(dt[At]=st[At]);var At=arguments.length-2;if(At===1)dt.children=ht;else if(1<At){for(var Ie=Array(At),te=0;te<At;te++)Ie[te]=arguments[te+2];dt.children=Ie}return D(U.type,yt,void 0,void 0,kt,dt)},Ut.createContext=function(U){return U={$$typeof:l,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:a,_context:U},U},Ut.createElement=function(U,st,ht){var dt,yt={},kt=null;if(st!=null)for(dt in st.key!==void 0&&(kt=""+st.key),st)z.call(st,dt)&&dt!=="key"&&dt!=="__self"&&dt!=="__source"&&(yt[dt]=st[dt]);var At=arguments.length-2;if(At===1)yt.children=ht;else if(1<At){for(var Ie=Array(At),te=0;te<At;te++)Ie[te]=arguments[te+2];yt.children=Ie}if(U&&U.defaultProps)for(dt in At=U.defaultProps,At)yt[dt]===void 0&&(yt[dt]=At[dt]);return D(U,kt,void 0,void 0,null,yt)},Ut.createRef=function(){return{current:null}},Ut.forwardRef=function(U){return{$$typeof:u,render:U}},Ut.isValidElement=C,Ut.lazy=function(U){return{$$typeof:m,_payload:{_status:-1,_result:U},_init:at}},Ut.memo=function(U,st){return{$$typeof:f,type:U,compare:st===void 0?null:st}},Ut.startTransition=function(U){var st=B.T,ht={};B.T=ht;try{var dt=U(),yt=B.S;yt!==null&&yt(ht,dt),typeof dt=="object"&&dt!==null&&typeof dt.then=="function"&&dt.then(Dt,mt)}catch(kt){mt(kt)}finally{B.T=st}},Ut.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},Ut.use=function(U){return B.H.use(U)},Ut.useActionState=function(U,st,ht){return B.H.useActionState(U,st,ht)},Ut.useCallback=function(U,st){return B.H.useCallback(U,st)},Ut.useContext=function(U){return B.H.useContext(U)},Ut.useDebugValue=function(){},Ut.useDeferredValue=function(U,st){return B.H.useDeferredValue(U,st)},Ut.useEffect=function(U,st,ht){var dt=B.H;if(typeof ht=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return dt.useEffect(U,st)},Ut.useId=function(){return B.H.useId()},Ut.useImperativeHandle=function(U,st,ht){return B.H.useImperativeHandle(U,st,ht)},Ut.useInsertionEffect=function(U,st){return B.H.useInsertionEffect(U,st)},Ut.useLayoutEffect=function(U,st){return B.H.useLayoutEffect(U,st)},Ut.useMemo=function(U,st){return B.H.useMemo(U,st)},Ut.useOptimistic=function(U,st){return B.H.useOptimistic(U,st)},Ut.useReducer=function(U,st,ht){return B.H.useReducer(U,st,ht)},Ut.useRef=function(U){return B.H.useRef(U)},Ut.useState=function(U){return B.H.useState(U)},Ut.useSyncExternalStore=function(U,st,ht){return B.H.useSyncExternalStore(U,st,ht)},Ut.useTransition=function(){return B.H.useTransition()},Ut.version="19.1.1",Ut}var LT;function j0(){return LT||(LT=1,ty.exports=XC()),ty.exports}var ut=j0();const ZC=i2(ut);var ey={exports:{}},Zu={},ny={exports:{}},sy={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jT;function JC(){return jT||(jT=1,(function(n){function t(Y,at){var mt=Y.length;Y.push(at);t:for(;0<mt;){var Dt=mt-1>>>1,U=Y[Dt];if(0<i(U,at))Y[Dt]=at,Y[mt]=U,mt=Dt;else break t}}function e(Y){return Y.length===0?null:Y[0]}function s(Y){if(Y.length===0)return null;var at=Y[0],mt=Y.pop();if(mt!==at){Y[0]=mt;t:for(var Dt=0,U=Y.length,st=U>>>1;Dt<st;){var ht=2*(Dt+1)-1,dt=Y[ht],yt=ht+1,kt=Y[yt];if(0>i(dt,mt))yt<U&&0>i(kt,dt)?(Y[Dt]=kt,Y[yt]=mt,Dt=yt):(Y[Dt]=dt,Y[ht]=mt,Dt=ht);else if(yt<U&&0>i(kt,mt))Y[Dt]=kt,Y[yt]=mt,Dt=yt;else break t}}return at}function i(Y,at){var mt=Y.sortIndex-at.sortIndex;return mt!==0?mt:Y.id-at.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();n.unstable_now=function(){return l.now()-u}}var h=[],f=[],m=1,_=null,x=3,E=!1,S=!1,T=!1,R=!1,M=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function H(Y){for(var at=e(f);at!==null;){if(at.callback===null)s(f);else if(at.startTime<=Y)s(f),at.sortIndex=at.expirationTime,t(h,at);else break;at=e(f)}}function B(Y){if(T=!1,H(Y),!S)if(e(h)!==null)S=!0,z||(z=!0,F());else{var at=e(f);at!==null&&bt(B,at.startTime-Y)}}var z=!1,D=-1,I=5,C=-1;function P(){return R?!0:!(n.unstable_now()-C<I)}function j(){if(R=!1,z){var Y=n.unstable_now();C=Y;var at=!0;try{t:{S=!1,T&&(T=!1,L(D),D=-1),E=!0;var mt=x;try{e:{for(H(Y),_=e(h);_!==null&&!(_.expirationTime>Y&&P());){var Dt=_.callback;if(typeof Dt=="function"){_.callback=null,x=_.priorityLevel;var U=Dt(_.expirationTime<=Y);if(Y=n.unstable_now(),typeof U=="function"){_.callback=U,H(Y),at=!0;break e}_===e(h)&&s(h),H(Y)}else s(h);_=e(h)}if(_!==null)at=!0;else{var st=e(f);st!==null&&bt(B,st.startTime-Y),at=!1}}break t}finally{_=null,x=mt,E=!1}at=void 0}}finally{at?F():z=!1}}}var F;if(typeof O=="function")F=function(){O(j)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,nt=k.port2;k.port1.onmessage=j,F=function(){nt.postMessage(null)}}else F=function(){M(j,0)};function bt(Y,at){D=M(function(){Y(n.unstable_now())},at)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Y){Y.callback=null},n.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<Y?Math.floor(1e3/Y):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_next=function(Y){switch(x){case 1:case 2:case 3:var at=3;break;default:at=x}var mt=x;x=at;try{return Y()}finally{x=mt}},n.unstable_requestPaint=function(){R=!0},n.unstable_runWithPriority=function(Y,at){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var mt=x;x=Y;try{return at()}finally{x=mt}},n.unstable_scheduleCallback=function(Y,at,mt){var Dt=n.unstable_now();switch(typeof mt=="object"&&mt!==null?(mt=mt.delay,mt=typeof mt=="number"&&0<mt?Dt+mt:Dt):mt=Dt,Y){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=mt+U,Y={id:m++,callback:at,priorityLevel:Y,startTime:mt,expirationTime:U,sortIndex:-1},mt>Dt?(Y.sortIndex=mt,t(f,Y),e(h)===null&&Y===e(f)&&(T?(L(D),D=-1):T=!0,bt(B,mt-Dt))):(Y.sortIndex=U,t(h,Y),S||E||(S=!0,z||(z=!0,F()))),Y},n.unstable_shouldYield=P,n.unstable_wrapCallback=function(Y){var at=x;return function(){var mt=x;x=at;try{return Y.apply(this,arguments)}finally{x=mt}}}})(sy)),sy}var BT;function tM(){return BT||(BT=1,ny.exports=JC()),ny.exports}var iy={exports:{}},Nn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FT;function eM(){if(FT)return Nn;FT=1;var n=j0();function t(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var s={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(h,f,m){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:_==null?null:""+_,children:h,containerInfo:f,implementation:m}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Nn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Nn.createPortal=function(h,f){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return a(h,f,null,m)},Nn.flushSync=function(h){var f=l.T,m=s.p;try{if(l.T=null,s.p=2,h)return h()}finally{l.T=f,s.p=m,s.d.f()}},Nn.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,s.d.C(h,f))},Nn.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},Nn.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var m=f.as,_=u(m,f.crossOrigin),x=typeof f.integrity=="string"?f.integrity:void 0,E=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;m==="style"?s.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:_,integrity:x,fetchPriority:E}):m==="script"&&s.d.X(h,{crossOrigin:_,integrity:x,fetchPriority:E,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Nn.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var m=u(f.as,f.crossOrigin);s.d.M(h,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&s.d.M(h)},Nn.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var m=f.as,_=u(m,f.crossOrigin);s.d.L(h,m,{crossOrigin:_,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Nn.preloadModule=function(h,f){if(typeof h=="string")if(f){var m=u(f.as,f.crossOrigin);s.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else s.d.m(h)},Nn.requestFormReset=function(h){s.d.r(h)},Nn.unstable_batchedUpdates=function(h,f){return h(f)},Nn.useFormState=function(h,f,m){return l.H.useFormState(h,f,m)},Nn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Nn.version="19.1.1",Nn}var UT;function nM(){if(UT)return iy.exports;UT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),iy.exports=eM(),iy.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zT;function sM(){if(zT)return Zu;zT=1;var n=tM(),t=j0(),e=nM();function s(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var o=r,c=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(c=o.return),r=o.return;while(r)}return o.tag===3?c:null}function l(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function u(r){if(a(r)!==r)throw Error(s(188))}function h(r){var o=r.alternate;if(!o){if(o=a(r),o===null)throw Error(s(188));return o!==r?null:r}for(var c=r,d=o;;){var p=c.return;if(p===null)break;var b=p.alternate;if(b===null){if(d=p.return,d!==null){c=d;continue}break}if(p.child===b.child){for(b=p.child;b;){if(b===c)return u(p),r;if(b===d)return u(p),o;b=b.sibling}throw Error(s(188))}if(c.return!==d.return)c=p,d=b;else{for(var A=!1,N=p.child;N;){if(N===c){A=!0,c=p,d=b;break}if(N===d){A=!0,d=p,c=b;break}N=N.sibling}if(!A){for(N=b.child;N;){if(N===c){A=!0,c=b,d=p;break}if(N===d){A=!0,d=b,c=p;break}N=N.sibling}if(!A)throw Error(s(189))}}if(c.alternate!==d)throw Error(s(190))}if(c.tag!==3)throw Error(s(188));return c.stateNode.current===c?r:o}function f(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=f(r),o!==null)return o;r=r.sibling}return null}var m=Object.assign,_=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),L=Symbol.for("react.consumer"),O=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),j=Symbol.iterator;function F(r){return r===null||typeof r!="object"?null:(r=j&&r[j]||r["@@iterator"],typeof r=="function"?r:null)}var k=Symbol.for("react.client.reference");function nt(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===k?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case S:return"Fragment";case R:return"Profiler";case T:return"StrictMode";case B:return"Suspense";case z:return"SuspenseList";case C:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case E:return"Portal";case O:return(r.displayName||"Context")+".Provider";case L:return(r._context.displayName||"Context")+".Consumer";case H:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case D:return o=r.displayName||null,o!==null?o:nt(r.type)||"Memo";case I:o=r._payload,r=r._init;try{return nt(r(o))}catch{}}return null}var bt=Array.isArray,Y=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,at=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,mt={pending:!1,data:null,method:null,action:null},Dt=[],U=-1;function st(r){return{current:r}}function ht(r){0>U||(r.current=Dt[U],Dt[U]=null,U--)}function dt(r,o){U++,Dt[U]=r.current,r.current=o}var yt=st(null),kt=st(null),At=st(null),Ie=st(null);function te(r,o){switch(dt(At,o),dt(kt,r),dt(yt,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?lT(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=lT(o),r=cT(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}ht(yt),dt(yt,r)}function Fe(){ht(yt),ht(kt),ht(At)}function ur(r){r.memoizedState!==null&&dt(Ie,r);var o=yt.current,c=cT(o,r.type);o!==c&&(dt(kt,r),dt(yt,c))}function Ks(r){kt.current===r&&(ht(yt),ht(kt)),Ie.current===r&&(ht(Ie),$u._currentValue=mt)}var Ti=Object.prototype.hasOwnProperty,wi=n.unstable_scheduleCallback,hr=n.unstable_cancelCallback,tp=n.unstable_shouldYield,$c=n.unstable_requestPaint,Kn=n.unstable_now,Md=n.unstable_getCurrentPriorityLevel,nn=n.unstable_ImmediatePriority,hn=n.unstable_UserBlockingPriority,Si=n.unstable_NormalPriority,ep=n.unstable_LowPriority,Wc=n.unstable_IdlePriority,np=n.log,Oa=n.unstable_setDisableYieldValue,dr=null,In=null;function _s(r){if(typeof np=="function"&&Oa(r),In&&typeof In.setStrictMode=="function")try{In.setStrictMode(dr,r)}catch{}}var Fn=Math.clz32?Math.clz32:kd,sp=Math.log,Od=Math.LN2;function kd(r){return r>>>=0,r===0?32:31-(sp(r)/Od|0)|0}var Qs=256,fr=4194304;function Os(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function ys(r,o,c){var d=r.pendingLanes;if(d===0)return 0;var p=0,b=r.suspendedLanes,A=r.pingedLanes;r=r.warmLanes;var N=d&134217727;return N!==0?(d=N&~b,d!==0?p=Os(d):(A&=N,A!==0?p=Os(A):c||(c=N&~r,c!==0&&(p=Os(c))))):(N=d&~b,N!==0?p=Os(N):A!==0?p=Os(A):c||(c=d&~r,c!==0&&(p=Os(c)))),p===0?0:o!==0&&o!==p&&(o&b)===0&&(b=p&-p,c=o&-o,b>=c||b===32&&(c&4194048)!==0)?o:p}function mr(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function sl(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yc(){var r=Qs;return Qs<<=1,(Qs&4194048)===0&&(Qs=256),r}function gr(){var r=fr;return fr<<=1,(fr&62914560)===0&&(fr=4194304),r}function il(r){for(var o=[],c=0;31>c;c++)o.push(r);return o}function Ue(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Vd(r,o,c,d,p,b){var A=r.pendingLanes;r.pendingLanes=c,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=c,r.entangledLanes&=c,r.errorRecoveryDisabledLanes&=c,r.shellSuspendCounter=0;var N=r.entanglements,q=r.expirationTimes,X=r.hiddenUpdates;for(c=A&~c;0<c;){var it=31-Fn(c),ot=1<<it;N[it]=0,q[it]=-1;var Z=X[it];if(Z!==null)for(X[it]=null,it=0;it<Z.length;it++){var J=Z[it];J!==null&&(J.lane&=-536870913)}c&=~ot}d!==0&&pr(r,d,0),b!==0&&p===0&&r.tag!==0&&(r.suspendedLanes|=b&~(A&~o))}function pr(r,o,c){r.pendingLanes|=o,r.suspendedLanes&=~o;var d=31-Fn(o);r.entangledLanes|=o,r.entanglements[d]=r.entanglements[d]|1073741824|c&4194090}function _r(r,o){var c=r.entangledLanes|=o;for(r=r.entanglements;c;){var d=31-Fn(c),p=1<<d;p&o|r[d]&o&&(r[d]|=o),c&=~p}}function Kc(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Qc(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Ai(){var r=at.p;return r!==0?r:(r=window.event,r===void 0?32:RT(r.type))}function ip(r,o){var c=at.p;try{return at.p=r,o()}finally{at.p=c}}var Xs=Math.random().toString(36).slice(2),ze="__reactFiber$"+Xs,bn="__reactProps$"+Xs,Ii="__reactContainer$"+Xs,ka="__reactEvents$"+Xs,Va="__reactListeners$"+Xs,rp="__reactHandles$"+Xs,ks="__reactResources$"+Xs,yr="__reactMarker$"+Xs;function rl(r){delete r[ze],delete r[bn],delete r[ka],delete r[Va],delete r[rp]}function Zs(r){var o=r[ze];if(o)return o;for(var c=r.parentNode;c;){if(o=c[Ii]||c[ze]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(r=fT(r);r!==null;){if(c=r[ze])return c;r=fT(r)}return o}r=c,c=r.parentNode}return null}function Js(r){if(r=r[ze]||r[Ii]){var o=r.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return r}return null}function br(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(s(33))}function xr(r){var o=r[ks];return o||(o=r[ks]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function He(r){r[yr]=!0}var Pd=new Set,Pa={};function ti(r,o){ei(r,o),ei(r+"Capture",o)}function ei(r,o){for(Pa[r]=o,r=0;r<o.length;r++)Pd.add(o[r])}var La=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ni={},al={};function ap(r){return Ti.call(al,r)?!0:Ti.call(ni,r)?!1:La.test(r)?al[r]=!0:(ni[r]=!0,!1)}function ja(r,o,c){if(ap(o))if(c===null)r.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var d=o.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+c)}}function Ba(r,o,c){if(c===null)r.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+c)}}function bs(r,o,c,d){if(d===null)r.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(c);return}r.setAttributeNS(o,c,""+d)}}var Fa,ol;function Ri(r){if(Fa===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);Fa=o&&o[1]||"",ol=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Fa+r+ol}var ll=!1;function cl(r,o){if(!r||ll)return"";ll=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(o){var ot=function(){throw Error()};if(Object.defineProperty(ot.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ot,[])}catch(J){var Z=J}Reflect.construct(r,[],ot)}else{try{ot.call()}catch(J){Z=J}r.call(ot.prototype)}}else{try{throw Error()}catch(J){Z=J}(ot=r())&&typeof ot.catch=="function"&&ot.catch(function(){})}}catch(J){if(J&&Z&&typeof J.stack=="string")return[J.stack,Z.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=d.DetermineComponentFrameRoot(),A=b[0],N=b[1];if(A&&N){var q=A.split(`
`),X=N.split(`
`);for(p=d=0;d<q.length&&!q[d].includes("DetermineComponentFrameRoot");)d++;for(;p<X.length&&!X[p].includes("DetermineComponentFrameRoot");)p++;if(d===q.length||p===X.length)for(d=q.length-1,p=X.length-1;1<=d&&0<=p&&q[d]!==X[p];)p--;for(;1<=d&&0<=p;d--,p--)if(q[d]!==X[p]){if(d!==1||p!==1)do if(d--,p--,0>p||q[d]!==X[p]){var it=`
`+q[d].replace(" at new "," at ");return r.displayName&&it.includes("<anonymous>")&&(it=it.replace("<anonymous>",r.displayName)),it}while(1<=d&&0<=p);break}}}finally{ll=!1,Error.prepareStackTrace=c}return(c=r?r.displayName||r.name:"")?Ri(c):""}function op(r){switch(r.tag){case 26:case 27:case 5:return Ri(r.type);case 16:return Ri("Lazy");case 13:return Ri("Suspense");case 19:return Ri("SuspenseList");case 0:case 15:return cl(r.type,!1);case 11:return cl(r.type.render,!1);case 1:return cl(r.type,!0);case 31:return Ri("Activity");default:return""}}function Vs(r){try{var o="";do o+=op(r),r=r.return;while(r);return o}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function ke(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function vr(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ua(r){var o=vr(r)?"checked":"value",c=Object.getOwnPropertyDescriptor(r.constructor.prototype,o),d=""+r[o];if(!r.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,b=c.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return p.call(this)},set:function(A){d=""+A,b.call(this,A)}}),Object.defineProperty(r,o,{enumerable:c.enumerable}),{getValue:function(){return d},setValue:function(A){d=""+A},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function Er(r){r._valueTracker||(r._valueTracker=Ua(r))}function me(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var c=o.getValue(),d="";return r&&(d=vr(r)?r.checked?"true":"false":r.value),r=d,r!==c?(o.setValue(r),!0):!1}function Di(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var za=/[\n"\\]/g;function dn(r){return r.replace(za,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Xc(r,o,c,d,p,b,A,N){r.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?r.type=A:r.removeAttribute("type"),o!=null?A==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+ke(o)):r.value!==""+ke(o)&&(r.value=""+ke(o)):A!=="submit"&&A!=="reset"||r.removeAttribute("value"),o!=null?Jc(r,A,ke(o)):c!=null?Jc(r,A,ke(c)):d!=null&&r.removeAttribute("value"),p==null&&b!=null&&(r.defaultChecked=!!b),p!=null&&(r.checked=p&&typeof p!="function"&&typeof p!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?r.name=""+ke(N):r.removeAttribute("name")}function Zc(r,o,c,d,p,b,A,N){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(r.type=b),o!=null||c!=null){if(!(b!=="submit"&&b!=="reset"||o!=null))return;c=c!=null?""+ke(c):"",o=o!=null?""+ke(o):c,N||o===r.value||(r.value=o),r.defaultValue=o}d=d??p,d=typeof d!="function"&&typeof d!="symbol"&&!!d,r.checked=N?r.checked:!!d,r.defaultChecked=!!d,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(r.name=A)}function Jc(r,o,c){o==="number"&&Di(r.ownerDocument)===r||r.defaultValue===""+c||(r.defaultValue=""+c)}function Tr(r,o,c,d){if(r=r.options,o){o={};for(var p=0;p<c.length;p++)o["$"+c[p]]=!0;for(c=0;c<r.length;c++)p=o.hasOwnProperty("$"+r[c].value),r[c].selected!==p&&(r[c].selected=p),p&&d&&(r[c].defaultSelected=!0)}else{for(c=""+ke(c),o=null,p=0;p<r.length;p++){if(r[p].value===c){r[p].selected=!0,d&&(r[p].defaultSelected=!0);return}o!==null||r[p].disabled||(o=r[p])}o!==null&&(o.selected=!0)}}function Ld(r,o,c){if(o!=null&&(o=""+ke(o),o!==r.value&&(r.value=o),c==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=c!=null?""+ke(c):""}function jd(r,o,c,d){if(o==null){if(d!=null){if(c!=null)throw Error(s(92));if(bt(d)){if(1<d.length)throw Error(s(93));d=d[0]}c=d}c==null&&(c=""),o=c}c=ke(o),r.defaultValue=c,d=r.textContent,d===c&&d!==""&&d!==null&&(r.value=d)}function xs(r,o){if(o){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=o;return}}r.textContent=o}var Ni=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function tu(r,o,c){var d=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":d?r.setProperty(o,c):typeof c!="number"||c===0||Ni.has(o)?o==="float"?r.cssFloat=c:r[o]=(""+c).trim():r[o]=c+"px"}function eu(r,o,c){if(o!=null&&typeof o!="object")throw Error(s(62));if(r=r.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||o!=null&&o.hasOwnProperty(d)||(d.indexOf("--")===0?r.setProperty(d,""):d==="float"?r.cssFloat="":r[d]="");for(var p in o)d=o[p],o.hasOwnProperty(p)&&c[p]!==d&&tu(r,p,d)}else for(var b in o)o.hasOwnProperty(b)&&tu(r,b,o[b])}function ul(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Fd=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ps(r){return Fd.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var nu=null;function su(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var wr=null,Un=null;function Ud(r){var o=Js(r);if(o&&(r=o.stateNode)){var c=r[bn]||null;t:switch(r=o.stateNode,o.type){case"input":if(Xc(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+dn(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var d=c[o];if(d!==r&&d.form===r.form){var p=d[bn]||null;if(!p)throw Error(s(90));Xc(d,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(o=0;o<c.length;o++)d=c[o],d.form===r.form&&me(d)}break t;case"textarea":Ld(r,c.value,c.defaultValue);break t;case"select":o=c.value,o!=null&&Tr(r,!!c.multiple,o,!1)}}}var Ha=!1;function qa(r,o,c){if(Ha)return r(o,c);Ha=!0;try{var d=r(o);return d}finally{if(Ha=!1,(wr!==null||Un!==null)&&(Cf(),wr&&(o=wr,r=Un,Un=wr=null,Ud(o),r)))for(o=0;o<r.length;o++)Ud(r[o])}}function Sr(r,o){var c=r.stateNode;if(c===null)return null;var d=c[bn]||null;if(d===null)return null;c=d[o];t:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(r=r.type,d=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!d;break t;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(s(231,o,typeof c));return c}var zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ci=!1;if(zn)try{var Ar={};Object.defineProperty(Ar,"passive",{get:function(){Ci=!0}}),window.addEventListener("test",Ar,Ar),window.removeEventListener("test",Ar,Ar)}catch{Ci=!1}var vs=null,be=null,hl=null;function zd(){if(hl)return hl;var r,o=be,c=o.length,d,p="value"in vs?vs.value:vs.textContent,b=p.length;for(r=0;r<c&&o[r]===p[r];r++);var A=c-r;for(d=1;d<=A&&o[c-d]===p[b-d];d++);return hl=p.slice(r,1<d?1-d:void 0)}function Ga(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function $a(){return!0}function iu(){return!1}function sn(r){function o(c,d,p,b,A){this._reactName=c,this._targetInst=p,this.type=d,this.nativeEvent=b,this.target=A,this.currentTarget=null;for(var N in r)r.hasOwnProperty(N)&&(c=r[N],this[N]=c?c(b):b[N]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?$a:iu,this.isPropagationStopped=iu,this}return m(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=$a)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=$a)},persist:function(){},isPersistent:$a}),o}var Rn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wa=sn(Rn),Ya=m({},Rn,{view:0,detail:0}),Ka=sn(Ya),dl,Qa,si,Xa=m({},Ya,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gl,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==si&&(si&&r.type==="mousemove"?(dl=r.screenX-si.screenX,Qa=r.screenY-si.screenY):Qa=dl=0,si=r),dl)},movementY:function(r){return"movementY"in r?r.movementY:Qa}}),Za=sn(Xa),lp=m({},Xa,{dataTransfer:0}),Hd=sn(lp),Ja=m({},Ya,{relatedTarget:0}),fl=sn(Ja),qd=m({},Rn,{animationName:0,elapsedTime:0,pseudoElement:0}),ru=sn(qd),au=m({},Rn,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Gd=sn(au),ml=m({},Rn,{data:0}),ou=sn(ml),$d={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yd(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=Wd[r])?!!o[r]:!1}function gl(){return Yd}var Kd=m({},Ya,{key:function(r){if(r.key){var o=$d[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=Ga(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Mi[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gl,charCode:function(r){return r.type==="keypress"?Ga(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ga(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),pl=sn(Kd),Hn=m({},Xa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lu=sn(Hn),Qd=m({},Ya,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gl}),Ir=sn(Qd),g=m({},Rn,{propertyName:0,elapsedTime:0,pseudoElement:0}),v=sn(g),w=m({},Xa,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),V=sn(w),Q=m({},Rn,{newState:0,oldState:0}),et=sn(Q),gt=[9,13,27,32],Pt=zn&&"CompositionEvent"in window,we=null;zn&&"documentMode"in document&&(we=document.documentMode);var le=zn&&"TextEvent"in window&&!we,qe=zn&&(!Pt||we&&8<we&&11>=we),is=" ",ii=!1;function Ls(r,o){switch(r){case"keyup":return gt.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function js(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Bs=!1;function cu(r,o){switch(r){case"compositionend":return js(o);case"keypress":return o.which!==32?null:(ii=!0,is);case"textInput":return r=o.data,r===is&&ii?null:r;default:return null}}function xN(r,o){if(Bs)return r==="compositionend"||!Pt&&Ls(r,o)?(r=zd(),hl=be=vs=null,Bs=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return qe&&o.locale!=="ko"?null:o.data;default:return null}}var vN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ex(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!vN[r.type]:o==="textarea"}function Tx(r,o,c,d){wr?Un?Un.push(d):Un=[d]:wr=d,o=Lf(o,"onChange"),0<o.length&&(c=new Wa("onChange","change",null,c,d),r.push({event:c,listeners:o}))}var uu=null,hu=null;function EN(r){sT(r,0)}function Xd(r){var o=br(r);if(me(o))return r}function wx(r,o){if(r==="change")return o}var Sx=!1;if(zn){var cp;if(zn){var up="oninput"in document;if(!up){var Ax=document.createElement("div");Ax.setAttribute("oninput","return;"),up=typeof Ax.oninput=="function"}cp=up}else cp=!1;Sx=cp&&(!document.documentMode||9<document.documentMode)}function Ix(){uu&&(uu.detachEvent("onpropertychange",Rx),hu=uu=null)}function Rx(r){if(r.propertyName==="value"&&Xd(hu)){var o=[];Tx(o,hu,r,su(r)),qa(EN,o)}}function TN(r,o,c){r==="focusin"?(Ix(),uu=o,hu=c,uu.attachEvent("onpropertychange",Rx)):r==="focusout"&&Ix()}function wN(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Xd(hu)}function SN(r,o){if(r==="click")return Xd(o)}function AN(r,o){if(r==="input"||r==="change")return Xd(o)}function IN(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var rs=typeof Object.is=="function"?Object.is:IN;function du(r,o){if(rs(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var c=Object.keys(r),d=Object.keys(o);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var p=c[d];if(!Ti.call(o,p)||!rs(r[p],o[p]))return!1}return!0}function Dx(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Nx(r,o){var c=Dx(r);r=0;for(var d;c;){if(c.nodeType===3){if(d=r+c.textContent.length,r<=o&&d>=o)return{node:c,offset:o-r};r=d}t:{for(;c;){if(c.nextSibling){c=c.nextSibling;break t}c=c.parentNode}c=void 0}c=Dx(c)}}function Cx(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?Cx(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function Mx(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=Di(r.document);o instanceof r.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)r=o.contentWindow;else break;o=Di(r.document)}return o}function hp(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var RN=zn&&"documentMode"in document&&11>=document.documentMode,_l=null,dp=null,fu=null,fp=!1;function Ox(r,o,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;fp||_l==null||_l!==Di(d)||(d=_l,"selectionStart"in d&&hp(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),fu&&du(fu,d)||(fu=d,d=Lf(dp,"onSelect"),0<d.length&&(o=new Wa("onSelect","select",null,o,c),r.push({event:o,listeners:d}),o.target=_l)))}function to(r,o){var c={};return c[r.toLowerCase()]=o.toLowerCase(),c["Webkit"+r]="webkit"+o,c["Moz"+r]="moz"+o,c}var yl={animationend:to("Animation","AnimationEnd"),animationiteration:to("Animation","AnimationIteration"),animationstart:to("Animation","AnimationStart"),transitionrun:to("Transition","TransitionRun"),transitionstart:to("Transition","TransitionStart"),transitioncancel:to("Transition","TransitionCancel"),transitionend:to("Transition","TransitionEnd")},mp={},kx={};zn&&(kx=document.createElement("div").style,"AnimationEvent"in window||(delete yl.animationend.animation,delete yl.animationiteration.animation,delete yl.animationstart.animation),"TransitionEvent"in window||delete yl.transitionend.transition);function eo(r){if(mp[r])return mp[r];if(!yl[r])return r;var o=yl[r],c;for(c in o)if(o.hasOwnProperty(c)&&c in kx)return mp[r]=o[c];return r}var Vx=eo("animationend"),Px=eo("animationiteration"),Lx=eo("animationstart"),DN=eo("transitionrun"),NN=eo("transitionstart"),CN=eo("transitioncancel"),jx=eo("transitionend"),Bx=new Map,gp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");gp.push("scrollEnd");function Fs(r,o){Bx.set(r,o),ti(o,[r])}var Fx=new WeakMap;function Es(r,o){if(typeof r=="object"&&r!==null){var c=Fx.get(r);return c!==void 0?c:(o={value:r,source:o,stack:Vs(o)},Fx.set(r,o),o)}return{value:r,source:o,stack:Vs(o)}}var Ts=[],bl=0,pp=0;function Zd(){for(var r=bl,o=pp=bl=0;o<r;){var c=Ts[o];Ts[o++]=null;var d=Ts[o];Ts[o++]=null;var p=Ts[o];Ts[o++]=null;var b=Ts[o];if(Ts[o++]=null,d!==null&&p!==null){var A=d.pending;A===null?p.next=p:(p.next=A.next,A.next=p),d.pending=p}b!==0&&Ux(c,p,b)}}function Jd(r,o,c,d){Ts[bl++]=r,Ts[bl++]=o,Ts[bl++]=c,Ts[bl++]=d,pp|=d,r.lanes|=d,r=r.alternate,r!==null&&(r.lanes|=d)}function _p(r,o,c,d){return Jd(r,o,c,d),tf(r)}function xl(r,o){return Jd(r,null,null,o),tf(r)}function Ux(r,o,c){r.lanes|=c;var d=r.alternate;d!==null&&(d.lanes|=c);for(var p=!1,b=r.return;b!==null;)b.childLanes|=c,d=b.alternate,d!==null&&(d.childLanes|=c),b.tag===22&&(r=b.stateNode,r===null||r._visibility&1||(p=!0)),r=b,b=b.return;return r.tag===3?(b=r.stateNode,p&&o!==null&&(p=31-Fn(c),r=b.hiddenUpdates,d=r[p],d===null?r[p]=[o]:d.push(o),o.lane=c|536870912),b):null}function tf(r){if(50<ju)throw ju=0,T_=null,Error(s(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var vl={};function MN(r,o,c,d){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function as(r,o,c,d){return new MN(r,o,c,d)}function yp(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Oi(r,o){var c=r.alternate;return c===null?(c=as(r.tag,o,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=o,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&65011712,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,o=r.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c.refCleanup=r.refCleanup,c}function zx(r,o){r.flags&=65011714;var c=r.alternate;return c===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=c.childLanes,r.lanes=c.lanes,r.child=c.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=c.memoizedProps,r.memoizedState=c.memoizedState,r.updateQueue=c.updateQueue,r.type=c.type,o=c.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function ef(r,o,c,d,p,b){var A=0;if(d=r,typeof r=="function")yp(r)&&(A=1);else if(typeof r=="string")A=kC(r,c,yt.current)?26:r==="html"||r==="head"||r==="body"?27:5;else t:switch(r){case C:return r=as(31,c,o,p),r.elementType=C,r.lanes=b,r;case S:return no(c.children,p,b,o);case T:A=8,p|=24;break;case R:return r=as(12,c,o,p|2),r.elementType=R,r.lanes=b,r;case B:return r=as(13,c,o,p),r.elementType=B,r.lanes=b,r;case z:return r=as(19,c,o,p),r.elementType=z,r.lanes=b,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case M:case O:A=10;break t;case L:A=9;break t;case H:A=11;break t;case D:A=14;break t;case I:A=16,d=null;break t}A=29,c=Error(s(130,r===null?"null":typeof r,"")),d=null}return o=as(A,c,o,p),o.elementType=r,o.type=d,o.lanes=b,o}function no(r,o,c,d){return r=as(7,r,d,o),r.lanes=c,r}function bp(r,o,c){return r=as(6,r,null,o),r.lanes=c,r}function xp(r,o,c){return o=as(4,r.children!==null?r.children:[],r.key,o),o.lanes=c,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var El=[],Tl=0,nf=null,sf=0,ws=[],Ss=0,so=null,ki=1,Vi="";function io(r,o){El[Tl++]=sf,El[Tl++]=nf,nf=r,sf=o}function Hx(r,o,c){ws[Ss++]=ki,ws[Ss++]=Vi,ws[Ss++]=so,so=r;var d=ki;r=Vi;var p=32-Fn(d)-1;d&=~(1<<p),c+=1;var b=32-Fn(o)+p;if(30<b){var A=p-p%5;b=(d&(1<<A)-1).toString(32),d>>=A,p-=A,ki=1<<32-Fn(o)+p|c<<p|d,Vi=b+r}else ki=1<<b|c<<p|d,Vi=r}function vp(r){r.return!==null&&(io(r,1),Hx(r,1,0))}function Ep(r){for(;r===nf;)nf=El[--Tl],El[Tl]=null,sf=El[--Tl],El[Tl]=null;for(;r===so;)so=ws[--Ss],ws[Ss]=null,Vi=ws[--Ss],ws[Ss]=null,ki=ws[--Ss],ws[Ss]=null}var qn=null,Pe=null,ae=!1,ro=null,ri=!1,Tp=Error(s(519));function ao(r){var o=Error(s(418,""));throw pu(Es(o,r)),Tp}function qx(r){var o=r.stateNode,c=r.type,d=r.memoizedProps;switch(o[ze]=r,o[bn]=d,c){case"dialog":$t("cancel",o),$t("close",o);break;case"iframe":case"object":case"embed":$t("load",o);break;case"video":case"audio":for(c=0;c<Fu.length;c++)$t(Fu[c],o);break;case"source":$t("error",o);break;case"img":case"image":case"link":$t("error",o),$t("load",o);break;case"details":$t("toggle",o);break;case"input":$t("invalid",o),Zc(o,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0),Er(o);break;case"select":$t("invalid",o);break;case"textarea":$t("invalid",o),jd(o,d.value,d.defaultValue,d.children),Er(o)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||d.suppressHydrationWarning===!0||oT(o.textContent,c)?(d.popover!=null&&($t("beforetoggle",o),$t("toggle",o)),d.onScroll!=null&&$t("scroll",o),d.onScrollEnd!=null&&$t("scrollend",o),d.onClick!=null&&(o.onclick=jf),o=!0):o=!1,o||ao(r)}function Gx(r){for(qn=r.return;qn;)switch(qn.tag){case 5:case 13:ri=!1;return;case 27:case 3:ri=!0;return;default:qn=qn.return}}function mu(r){if(r!==qn)return!1;if(!ae)return Gx(r),ae=!0,!1;var o=r.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=r.type,c=!(c!=="form"&&c!=="button")||B_(r.type,r.memoizedProps)),c=!c),c&&Pe&&ao(r),Gx(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));t:{for(r=r.nextSibling,o=0;r;){if(r.nodeType===8)if(c=r.data,c==="/$"){if(o===0){Pe=zs(r.nextSibling);break t}o--}else c!=="$"&&c!=="$!"&&c!=="$?"||o++;r=r.nextSibling}Pe=null}}else o===27?(o=Pe,Hr(r.type)?(r=H_,H_=null,Pe=r):Pe=o):Pe=qn?zs(r.stateNode.nextSibling):null;return!0}function gu(){Pe=qn=null,ae=!1}function $x(){var r=ro;return r!==null&&(Zn===null?Zn=r:Zn.push.apply(Zn,r),ro=null),r}function pu(r){ro===null?ro=[r]:ro.push(r)}var wp=st(null),oo=null,Pi=null;function Rr(r,o,c){dt(wp,o._currentValue),o._currentValue=c}function Li(r){r._currentValue=wp.current,ht(wp)}function Sp(r,o,c){for(;r!==null;){var d=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,d!==null&&(d.childLanes|=o)):d!==null&&(d.childLanes&o)!==o&&(d.childLanes|=o),r===c)break;r=r.return}}function Ap(r,o,c,d){var p=r.child;for(p!==null&&(p.return=r);p!==null;){var b=p.dependencies;if(b!==null){var A=p.child;b=b.firstContext;t:for(;b!==null;){var N=b;b=p;for(var q=0;q<o.length;q++)if(N.context===o[q]){b.lanes|=c,N=b.alternate,N!==null&&(N.lanes|=c),Sp(b.return,c,r),d||(A=null);break t}b=N.next}}else if(p.tag===18){if(A=p.return,A===null)throw Error(s(341));A.lanes|=c,b=A.alternate,b!==null&&(b.lanes|=c),Sp(A,c,r),A=null}else A=p.child;if(A!==null)A.return=p;else for(A=p;A!==null;){if(A===r){A=null;break}if(p=A.sibling,p!==null){p.return=A.return,A=p;break}A=A.return}p=A}}function _u(r,o,c,d){r=null;for(var p=o,b=!1;p!==null;){if(!b){if((p.flags&524288)!==0)b=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var A=p.alternate;if(A===null)throw Error(s(387));if(A=A.memoizedProps,A!==null){var N=p.type;rs(p.pendingProps.value,A.value)||(r!==null?r.push(N):r=[N])}}else if(p===Ie.current){if(A=p.alternate,A===null)throw Error(s(387));A.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(r!==null?r.push($u):r=[$u])}p=p.return}r!==null&&Ap(o,r,c,d),o.flags|=262144}function rf(r){for(r=r.firstContext;r!==null;){if(!rs(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function lo(r){oo=r,Pi=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Dn(r){return Wx(oo,r)}function af(r,o){return oo===null&&lo(r),Wx(r,o)}function Wx(r,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},Pi===null){if(r===null)throw Error(s(308));Pi=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else Pi=Pi.next=o;return c}var ON=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(c,d){r.push(d)}};this.abort=function(){o.aborted=!0,r.forEach(function(c){return c()})}},kN=n.unstable_scheduleCallback,VN=n.unstable_NormalPriority,rn={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ip(){return{controller:new ON,data:new Map,refCount:0}}function yu(r){r.refCount--,r.refCount===0&&kN(VN,function(){r.controller.abort()})}var bu=null,Rp=0,wl=0,Sl=null;function PN(r,o){if(bu===null){var c=bu=[];Rp=0,wl=N_(),Sl={status:"pending",value:void 0,then:function(d){c.push(d)}}}return Rp++,o.then(Yx,Yx),o}function Yx(){if(--Rp===0&&bu!==null){Sl!==null&&(Sl.status="fulfilled");var r=bu;bu=null,wl=0,Sl=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function LN(r,o){var c=[],d={status:"pending",value:null,reason:null,then:function(p){c.push(p)}};return r.then(function(){d.status="fulfilled",d.value=o;for(var p=0;p<c.length;p++)(0,c[p])(o)},function(p){for(d.status="rejected",d.reason=p,p=0;p<c.length;p++)(0,c[p])(void 0)}),d}var Kx=Y.S;Y.S=function(r,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&PN(r,o),Kx!==null&&Kx(r,o)};var co=st(null);function Dp(){var r=co.current;return r!==null?r:xe.pooledCache}function of(r,o){o===null?dt(co,co.current):dt(co,o.pool)}function Qx(){var r=Dp();return r===null?null:{parent:rn._currentValue,pool:r}}var xu=Error(s(460)),Xx=Error(s(474)),lf=Error(s(542)),Np={then:function(){}};function Zx(r){return r=r.status,r==="fulfilled"||r==="rejected"}function cf(){}function Jx(r,o,c){switch(c=r[c],c===void 0?r.push(o):c!==o&&(o.then(cf,cf),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,ev(r),r;default:if(typeof o.status=="string")o.then(cf,cf);else{if(r=xe,r!==null&&100<r.shellSuspendCounter)throw Error(s(482));r=o,r.status="pending",r.then(function(d){if(o.status==="pending"){var p=o;p.status="fulfilled",p.value=d}},function(d){if(o.status==="pending"){var p=o;p.status="rejected",p.reason=d}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,ev(r),r}throw vu=o,xu}}var vu=null;function tv(){if(vu===null)throw Error(s(459));var r=vu;return vu=null,r}function ev(r){if(r===xu||r===lf)throw Error(s(483))}var Dr=!1;function Cp(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Mp(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Nr(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Cr(r,o,c){var d=r.updateQueue;if(d===null)return null;if(d=d.shared,(ce&2)!==0){var p=d.pending;return p===null?o.next=o:(o.next=p.next,p.next=o),d.pending=o,o=tf(r),Ux(r,null,c),o}return Jd(r,d,o,c),tf(r)}function Eu(r,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var d=o.lanes;d&=r.pendingLanes,c|=d,o.lanes=c,_r(r,c)}}function Op(r,o){var c=r.updateQueue,d=r.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var p=null,b=null;if(c=c.firstBaseUpdate,c!==null){do{var A={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};b===null?p=b=A:b=b.next=A,c=c.next}while(c!==null);b===null?p=b=o:b=b.next=o}else p=b=o;c={baseState:d.baseState,firstBaseUpdate:p,lastBaseUpdate:b,shared:d.shared,callbacks:d.callbacks},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=o:r.next=o,c.lastBaseUpdate=o}var kp=!1;function Tu(){if(kp){var r=Sl;if(r!==null)throw r}}function wu(r,o,c,d){kp=!1;var p=r.updateQueue;Dr=!1;var b=p.firstBaseUpdate,A=p.lastBaseUpdate,N=p.shared.pending;if(N!==null){p.shared.pending=null;var q=N,X=q.next;q.next=null,A===null?b=X:A.next=X,A=q;var it=r.alternate;it!==null&&(it=it.updateQueue,N=it.lastBaseUpdate,N!==A&&(N===null?it.firstBaseUpdate=X:N.next=X,it.lastBaseUpdate=q))}if(b!==null){var ot=p.baseState;A=0,it=X=q=null,N=b;do{var Z=N.lane&-536870913,J=Z!==N.lane;if(J?(Zt&Z)===Z:(d&Z)===Z){Z!==0&&Z===wl&&(kp=!0),it!==null&&(it=it.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});t:{var Ot=r,Ct=N;Z=o;var _e=c;switch(Ct.tag){case 1:if(Ot=Ct.payload,typeof Ot=="function"){ot=Ot.call(_e,ot,Z);break t}ot=Ot;break t;case 3:Ot.flags=Ot.flags&-65537|128;case 0:if(Ot=Ct.payload,Z=typeof Ot=="function"?Ot.call(_e,ot,Z):Ot,Z==null)break t;ot=m({},ot,Z);break t;case 2:Dr=!0}}Z=N.callback,Z!==null&&(r.flags|=64,J&&(r.flags|=8192),J=p.callbacks,J===null?p.callbacks=[Z]:J.push(Z))}else J={lane:Z,tag:N.tag,payload:N.payload,callback:N.callback,next:null},it===null?(X=it=J,q=ot):it=it.next=J,A|=Z;if(N=N.next,N===null){if(N=p.shared.pending,N===null)break;J=N,N=J.next,J.next=null,p.lastBaseUpdate=J,p.shared.pending=null}}while(!0);it===null&&(q=ot),p.baseState=q,p.firstBaseUpdate=X,p.lastBaseUpdate=it,b===null&&(p.shared.lanes=0),Br|=A,r.lanes=A,r.memoizedState=ot}}function nv(r,o){if(typeof r!="function")throw Error(s(191,r));r.call(o)}function sv(r,o){var c=r.callbacks;if(c!==null)for(r.callbacks=null,r=0;r<c.length;r++)nv(c[r],o)}var Al=st(null),uf=st(0);function iv(r,o){r=qi,dt(uf,r),dt(Al,o),qi=r|o.baseLanes}function Vp(){dt(uf,qi),dt(Al,Al.current)}function Pp(){qi=uf.current,ht(Al),ht(uf)}var Mr=0,zt=null,ge=null,Xe=null,hf=!1,Il=!1,uo=!1,df=0,Su=0,Rl=null,jN=0;function Ge(){throw Error(s(321))}function Lp(r,o){if(o===null)return!1;for(var c=0;c<o.length&&c<r.length;c++)if(!rs(r[c],o[c]))return!1;return!0}function jp(r,o,c,d,p,b){return Mr=b,zt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Y.H=r===null||r.memoizedState===null?Uv:zv,uo=!1,b=c(d,p),uo=!1,Il&&(b=av(o,c,d,p)),rv(r),b}function rv(r){Y.H=yf;var o=ge!==null&&ge.next!==null;if(Mr=0,Xe=ge=zt=null,hf=!1,Su=0,Rl=null,o)throw Error(s(300));r===null||fn||(r=r.dependencies,r!==null&&rf(r)&&(fn=!0))}function av(r,o,c,d){zt=r;var p=0;do{if(Il&&(Rl=null),Su=0,Il=!1,25<=p)throw Error(s(301));if(p+=1,Xe=ge=null,r.updateQueue!=null){var b=r.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}Y.H=GN,b=o(c,d)}while(Il);return b}function BN(){var r=Y.H,o=r.useState()[0];return o=typeof o.then=="function"?Au(o):o,r=r.useState()[0],(ge!==null?ge.memoizedState:null)!==r&&(zt.flags|=1024),o}function Bp(){var r=df!==0;return df=0,r}function Fp(r,o,c){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~c}function Up(r){if(hf){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}hf=!1}Mr=0,Xe=ge=zt=null,Il=!1,Su=df=0,Rl=null}function Qn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xe===null?zt.memoizedState=Xe=r:Xe=Xe.next=r,Xe}function Ze(){if(ge===null){var r=zt.alternate;r=r!==null?r.memoizedState:null}else r=ge.next;var o=Xe===null?zt.memoizedState:Xe.next;if(o!==null)Xe=o,ge=r;else{if(r===null)throw zt.alternate===null?Error(s(467)):Error(s(310));ge=r,r={memoizedState:ge.memoizedState,baseState:ge.baseState,baseQueue:ge.baseQueue,queue:ge.queue,next:null},Xe===null?zt.memoizedState=Xe=r:Xe=Xe.next=r}return Xe}function zp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Au(r){var o=Su;return Su+=1,Rl===null&&(Rl=[]),r=Jx(Rl,r,o),o=zt,(Xe===null?o.memoizedState:Xe.next)===null&&(o=o.alternate,Y.H=o===null||o.memoizedState===null?Uv:zv),r}function ff(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Au(r);if(r.$$typeof===O)return Dn(r)}throw Error(s(438,String(r)))}function Hp(r){var o=null,c=zt.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var d=zt.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(o={data:d.data.map(function(p){return p.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=zp(),zt.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(r),d=0;d<r;d++)c[d]=P;return o.index++,c}function ji(r,o){return typeof o=="function"?o(r):o}function mf(r){var o=Ze();return qp(o,ge,r)}function qp(r,o,c){var d=r.queue;if(d===null)throw Error(s(311));d.lastRenderedReducer=c;var p=r.baseQueue,b=d.pending;if(b!==null){if(p!==null){var A=p.next;p.next=b.next,b.next=A}o.baseQueue=p=b,d.pending=null}if(b=r.baseState,p===null)r.memoizedState=b;else{o=p.next;var N=A=null,q=null,X=o,it=!1;do{var ot=X.lane&-536870913;if(ot!==X.lane?(Zt&ot)===ot:(Mr&ot)===ot){var Z=X.revertLane;if(Z===0)q!==null&&(q=q.next={lane:0,revertLane:0,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null}),ot===wl&&(it=!0);else if((Mr&Z)===Z){X=X.next,Z===wl&&(it=!0);continue}else ot={lane:0,revertLane:X.revertLane,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},q===null?(N=q=ot,A=b):q=q.next=ot,zt.lanes|=Z,Br|=Z;ot=X.action,uo&&c(b,ot),b=X.hasEagerState?X.eagerState:c(b,ot)}else Z={lane:ot,revertLane:X.revertLane,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},q===null?(N=q=Z,A=b):q=q.next=Z,zt.lanes|=ot,Br|=ot;X=X.next}while(X!==null&&X!==o);if(q===null?A=b:q.next=N,!rs(b,r.memoizedState)&&(fn=!0,it&&(c=Sl,c!==null)))throw c;r.memoizedState=b,r.baseState=A,r.baseQueue=q,d.lastRenderedState=b}return p===null&&(d.lanes=0),[r.memoizedState,d.dispatch]}function Gp(r){var o=Ze(),c=o.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=r;var d=c.dispatch,p=c.pending,b=o.memoizedState;if(p!==null){c.pending=null;var A=p=p.next;do b=r(b,A.action),A=A.next;while(A!==p);rs(b,o.memoizedState)||(fn=!0),o.memoizedState=b,o.baseQueue===null&&(o.baseState=b),c.lastRenderedState=b}return[b,d]}function ov(r,o,c){var d=zt,p=Ze(),b=ae;if(b){if(c===void 0)throw Error(s(407));c=c()}else c=o();var A=!rs((ge||p).memoizedState,c);A&&(p.memoizedState=c,fn=!0),p=p.queue;var N=uv.bind(null,d,p,r);if(Iu(2048,8,N,[r]),p.getSnapshot!==o||A||Xe!==null&&Xe.memoizedState.tag&1){if(d.flags|=2048,Dl(9,gf(),cv.bind(null,d,p,c,o),null),xe===null)throw Error(s(349));b||(Mr&124)!==0||lv(d,o,c)}return c}function lv(r,o,c){r.flags|=16384,r={getSnapshot:o,value:c},o=zt.updateQueue,o===null?(o=zp(),zt.updateQueue=o,o.stores=[r]):(c=o.stores,c===null?o.stores=[r]:c.push(r))}function cv(r,o,c,d){o.value=c,o.getSnapshot=d,hv(o)&&dv(r)}function uv(r,o,c){return c(function(){hv(o)&&dv(r)})}function hv(r){var o=r.getSnapshot;r=r.value;try{var c=o();return!rs(r,c)}catch{return!0}}function dv(r){var o=xl(r,2);o!==null&&hs(o,r,2)}function $p(r){var o=Qn();if(typeof r=="function"){var c=r;if(r=c(),uo){_s(!0);try{c()}finally{_s(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ji,lastRenderedState:r},o}function fv(r,o,c,d){return r.baseState=c,qp(r,ge,typeof d=="function"?d:ji)}function FN(r,o,c,d,p){if(_f(r))throw Error(s(485));if(r=o.action,r!==null){var b={payload:p,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){b.listeners.push(A)}};Y.T!==null?c(!0):b.isTransition=!1,d(b),c=o.pending,c===null?(b.next=o.pending=b,mv(o,b)):(b.next=c.next,o.pending=c.next=b)}}function mv(r,o){var c=o.action,d=o.payload,p=r.state;if(o.isTransition){var b=Y.T,A={};Y.T=A;try{var N=c(p,d),q=Y.S;q!==null&&q(A,N),gv(r,o,N)}catch(X){Wp(r,o,X)}finally{Y.T=b}}else try{b=c(p,d),gv(r,o,b)}catch(X){Wp(r,o,X)}}function gv(r,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){pv(r,o,d)},function(d){return Wp(r,o,d)}):pv(r,o,c)}function pv(r,o,c){o.status="fulfilled",o.value=c,_v(o),r.state=c,o=r.pending,o!==null&&(c=o.next,c===o?r.pending=null:(c=c.next,o.next=c,mv(r,c)))}function Wp(r,o,c){var d=r.pending;if(r.pending=null,d!==null){d=d.next;do o.status="rejected",o.reason=c,_v(o),o=o.next;while(o!==d)}r.action=null}function _v(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function yv(r,o){return o}function bv(r,o){if(ae){var c=xe.formState;if(c!==null){t:{var d=zt;if(ae){if(Pe){e:{for(var p=Pe,b=ri;p.nodeType!==8;){if(!b){p=null;break e}if(p=zs(p.nextSibling),p===null){p=null;break e}}b=p.data,p=b==="F!"||b==="F"?p:null}if(p){Pe=zs(p.nextSibling),d=p.data==="F!";break t}}ao(d)}d=!1}d&&(o=c[0])}}return c=Qn(),c.memoizedState=c.baseState=o,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yv,lastRenderedState:o},c.queue=d,c=jv.bind(null,zt,d),d.dispatch=c,d=$p(!1),b=Zp.bind(null,zt,!1,d.queue),d=Qn(),p={state:o,dispatch:null,action:r,pending:null},d.queue=p,c=FN.bind(null,zt,p,b,c),p.dispatch=c,d.memoizedState=r,[o,c,!1]}function xv(r){var o=Ze();return vv(o,ge,r)}function vv(r,o,c){if(o=qp(r,o,yv)[0],r=mf(ji)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var d=Au(o)}catch(A){throw A===xu?lf:A}else d=o;o=Ze();var p=o.queue,b=p.dispatch;return c!==o.memoizedState&&(zt.flags|=2048,Dl(9,gf(),UN.bind(null,p,c),null)),[d,b,r]}function UN(r,o){r.action=o}function Ev(r){var o=Ze(),c=ge;if(c!==null)return vv(o,c,r);Ze(),o=o.memoizedState,c=Ze();var d=c.queue.dispatch;return c.memoizedState=r,[o,d,!1]}function Dl(r,o,c,d){return r={tag:r,create:c,deps:d,inst:o,next:null},o=zt.updateQueue,o===null&&(o=zp(),zt.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=r.next=r:(d=c.next,c.next=r,r.next=d,o.lastEffect=r),r}function gf(){return{destroy:void 0,resource:void 0}}function Tv(){return Ze().memoizedState}function pf(r,o,c,d){var p=Qn();d=d===void 0?null:d,zt.flags|=r,p.memoizedState=Dl(1|o,gf(),c,d)}function Iu(r,o,c,d){var p=Ze();d=d===void 0?null:d;var b=p.memoizedState.inst;ge!==null&&d!==null&&Lp(d,ge.memoizedState.deps)?p.memoizedState=Dl(o,b,c,d):(zt.flags|=r,p.memoizedState=Dl(1|o,b,c,d))}function wv(r,o){pf(8390656,8,r,o)}function Sv(r,o){Iu(2048,8,r,o)}function Av(r,o){return Iu(4,2,r,o)}function Iv(r,o){return Iu(4,4,r,o)}function Rv(r,o){if(typeof o=="function"){r=r();var c=o(r);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function Dv(r,o,c){c=c!=null?c.concat([r]):null,Iu(4,4,Rv.bind(null,o,r),c)}function Yp(){}function Nv(r,o){var c=Ze();o=o===void 0?null:o;var d=c.memoizedState;return o!==null&&Lp(o,d[1])?d[0]:(c.memoizedState=[r,o],r)}function Cv(r,o){var c=Ze();o=o===void 0?null:o;var d=c.memoizedState;if(o!==null&&Lp(o,d[1]))return d[0];if(d=r(),uo){_s(!0);try{r()}finally{_s(!1)}}return c.memoizedState=[d,o],d}function Kp(r,o,c){return c===void 0||(Mr&1073741824)!==0?r.memoizedState=o:(r.memoizedState=c,r=kE(),zt.lanes|=r,Br|=r,c)}function Mv(r,o,c,d){return rs(c,o)?c:Al.current!==null?(r=Kp(r,c,d),rs(r,o)||(fn=!0),r):(Mr&42)===0?(fn=!0,r.memoizedState=c):(r=kE(),zt.lanes|=r,Br|=r,o)}function Ov(r,o,c,d,p){var b=at.p;at.p=b!==0&&8>b?b:8;var A=Y.T,N={};Y.T=N,Zp(r,!1,o,c);try{var q=p(),X=Y.S;if(X!==null&&X(N,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var it=LN(q,d);Ru(r,o,it,us(r))}else Ru(r,o,d,us(r))}catch(ot){Ru(r,o,{then:function(){},status:"rejected",reason:ot},us())}finally{at.p=b,Y.T=A}}function zN(){}function Qp(r,o,c,d){if(r.tag!==5)throw Error(s(476));var p=kv(r).queue;Ov(r,p,o,mt,c===null?zN:function(){return Vv(r),c(d)})}function kv(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:mt,baseState:mt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ji,lastRenderedState:mt},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ji,lastRenderedState:c},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function Vv(r){var o=kv(r).next.queue;Ru(r,o,{},us())}function Xp(){return Dn($u)}function Pv(){return Ze().memoizedState}function Lv(){return Ze().memoizedState}function HN(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var c=us();r=Nr(c);var d=Cr(o,r,c);d!==null&&(hs(d,o,c),Eu(d,o,c)),o={cache:Ip()},r.payload=o;return}o=o.return}}function qN(r,o,c){var d=us();c={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},_f(r)?Bv(o,c):(c=_p(r,o,c,d),c!==null&&(hs(c,r,d),Fv(c,o,d)))}function jv(r,o,c){var d=us();Ru(r,o,c,d)}function Ru(r,o,c,d){var p={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(_f(r))Bv(o,p);else{var b=r.alternate;if(r.lanes===0&&(b===null||b.lanes===0)&&(b=o.lastRenderedReducer,b!==null))try{var A=o.lastRenderedState,N=b(A,c);if(p.hasEagerState=!0,p.eagerState=N,rs(N,A))return Jd(r,o,p,0),xe===null&&Zd(),!1}catch{}finally{}if(c=_p(r,o,p,d),c!==null)return hs(c,r,d),Fv(c,o,d),!0}return!1}function Zp(r,o,c,d){if(d={lane:2,revertLane:N_(),action:d,hasEagerState:!1,eagerState:null,next:null},_f(r)){if(o)throw Error(s(479))}else o=_p(r,c,d,2),o!==null&&hs(o,r,2)}function _f(r){var o=r.alternate;return r===zt||o!==null&&o===zt}function Bv(r,o){Il=hf=!0;var c=r.pending;c===null?o.next=o:(o.next=c.next,c.next=o),r.pending=o}function Fv(r,o,c){if((c&4194048)!==0){var d=o.lanes;d&=r.pendingLanes,c|=d,o.lanes=c,_r(r,c)}}var yf={readContext:Dn,use:ff,useCallback:Ge,useContext:Ge,useEffect:Ge,useImperativeHandle:Ge,useLayoutEffect:Ge,useInsertionEffect:Ge,useMemo:Ge,useReducer:Ge,useRef:Ge,useState:Ge,useDebugValue:Ge,useDeferredValue:Ge,useTransition:Ge,useSyncExternalStore:Ge,useId:Ge,useHostTransitionStatus:Ge,useFormState:Ge,useActionState:Ge,useOptimistic:Ge,useMemoCache:Ge,useCacheRefresh:Ge},Uv={readContext:Dn,use:ff,useCallback:function(r,o){return Qn().memoizedState=[r,o===void 0?null:o],r},useContext:Dn,useEffect:wv,useImperativeHandle:function(r,o,c){c=c!=null?c.concat([r]):null,pf(4194308,4,Rv.bind(null,o,r),c)},useLayoutEffect:function(r,o){return pf(4194308,4,r,o)},useInsertionEffect:function(r,o){pf(4,2,r,o)},useMemo:function(r,o){var c=Qn();o=o===void 0?null:o;var d=r();if(uo){_s(!0);try{r()}finally{_s(!1)}}return c.memoizedState=[d,o],d},useReducer:function(r,o,c){var d=Qn();if(c!==void 0){var p=c(o);if(uo){_s(!0);try{c(o)}finally{_s(!1)}}}else p=o;return d.memoizedState=d.baseState=p,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:p},d.queue=r,r=r.dispatch=qN.bind(null,zt,r),[d.memoizedState,r]},useRef:function(r){var o=Qn();return r={current:r},o.memoizedState=r},useState:function(r){r=$p(r);var o=r.queue,c=jv.bind(null,zt,o);return o.dispatch=c,[r.memoizedState,c]},useDebugValue:Yp,useDeferredValue:function(r,o){var c=Qn();return Kp(c,r,o)},useTransition:function(){var r=$p(!1);return r=Ov.bind(null,zt,r.queue,!0,!1),Qn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,c){var d=zt,p=Qn();if(ae){if(c===void 0)throw Error(s(407));c=c()}else{if(c=o(),xe===null)throw Error(s(349));(Zt&124)!==0||lv(d,o,c)}p.memoizedState=c;var b={value:c,getSnapshot:o};return p.queue=b,wv(uv.bind(null,d,b,r),[r]),d.flags|=2048,Dl(9,gf(),cv.bind(null,d,b,c,o),null),c},useId:function(){var r=Qn(),o=xe.identifierPrefix;if(ae){var c=Vi,d=ki;c=(d&~(1<<32-Fn(d)-1)).toString(32)+c,o="«"+o+"R"+c,c=df++,0<c&&(o+="H"+c.toString(32)),o+="»"}else c=jN++,o="«"+o+"r"+c.toString(32)+"»";return r.memoizedState=o},useHostTransitionStatus:Xp,useFormState:bv,useActionState:bv,useOptimistic:function(r){var o=Qn();o.memoizedState=o.baseState=r;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=Zp.bind(null,zt,!0,c),c.dispatch=o,[r,o]},useMemoCache:Hp,useCacheRefresh:function(){return Qn().memoizedState=HN.bind(null,zt)}},zv={readContext:Dn,use:ff,useCallback:Nv,useContext:Dn,useEffect:Sv,useImperativeHandle:Dv,useInsertionEffect:Av,useLayoutEffect:Iv,useMemo:Cv,useReducer:mf,useRef:Tv,useState:function(){return mf(ji)},useDebugValue:Yp,useDeferredValue:function(r,o){var c=Ze();return Mv(c,ge.memoizedState,r,o)},useTransition:function(){var r=mf(ji)[0],o=Ze().memoizedState;return[typeof r=="boolean"?r:Au(r),o]},useSyncExternalStore:ov,useId:Pv,useHostTransitionStatus:Xp,useFormState:xv,useActionState:xv,useOptimistic:function(r,o){var c=Ze();return fv(c,ge,r,o)},useMemoCache:Hp,useCacheRefresh:Lv},GN={readContext:Dn,use:ff,useCallback:Nv,useContext:Dn,useEffect:Sv,useImperativeHandle:Dv,useInsertionEffect:Av,useLayoutEffect:Iv,useMemo:Cv,useReducer:Gp,useRef:Tv,useState:function(){return Gp(ji)},useDebugValue:Yp,useDeferredValue:function(r,o){var c=Ze();return ge===null?Kp(c,r,o):Mv(c,ge.memoizedState,r,o)},useTransition:function(){var r=Gp(ji)[0],o=Ze().memoizedState;return[typeof r=="boolean"?r:Au(r),o]},useSyncExternalStore:ov,useId:Pv,useHostTransitionStatus:Xp,useFormState:Ev,useActionState:Ev,useOptimistic:function(r,o){var c=Ze();return ge!==null?fv(c,ge,r,o):(c.baseState=r,[r,c.queue.dispatch])},useMemoCache:Hp,useCacheRefresh:Lv},Nl=null,Du=0;function bf(r){var o=Du;return Du+=1,Nl===null&&(Nl=[]),Jx(Nl,r,o)}function Nu(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function xf(r,o){throw o.$$typeof===_?Error(s(525)):(r=Object.prototype.toString.call(o),Error(s(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function Hv(r){var o=r._init;return o(r._payload)}function qv(r){function o($,G){if(r){var K=$.deletions;K===null?($.deletions=[G],$.flags|=16):K.push(G)}}function c($,G){if(!r)return null;for(;G!==null;)o($,G),G=G.sibling;return null}function d($){for(var G=new Map;$!==null;)$.key!==null?G.set($.key,$):G.set($.index,$),$=$.sibling;return G}function p($,G){return $=Oi($,G),$.index=0,$.sibling=null,$}function b($,G,K){return $.index=K,r?(K=$.alternate,K!==null?(K=K.index,K<G?($.flags|=67108866,G):K):($.flags|=67108866,G)):($.flags|=1048576,G)}function A($){return r&&$.alternate===null&&($.flags|=67108866),$}function N($,G,K,rt){return G===null||G.tag!==6?(G=bp(K,$.mode,rt),G.return=$,G):(G=p(G,K),G.return=$,G)}function q($,G,K,rt){var Tt=K.type;return Tt===S?it($,G,K.props.children,rt,K.key):G!==null&&(G.elementType===Tt||typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===I&&Hv(Tt)===G.type)?(G=p(G,K.props),Nu(G,K),G.return=$,G):(G=ef(K.type,K.key,K.props,null,$.mode,rt),Nu(G,K),G.return=$,G)}function X($,G,K,rt){return G===null||G.tag!==4||G.stateNode.containerInfo!==K.containerInfo||G.stateNode.implementation!==K.implementation?(G=xp(K,$.mode,rt),G.return=$,G):(G=p(G,K.children||[]),G.return=$,G)}function it($,G,K,rt,Tt){return G===null||G.tag!==7?(G=no(K,$.mode,rt,Tt),G.return=$,G):(G=p(G,K),G.return=$,G)}function ot($,G,K){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=bp(""+G,$.mode,K),G.return=$,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case x:return K=ef(G.type,G.key,G.props,null,$.mode,K),Nu(K,G),K.return=$,K;case E:return G=xp(G,$.mode,K),G.return=$,G;case I:var rt=G._init;return G=rt(G._payload),ot($,G,K)}if(bt(G)||F(G))return G=no(G,$.mode,K,null),G.return=$,G;if(typeof G.then=="function")return ot($,bf(G),K);if(G.$$typeof===O)return ot($,af($,G),K);xf($,G)}return null}function Z($,G,K,rt){var Tt=G!==null?G.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return Tt!==null?null:N($,G,""+K,rt);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case x:return K.key===Tt?q($,G,K,rt):null;case E:return K.key===Tt?X($,G,K,rt):null;case I:return Tt=K._init,K=Tt(K._payload),Z($,G,K,rt)}if(bt(K)||F(K))return Tt!==null?null:it($,G,K,rt,null);if(typeof K.then=="function")return Z($,G,bf(K),rt);if(K.$$typeof===O)return Z($,G,af($,K),rt);xf($,K)}return null}function J($,G,K,rt,Tt){if(typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint")return $=$.get(K)||null,N(G,$,""+rt,Tt);if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case x:return $=$.get(rt.key===null?K:rt.key)||null,q(G,$,rt,Tt);case E:return $=$.get(rt.key===null?K:rt.key)||null,X(G,$,rt,Tt);case I:var Ht=rt._init;return rt=Ht(rt._payload),J($,G,K,rt,Tt)}if(bt(rt)||F(rt))return $=$.get(K)||null,it(G,$,rt,Tt,null);if(typeof rt.then=="function")return J($,G,K,bf(rt),Tt);if(rt.$$typeof===O)return J($,G,K,af(G,rt),Tt);xf(G,rt)}return null}function Ot($,G,K,rt){for(var Tt=null,Ht=null,Nt=G,Mt=G=0,gn=null;Nt!==null&&Mt<K.length;Mt++){Nt.index>Mt?(gn=Nt,Nt=null):gn=Nt.sibling;var ne=Z($,Nt,K[Mt],rt);if(ne===null){Nt===null&&(Nt=gn);break}r&&Nt&&ne.alternate===null&&o($,Nt),G=b(ne,G,Mt),Ht===null?Tt=ne:Ht.sibling=ne,Ht=ne,Nt=gn}if(Mt===K.length)return c($,Nt),ae&&io($,Mt),Tt;if(Nt===null){for(;Mt<K.length;Mt++)Nt=ot($,K[Mt],rt),Nt!==null&&(G=b(Nt,G,Mt),Ht===null?Tt=Nt:Ht.sibling=Nt,Ht=Nt);return ae&&io($,Mt),Tt}for(Nt=d(Nt);Mt<K.length;Mt++)gn=J(Nt,$,Mt,K[Mt],rt),gn!==null&&(r&&gn.alternate!==null&&Nt.delete(gn.key===null?Mt:gn.key),G=b(gn,G,Mt),Ht===null?Tt=gn:Ht.sibling=gn,Ht=gn);return r&&Nt.forEach(function(Yr){return o($,Yr)}),ae&&io($,Mt),Tt}function Ct($,G,K,rt){if(K==null)throw Error(s(151));for(var Tt=null,Ht=null,Nt=G,Mt=G=0,gn=null,ne=K.next();Nt!==null&&!ne.done;Mt++,ne=K.next()){Nt.index>Mt?(gn=Nt,Nt=null):gn=Nt.sibling;var Yr=Z($,Nt,ne.value,rt);if(Yr===null){Nt===null&&(Nt=gn);break}r&&Nt&&Yr.alternate===null&&o($,Nt),G=b(Yr,G,Mt),Ht===null?Tt=Yr:Ht.sibling=Yr,Ht=Yr,Nt=gn}if(ne.done)return c($,Nt),ae&&io($,Mt),Tt;if(Nt===null){for(;!ne.done;Mt++,ne=K.next())ne=ot($,ne.value,rt),ne!==null&&(G=b(ne,G,Mt),Ht===null?Tt=ne:Ht.sibling=ne,Ht=ne);return ae&&io($,Mt),Tt}for(Nt=d(Nt);!ne.done;Mt++,ne=K.next())ne=J(Nt,$,Mt,ne.value,rt),ne!==null&&(r&&ne.alternate!==null&&Nt.delete(ne.key===null?Mt:ne.key),G=b(ne,G,Mt),Ht===null?Tt=ne:Ht.sibling=ne,Ht=ne);return r&&Nt.forEach(function($C){return o($,$C)}),ae&&io($,Mt),Tt}function _e($,G,K,rt){if(typeof K=="object"&&K!==null&&K.type===S&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case x:t:{for(var Tt=K.key;G!==null;){if(G.key===Tt){if(Tt=K.type,Tt===S){if(G.tag===7){c($,G.sibling),rt=p(G,K.props.children),rt.return=$,$=rt;break t}}else if(G.elementType===Tt||typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===I&&Hv(Tt)===G.type){c($,G.sibling),rt=p(G,K.props),Nu(rt,K),rt.return=$,$=rt;break t}c($,G);break}else o($,G);G=G.sibling}K.type===S?(rt=no(K.props.children,$.mode,rt,K.key),rt.return=$,$=rt):(rt=ef(K.type,K.key,K.props,null,$.mode,rt),Nu(rt,K),rt.return=$,$=rt)}return A($);case E:t:{for(Tt=K.key;G!==null;){if(G.key===Tt)if(G.tag===4&&G.stateNode.containerInfo===K.containerInfo&&G.stateNode.implementation===K.implementation){c($,G.sibling),rt=p(G,K.children||[]),rt.return=$,$=rt;break t}else{c($,G);break}else o($,G);G=G.sibling}rt=xp(K,$.mode,rt),rt.return=$,$=rt}return A($);case I:return Tt=K._init,K=Tt(K._payload),_e($,G,K,rt)}if(bt(K))return Ot($,G,K,rt);if(F(K)){if(Tt=F(K),typeof Tt!="function")throw Error(s(150));return K=Tt.call(K),Ct($,G,K,rt)}if(typeof K.then=="function")return _e($,G,bf(K),rt);if(K.$$typeof===O)return _e($,G,af($,K),rt);xf($,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,G!==null&&G.tag===6?(c($,G.sibling),rt=p(G,K),rt.return=$,$=rt):(c($,G),rt=bp(K,$.mode,rt),rt.return=$,$=rt),A($)):c($,G)}return function($,G,K,rt){try{Du=0;var Tt=_e($,G,K,rt);return Nl=null,Tt}catch(Nt){if(Nt===xu||Nt===lf)throw Nt;var Ht=as(29,Nt,null,$.mode);return Ht.lanes=rt,Ht.return=$,Ht}finally{}}}var Cl=qv(!0),Gv=qv(!1),As=st(null),ai=null;function Or(r){var o=r.alternate;dt(an,an.current&1),dt(As,r),ai===null&&(o===null||Al.current!==null||o.memoizedState!==null)&&(ai=r)}function $v(r){if(r.tag===22){if(dt(an,an.current),dt(As,r),ai===null){var o=r.alternate;o!==null&&o.memoizedState!==null&&(ai=r)}}else kr()}function kr(){dt(an,an.current),dt(As,As.current)}function Bi(r){ht(As),ai===r&&(ai=null),ht(an)}var an=st(0);function vf(r){for(var o=r;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||z_(c)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function Jp(r,o,c,d){o=r.memoizedState,c=c(d,o),c=c==null?o:m({},o,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var t_={enqueueSetState:function(r,o,c){r=r._reactInternals;var d=us(),p=Nr(d);p.payload=o,c!=null&&(p.callback=c),o=Cr(r,p,d),o!==null&&(hs(o,r,d),Eu(o,r,d))},enqueueReplaceState:function(r,o,c){r=r._reactInternals;var d=us(),p=Nr(d);p.tag=1,p.payload=o,c!=null&&(p.callback=c),o=Cr(r,p,d),o!==null&&(hs(o,r,d),Eu(o,r,d))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var c=us(),d=Nr(c);d.tag=2,o!=null&&(d.callback=o),o=Cr(r,d,c),o!==null&&(hs(o,r,c),Eu(o,r,c))}};function Wv(r,o,c,d,p,b,A){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(d,b,A):o.prototype&&o.prototype.isPureReactComponent?!du(c,d)||!du(p,b):!0}function Yv(r,o,c,d){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,d),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,d),o.state!==r&&t_.enqueueReplaceState(o,o.state,null)}function ho(r,o){var c=o;if("ref"in o){c={};for(var d in o)d!=="ref"&&(c[d]=o[d])}if(r=r.defaultProps){c===o&&(c=m({},c));for(var p in r)c[p]===void 0&&(c[p]=r[p])}return c}var Ef=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function Kv(r){Ef(r)}function Qv(r){console.error(r)}function Xv(r){Ef(r)}function Tf(r,o){try{var c=r.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(d){setTimeout(function(){throw d})}}function Zv(r,o,c){try{var d=r.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function e_(r,o,c){return c=Nr(c),c.tag=3,c.payload={element:null},c.callback=function(){Tf(r,o)},c}function Jv(r){return r=Nr(r),r.tag=3,r}function tE(r,o,c,d){var p=c.type.getDerivedStateFromError;if(typeof p=="function"){var b=d.value;r.payload=function(){return p(b)},r.callback=function(){Zv(o,c,d)}}var A=c.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(r.callback=function(){Zv(o,c,d),typeof p!="function"&&(Fr===null?Fr=new Set([this]):Fr.add(this));var N=d.stack;this.componentDidCatch(d.value,{componentStack:N!==null?N:""})})}function $N(r,o,c,d,p){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(o=c.alternate,o!==null&&_u(o,c,p,!0),c=As.current,c!==null){switch(c.tag){case 13:return ai===null?S_():c.alternate===null&&Le===0&&(Le=3),c.flags&=-257,c.flags|=65536,c.lanes=p,d===Np?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([d]):o.add(d),I_(r,d,p)),!1;case 22:return c.flags|=65536,d===Np?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([d]):c.add(d)),I_(r,d,p)),!1}throw Error(s(435,c.tag))}return I_(r,d,p),S_(),!1}if(ae)return o=As.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=p,d!==Tp&&(r=Error(s(422),{cause:d}),pu(Es(r,c)))):(d!==Tp&&(o=Error(s(423),{cause:d}),pu(Es(o,c))),r=r.current.alternate,r.flags|=65536,p&=-p,r.lanes|=p,d=Es(d,c),p=e_(r.stateNode,d,p),Op(r,p),Le!==4&&(Le=2)),!1;var b=Error(s(520),{cause:d});if(b=Es(b,c),Lu===null?Lu=[b]:Lu.push(b),Le!==4&&(Le=2),o===null)return!0;d=Es(d,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,r=p&-p,c.lanes|=r,r=e_(c.stateNode,d,r),Op(c,r),!1;case 1:if(o=c.type,b=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Fr===null||!Fr.has(b))))return c.flags|=65536,p&=-p,c.lanes|=p,p=Jv(p),tE(p,r,c,d),Op(c,p),!1}c=c.return}while(c!==null);return!1}var eE=Error(s(461)),fn=!1;function xn(r,o,c,d){o.child=r===null?Gv(o,null,c,d):Cl(o,r.child,c,d)}function nE(r,o,c,d,p){c=c.render;var b=o.ref;if("ref"in d){var A={};for(var N in d)N!=="ref"&&(A[N]=d[N])}else A=d;return lo(o),d=jp(r,o,c,A,b,p),N=Bp(),r!==null&&!fn?(Fp(r,o,p),Fi(r,o,p)):(ae&&N&&vp(o),o.flags|=1,xn(r,o,d,p),o.child)}function sE(r,o,c,d,p){if(r===null){var b=c.type;return typeof b=="function"&&!yp(b)&&b.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=b,iE(r,o,b,d,p)):(r=ef(c.type,null,d,o,o.mode,p),r.ref=o.ref,r.return=o,o.child=r)}if(b=r.child,!c_(r,p)){var A=b.memoizedProps;if(c=c.compare,c=c!==null?c:du,c(A,d)&&r.ref===o.ref)return Fi(r,o,p)}return o.flags|=1,r=Oi(b,d),r.ref=o.ref,r.return=o,o.child=r}function iE(r,o,c,d,p){if(r!==null){var b=r.memoizedProps;if(du(b,d)&&r.ref===o.ref)if(fn=!1,o.pendingProps=d=b,c_(r,p))(r.flags&131072)!==0&&(fn=!0);else return o.lanes=r.lanes,Fi(r,o,p)}return n_(r,o,c,d,p)}function rE(r,o,c){var d=o.pendingProps,p=d.children,b=r!==null?r.memoizedState:null;if(d.mode==="hidden"){if((o.flags&128)!==0){if(d=b!==null?b.baseLanes|c:c,r!==null){for(p=o.child=r.child,b=0;p!==null;)b=b|p.lanes|p.childLanes,p=p.sibling;o.childLanes=b&~d}else o.childLanes=0,o.child=null;return aE(r,o,d,c)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&of(o,b!==null?b.cachePool:null),b!==null?iv(o,b):Vp(),$v(o);else return o.lanes=o.childLanes=536870912,aE(r,o,b!==null?b.baseLanes|c:c,c)}else b!==null?(of(o,b.cachePool),iv(o,b),kr(),o.memoizedState=null):(r!==null&&of(o,null),Vp(),kr());return xn(r,o,p,c),o.child}function aE(r,o,c,d){var p=Dp();return p=p===null?null:{parent:rn._currentValue,pool:p},o.memoizedState={baseLanes:c,cachePool:p},r!==null&&of(o,null),Vp(),$v(o),r!==null&&_u(r,o,d,!0),null}function wf(r,o){var c=o.ref;if(c===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(s(284));(r===null||r.ref!==c)&&(o.flags|=4194816)}}function n_(r,o,c,d,p){return lo(o),c=jp(r,o,c,d,void 0,p),d=Bp(),r!==null&&!fn?(Fp(r,o,p),Fi(r,o,p)):(ae&&d&&vp(o),o.flags|=1,xn(r,o,c,p),o.child)}function oE(r,o,c,d,p,b){return lo(o),o.updateQueue=null,c=av(o,d,c,p),rv(r),d=Bp(),r!==null&&!fn?(Fp(r,o,b),Fi(r,o,b)):(ae&&d&&vp(o),o.flags|=1,xn(r,o,c,b),o.child)}function lE(r,o,c,d,p){if(lo(o),o.stateNode===null){var b=vl,A=c.contextType;typeof A=="object"&&A!==null&&(b=Dn(A)),b=new c(d,b),o.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=t_,o.stateNode=b,b._reactInternals=o,b=o.stateNode,b.props=d,b.state=o.memoizedState,b.refs={},Cp(o),A=c.contextType,b.context=typeof A=="object"&&A!==null?Dn(A):vl,b.state=o.memoizedState,A=c.getDerivedStateFromProps,typeof A=="function"&&(Jp(o,c,A,d),b.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(A=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),A!==b.state&&t_.enqueueReplaceState(b,b.state,null),wu(o,d,b,p),Tu(),b.state=o.memoizedState),typeof b.componentDidMount=="function"&&(o.flags|=4194308),d=!0}else if(r===null){b=o.stateNode;var N=o.memoizedProps,q=ho(c,N);b.props=q;var X=b.context,it=c.contextType;A=vl,typeof it=="object"&&it!==null&&(A=Dn(it));var ot=c.getDerivedStateFromProps;it=typeof ot=="function"||typeof b.getSnapshotBeforeUpdate=="function",N=o.pendingProps!==N,it||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(N||X!==A)&&Yv(o,b,d,A),Dr=!1;var Z=o.memoizedState;b.state=Z,wu(o,d,b,p),Tu(),X=o.memoizedState,N||Z!==X||Dr?(typeof ot=="function"&&(Jp(o,c,ot,d),X=o.memoizedState),(q=Dr||Wv(o,c,q,d,Z,X,A))?(it||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(o.flags|=4194308)):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=d,o.memoizedState=X),b.props=d,b.state=X,b.context=A,d=q):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),d=!1)}else{b=o.stateNode,Mp(r,o),A=o.memoizedProps,it=ho(c,A),b.props=it,ot=o.pendingProps,Z=b.context,X=c.contextType,q=vl,typeof X=="object"&&X!==null&&(q=Dn(X)),N=c.getDerivedStateFromProps,(X=typeof N=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(A!==ot||Z!==q)&&Yv(o,b,d,q),Dr=!1,Z=o.memoizedState,b.state=Z,wu(o,d,b,p),Tu();var J=o.memoizedState;A!==ot||Z!==J||Dr||r!==null&&r.dependencies!==null&&rf(r.dependencies)?(typeof N=="function"&&(Jp(o,c,N,d),J=o.memoizedState),(it=Dr||Wv(o,c,it,d,Z,J,q)||r!==null&&r.dependencies!==null&&rf(r.dependencies))?(X||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(d,J,q),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(d,J,q)),typeof b.componentDidUpdate=="function"&&(o.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof b.componentDidUpdate!="function"||A===r.memoizedProps&&Z===r.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||A===r.memoizedProps&&Z===r.memoizedState||(o.flags|=1024),o.memoizedProps=d,o.memoizedState=J),b.props=d,b.state=J,b.context=q,d=it):(typeof b.componentDidUpdate!="function"||A===r.memoizedProps&&Z===r.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||A===r.memoizedProps&&Z===r.memoizedState||(o.flags|=1024),d=!1)}return b=d,wf(r,o),d=(o.flags&128)!==0,b||d?(b=o.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:b.render(),o.flags|=1,r!==null&&d?(o.child=Cl(o,r.child,null,p),o.child=Cl(o,null,c,p)):xn(r,o,c,p),o.memoizedState=b.state,r=o.child):r=Fi(r,o,p),r}function cE(r,o,c,d){return gu(),o.flags|=256,xn(r,o,c,d),o.child}var s_={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function i_(r){return{baseLanes:r,cachePool:Qx()}}function r_(r,o,c){return r=r!==null?r.childLanes&~c:0,o&&(r|=Is),r}function uE(r,o,c){var d=o.pendingProps,p=!1,b=(o.flags&128)!==0,A;if((A=b)||(A=r!==null&&r.memoizedState===null?!1:(an.current&2)!==0),A&&(p=!0,o.flags&=-129),A=(o.flags&32)!==0,o.flags&=-33,r===null){if(ae){if(p?Or(o):kr(),ae){var N=Pe,q;if(q=N){t:{for(q=N,N=ri;q.nodeType!==8;){if(!N){N=null;break t}if(q=zs(q.nextSibling),q===null){N=null;break t}}N=q}N!==null?(o.memoizedState={dehydrated:N,treeContext:so!==null?{id:ki,overflow:Vi}:null,retryLane:536870912,hydrationErrors:null},q=as(18,null,null,0),q.stateNode=N,q.return=o,o.child=q,qn=o,Pe=null,q=!0):q=!1}q||ao(o)}if(N=o.memoizedState,N!==null&&(N=N.dehydrated,N!==null))return z_(N)?o.lanes=32:o.lanes=536870912,null;Bi(o)}return N=d.children,d=d.fallback,p?(kr(),p=o.mode,N=Sf({mode:"hidden",children:N},p),d=no(d,p,c,null),N.return=o,d.return=o,N.sibling=d,o.child=N,p=o.child,p.memoizedState=i_(c),p.childLanes=r_(r,A,c),o.memoizedState=s_,d):(Or(o),a_(o,N))}if(q=r.memoizedState,q!==null&&(N=q.dehydrated,N!==null)){if(b)o.flags&256?(Or(o),o.flags&=-257,o=o_(r,o,c)):o.memoizedState!==null?(kr(),o.child=r.child,o.flags|=128,o=null):(kr(),p=d.fallback,N=o.mode,d=Sf({mode:"visible",children:d.children},N),p=no(p,N,c,null),p.flags|=2,d.return=o,p.return=o,d.sibling=p,o.child=d,Cl(o,r.child,null,c),d=o.child,d.memoizedState=i_(c),d.childLanes=r_(r,A,c),o.memoizedState=s_,o=p);else if(Or(o),z_(N)){if(A=N.nextSibling&&N.nextSibling.dataset,A)var X=A.dgst;A=X,d=Error(s(419)),d.stack="",d.digest=A,pu({value:d,source:null,stack:null}),o=o_(r,o,c)}else if(fn||_u(r,o,c,!1),A=(c&r.childLanes)!==0,fn||A){if(A=xe,A!==null&&(d=c&-c,d=(d&42)!==0?1:Kc(d),d=(d&(A.suspendedLanes|c))!==0?0:d,d!==0&&d!==q.retryLane))throw q.retryLane=d,xl(r,d),hs(A,r,d),eE;N.data==="$?"||S_(),o=o_(r,o,c)}else N.data==="$?"?(o.flags|=192,o.child=r.child,o=null):(r=q.treeContext,Pe=zs(N.nextSibling),qn=o,ae=!0,ro=null,ri=!1,r!==null&&(ws[Ss++]=ki,ws[Ss++]=Vi,ws[Ss++]=so,ki=r.id,Vi=r.overflow,so=o),o=a_(o,d.children),o.flags|=4096);return o}return p?(kr(),p=d.fallback,N=o.mode,q=r.child,X=q.sibling,d=Oi(q,{mode:"hidden",children:d.children}),d.subtreeFlags=q.subtreeFlags&65011712,X!==null?p=Oi(X,p):(p=no(p,N,c,null),p.flags|=2),p.return=o,d.return=o,d.sibling=p,o.child=d,d=p,p=o.child,N=r.child.memoizedState,N===null?N=i_(c):(q=N.cachePool,q!==null?(X=rn._currentValue,q=q.parent!==X?{parent:X,pool:X}:q):q=Qx(),N={baseLanes:N.baseLanes|c,cachePool:q}),p.memoizedState=N,p.childLanes=r_(r,A,c),o.memoizedState=s_,d):(Or(o),c=r.child,r=c.sibling,c=Oi(c,{mode:"visible",children:d.children}),c.return=o,c.sibling=null,r!==null&&(A=o.deletions,A===null?(o.deletions=[r],o.flags|=16):A.push(r)),o.child=c,o.memoizedState=null,c)}function a_(r,o){return o=Sf({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function Sf(r,o){return r=as(22,r,null,o),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function o_(r,o,c){return Cl(o,r.child,null,c),r=a_(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function hE(r,o,c){r.lanes|=o;var d=r.alternate;d!==null&&(d.lanes|=o),Sp(r.return,o,c)}function l_(r,o,c,d,p){var b=r.memoizedState;b===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:p}:(b.isBackwards=o,b.rendering=null,b.renderingStartTime=0,b.last=d,b.tail=c,b.tailMode=p)}function dE(r,o,c){var d=o.pendingProps,p=d.revealOrder,b=d.tail;if(xn(r,o,d.children,c),d=an.current,(d&2)!==0)d=d&1|2,o.flags|=128;else{if(r!==null&&(r.flags&128)!==0)t:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&hE(r,c,o);else if(r.tag===19)hE(r,c,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break t;for(;r.sibling===null;){if(r.return===null||r.return===o)break t;r=r.return}r.sibling.return=r.return,r=r.sibling}d&=1}switch(dt(an,d),p){case"forwards":for(c=o.child,p=null;c!==null;)r=c.alternate,r!==null&&vf(r)===null&&(p=c),c=c.sibling;c=p,c===null?(p=o.child,o.child=null):(p=c.sibling,c.sibling=null),l_(o,!1,p,c,b);break;case"backwards":for(c=null,p=o.child,o.child=null;p!==null;){if(r=p.alternate,r!==null&&vf(r)===null){o.child=p;break}r=p.sibling,p.sibling=c,c=p,p=r}l_(o,!0,c,null,b);break;case"together":l_(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Fi(r,o,c){if(r!==null&&(o.dependencies=r.dependencies),Br|=o.lanes,(c&o.childLanes)===0)if(r!==null){if(_u(r,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(s(153));if(o.child!==null){for(r=o.child,c=Oi(r,r.pendingProps),o.child=c,c.return=o;r.sibling!==null;)r=r.sibling,c=c.sibling=Oi(r,r.pendingProps),c.return=o;c.sibling=null}return o.child}function c_(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&rf(r)))}function WN(r,o,c){switch(o.tag){case 3:te(o,o.stateNode.containerInfo),Rr(o,rn,r.memoizedState.cache),gu();break;case 27:case 5:ur(o);break;case 4:te(o,o.stateNode.containerInfo);break;case 10:Rr(o,o.type,o.memoizedProps.value);break;case 13:var d=o.memoizedState;if(d!==null)return d.dehydrated!==null?(Or(o),o.flags|=128,null):(c&o.child.childLanes)!==0?uE(r,o,c):(Or(o),r=Fi(r,o,c),r!==null?r.sibling:null);Or(o);break;case 19:var p=(r.flags&128)!==0;if(d=(c&o.childLanes)!==0,d||(_u(r,o,c,!1),d=(c&o.childLanes)!==0),p){if(d)return dE(r,o,c);o.flags|=128}if(p=o.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),dt(an,an.current),d)break;return null;case 22:case 23:return o.lanes=0,rE(r,o,c);case 24:Rr(o,rn,r.memoizedState.cache)}return Fi(r,o,c)}function fE(r,o,c){if(r!==null)if(r.memoizedProps!==o.pendingProps)fn=!0;else{if(!c_(r,c)&&(o.flags&128)===0)return fn=!1,WN(r,o,c);fn=(r.flags&131072)!==0}else fn=!1,ae&&(o.flags&1048576)!==0&&Hx(o,sf,o.index);switch(o.lanes=0,o.tag){case 16:t:{r=o.pendingProps;var d=o.elementType,p=d._init;if(d=p(d._payload),o.type=d,typeof d=="function")yp(d)?(r=ho(d,r),o.tag=1,o=lE(null,o,d,r,c)):(o.tag=0,o=n_(null,o,d,r,c));else{if(d!=null){if(p=d.$$typeof,p===H){o.tag=11,o=nE(null,o,d,r,c);break t}else if(p===D){o.tag=14,o=sE(null,o,d,r,c);break t}}throw o=nt(d)||d,Error(s(306,o,""))}}return o;case 0:return n_(r,o,o.type,o.pendingProps,c);case 1:return d=o.type,p=ho(d,o.pendingProps),lE(r,o,d,p,c);case 3:t:{if(te(o,o.stateNode.containerInfo),r===null)throw Error(s(387));d=o.pendingProps;var b=o.memoizedState;p=b.element,Mp(r,o),wu(o,d,null,c);var A=o.memoizedState;if(d=A.cache,Rr(o,rn,d),d!==b.cache&&Ap(o,[rn],c,!0),Tu(),d=A.element,b.isDehydrated)if(b={element:d,isDehydrated:!1,cache:A.cache},o.updateQueue.baseState=b,o.memoizedState=b,o.flags&256){o=cE(r,o,d,c);break t}else if(d!==p){p=Es(Error(s(424)),o),pu(p),o=cE(r,o,d,c);break t}else{switch(r=o.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Pe=zs(r.firstChild),qn=o,ae=!0,ro=null,ri=!0,c=Gv(o,null,d,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(gu(),d===p){o=Fi(r,o,c);break t}xn(r,o,d,c)}o=o.child}return o;case 26:return wf(r,o),r===null?(c=_T(o.type,null,o.pendingProps,null))?o.memoizedState=c:ae||(c=o.type,r=o.pendingProps,d=Bf(At.current).createElement(c),d[ze]=o,d[bn]=r,En(d,c,r),He(d),o.stateNode=d):o.memoizedState=_T(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return ur(o),r===null&&ae&&(d=o.stateNode=mT(o.type,o.pendingProps,At.current),qn=o,ri=!0,p=Pe,Hr(o.type)?(H_=p,Pe=zs(d.firstChild)):Pe=p),xn(r,o,o.pendingProps.children,c),wf(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&ae&&((p=d=Pe)&&(d=vC(d,o.type,o.pendingProps,ri),d!==null?(o.stateNode=d,qn=o,Pe=zs(d.firstChild),ri=!1,p=!0):p=!1),p||ao(o)),ur(o),p=o.type,b=o.pendingProps,A=r!==null?r.memoizedProps:null,d=b.children,B_(p,b)?d=null:A!==null&&B_(p,A)&&(o.flags|=32),o.memoizedState!==null&&(p=jp(r,o,BN,null,null,c),$u._currentValue=p),wf(r,o),xn(r,o,d,c),o.child;case 6:return r===null&&ae&&((r=c=Pe)&&(c=EC(c,o.pendingProps,ri),c!==null?(o.stateNode=c,qn=o,Pe=null,r=!0):r=!1),r||ao(o)),null;case 13:return uE(r,o,c);case 4:return te(o,o.stateNode.containerInfo),d=o.pendingProps,r===null?o.child=Cl(o,null,d,c):xn(r,o,d,c),o.child;case 11:return nE(r,o,o.type,o.pendingProps,c);case 7:return xn(r,o,o.pendingProps,c),o.child;case 8:return xn(r,o,o.pendingProps.children,c),o.child;case 12:return xn(r,o,o.pendingProps.children,c),o.child;case 10:return d=o.pendingProps,Rr(o,o.type,d.value),xn(r,o,d.children,c),o.child;case 9:return p=o.type._context,d=o.pendingProps.children,lo(o),p=Dn(p),d=d(p),o.flags|=1,xn(r,o,d,c),o.child;case 14:return sE(r,o,o.type,o.pendingProps,c);case 15:return iE(r,o,o.type,o.pendingProps,c);case 19:return dE(r,o,c);case 31:return d=o.pendingProps,c=o.mode,d={mode:d.mode,children:d.children},r===null?(c=Sf(d,c),c.ref=o.ref,o.child=c,c.return=o,o=c):(c=Oi(r.child,d),c.ref=o.ref,o.child=c,c.return=o,o=c),o;case 22:return rE(r,o,c);case 24:return lo(o),d=Dn(rn),r===null?(p=Dp(),p===null&&(p=xe,b=Ip(),p.pooledCache=b,b.refCount++,b!==null&&(p.pooledCacheLanes|=c),p=b),o.memoizedState={parent:d,cache:p},Cp(o),Rr(o,rn,p)):((r.lanes&c)!==0&&(Mp(r,o),wu(o,null,null,c),Tu()),p=r.memoizedState,b=o.memoizedState,p.parent!==d?(p={parent:d,cache:d},o.memoizedState=p,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=p),Rr(o,rn,d)):(d=b.cache,Rr(o,rn,d),d!==p.cache&&Ap(o,[rn],c,!0))),xn(r,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(s(156,o.tag))}function Ui(r){r.flags|=4}function mE(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!ET(o)){if(o=As.current,o!==null&&((Zt&4194048)===Zt?ai!==null:(Zt&62914560)!==Zt&&(Zt&536870912)===0||o!==ai))throw vu=Np,Xx;r.flags|=8192}}function Af(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?gr():536870912,r.lanes|=o,Vl|=o)}function Cu(r,o){if(!ae)switch(r.tailMode){case"hidden":o=r.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:d.sibling=null}}function Ve(r){var o=r.alternate!==null&&r.alternate.child===r.child,c=0,d=0;if(o)for(var p=r.child;p!==null;)c|=p.lanes|p.childLanes,d|=p.subtreeFlags&65011712,d|=p.flags&65011712,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)c|=p.lanes|p.childLanes,d|=p.subtreeFlags,d|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=d,r.childLanes=c,o}function YN(r,o,c){var d=o.pendingProps;switch(Ep(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ve(o),null;case 1:return Ve(o),null;case 3:return c=o.stateNode,d=null,r!==null&&(d=r.memoizedState.cache),o.memoizedState.cache!==d&&(o.flags|=2048),Li(rn),Fe(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(r===null||r.child===null)&&(mu(o)?Ui(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,$x())),Ve(o),null;case 26:return c=o.memoizedState,r===null?(Ui(o),c!==null?(Ve(o),mE(o,c)):(Ve(o),o.flags&=-16777217)):c?c!==r.memoizedState?(Ui(o),Ve(o),mE(o,c)):(Ve(o),o.flags&=-16777217):(r.memoizedProps!==d&&Ui(o),Ve(o),o.flags&=-16777217),null;case 27:Ks(o),c=At.current;var p=o.type;if(r!==null&&o.stateNode!=null)r.memoizedProps!==d&&Ui(o);else{if(!d){if(o.stateNode===null)throw Error(s(166));return Ve(o),null}r=yt.current,mu(o)?qx(o):(r=mT(p,d,c),o.stateNode=r,Ui(o))}return Ve(o),null;case 5:if(Ks(o),c=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==d&&Ui(o);else{if(!d){if(o.stateNode===null)throw Error(s(166));return Ve(o),null}if(r=yt.current,mu(o))qx(o);else{switch(p=Bf(At.current),r){case 1:r=p.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:r=p.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":r=p.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":r=p.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":r=p.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof d.is=="string"?p.createElement("select",{is:d.is}):p.createElement("select"),d.multiple?r.multiple=!0:d.size&&(r.size=d.size);break;default:r=typeof d.is=="string"?p.createElement(c,{is:d.is}):p.createElement(c)}}r[ze]=o,r[bn]=d;t:for(p=o.child;p!==null;){if(p.tag===5||p.tag===6)r.appendChild(p.stateNode);else if(p.tag!==4&&p.tag!==27&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===o)break t;for(;p.sibling===null;){if(p.return===null||p.return===o)break t;p=p.return}p.sibling.return=p.return,p=p.sibling}o.stateNode=r;t:switch(En(r,c,d),c){case"button":case"input":case"select":case"textarea":r=!!d.autoFocus;break t;case"img":r=!0;break t;default:r=!1}r&&Ui(o)}}return Ve(o),o.flags&=-16777217,null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==d&&Ui(o);else{if(typeof d!="string"&&o.stateNode===null)throw Error(s(166));if(r=At.current,mu(o)){if(r=o.stateNode,c=o.memoizedProps,d=null,p=qn,p!==null)switch(p.tag){case 27:case 5:d=p.memoizedProps}r[ze]=o,r=!!(r.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||oT(r.nodeValue,c)),r||ao(o)}else r=Bf(r).createTextNode(d),r[ze]=o,o.stateNode=r}return Ve(o),null;case 13:if(d=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(p=mu(o),d!==null&&d.dehydrated!==null){if(r===null){if(!p)throw Error(s(318));if(p=o.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(s(317));p[ze]=o}else gu(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Ve(o),p=!1}else p=$x(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=p),p=!0;if(!p)return o.flags&256?(Bi(o),o):(Bi(o),null)}if(Bi(o),(o.flags&128)!==0)return o.lanes=c,o;if(c=d!==null,r=r!==null&&r.memoizedState!==null,c){d=o.child,p=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(p=d.alternate.memoizedState.cachePool.pool);var b=null;d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(b=d.memoizedState.cachePool.pool),b!==p&&(d.flags|=2048)}return c!==r&&c&&(o.child.flags|=8192),Af(o,o.updateQueue),Ve(o),null;case 4:return Fe(),r===null&&k_(o.stateNode.containerInfo),Ve(o),null;case 10:return Li(o.type),Ve(o),null;case 19:if(ht(an),p=o.memoizedState,p===null)return Ve(o),null;if(d=(o.flags&128)!==0,b=p.rendering,b===null)if(d)Cu(p,!1);else{if(Le!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(b=vf(r),b!==null){for(o.flags|=128,Cu(p,!1),r=b.updateQueue,o.updateQueue=r,Af(o,r),o.subtreeFlags=0,r=c,c=o.child;c!==null;)zx(c,r),c=c.sibling;return dt(an,an.current&1|2),o.child}r=r.sibling}p.tail!==null&&Kn()>Df&&(o.flags|=128,d=!0,Cu(p,!1),o.lanes=4194304)}else{if(!d)if(r=vf(b),r!==null){if(o.flags|=128,d=!0,r=r.updateQueue,o.updateQueue=r,Af(o,r),Cu(p,!0),p.tail===null&&p.tailMode==="hidden"&&!b.alternate&&!ae)return Ve(o),null}else 2*Kn()-p.renderingStartTime>Df&&c!==536870912&&(o.flags|=128,d=!0,Cu(p,!1),o.lanes=4194304);p.isBackwards?(b.sibling=o.child,o.child=b):(r=p.last,r!==null?r.sibling=b:o.child=b,p.last=b)}return p.tail!==null?(o=p.tail,p.rendering=o,p.tail=o.sibling,p.renderingStartTime=Kn(),o.sibling=null,r=an.current,dt(an,d?r&1|2:r&1),o):(Ve(o),null);case 22:case 23:return Bi(o),Pp(),d=o.memoizedState!==null,r!==null?r.memoizedState!==null!==d&&(o.flags|=8192):d&&(o.flags|=8192),d?(c&536870912)!==0&&(o.flags&128)===0&&(Ve(o),o.subtreeFlags&6&&(o.flags|=8192)):Ve(o),c=o.updateQueue,c!==null&&Af(o,c.retryQueue),c=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),d=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(d=o.memoizedState.cachePool.pool),d!==c&&(o.flags|=2048),r!==null&&ht(co),null;case 24:return c=null,r!==null&&(c=r.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),Li(rn),Ve(o),null;case 25:return null;case 30:return null}throw Error(s(156,o.tag))}function KN(r,o){switch(Ep(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return Li(rn),Fe(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return Ks(o),null;case 13:if(Bi(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(s(340));gu()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return ht(an),null;case 4:return Fe(),null;case 10:return Li(o.type),null;case 22:case 23:return Bi(o),Pp(),r!==null&&ht(co),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return Li(rn),null;case 25:return null;default:return null}}function gE(r,o){switch(Ep(o),o.tag){case 3:Li(rn),Fe();break;case 26:case 27:case 5:Ks(o);break;case 4:Fe();break;case 13:Bi(o);break;case 19:ht(an);break;case 10:Li(o.type);break;case 22:case 23:Bi(o),Pp(),r!==null&&ht(co);break;case 24:Li(rn)}}function Mu(r,o){try{var c=o.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var p=d.next;c=p;do{if((c.tag&r)===r){d=void 0;var b=c.create,A=c.inst;d=b(),A.destroy=d}c=c.next}while(c!==p)}}catch(N){ye(o,o.return,N)}}function Vr(r,o,c){try{var d=o.updateQueue,p=d!==null?d.lastEffect:null;if(p!==null){var b=p.next;d=b;do{if((d.tag&r)===r){var A=d.inst,N=A.destroy;if(N!==void 0){A.destroy=void 0,p=o;var q=c,X=N;try{X()}catch(it){ye(p,q,it)}}}d=d.next}while(d!==b)}}catch(it){ye(o,o.return,it)}}function pE(r){var o=r.updateQueue;if(o!==null){var c=r.stateNode;try{sv(o,c)}catch(d){ye(r,r.return,d)}}}function _E(r,o,c){c.props=ho(r.type,r.memoizedProps),c.state=r.memoizedState;try{c.componentWillUnmount()}catch(d){ye(r,o,d)}}function Ou(r,o){try{var c=r.ref;if(c!==null){switch(r.tag){case 26:case 27:case 5:var d=r.stateNode;break;case 30:d=r.stateNode;break;default:d=r.stateNode}typeof c=="function"?r.refCleanup=c(d):c.current=d}}catch(p){ye(r,o,p)}}function oi(r,o){var c=r.ref,d=r.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(p){ye(r,o,p)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(p){ye(r,o,p)}else c.current=null}function yE(r){var o=r.type,c=r.memoizedProps,d=r.stateNode;try{t:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break t;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(p){ye(r,r.return,p)}}function u_(r,o,c){try{var d=r.stateNode;pC(d,r.type,c,o),d[bn]=o}catch(p){ye(r,r.return,p)}}function bE(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Hr(r.type)||r.tag===4}function h_(r){t:for(;;){for(;r.sibling===null;){if(r.return===null||bE(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Hr(r.type)||r.flags&2||r.child===null||r.tag===4)continue t;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function d_(r,o,c){var d=r.tag;if(d===5||d===6)r=r.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(r,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(r),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=jf));else if(d!==4&&(d===27&&Hr(r.type)&&(c=r.stateNode,o=null),r=r.child,r!==null))for(d_(r,o,c),r=r.sibling;r!==null;)d_(r,o,c),r=r.sibling}function If(r,o,c){var d=r.tag;if(d===5||d===6)r=r.stateNode,o?c.insertBefore(r,o):c.appendChild(r);else if(d!==4&&(d===27&&Hr(r.type)&&(c=r.stateNode),r=r.child,r!==null))for(If(r,o,c),r=r.sibling;r!==null;)If(r,o,c),r=r.sibling}function xE(r){var o=r.stateNode,c=r.memoizedProps;try{for(var d=r.type,p=o.attributes;p.length;)o.removeAttributeNode(p[0]);En(o,d,c),o[ze]=r,o[bn]=c}catch(b){ye(r,r.return,b)}}var zi=!1,$e=!1,f_=!1,vE=typeof WeakSet=="function"?WeakSet:Set,mn=null;function QN(r,o){if(r=r.containerInfo,L_=Gf,r=Mx(r),hp(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else t:{c=(c=r.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var p=d.anchorOffset,b=d.focusNode;d=d.focusOffset;try{c.nodeType,b.nodeType}catch{c=null;break t}var A=0,N=-1,q=-1,X=0,it=0,ot=r,Z=null;e:for(;;){for(var J;ot!==c||p!==0&&ot.nodeType!==3||(N=A+p),ot!==b||d!==0&&ot.nodeType!==3||(q=A+d),ot.nodeType===3&&(A+=ot.nodeValue.length),(J=ot.firstChild)!==null;)Z=ot,ot=J;for(;;){if(ot===r)break e;if(Z===c&&++X===p&&(N=A),Z===b&&++it===d&&(q=A),(J=ot.nextSibling)!==null)break;ot=Z,Z=ot.parentNode}ot=J}c=N===-1||q===-1?null:{start:N,end:q}}else c=null}c=c||{start:0,end:0}}else c=null;for(j_={focusedElem:r,selectionRange:c},Gf=!1,mn=o;mn!==null;)if(o=mn,r=o.child,(o.subtreeFlags&1024)!==0&&r!==null)r.return=o,mn=r;else for(;mn!==null;){switch(o=mn,b=o.alternate,r=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&b!==null){r=void 0,c=o,p=b.memoizedProps,b=b.memoizedState,d=c.stateNode;try{var Ot=ho(c.type,p,c.elementType===c.type);r=d.getSnapshotBeforeUpdate(Ot,b),d.__reactInternalSnapshotBeforeUpdate=r}catch(Ct){ye(c,c.return,Ct)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,c=r.nodeType,c===9)U_(r);else if(c===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":U_(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(s(163))}if(r=o.sibling,r!==null){r.return=o.return,mn=r;break}mn=o.return}}function EE(r,o,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:Pr(r,c),d&4&&Mu(5,c);break;case 1:if(Pr(r,c),d&4)if(r=c.stateNode,o===null)try{r.componentDidMount()}catch(A){ye(c,c.return,A)}else{var p=ho(c.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(p,o,r.__reactInternalSnapshotBeforeUpdate)}catch(A){ye(c,c.return,A)}}d&64&&pE(c),d&512&&Ou(c,c.return);break;case 3:if(Pr(r,c),d&64&&(r=c.updateQueue,r!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{sv(r,o)}catch(A){ye(c,c.return,A)}}break;case 27:o===null&&d&4&&xE(c);case 26:case 5:Pr(r,c),o===null&&d&4&&yE(c),d&512&&Ou(c,c.return);break;case 12:Pr(r,c);break;case 13:Pr(r,c),d&4&&SE(r,c),d&64&&(r=c.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(c=rC.bind(null,c),TC(r,c))));break;case 22:if(d=c.memoizedState!==null||zi,!d){o=o!==null&&o.memoizedState!==null||$e,p=zi;var b=$e;zi=d,($e=o)&&!b?Lr(r,c,(c.subtreeFlags&8772)!==0):Pr(r,c),zi=p,$e=b}break;case 30:break;default:Pr(r,c)}}function TE(r){var o=r.alternate;o!==null&&(r.alternate=null,TE(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&rl(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Re=null,Xn=!1;function Hi(r,o,c){for(c=c.child;c!==null;)wE(r,o,c),c=c.sibling}function wE(r,o,c){if(In&&typeof In.onCommitFiberUnmount=="function")try{In.onCommitFiberUnmount(dr,c)}catch{}switch(c.tag){case 26:$e||oi(c,o),Hi(r,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:$e||oi(c,o);var d=Re,p=Xn;Hr(c.type)&&(Re=c.stateNode,Xn=!1),Hi(r,o,c),zu(c.stateNode),Re=d,Xn=p;break;case 5:$e||oi(c,o);case 6:if(d=Re,p=Xn,Re=null,Hi(r,o,c),Re=d,Xn=p,Re!==null)if(Xn)try{(Re.nodeType===9?Re.body:Re.nodeName==="HTML"?Re.ownerDocument.body:Re).removeChild(c.stateNode)}catch(b){ye(c,o,b)}else try{Re.removeChild(c.stateNode)}catch(b){ye(c,o,b)}break;case 18:Re!==null&&(Xn?(r=Re,dT(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,c.stateNode),Qu(r)):dT(Re,c.stateNode));break;case 4:d=Re,p=Xn,Re=c.stateNode.containerInfo,Xn=!0,Hi(r,o,c),Re=d,Xn=p;break;case 0:case 11:case 14:case 15:$e||Vr(2,c,o),$e||Vr(4,c,o),Hi(r,o,c);break;case 1:$e||(oi(c,o),d=c.stateNode,typeof d.componentWillUnmount=="function"&&_E(c,o,d)),Hi(r,o,c);break;case 21:Hi(r,o,c);break;case 22:$e=(d=$e)||c.memoizedState!==null,Hi(r,o,c),$e=d;break;default:Hi(r,o,c)}}function SE(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Qu(r)}catch(c){ye(o,o.return,c)}}function XN(r){switch(r.tag){case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new vE),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new vE),o;default:throw Error(s(435,r.tag))}}function m_(r,o){var c=XN(r);o.forEach(function(d){var p=aC.bind(null,r,d);c.has(d)||(c.add(d),d.then(p,p))})}function os(r,o){var c=o.deletions;if(c!==null)for(var d=0;d<c.length;d++){var p=c[d],b=r,A=o,N=A;t:for(;N!==null;){switch(N.tag){case 27:if(Hr(N.type)){Re=N.stateNode,Xn=!1;break t}break;case 5:Re=N.stateNode,Xn=!1;break t;case 3:case 4:Re=N.stateNode.containerInfo,Xn=!0;break t}N=N.return}if(Re===null)throw Error(s(160));wE(b,A,p),Re=null,Xn=!1,b=p.alternate,b!==null&&(b.return=null),p.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)AE(o,r),o=o.sibling}var Us=null;function AE(r,o){var c=r.alternate,d=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:os(o,r),ls(r),d&4&&(Vr(3,r,r.return),Mu(3,r),Vr(5,r,r.return));break;case 1:os(o,r),ls(r),d&512&&($e||c===null||oi(c,c.return)),d&64&&zi&&(r=r.updateQueue,r!==null&&(d=r.callbacks,d!==null&&(c=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var p=Us;if(os(o,r),ls(r),d&512&&($e||c===null||oi(c,c.return)),d&4){var b=c!==null?c.memoizedState:null;if(d=r.memoizedState,c===null)if(d===null)if(r.stateNode===null){t:{d=r.type,c=r.memoizedProps,p=p.ownerDocument||p;e:switch(d){case"title":b=p.getElementsByTagName("title")[0],(!b||b[yr]||b[ze]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=p.createElement(d),p.head.insertBefore(b,p.querySelector("head > title"))),En(b,d,c),b[ze]=r,He(b),d=b;break t;case"link":var A=xT("link","href",p).get(d+(c.href||""));if(A){for(var N=0;N<A.length;N++)if(b=A[N],b.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&b.getAttribute("rel")===(c.rel==null?null:c.rel)&&b.getAttribute("title")===(c.title==null?null:c.title)&&b.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){A.splice(N,1);break e}}b=p.createElement(d),En(b,d,c),p.head.appendChild(b);break;case"meta":if(A=xT("meta","content",p).get(d+(c.content||""))){for(N=0;N<A.length;N++)if(b=A[N],b.getAttribute("content")===(c.content==null?null:""+c.content)&&b.getAttribute("name")===(c.name==null?null:c.name)&&b.getAttribute("property")===(c.property==null?null:c.property)&&b.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&b.getAttribute("charset")===(c.charSet==null?null:c.charSet)){A.splice(N,1);break e}}b=p.createElement(d),En(b,d,c),p.head.appendChild(b);break;default:throw Error(s(468,d))}b[ze]=r,He(b),d=b}r.stateNode=d}else vT(p,r.type,r.stateNode);else r.stateNode=bT(p,d,r.memoizedProps);else b!==d?(b===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):b.count--,d===null?vT(p,r.type,r.stateNode):bT(p,d,r.memoizedProps)):d===null&&r.stateNode!==null&&u_(r,r.memoizedProps,c.memoizedProps)}break;case 27:os(o,r),ls(r),d&512&&($e||c===null||oi(c,c.return)),c!==null&&d&4&&u_(r,r.memoizedProps,c.memoizedProps);break;case 5:if(os(o,r),ls(r),d&512&&($e||c===null||oi(c,c.return)),r.flags&32){p=r.stateNode;try{xs(p,"")}catch(J){ye(r,r.return,J)}}d&4&&r.stateNode!=null&&(p=r.memoizedProps,u_(r,p,c!==null?c.memoizedProps:p)),d&1024&&(f_=!0);break;case 6:if(os(o,r),ls(r),d&4){if(r.stateNode===null)throw Error(s(162));d=r.memoizedProps,c=r.stateNode;try{c.nodeValue=d}catch(J){ye(r,r.return,J)}}break;case 3:if(zf=null,p=Us,Us=Ff(o.containerInfo),os(o,r),Us=p,ls(r),d&4&&c!==null&&c.memoizedState.isDehydrated)try{Qu(o.containerInfo)}catch(J){ye(r,r.return,J)}f_&&(f_=!1,IE(r));break;case 4:d=Us,Us=Ff(r.stateNode.containerInfo),os(o,r),ls(r),Us=d;break;case 12:os(o,r),ls(r);break;case 13:os(o,r),ls(r),r.child.flags&8192&&r.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(x_=Kn()),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,m_(r,d)));break;case 22:p=r.memoizedState!==null;var q=c!==null&&c.memoizedState!==null,X=zi,it=$e;if(zi=X||p,$e=it||q,os(o,r),$e=it,zi=X,ls(r),d&8192)t:for(o=r.stateNode,o._visibility=p?o._visibility&-2:o._visibility|1,p&&(c===null||q||zi||$e||fo(r)),c=null,o=r;;){if(o.tag===5||o.tag===26){if(c===null){q=c=o;try{if(b=q.stateNode,p)A=b.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{N=q.stateNode;var ot=q.memoizedProps.style,Z=ot!=null&&ot.hasOwnProperty("display")?ot.display:null;N.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(J){ye(q,q.return,J)}}}else if(o.tag===6){if(c===null){q=o;try{q.stateNode.nodeValue=p?"":q.memoizedProps}catch(J){ye(q,q.return,J)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break t;for(;o.sibling===null;){if(o.return===null||o.return===r)break t;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}d&4&&(d=r.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,m_(r,c))));break;case 19:os(o,r),ls(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,m_(r,d)));break;case 30:break;case 21:break;default:os(o,r),ls(r)}}function ls(r){var o=r.flags;if(o&2){try{for(var c,d=r.return;d!==null;){if(bE(d)){c=d;break}d=d.return}if(c==null)throw Error(s(160));switch(c.tag){case 27:var p=c.stateNode,b=h_(r);If(r,b,p);break;case 5:var A=c.stateNode;c.flags&32&&(xs(A,""),c.flags&=-33);var N=h_(r);If(r,N,A);break;case 3:case 4:var q=c.stateNode.containerInfo,X=h_(r);d_(r,X,q);break;default:throw Error(s(161))}}catch(it){ye(r,r.return,it)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function IE(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;IE(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function Pr(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)EE(r,o.alternate,o),o=o.sibling}function fo(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:Vr(4,o,o.return),fo(o);break;case 1:oi(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&_E(o,o.return,c),fo(o);break;case 27:zu(o.stateNode);case 26:case 5:oi(o,o.return),fo(o);break;case 22:o.memoizedState===null&&fo(o);break;case 30:fo(o);break;default:fo(o)}r=r.sibling}}function Lr(r,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var d=o.alternate,p=r,b=o,A=b.flags;switch(b.tag){case 0:case 11:case 15:Lr(p,b,c),Mu(4,b);break;case 1:if(Lr(p,b,c),d=b,p=d.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(X){ye(d,d.return,X)}if(d=b,p=d.updateQueue,p!==null){var N=d.stateNode;try{var q=p.shared.hiddenCallbacks;if(q!==null)for(p.shared.hiddenCallbacks=null,p=0;p<q.length;p++)nv(q[p],N)}catch(X){ye(d,d.return,X)}}c&&A&64&&pE(b),Ou(b,b.return);break;case 27:xE(b);case 26:case 5:Lr(p,b,c),c&&d===null&&A&4&&yE(b),Ou(b,b.return);break;case 12:Lr(p,b,c);break;case 13:Lr(p,b,c),c&&A&4&&SE(p,b);break;case 22:b.memoizedState===null&&Lr(p,b,c),Ou(b,b.return);break;case 30:break;default:Lr(p,b,c)}o=o.sibling}}function g_(r,o){var c=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==c&&(r!=null&&r.refCount++,c!=null&&yu(c))}function p_(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&yu(r))}function li(r,o,c,d){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)RE(r,o,c,d),o=o.sibling}function RE(r,o,c,d){var p=o.flags;switch(o.tag){case 0:case 11:case 15:li(r,o,c,d),p&2048&&Mu(9,o);break;case 1:li(r,o,c,d);break;case 3:li(r,o,c,d),p&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&yu(r)));break;case 12:if(p&2048){li(r,o,c,d),r=o.stateNode;try{var b=o.memoizedProps,A=b.id,N=b.onPostCommit;typeof N=="function"&&N(A,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(q){ye(o,o.return,q)}}else li(r,o,c,d);break;case 13:li(r,o,c,d);break;case 23:break;case 22:b=o.stateNode,A=o.alternate,o.memoizedState!==null?b._visibility&2?li(r,o,c,d):ku(r,o):b._visibility&2?li(r,o,c,d):(b._visibility|=2,Ml(r,o,c,d,(o.subtreeFlags&10256)!==0)),p&2048&&g_(A,o);break;case 24:li(r,o,c,d),p&2048&&p_(o.alternate,o);break;default:li(r,o,c,d)}}function Ml(r,o,c,d,p){for(p=p&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var b=r,A=o,N=c,q=d,X=A.flags;switch(A.tag){case 0:case 11:case 15:Ml(b,A,N,q,p),Mu(8,A);break;case 23:break;case 22:var it=A.stateNode;A.memoizedState!==null?it._visibility&2?Ml(b,A,N,q,p):ku(b,A):(it._visibility|=2,Ml(b,A,N,q,p)),p&&X&2048&&g_(A.alternate,A);break;case 24:Ml(b,A,N,q,p),p&&X&2048&&p_(A.alternate,A);break;default:Ml(b,A,N,q,p)}o=o.sibling}}function ku(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=r,d=o,p=d.flags;switch(d.tag){case 22:ku(c,d),p&2048&&g_(d.alternate,d);break;case 24:ku(c,d),p&2048&&p_(d.alternate,d);break;default:ku(c,d)}o=o.sibling}}var Vu=8192;function Ol(r){if(r.subtreeFlags&Vu)for(r=r.child;r!==null;)DE(r),r=r.sibling}function DE(r){switch(r.tag){case 26:Ol(r),r.flags&Vu&&r.memoizedState!==null&&PC(Us,r.memoizedState,r.memoizedProps);break;case 5:Ol(r);break;case 3:case 4:var o=Us;Us=Ff(r.stateNode.containerInfo),Ol(r),Us=o;break;case 22:r.memoizedState===null&&(o=r.alternate,o!==null&&o.memoizedState!==null?(o=Vu,Vu=16777216,Ol(r),Vu=o):Ol(r));break;default:Ol(r)}}function NE(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function Pu(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var d=o[c];mn=d,ME(d,r)}NE(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)CE(r),r=r.sibling}function CE(r){switch(r.tag){case 0:case 11:case 15:Pu(r),r.flags&2048&&Vr(9,r,r.return);break;case 3:Pu(r);break;case 12:Pu(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,Rf(r)):Pu(r);break;default:Pu(r)}}function Rf(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var d=o[c];mn=d,ME(d,r)}NE(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:Vr(8,o,o.return),Rf(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,Rf(o));break;default:Rf(o)}r=r.sibling}}function ME(r,o){for(;mn!==null;){var c=mn;switch(c.tag){case 0:case 11:case 15:Vr(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:yu(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,mn=d;else t:for(c=r;mn!==null;){d=mn;var p=d.sibling,b=d.return;if(TE(d),d===c){mn=null;break t}if(p!==null){p.return=b,mn=p;break t}mn=b}}}var ZN={getCacheForType:function(r){var o=Dn(rn),c=o.data.get(r);return c===void 0&&(c=r(),o.data.set(r,c)),c}},JN=typeof WeakMap=="function"?WeakMap:Map,ce=0,xe=null,Gt=null,Zt=0,ue=0,cs=null,jr=!1,kl=!1,__=!1,qi=0,Le=0,Br=0,mo=0,y_=0,Is=0,Vl=0,Lu=null,Zn=null,b_=!1,x_=0,Df=1/0,Nf=null,Fr=null,vn=0,Ur=null,Pl=null,Ll=0,v_=0,E_=null,OE=null,ju=0,T_=null;function us(){if((ce&2)!==0&&Zt!==0)return Zt&-Zt;if(Y.T!==null){var r=wl;return r!==0?r:N_()}return Ai()}function kE(){Is===0&&(Is=(Zt&536870912)===0||ae?Yc():536870912);var r=As.current;return r!==null&&(r.flags|=32),Is}function hs(r,o,c){(r===xe&&(ue===2||ue===9)||r.cancelPendingCommit!==null)&&(jl(r,0),zr(r,Zt,Is,!1)),Ue(r,c),((ce&2)===0||r!==xe)&&(r===xe&&((ce&2)===0&&(mo|=c),Le===4&&zr(r,Zt,Is,!1)),ci(r))}function VE(r,o,c){if((ce&6)!==0)throw Error(s(327));var d=!c&&(o&124)===0&&(o&r.expiredLanes)===0||mr(r,o),p=d?nC(r,o):A_(r,o,!0),b=d;do{if(p===0){kl&&!d&&zr(r,o,0,!1);break}else{if(c=r.current.alternate,b&&!tC(c)){p=A_(r,o,!1),b=!1;continue}if(p===2){if(b=o,r.errorRecoveryDisabledLanes&b)var A=0;else A=r.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){o=A;t:{var N=r;p=Lu;var q=N.current.memoizedState.isDehydrated;if(q&&(jl(N,A).flags|=256),A=A_(N,A,!1),A!==2){if(__&&!q){N.errorRecoveryDisabledLanes|=b,mo|=b,p=4;break t}b=Zn,Zn=p,b!==null&&(Zn===null?Zn=b:Zn.push.apply(Zn,b))}p=A}if(b=!1,p!==2)continue}}if(p===1){jl(r,0),zr(r,o,0,!0);break}t:{switch(d=r,b=p,b){case 0:case 1:throw Error(s(345));case 4:if((o&4194048)!==o)break;case 6:zr(d,o,Is,!jr);break t;case 2:Zn=null;break;case 3:case 5:break;default:throw Error(s(329))}if((o&62914560)===o&&(p=x_+300-Kn(),10<p)){if(zr(d,o,Is,!jr),ys(d,0,!0)!==0)break t;d.timeoutHandle=uT(PE.bind(null,d,c,Zn,Nf,b_,o,Is,mo,Vl,jr,b,2,-0,0),p);break t}PE(d,c,Zn,Nf,b_,o,Is,mo,Vl,jr,b,0,-0,0)}}break}while(!0);ci(r)}function PE(r,o,c,d,p,b,A,N,q,X,it,ot,Z,J){if(r.timeoutHandle=-1,ot=o.subtreeFlags,(ot&8192||(ot&16785408)===16785408)&&(Gu={stylesheets:null,count:0,unsuspend:VC},DE(o),ot=LC(),ot!==null)){r.cancelPendingCommit=ot(HE.bind(null,r,o,b,c,d,p,A,N,q,it,1,Z,J)),zr(r,b,A,!X);return}HE(r,o,b,c,d,p,A,N,q)}function tC(r){for(var o=r;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var p=c[d],b=p.getSnapshot;p=p.value;try{if(!rs(b(),p))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function zr(r,o,c,d){o&=~y_,o&=~mo,r.suspendedLanes|=o,r.pingedLanes&=~o,d&&(r.warmLanes|=o),d=r.expirationTimes;for(var p=o;0<p;){var b=31-Fn(p),A=1<<b;d[b]=-1,p&=~A}c!==0&&pr(r,c,o)}function Cf(){return(ce&6)===0?(Bu(0),!1):!0}function w_(){if(Gt!==null){if(ue===0)var r=Gt.return;else r=Gt,Pi=oo=null,Up(r),Nl=null,Du=0,r=Gt;for(;r!==null;)gE(r.alternate,r),r=r.return;Gt=null}}function jl(r,o){var c=r.timeoutHandle;c!==-1&&(r.timeoutHandle=-1,yC(c)),c=r.cancelPendingCommit,c!==null&&(r.cancelPendingCommit=null,c()),w_(),xe=r,Gt=c=Oi(r.current,null),Zt=o,ue=0,cs=null,jr=!1,kl=mr(r,o),__=!1,Vl=Is=y_=mo=Br=Le=0,Zn=Lu=null,b_=!1,(o&8)!==0&&(o|=o&32);var d=r.entangledLanes;if(d!==0)for(r=r.entanglements,d&=o;0<d;){var p=31-Fn(d),b=1<<p;o|=r[p],d&=~b}return qi=o,Zd(),c}function LE(r,o){zt=null,Y.H=yf,o===xu||o===lf?(o=tv(),ue=3):o===Xx?(o=tv(),ue=4):ue=o===eE?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,cs=o,Gt===null&&(Le=1,Tf(r,Es(o,r.current)))}function jE(){var r=Y.H;return Y.H=yf,r===null?yf:r}function BE(){var r=Y.A;return Y.A=ZN,r}function S_(){Le=4,jr||(Zt&4194048)!==Zt&&As.current!==null||(kl=!0),(Br&134217727)===0&&(mo&134217727)===0||xe===null||zr(xe,Zt,Is,!1)}function A_(r,o,c){var d=ce;ce|=2;var p=jE(),b=BE();(xe!==r||Zt!==o)&&(Nf=null,jl(r,o)),o=!1;var A=Le;t:do try{if(ue!==0&&Gt!==null){var N=Gt,q=cs;switch(ue){case 8:w_(),A=6;break t;case 3:case 2:case 9:case 6:As.current===null&&(o=!0);var X=ue;if(ue=0,cs=null,Bl(r,N,q,X),c&&kl){A=0;break t}break;default:X=ue,ue=0,cs=null,Bl(r,N,q,X)}}eC(),A=Le;break}catch(it){LE(r,it)}while(!0);return o&&r.shellSuspendCounter++,Pi=oo=null,ce=d,Y.H=p,Y.A=b,Gt===null&&(xe=null,Zt=0,Zd()),A}function eC(){for(;Gt!==null;)FE(Gt)}function nC(r,o){var c=ce;ce|=2;var d=jE(),p=BE();xe!==r||Zt!==o?(Nf=null,Df=Kn()+500,jl(r,o)):kl=mr(r,o);t:do try{if(ue!==0&&Gt!==null){o=Gt;var b=cs;e:switch(ue){case 1:ue=0,cs=null,Bl(r,o,b,1);break;case 2:case 9:if(Zx(b)){ue=0,cs=null,UE(o);break}o=function(){ue!==2&&ue!==9||xe!==r||(ue=7),ci(r)},b.then(o,o);break t;case 3:ue=7;break t;case 4:ue=5;break t;case 7:Zx(b)?(ue=0,cs=null,UE(o)):(ue=0,cs=null,Bl(r,o,b,7));break;case 5:var A=null;switch(Gt.tag){case 26:A=Gt.memoizedState;case 5:case 27:var N=Gt;if(!A||ET(A)){ue=0,cs=null;var q=N.sibling;if(q!==null)Gt=q;else{var X=N.return;X!==null?(Gt=X,Mf(X)):Gt=null}break e}}ue=0,cs=null,Bl(r,o,b,5);break;case 6:ue=0,cs=null,Bl(r,o,b,6);break;case 8:w_(),Le=6;break t;default:throw Error(s(462))}}sC();break}catch(it){LE(r,it)}while(!0);return Pi=oo=null,Y.H=d,Y.A=p,ce=c,Gt!==null?0:(xe=null,Zt=0,Zd(),Le)}function sC(){for(;Gt!==null&&!tp();)FE(Gt)}function FE(r){var o=fE(r.alternate,r,qi);r.memoizedProps=r.pendingProps,o===null?Mf(r):Gt=o}function UE(r){var o=r,c=o.alternate;switch(o.tag){case 15:case 0:o=oE(c,o,o.pendingProps,o.type,void 0,Zt);break;case 11:o=oE(c,o,o.pendingProps,o.type.render,o.ref,Zt);break;case 5:Up(o);default:gE(c,o),o=Gt=zx(o,qi),o=fE(c,o,qi)}r.memoizedProps=r.pendingProps,o===null?Mf(r):Gt=o}function Bl(r,o,c,d){Pi=oo=null,Up(o),Nl=null,Du=0;var p=o.return;try{if($N(r,p,o,c,Zt)){Le=1,Tf(r,Es(c,r.current)),Gt=null;return}}catch(b){if(p!==null)throw Gt=p,b;Le=1,Tf(r,Es(c,r.current)),Gt=null;return}o.flags&32768?(ae||d===1?r=!0:kl||(Zt&536870912)!==0?r=!1:(jr=r=!0,(d===2||d===9||d===3||d===6)&&(d=As.current,d!==null&&d.tag===13&&(d.flags|=16384))),zE(o,r)):Mf(o)}function Mf(r){var o=r;do{if((o.flags&32768)!==0){zE(o,jr);return}r=o.return;var c=YN(o.alternate,o,qi);if(c!==null){Gt=c;return}if(o=o.sibling,o!==null){Gt=o;return}Gt=o=r}while(o!==null);Le===0&&(Le=5)}function zE(r,o){do{var c=KN(r.alternate,r);if(c!==null){c.flags&=32767,Gt=c;return}if(c=r.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(r=r.sibling,r!==null)){Gt=r;return}Gt=r=c}while(r!==null);Le=6,Gt=null}function HE(r,o,c,d,p,b,A,N,q){r.cancelPendingCommit=null;do Of();while(vn!==0);if((ce&6)!==0)throw Error(s(327));if(o!==null){if(o===r.current)throw Error(s(177));if(b=o.lanes|o.childLanes,b|=pp,Vd(r,c,b,A,N,q),r===xe&&(Gt=xe=null,Zt=0),Pl=o,Ur=r,Ll=c,v_=b,E_=p,OE=d,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,oC(Si,function(){return YE(),null})):(r.callbackNode=null,r.callbackPriority=0),d=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||d){d=Y.T,Y.T=null,p=at.p,at.p=2,A=ce,ce|=4;try{QN(r,o,c)}finally{ce=A,at.p=p,Y.T=d}}vn=1,qE(),GE(),$E()}}function qE(){if(vn===1){vn=0;var r=Ur,o=Pl,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=Y.T,Y.T=null;var d=at.p;at.p=2;var p=ce;ce|=4;try{AE(o,r);var b=j_,A=Mx(r.containerInfo),N=b.focusedElem,q=b.selectionRange;if(A!==N&&N&&N.ownerDocument&&Cx(N.ownerDocument.documentElement,N)){if(q!==null&&hp(N)){var X=q.start,it=q.end;if(it===void 0&&(it=X),"selectionStart"in N)N.selectionStart=X,N.selectionEnd=Math.min(it,N.value.length);else{var ot=N.ownerDocument||document,Z=ot&&ot.defaultView||window;if(Z.getSelection){var J=Z.getSelection(),Ot=N.textContent.length,Ct=Math.min(q.start,Ot),_e=q.end===void 0?Ct:Math.min(q.end,Ot);!J.extend&&Ct>_e&&(A=_e,_e=Ct,Ct=A);var $=Nx(N,Ct),G=Nx(N,_e);if($&&G&&(J.rangeCount!==1||J.anchorNode!==$.node||J.anchorOffset!==$.offset||J.focusNode!==G.node||J.focusOffset!==G.offset)){var K=ot.createRange();K.setStart($.node,$.offset),J.removeAllRanges(),Ct>_e?(J.addRange(K),J.extend(G.node,G.offset)):(K.setEnd(G.node,G.offset),J.addRange(K))}}}}for(ot=[],J=N;J=J.parentNode;)J.nodeType===1&&ot.push({element:J,left:J.scrollLeft,top:J.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<ot.length;N++){var rt=ot[N];rt.element.scrollLeft=rt.left,rt.element.scrollTop=rt.top}}Gf=!!L_,j_=L_=null}finally{ce=p,at.p=d,Y.T=c}}r.current=o,vn=2}}function GE(){if(vn===2){vn=0;var r=Ur,o=Pl,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=Y.T,Y.T=null;var d=at.p;at.p=2;var p=ce;ce|=4;try{EE(r,o.alternate,o)}finally{ce=p,at.p=d,Y.T=c}}vn=3}}function $E(){if(vn===4||vn===3){vn=0,$c();var r=Ur,o=Pl,c=Ll,d=OE;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?vn=5:(vn=0,Pl=Ur=null,WE(r,r.pendingLanes));var p=r.pendingLanes;if(p===0&&(Fr=null),Qc(c),o=o.stateNode,In&&typeof In.onCommitFiberRoot=="function")try{In.onCommitFiberRoot(dr,o,void 0,(o.current.flags&128)===128)}catch{}if(d!==null){o=Y.T,p=at.p,at.p=2,Y.T=null;try{for(var b=r.onRecoverableError,A=0;A<d.length;A++){var N=d[A];b(N.value,{componentStack:N.stack})}}finally{Y.T=o,at.p=p}}(Ll&3)!==0&&Of(),ci(r),p=r.pendingLanes,(c&4194090)!==0&&(p&42)!==0?r===T_?ju++:(ju=0,T_=r):ju=0,Bu(0)}}function WE(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,yu(o)))}function Of(r){return qE(),GE(),$E(),YE()}function YE(){if(vn!==5)return!1;var r=Ur,o=v_;v_=0;var c=Qc(Ll),d=Y.T,p=at.p;try{at.p=32>c?32:c,Y.T=null,c=E_,E_=null;var b=Ur,A=Ll;if(vn=0,Pl=Ur=null,Ll=0,(ce&6)!==0)throw Error(s(331));var N=ce;if(ce|=4,CE(b.current),RE(b,b.current,A,c),ce=N,Bu(0,!1),In&&typeof In.onPostCommitFiberRoot=="function")try{In.onPostCommitFiberRoot(dr,b)}catch{}return!0}finally{at.p=p,Y.T=d,WE(r,o)}}function KE(r,o,c){o=Es(c,o),o=e_(r.stateNode,o,2),r=Cr(r,o,2),r!==null&&(Ue(r,2),ci(r))}function ye(r,o,c){if(r.tag===3)KE(r,r,c);else for(;o!==null;){if(o.tag===3){KE(o,r,c);break}else if(o.tag===1){var d=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Fr===null||!Fr.has(d))){r=Es(c,r),c=Jv(2),d=Cr(o,c,2),d!==null&&(tE(c,d,o,r),Ue(d,2),ci(d));break}}o=o.return}}function I_(r,o,c){var d=r.pingCache;if(d===null){d=r.pingCache=new JN;var p=new Set;d.set(o,p)}else p=d.get(o),p===void 0&&(p=new Set,d.set(o,p));p.has(c)||(__=!0,p.add(c),r=iC.bind(null,r,o,c),o.then(r,r))}function iC(r,o,c){var d=r.pingCache;d!==null&&d.delete(o),r.pingedLanes|=r.suspendedLanes&c,r.warmLanes&=~c,xe===r&&(Zt&c)===c&&(Le===4||Le===3&&(Zt&62914560)===Zt&&300>Kn()-x_?(ce&2)===0&&jl(r,0):y_|=c,Vl===Zt&&(Vl=0)),ci(r)}function QE(r,o){o===0&&(o=gr()),r=xl(r,o),r!==null&&(Ue(r,o),ci(r))}function rC(r){var o=r.memoizedState,c=0;o!==null&&(c=o.retryLane),QE(r,c)}function aC(r,o){var c=0;switch(r.tag){case 13:var d=r.stateNode,p=r.memoizedState;p!==null&&(c=p.retryLane);break;case 19:d=r.stateNode;break;case 22:d=r.stateNode._retryCache;break;default:throw Error(s(314))}d!==null&&d.delete(o),QE(r,c)}function oC(r,o){return wi(r,o)}var kf=null,Fl=null,R_=!1,Vf=!1,D_=!1,go=0;function ci(r){r!==Fl&&r.next===null&&(Fl===null?kf=Fl=r:Fl=Fl.next=r),Vf=!0,R_||(R_=!0,cC())}function Bu(r,o){if(!D_&&Vf){D_=!0;do for(var c=!1,d=kf;d!==null;){if(r!==0){var p=d.pendingLanes;if(p===0)var b=0;else{var A=d.suspendedLanes,N=d.pingedLanes;b=(1<<31-Fn(42|r)+1)-1,b&=p&~(A&~N),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(c=!0,tT(d,b))}else b=Zt,b=ys(d,d===xe?b:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(b&3)===0||mr(d,b)||(c=!0,tT(d,b));d=d.next}while(c);D_=!1}}function lC(){XE()}function XE(){Vf=R_=!1;var r=0;go!==0&&(_C()&&(r=go),go=0);for(var o=Kn(),c=null,d=kf;d!==null;){var p=d.next,b=ZE(d,o);b===0?(d.next=null,c===null?kf=p:c.next=p,p===null&&(Fl=c)):(c=d,(r!==0||(b&3)!==0)&&(Vf=!0)),d=p}Bu(r)}function ZE(r,o){for(var c=r.suspendedLanes,d=r.pingedLanes,p=r.expirationTimes,b=r.pendingLanes&-62914561;0<b;){var A=31-Fn(b),N=1<<A,q=p[A];q===-1?((N&c)===0||(N&d)!==0)&&(p[A]=sl(N,o)):q<=o&&(r.expiredLanes|=N),b&=~N}if(o=xe,c=Zt,c=ys(r,r===o?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d=r.callbackNode,c===0||r===o&&(ue===2||ue===9)||r.cancelPendingCommit!==null)return d!==null&&d!==null&&hr(d),r.callbackNode=null,r.callbackPriority=0;if((c&3)===0||mr(r,c)){if(o=c&-c,o===r.callbackPriority)return o;switch(d!==null&&hr(d),Qc(c)){case 2:case 8:c=hn;break;case 32:c=Si;break;case 268435456:c=Wc;break;default:c=Si}return d=JE.bind(null,r),c=wi(c,d),r.callbackPriority=o,r.callbackNode=c,o}return d!==null&&d!==null&&hr(d),r.callbackPriority=2,r.callbackNode=null,2}function JE(r,o){if(vn!==0&&vn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var c=r.callbackNode;if(Of()&&r.callbackNode!==c)return null;var d=Zt;return d=ys(r,r===xe?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d===0?null:(VE(r,d,o),ZE(r,Kn()),r.callbackNode!=null&&r.callbackNode===c?JE.bind(null,r):null)}function tT(r,o){if(Of())return null;VE(r,o,!0)}function cC(){bC(function(){(ce&6)!==0?wi(nn,lC):XE()})}function N_(){return go===0&&(go=Yc()),go}function eT(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Ps(""+r)}function nT(r,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,r.id&&c.setAttribute("form",r.id),o.parentNode.insertBefore(c,o),r=new FormData(r),c.parentNode.removeChild(c),r}function uC(r,o,c,d,p){if(o==="submit"&&c&&c.stateNode===p){var b=eT((p[bn]||null).action),A=d.submitter;A&&(o=(o=A[bn]||null)?eT(o.formAction):A.getAttribute("formAction"),o!==null&&(b=o,A=null));var N=new Wa("action","action",null,d,p);r.push({event:N,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(go!==0){var q=A?nT(p,A):new FormData(p);Qp(c,{pending:!0,data:q,method:p.method,action:b},null,q)}}else typeof b=="function"&&(N.preventDefault(),q=A?nT(p,A):new FormData(p),Qp(c,{pending:!0,data:q,method:p.method,action:b},b,q))},currentTarget:p}]})}}for(var C_=0;C_<gp.length;C_++){var M_=gp[C_],hC=M_.toLowerCase(),dC=M_[0].toUpperCase()+M_.slice(1);Fs(hC,"on"+dC)}Fs(Vx,"onAnimationEnd"),Fs(Px,"onAnimationIteration"),Fs(Lx,"onAnimationStart"),Fs("dblclick","onDoubleClick"),Fs("focusin","onFocus"),Fs("focusout","onBlur"),Fs(DN,"onTransitionRun"),Fs(NN,"onTransitionStart"),Fs(CN,"onTransitionCancel"),Fs(jx,"onTransitionEnd"),ei("onMouseEnter",["mouseout","mouseover"]),ei("onMouseLeave",["mouseout","mouseover"]),ei("onPointerEnter",["pointerout","pointerover"]),ei("onPointerLeave",["pointerout","pointerover"]),ti("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ti("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ti("onBeforeInput",["compositionend","keypress","textInput","paste"]),ti("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ti("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ti("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Fu));function sT(r,o){o=(o&4)!==0;for(var c=0;c<r.length;c++){var d=r[c],p=d.event;d=d.listeners;t:{var b=void 0;if(o)for(var A=d.length-1;0<=A;A--){var N=d[A],q=N.instance,X=N.currentTarget;if(N=N.listener,q!==b&&p.isPropagationStopped())break t;b=N,p.currentTarget=X;try{b(p)}catch(it){Ef(it)}p.currentTarget=null,b=q}else for(A=0;A<d.length;A++){if(N=d[A],q=N.instance,X=N.currentTarget,N=N.listener,q!==b&&p.isPropagationStopped())break t;b=N,p.currentTarget=X;try{b(p)}catch(it){Ef(it)}p.currentTarget=null,b=q}}}}function $t(r,o){var c=o[ka];c===void 0&&(c=o[ka]=new Set);var d=r+"__bubble";c.has(d)||(iT(o,r,2,!1),c.add(d))}function O_(r,o,c){var d=0;o&&(d|=4),iT(c,r,d,o)}var Pf="_reactListening"+Math.random().toString(36).slice(2);function k_(r){if(!r[Pf]){r[Pf]=!0,Pd.forEach(function(c){c!=="selectionchange"&&(fC.has(c)||O_(c,!1,r),O_(c,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[Pf]||(o[Pf]=!0,O_("selectionchange",!1,o))}}function iT(r,o,c,d){switch(RT(o)){case 2:var p=FC;break;case 8:p=UC;break;default:p=Y_}c=p.bind(null,o,c,r),p=void 0,!Ci||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(p=!0),d?p!==void 0?r.addEventListener(o,c,{capture:!0,passive:p}):r.addEventListener(o,c,!0):p!==void 0?r.addEventListener(o,c,{passive:p}):r.addEventListener(o,c,!1)}function V_(r,o,c,d,p){var b=d;if((o&1)===0&&(o&2)===0&&d!==null)t:for(;;){if(d===null)return;var A=d.tag;if(A===3||A===4){var N=d.stateNode.containerInfo;if(N===p)break;if(A===4)for(A=d.return;A!==null;){var q=A.tag;if((q===3||q===4)&&A.stateNode.containerInfo===p)return;A=A.return}for(;N!==null;){if(A=Zs(N),A===null)return;if(q=A.tag,q===5||q===6||q===26||q===27){d=b=A;continue t}N=N.parentNode}}d=d.return}qa(function(){var X=b,it=su(c),ot=[];t:{var Z=Bx.get(r);if(Z!==void 0){var J=Wa,Ot=r;switch(r){case"keypress":if(Ga(c)===0)break t;case"keydown":case"keyup":J=pl;break;case"focusin":Ot="focus",J=fl;break;case"focusout":Ot="blur",J=fl;break;case"beforeblur":case"afterblur":J=fl;break;case"click":if(c.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":J=Za;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":J=Hd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":J=Ir;break;case Vx:case Px:case Lx:J=ru;break;case jx:J=v;break;case"scroll":case"scrollend":J=Ka;break;case"wheel":J=V;break;case"copy":case"cut":case"paste":J=Gd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":J=lu;break;case"toggle":case"beforetoggle":J=et}var Ct=(o&4)!==0,_e=!Ct&&(r==="scroll"||r==="scrollend"),$=Ct?Z!==null?Z+"Capture":null:Z;Ct=[];for(var G=X,K;G!==null;){var rt=G;if(K=rt.stateNode,rt=rt.tag,rt!==5&&rt!==26&&rt!==27||K===null||$===null||(rt=Sr(G,$),rt!=null&&Ct.push(Uu(G,rt,K))),_e)break;G=G.return}0<Ct.length&&(Z=new J(Z,Ot,null,c,it),ot.push({event:Z,listeners:Ct}))}}if((o&7)===0){t:{if(Z=r==="mouseover"||r==="pointerover",J=r==="mouseout"||r==="pointerout",Z&&c!==nu&&(Ot=c.relatedTarget||c.fromElement)&&(Zs(Ot)||Ot[Ii]))break t;if((J||Z)&&(Z=it.window===it?it:(Z=it.ownerDocument)?Z.defaultView||Z.parentWindow:window,J?(Ot=c.relatedTarget||c.toElement,J=X,Ot=Ot?Zs(Ot):null,Ot!==null&&(_e=a(Ot),Ct=Ot.tag,Ot!==_e||Ct!==5&&Ct!==27&&Ct!==6)&&(Ot=null)):(J=null,Ot=X),J!==Ot)){if(Ct=Za,rt="onMouseLeave",$="onMouseEnter",G="mouse",(r==="pointerout"||r==="pointerover")&&(Ct=lu,rt="onPointerLeave",$="onPointerEnter",G="pointer"),_e=J==null?Z:br(J),K=Ot==null?Z:br(Ot),Z=new Ct(rt,G+"leave",J,c,it),Z.target=_e,Z.relatedTarget=K,rt=null,Zs(it)===X&&(Ct=new Ct($,G+"enter",Ot,c,it),Ct.target=K,Ct.relatedTarget=_e,rt=Ct),_e=rt,J&&Ot)e:{for(Ct=J,$=Ot,G=0,K=Ct;K;K=Ul(K))G++;for(K=0,rt=$;rt;rt=Ul(rt))K++;for(;0<G-K;)Ct=Ul(Ct),G--;for(;0<K-G;)$=Ul($),K--;for(;G--;){if(Ct===$||$!==null&&Ct===$.alternate)break e;Ct=Ul(Ct),$=Ul($)}Ct=null}else Ct=null;J!==null&&rT(ot,Z,J,Ct,!1),Ot!==null&&_e!==null&&rT(ot,_e,Ot,Ct,!0)}}t:{if(Z=X?br(X):window,J=Z.nodeName&&Z.nodeName.toLowerCase(),J==="select"||J==="input"&&Z.type==="file")var Tt=wx;else if(Ex(Z))if(Sx)Tt=AN;else{Tt=wN;var Ht=TN}else J=Z.nodeName,!J||J.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?X&&ul(X.elementType)&&(Tt=wx):Tt=SN;if(Tt&&(Tt=Tt(r,X))){Tx(ot,Tt,c,it);break t}Ht&&Ht(r,Z,X),r==="focusout"&&X&&Z.type==="number"&&X.memoizedProps.value!=null&&Jc(Z,"number",Z.value)}switch(Ht=X?br(X):window,r){case"focusin":(Ex(Ht)||Ht.contentEditable==="true")&&(_l=Ht,dp=X,fu=null);break;case"focusout":fu=dp=_l=null;break;case"mousedown":fp=!0;break;case"contextmenu":case"mouseup":case"dragend":fp=!1,Ox(ot,c,it);break;case"selectionchange":if(RN)break;case"keydown":case"keyup":Ox(ot,c,it)}var Nt;if(Pt)t:{switch(r){case"compositionstart":var Mt="onCompositionStart";break t;case"compositionend":Mt="onCompositionEnd";break t;case"compositionupdate":Mt="onCompositionUpdate";break t}Mt=void 0}else Bs?Ls(r,c)&&(Mt="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(Mt="onCompositionStart");Mt&&(qe&&c.locale!=="ko"&&(Bs||Mt!=="onCompositionStart"?Mt==="onCompositionEnd"&&Bs&&(Nt=zd()):(vs=it,be="value"in vs?vs.value:vs.textContent,Bs=!0)),Ht=Lf(X,Mt),0<Ht.length&&(Mt=new ou(Mt,r,null,c,it),ot.push({event:Mt,listeners:Ht}),Nt?Mt.data=Nt:(Nt=js(c),Nt!==null&&(Mt.data=Nt)))),(Nt=le?cu(r,c):xN(r,c))&&(Mt=Lf(X,"onBeforeInput"),0<Mt.length&&(Ht=new ou("onBeforeInput","beforeinput",null,c,it),ot.push({event:Ht,listeners:Mt}),Ht.data=Nt)),uC(ot,r,X,c,it)}sT(ot,o)})}function Uu(r,o,c){return{instance:r,listener:o,currentTarget:c}}function Lf(r,o){for(var c=o+"Capture",d=[];r!==null;){var p=r,b=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||b===null||(p=Sr(r,c),p!=null&&d.unshift(Uu(r,p,b)),p=Sr(r,o),p!=null&&d.push(Uu(r,p,b))),r.tag===3)return d;r=r.return}return[]}function Ul(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function rT(r,o,c,d,p){for(var b=o._reactName,A=[];c!==null&&c!==d;){var N=c,q=N.alternate,X=N.stateNode;if(N=N.tag,q!==null&&q===d)break;N!==5&&N!==26&&N!==27||X===null||(q=X,p?(X=Sr(c,b),X!=null&&A.unshift(Uu(c,X,q))):p||(X=Sr(c,b),X!=null&&A.push(Uu(c,X,q)))),c=c.return}A.length!==0&&r.push({event:o,listeners:A})}var mC=/\r\n?/g,gC=/\u0000|\uFFFD/g;function aT(r){return(typeof r=="string"?r:""+r).replace(mC,`
`).replace(gC,"")}function oT(r,o){return o=aT(o),aT(r)===o}function jf(){}function pe(r,o,c,d,p,b){switch(c){case"children":typeof d=="string"?o==="body"||o==="textarea"&&d===""||xs(r,d):(typeof d=="number"||typeof d=="bigint")&&o!=="body"&&xs(r,""+d);break;case"className":Ba(r,"class",d);break;case"tabIndex":Ba(r,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":Ba(r,c,d);break;case"style":eu(r,d,b);break;case"data":if(o!=="object"){Ba(r,"data",d);break}case"src":case"href":if(d===""&&(o!=="a"||c!=="href")){r.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(c);break}d=Ps(""+d),r.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){r.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(c==="formAction"?(o!=="input"&&pe(r,o,"name",p.name,p,null),pe(r,o,"formEncType",p.formEncType,p,null),pe(r,o,"formMethod",p.formMethod,p,null),pe(r,o,"formTarget",p.formTarget,p,null)):(pe(r,o,"encType",p.encType,p,null),pe(r,o,"method",p.method,p,null),pe(r,o,"target",p.target,p,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(c);break}d=Ps(""+d),r.setAttribute(c,d);break;case"onClick":d!=null&&(r.onclick=jf);break;case"onScroll":d!=null&&$t("scroll",r);break;case"onScrollEnd":d!=null&&$t("scrollend",r);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(s(61));if(c=d.__html,c!=null){if(p.children!=null)throw Error(s(60));r.innerHTML=c}}break;case"multiple":r.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":r.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){r.removeAttribute("xlink:href");break}c=Ps(""+d),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,""+d):r.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,""):r.removeAttribute(c);break;case"capture":case"download":d===!0?r.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,d):r.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?r.setAttribute(c,d):r.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?r.removeAttribute(c):r.setAttribute(c,d);break;case"popover":$t("beforetoggle",r),$t("toggle",r),ja(r,"popover",d);break;case"xlinkActuate":bs(r,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":bs(r,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":bs(r,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":bs(r,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":bs(r,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":bs(r,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":bs(r,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":bs(r,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":bs(r,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":ja(r,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Bd.get(c)||c,ja(r,c,d))}}function P_(r,o,c,d,p,b){switch(c){case"style":eu(r,d,b);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(s(61));if(c=d.__html,c!=null){if(p.children!=null)throw Error(s(60));r.innerHTML=c}}break;case"children":typeof d=="string"?xs(r,d):(typeof d=="number"||typeof d=="bigint")&&xs(r,""+d);break;case"onScroll":d!=null&&$t("scroll",r);break;case"onScrollEnd":d!=null&&$t("scrollend",r);break;case"onClick":d!=null&&(r.onclick=jf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Pa.hasOwnProperty(c))t:{if(c[0]==="o"&&c[1]==="n"&&(p=c.endsWith("Capture"),o=c.slice(2,p?c.length-7:void 0),b=r[bn]||null,b=b!=null?b[c]:null,typeof b=="function"&&r.removeEventListener(o,b,p),typeof d=="function")){typeof b!="function"&&b!==null&&(c in r?r[c]=null:r.hasAttribute(c)&&r.removeAttribute(c)),r.addEventListener(o,d,p);break t}c in r?r[c]=d:d===!0?r.setAttribute(c,""):ja(r,c,d)}}}function En(r,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$t("error",r),$t("load",r);var d=!1,p=!1,b;for(b in c)if(c.hasOwnProperty(b)){var A=c[b];if(A!=null)switch(b){case"src":d=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,o));default:pe(r,o,b,A,c,null)}}p&&pe(r,o,"srcSet",c.srcSet,c,null),d&&pe(r,o,"src",c.src,c,null);return;case"input":$t("invalid",r);var N=b=A=p=null,q=null,X=null;for(d in c)if(c.hasOwnProperty(d)){var it=c[d];if(it!=null)switch(d){case"name":p=it;break;case"type":A=it;break;case"checked":q=it;break;case"defaultChecked":X=it;break;case"value":b=it;break;case"defaultValue":N=it;break;case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(s(137,o));break;default:pe(r,o,d,it,c,null)}}Zc(r,b,N,q,X,A,p,!1),Er(r);return;case"select":$t("invalid",r),d=A=b=null;for(p in c)if(c.hasOwnProperty(p)&&(N=c[p],N!=null))switch(p){case"value":b=N;break;case"defaultValue":A=N;break;case"multiple":d=N;default:pe(r,o,p,N,c,null)}o=b,c=A,r.multiple=!!d,o!=null?Tr(r,!!d,o,!1):c!=null&&Tr(r,!!d,c,!0);return;case"textarea":$t("invalid",r),b=p=d=null;for(A in c)if(c.hasOwnProperty(A)&&(N=c[A],N!=null))switch(A){case"value":d=N;break;case"defaultValue":p=N;break;case"children":b=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(s(91));break;default:pe(r,o,A,N,c,null)}jd(r,d,p,b),Er(r);return;case"option":for(q in c)if(c.hasOwnProperty(q)&&(d=c[q],d!=null))switch(q){case"selected":r.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:pe(r,o,q,d,c,null)}return;case"dialog":$t("beforetoggle",r),$t("toggle",r),$t("cancel",r),$t("close",r);break;case"iframe":case"object":$t("load",r);break;case"video":case"audio":for(d=0;d<Fu.length;d++)$t(Fu[d],r);break;case"image":$t("error",r),$t("load",r);break;case"details":$t("toggle",r);break;case"embed":case"source":case"link":$t("error",r),$t("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(X in c)if(c.hasOwnProperty(X)&&(d=c[X],d!=null))switch(X){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,o));default:pe(r,o,X,d,c,null)}return;default:if(ul(o)){for(it in c)c.hasOwnProperty(it)&&(d=c[it],d!==void 0&&P_(r,o,it,d,c,void 0));return}}for(N in c)c.hasOwnProperty(N)&&(d=c[N],d!=null&&pe(r,o,N,d,c,null))}function pC(r,o,c,d){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,b=null,A=null,N=null,q=null,X=null,it=null;for(J in c){var ot=c[J];if(c.hasOwnProperty(J)&&ot!=null)switch(J){case"checked":break;case"value":break;case"defaultValue":q=ot;default:d.hasOwnProperty(J)||pe(r,o,J,null,d,ot)}}for(var Z in d){var J=d[Z];if(ot=c[Z],d.hasOwnProperty(Z)&&(J!=null||ot!=null))switch(Z){case"type":b=J;break;case"name":p=J;break;case"checked":X=J;break;case"defaultChecked":it=J;break;case"value":A=J;break;case"defaultValue":N=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(s(137,o));break;default:J!==ot&&pe(r,o,Z,J,d,ot)}}Xc(r,A,N,q,X,it,b,p);return;case"select":J=A=N=Z=null;for(b in c)if(q=c[b],c.hasOwnProperty(b)&&q!=null)switch(b){case"value":break;case"multiple":J=q;default:d.hasOwnProperty(b)||pe(r,o,b,null,d,q)}for(p in d)if(b=d[p],q=c[p],d.hasOwnProperty(p)&&(b!=null||q!=null))switch(p){case"value":Z=b;break;case"defaultValue":N=b;break;case"multiple":A=b;default:b!==q&&pe(r,o,p,b,d,q)}o=N,c=A,d=J,Z!=null?Tr(r,!!c,Z,!1):!!d!=!!c&&(o!=null?Tr(r,!!c,o,!0):Tr(r,!!c,c?[]:"",!1));return;case"textarea":J=Z=null;for(N in c)if(p=c[N],c.hasOwnProperty(N)&&p!=null&&!d.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:pe(r,o,N,null,d,p)}for(A in d)if(p=d[A],b=c[A],d.hasOwnProperty(A)&&(p!=null||b!=null))switch(A){case"value":Z=p;break;case"defaultValue":J=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(s(91));break;default:p!==b&&pe(r,o,A,p,d,b)}Ld(r,Z,J);return;case"option":for(var Ot in c)if(Z=c[Ot],c.hasOwnProperty(Ot)&&Z!=null&&!d.hasOwnProperty(Ot))switch(Ot){case"selected":r.selected=!1;break;default:pe(r,o,Ot,null,d,Z)}for(q in d)if(Z=d[q],J=c[q],d.hasOwnProperty(q)&&Z!==J&&(Z!=null||J!=null))switch(q){case"selected":r.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:pe(r,o,q,Z,d,J)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ct in c)Z=c[Ct],c.hasOwnProperty(Ct)&&Z!=null&&!d.hasOwnProperty(Ct)&&pe(r,o,Ct,null,d,Z);for(X in d)if(Z=d[X],J=c[X],d.hasOwnProperty(X)&&Z!==J&&(Z!=null||J!=null))switch(X){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(s(137,o));break;default:pe(r,o,X,Z,d,J)}return;default:if(ul(o)){for(var _e in c)Z=c[_e],c.hasOwnProperty(_e)&&Z!==void 0&&!d.hasOwnProperty(_e)&&P_(r,o,_e,void 0,d,Z);for(it in d)Z=d[it],J=c[it],!d.hasOwnProperty(it)||Z===J||Z===void 0&&J===void 0||P_(r,o,it,Z,d,J);return}}for(var $ in c)Z=c[$],c.hasOwnProperty($)&&Z!=null&&!d.hasOwnProperty($)&&pe(r,o,$,null,d,Z);for(ot in d)Z=d[ot],J=c[ot],!d.hasOwnProperty(ot)||Z===J||Z==null&&J==null||pe(r,o,ot,Z,d,J)}var L_=null,j_=null;function Bf(r){return r.nodeType===9?r:r.ownerDocument}function lT(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function cT(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function B_(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var F_=null;function _C(){var r=window.event;return r&&r.type==="popstate"?r===F_?!1:(F_=r,!0):(F_=null,!1)}var uT=typeof setTimeout=="function"?setTimeout:void 0,yC=typeof clearTimeout=="function"?clearTimeout:void 0,hT=typeof Promise=="function"?Promise:void 0,bC=typeof queueMicrotask=="function"?queueMicrotask:typeof hT<"u"?function(r){return hT.resolve(null).then(r).catch(xC)}:uT;function xC(r){setTimeout(function(){throw r})}function Hr(r){return r==="head"}function dT(r,o){var c=o,d=0,p=0;do{var b=c.nextSibling;if(r.removeChild(c),b&&b.nodeType===8)if(c=b.data,c==="/$"){if(0<d&&8>d){c=d;var A=r.ownerDocument;if(c&1&&zu(A.documentElement),c&2&&zu(A.body),c&4)for(c=A.head,zu(c),A=c.firstChild;A;){var N=A.nextSibling,q=A.nodeName;A[yr]||q==="SCRIPT"||q==="STYLE"||q==="LINK"&&A.rel.toLowerCase()==="stylesheet"||c.removeChild(A),A=N}}if(p===0){r.removeChild(b),Qu(o);return}p--}else c==="$"||c==="$?"||c==="$!"?p++:d=c.charCodeAt(0)-48;else d=0;c=b}while(c);Qu(o)}function U_(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":U_(c),rl(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}r.removeChild(c)}}function vC(r,o,c,d){for(;r.nodeType===1;){var p=c;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!d&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(d){if(!r[yr])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(b=r.getAttribute("rel"),b==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(b!==p.rel||r.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||r.getAttribute("title")!==(p.title==null?null:p.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(b=r.getAttribute("src"),(b!==(p.src==null?null:p.src)||r.getAttribute("type")!==(p.type==null?null:p.type)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&b&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var b=p.name==null?null:""+p.name;if(p.type==="hidden"&&r.getAttribute("name")===b)return r}else return r;if(r=zs(r.nextSibling),r===null)break}return null}function EC(r,o,c){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!c||(r=zs(r.nextSibling),r===null))return null;return r}function z_(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function TC(r,o){var c=r.ownerDocument;if(r.data!=="$?"||c.readyState==="complete")o();else{var d=function(){o(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),r._reactRetry=d}}function zs(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return r}var H_=null;function fT(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"){if(o===0)return r;o--}else c==="/$"&&o++}r=r.previousSibling}return null}function mT(r,o,c){switch(o=Bf(c),r){case"html":if(r=o.documentElement,!r)throw Error(s(452));return r;case"head":if(r=o.head,!r)throw Error(s(453));return r;case"body":if(r=o.body,!r)throw Error(s(454));return r;default:throw Error(s(451))}}function zu(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);rl(r)}var Rs=new Map,gT=new Set;function Ff(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Gi=at.d;at.d={f:wC,r:SC,D:AC,C:IC,L:RC,m:DC,X:CC,S:NC,M:MC};function wC(){var r=Gi.f(),o=Cf();return r||o}function SC(r){var o=Js(r);o!==null&&o.tag===5&&o.type==="form"?Vv(o):Gi.r(r)}var zl=typeof document>"u"?null:document;function pT(r,o,c){var d=zl;if(d&&typeof o=="string"&&o){var p=dn(o);p='link[rel="'+r+'"][href="'+p+'"]',typeof c=="string"&&(p+='[crossorigin="'+c+'"]'),gT.has(p)||(gT.add(p),r={rel:r,crossOrigin:c,href:o},d.querySelector(p)===null&&(o=d.createElement("link"),En(o,"link",r),He(o),d.head.appendChild(o)))}}function AC(r){Gi.D(r),pT("dns-prefetch",r,null)}function IC(r,o){Gi.C(r,o),pT("preconnect",r,o)}function RC(r,o,c){Gi.L(r,o,c);var d=zl;if(d&&r&&o){var p='link[rel="preload"][as="'+dn(o)+'"]';o==="image"&&c&&c.imageSrcSet?(p+='[imagesrcset="'+dn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(p+='[imagesizes="'+dn(c.imageSizes)+'"]')):p+='[href="'+dn(r)+'"]';var b=p;switch(o){case"style":b=Hl(r);break;case"script":b=ql(r)}Rs.has(b)||(r=m({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:r,as:o},c),Rs.set(b,r),d.querySelector(p)!==null||o==="style"&&d.querySelector(Hu(b))||o==="script"&&d.querySelector(qu(b))||(o=d.createElement("link"),En(o,"link",r),He(o),d.head.appendChild(o)))}}function DC(r,o){Gi.m(r,o);var c=zl;if(c&&r){var d=o&&typeof o.as=="string"?o.as:"script",p='link[rel="modulepreload"][as="'+dn(d)+'"][href="'+dn(r)+'"]',b=p;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=ql(r)}if(!Rs.has(b)&&(r=m({rel:"modulepreload",href:r},o),Rs.set(b,r),c.querySelector(p)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(qu(b)))return}d=c.createElement("link"),En(d,"link",r),He(d),c.head.appendChild(d)}}}function NC(r,o,c){Gi.S(r,o,c);var d=zl;if(d&&r){var p=xr(d).hoistableStyles,b=Hl(r);o=o||"default";var A=p.get(b);if(!A){var N={loading:0,preload:null};if(A=d.querySelector(Hu(b)))N.loading=5;else{r=m({rel:"stylesheet",href:r,"data-precedence":o},c),(c=Rs.get(b))&&q_(r,c);var q=A=d.createElement("link");He(q),En(q,"link",r),q._p=new Promise(function(X,it){q.onload=X,q.onerror=it}),q.addEventListener("load",function(){N.loading|=1}),q.addEventListener("error",function(){N.loading|=2}),N.loading|=4,Uf(A,o,d)}A={type:"stylesheet",instance:A,count:1,state:N},p.set(b,A)}}}function CC(r,o){Gi.X(r,o);var c=zl;if(c&&r){var d=xr(c).hoistableScripts,p=ql(r),b=d.get(p);b||(b=c.querySelector(qu(p)),b||(r=m({src:r,async:!0},o),(o=Rs.get(p))&&G_(r,o),b=c.createElement("script"),He(b),En(b,"link",r),c.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},d.set(p,b))}}function MC(r,o){Gi.M(r,o);var c=zl;if(c&&r){var d=xr(c).hoistableScripts,p=ql(r),b=d.get(p);b||(b=c.querySelector(qu(p)),b||(r=m({src:r,async:!0,type:"module"},o),(o=Rs.get(p))&&G_(r,o),b=c.createElement("script"),He(b),En(b,"link",r),c.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},d.set(p,b))}}function _T(r,o,c,d){var p=(p=At.current)?Ff(p):null;if(!p)throw Error(s(446));switch(r){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=Hl(c.href),c=xr(p).hoistableStyles,d=c.get(o),d||(d={type:"style",instance:null,count:0,state:null},c.set(o,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){r=Hl(c.href);var b=xr(p).hoistableStyles,A=b.get(r);if(A||(p=p.ownerDocument||p,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(r,A),(b=p.querySelector(Hu(r)))&&!b._p&&(A.instance=b,A.state.loading=5),Rs.has(r)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Rs.set(r,c),b||OC(p,r,c,A.state))),o&&d===null)throw Error(s(528,""));return A}if(o&&d!==null)throw Error(s(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=ql(c),c=xr(p).hoistableScripts,d=c.get(o),d||(d={type:"script",instance:null,count:0,state:null},c.set(o,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,r))}}function Hl(r){return'href="'+dn(r)+'"'}function Hu(r){return'link[rel="stylesheet"]['+r+"]"}function yT(r){return m({},r,{"data-precedence":r.precedence,precedence:null})}function OC(r,o,c,d){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?d.loading=1:(o=r.createElement("link"),d.preload=o,o.addEventListener("load",function(){return d.loading|=1}),o.addEventListener("error",function(){return d.loading|=2}),En(o,"link",c),He(o),r.head.appendChild(o))}function ql(r){return'[src="'+dn(r)+'"]'}function qu(r){return"script[async]"+r}function bT(r,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var d=r.querySelector('style[data-href~="'+dn(c.href)+'"]');if(d)return o.instance=d,He(d),d;var p=m({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(r.ownerDocument||r).createElement("style"),He(d),En(d,"style",p),Uf(d,c.precedence,r),o.instance=d;case"stylesheet":p=Hl(c.href);var b=r.querySelector(Hu(p));if(b)return o.state.loading|=4,o.instance=b,He(b),b;d=yT(c),(p=Rs.get(p))&&q_(d,p),b=(r.ownerDocument||r).createElement("link"),He(b);var A=b;return A._p=new Promise(function(N,q){A.onload=N,A.onerror=q}),En(b,"link",d),o.state.loading|=4,Uf(b,c.precedence,r),o.instance=b;case"script":return b=ql(c.src),(p=r.querySelector(qu(b)))?(o.instance=p,He(p),p):(d=c,(p=Rs.get(b))&&(d=m({},c),G_(d,p)),r=r.ownerDocument||r,p=r.createElement("script"),He(p),En(p,"link",d),r.head.appendChild(p),o.instance=p);case"void":return null;default:throw Error(s(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(d=o.instance,o.state.loading|=4,Uf(d,c.precedence,r));return o.instance}function Uf(r,o,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=d.length?d[d.length-1]:null,b=p,A=0;A<d.length;A++){var N=d[A];if(N.dataset.precedence===o)b=N;else if(b!==p)break}b?b.parentNode.insertBefore(r,b.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(r,o.firstChild))}function q_(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function G_(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var zf=null;function xT(r,o,c){if(zf===null){var d=new Map,p=zf=new Map;p.set(c,d)}else p=zf,d=p.get(c),d||(d=new Map,p.set(c,d));if(d.has(r))return d;for(d.set(r,null),c=c.getElementsByTagName(r),p=0;p<c.length;p++){var b=c[p];if(!(b[yr]||b[ze]||r==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var A=b.getAttribute(o)||"";A=r+A;var N=d.get(A);N?N.push(b):d.set(A,[b])}}return d}function vT(r,o,c){r=r.ownerDocument||r,r.head.insertBefore(c,o==="title"?r.querySelector("head > title"):null)}function kC(r,o,c){if(c===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return r=o.disabled,typeof o.precedence=="string"&&r==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function ET(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var Gu=null;function VC(){}function PC(r,o,c){if(Gu===null)throw Error(s(475));var d=Gu;if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var p=Hl(c.href),b=r.querySelector(Hu(p));if(b){r=b._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(d.count++,d=Hf.bind(d),r.then(d,d)),o.state.loading|=4,o.instance=b,He(b);return}b=r.ownerDocument||r,c=yT(c),(p=Rs.get(p))&&q_(c,p),b=b.createElement("link"),He(b);var A=b;A._p=new Promise(function(N,q){A.onload=N,A.onerror=q}),En(b,"link",c),o.instance=b}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(d.count++,o=Hf.bind(d),r.addEventListener("load",o),r.addEventListener("error",o))}}function LC(){if(Gu===null)throw Error(s(475));var r=Gu;return r.stylesheets&&r.count===0&&$_(r,r.stylesheets),0<r.count?function(o){var c=setTimeout(function(){if(r.stylesheets&&$_(r,r.stylesheets),r.unsuspend){var d=r.unsuspend;r.unsuspend=null,d()}},6e4);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(c)}}:null}function Hf(){if(this.count--,this.count===0){if(this.stylesheets)$_(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var qf=null;function $_(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,qf=new Map,o.forEach(jC,r),qf=null,Hf.call(r))}function jC(r,o){if(!(o.state.loading&4)){var c=qf.get(r);if(c)var d=c.get(null);else{c=new Map,qf.set(r,c);for(var p=r.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<p.length;b++){var A=p[b];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(c.set(A.dataset.precedence,A),d=A)}d&&c.set(null,d)}p=o.instance,A=p.getAttribute("data-precedence"),b=c.get(A)||d,b===d&&c.set(null,p),c.set(A,p),this.count++,d=Hf.bind(this),p.addEventListener("load",d),p.addEventListener("error",d),b?b.parentNode.insertBefore(p,b.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(p,r.firstChild)),o.state.loading|=4}}var $u={$$typeof:O,Provider:null,Consumer:null,_currentValue:mt,_currentValue2:mt,_threadCount:0};function BC(r,o,c,d,p,b,A,N){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=il(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=il(0),this.hiddenUpdates=il(null),this.identifierPrefix=d,this.onUncaughtError=p,this.onCaughtError=b,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=N,this.incompleteTransitions=new Map}function TT(r,o,c,d,p,b,A,N,q,X,it,ot){return r=new BC(r,o,c,A,N,q,X,ot),o=1,b===!0&&(o|=24),b=as(3,null,null,o),r.current=b,b.stateNode=r,o=Ip(),o.refCount++,r.pooledCache=o,o.refCount++,b.memoizedState={element:d,isDehydrated:c,cache:o},Cp(b),r}function wT(r){return r?(r=vl,r):vl}function ST(r,o,c,d,p,b){p=wT(p),d.context===null?d.context=p:d.pendingContext=p,d=Nr(o),d.payload={element:c},b=b===void 0?null:b,b!==null&&(d.callback=b),c=Cr(r,d,o),c!==null&&(hs(c,r,o),Eu(c,r,o))}function AT(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<o?c:o}}function W_(r,o){AT(r,o),(r=r.alternate)&&AT(r,o)}function IT(r){if(r.tag===13){var o=xl(r,67108864);o!==null&&hs(o,r,67108864),W_(r,67108864)}}var Gf=!0;function FC(r,o,c,d){var p=Y.T;Y.T=null;var b=at.p;try{at.p=2,Y_(r,o,c,d)}finally{at.p=b,Y.T=p}}function UC(r,o,c,d){var p=Y.T;Y.T=null;var b=at.p;try{at.p=8,Y_(r,o,c,d)}finally{at.p=b,Y.T=p}}function Y_(r,o,c,d){if(Gf){var p=K_(d);if(p===null)V_(r,o,d,$f,c),DT(r,d);else if(HC(p,r,o,c,d))d.stopPropagation();else if(DT(r,d),o&4&&-1<zC.indexOf(r)){for(;p!==null;){var b=Js(p);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var A=Os(b.pendingLanes);if(A!==0){var N=b;for(N.pendingLanes|=2,N.entangledLanes|=2;A;){var q=1<<31-Fn(A);N.entanglements[1]|=q,A&=~q}ci(b),(ce&6)===0&&(Df=Kn()+500,Bu(0))}}break;case 13:N=xl(b,2),N!==null&&hs(N,b,2),Cf(),W_(b,2)}if(b=K_(d),b===null&&V_(r,o,d,$f,c),b===p)break;p=b}p!==null&&d.stopPropagation()}else V_(r,o,d,null,c)}}function K_(r){return r=su(r),Q_(r)}var $f=null;function Q_(r){if($f=null,r=Zs(r),r!==null){var o=a(r);if(o===null)r=null;else{var c=o.tag;if(c===13){if(r=l(o),r!==null)return r;r=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return $f=r,null}function RT(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Md()){case nn:return 2;case hn:return 8;case Si:case ep:return 32;case Wc:return 268435456;default:return 32}default:return 32}}var X_=!1,qr=null,Gr=null,$r=null,Wu=new Map,Yu=new Map,Wr=[],zC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function DT(r,o){switch(r){case"focusin":case"focusout":qr=null;break;case"dragenter":case"dragleave":Gr=null;break;case"mouseover":case"mouseout":$r=null;break;case"pointerover":case"pointerout":Wu.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yu.delete(o.pointerId)}}function Ku(r,o,c,d,p,b){return r===null||r.nativeEvent!==b?(r={blockedOn:o,domEventName:c,eventSystemFlags:d,nativeEvent:b,targetContainers:[p]},o!==null&&(o=Js(o),o!==null&&IT(o)),r):(r.eventSystemFlags|=d,o=r.targetContainers,p!==null&&o.indexOf(p)===-1&&o.push(p),r)}function HC(r,o,c,d,p){switch(o){case"focusin":return qr=Ku(qr,r,o,c,d,p),!0;case"dragenter":return Gr=Ku(Gr,r,o,c,d,p),!0;case"mouseover":return $r=Ku($r,r,o,c,d,p),!0;case"pointerover":var b=p.pointerId;return Wu.set(b,Ku(Wu.get(b)||null,r,o,c,d,p)),!0;case"gotpointercapture":return b=p.pointerId,Yu.set(b,Ku(Yu.get(b)||null,r,o,c,d,p)),!0}return!1}function NT(r){var o=Zs(r.target);if(o!==null){var c=a(o);if(c!==null){if(o=c.tag,o===13){if(o=l(c),o!==null){r.blockedOn=o,ip(r.priority,function(){if(c.tag===13){var d=us();d=Kc(d);var p=xl(c,d);p!==null&&hs(p,c,d),W_(c,d)}});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Wf(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var c=K_(r.nativeEvent);if(c===null){c=r.nativeEvent;var d=new c.constructor(c.type,c);nu=d,c.target.dispatchEvent(d),nu=null}else return o=Js(c),o!==null&&IT(o),r.blockedOn=c,!1;o.shift()}return!0}function CT(r,o,c){Wf(r)&&c.delete(o)}function qC(){X_=!1,qr!==null&&Wf(qr)&&(qr=null),Gr!==null&&Wf(Gr)&&(Gr=null),$r!==null&&Wf($r)&&($r=null),Wu.forEach(CT),Yu.forEach(CT)}function Yf(r,o){r.blockedOn===o&&(r.blockedOn=null,X_||(X_=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,qC)))}var Kf=null;function MT(r){Kf!==r&&(Kf=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Kf===r&&(Kf=null);for(var o=0;o<r.length;o+=3){var c=r[o],d=r[o+1],p=r[o+2];if(typeof d!="function"){if(Q_(d||c)===null)continue;break}var b=Js(c);b!==null&&(r.splice(o,3),o-=3,Qp(b,{pending:!0,data:p,method:c.method,action:d},d,p))}}))}function Qu(r){function o(q){return Yf(q,r)}qr!==null&&Yf(qr,r),Gr!==null&&Yf(Gr,r),$r!==null&&Yf($r,r),Wu.forEach(o),Yu.forEach(o);for(var c=0;c<Wr.length;c++){var d=Wr[c];d.blockedOn===r&&(d.blockedOn=null)}for(;0<Wr.length&&(c=Wr[0],c.blockedOn===null);)NT(c),c.blockedOn===null&&Wr.shift();if(c=(r.ownerDocument||r).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var p=c[d],b=c[d+1],A=p[bn]||null;if(typeof b=="function")A||MT(c);else if(A){var N=null;if(b&&b.hasAttribute("formAction")){if(p=b,A=b[bn]||null)N=A.formAction;else if(Q_(p)!==null)continue}else N=A.action;typeof N=="function"?c[d+1]=N:(c.splice(d,3),d-=3),MT(c)}}}function Z_(r){this._internalRoot=r}Qf.prototype.render=Z_.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(s(409));var c=o.current,d=us();ST(c,d,r,o,null,null)},Qf.prototype.unmount=Z_.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;ST(r.current,2,null,r,null,null),Cf(),o[Ii]=null}};function Qf(r){this._internalRoot=r}Qf.prototype.unstable_scheduleHydration=function(r){if(r){var o=Ai();r={blockedOn:null,target:r,priority:o};for(var c=0;c<Wr.length&&o!==0&&o<Wr[c].priority;c++);Wr.splice(c,0,r),c===0&&NT(r)}};var OT=t.version;if(OT!=="19.1.1")throw Error(s(527,OT,"19.1.1"));at.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(s(188)):(r=Object.keys(r).join(","),Error(s(268,r)));return r=h(o),r=r!==null?f(r):null,r=r===null?null:r.stateNode,r};var GC={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xf.isDisabled&&Xf.supportsFiber)try{dr=Xf.inject(GC),In=Xf}catch{}}return Zu.createRoot=function(r,o){if(!i(r))throw Error(s(299));var c=!1,d="",p=Kv,b=Qv,A=Xv,N=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(d=o.identifierPrefix),o.onUncaughtError!==void 0&&(p=o.onUncaughtError),o.onCaughtError!==void 0&&(b=o.onCaughtError),o.onRecoverableError!==void 0&&(A=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(N=o.unstable_transitionCallbacks)),o=TT(r,1,!1,null,null,c,d,p,b,A,N,null),r[Ii]=o.current,k_(r),new Z_(o)},Zu.hydrateRoot=function(r,o,c){if(!i(r))throw Error(s(299));var d=!1,p="",b=Kv,A=Qv,N=Xv,q=null,X=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(b=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(N=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(q=c.unstable_transitionCallbacks),c.formState!==void 0&&(X=c.formState)),o=TT(r,1,!0,o,c??null,d,p,b,A,N,q,X),o.context=wT(null),c=o.current,d=us(),d=Kc(d),p=Nr(d),p.callback=null,Cr(c,p,d),c=d,o.current.lanes=c,Ue(o,c),ci(o),r[Ii]=o.current,k_(r),new Qf(o)},Zu.version="19.1.1",Zu}var HT;function iM(){if(HT)return ey.exports;HT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),ey.exports=sM(),ey.exports}var rM=iM();const aM=i2(rM),oM=()=>{};var qT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r2=function(n){const t=[];let e=0;for(let s=0;s<n.length;s++){let i=n.charCodeAt(s);i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=i&63|128):(i&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++s)&1023),t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=i&63|128):(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=i&63|128)}return t},lM=function(n){const t=[];let e=0,s=0;for(;e<n.length;){const i=n[e++];if(i<128)t[s++]=String.fromCharCode(i);else if(i>191&&i<224){const a=n[e++];t[s++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=n[e++],l=n[e++],u=n[e++],h=((i&7)<<18|(a&63)<<12|(l&63)<<6|u&63)-65536;t[s++]=String.fromCharCode(55296+(h>>10)),t[s++]=String.fromCharCode(56320+(h&1023))}else{const a=n[e++],l=n[e++];t[s++]=String.fromCharCode((i&15)<<12|(a&63)<<6|l&63)}}return t.join("")},a2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<n.length;i+=3){const a=n[i],l=i+1<n.length,u=l?n[i+1]:0,h=i+2<n.length,f=h?n[i+2]:0,m=a>>2,_=(a&3)<<4|u>>4;let x=(u&15)<<2|f>>6,E=f&63;h||(E=64,l||(x=64)),s.push(e[m],e[_],e[x],e[E])}return s.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(r2(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):lM(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<n.length;){const a=e[n.charAt(i++)],u=i<n.length?e[n.charAt(i)]:0;++i;const f=i<n.length?e[n.charAt(i)]:64;++i;const _=i<n.length?e[n.charAt(i)]:64;if(++i,a==null||u==null||f==null||_==null)throw new cM;const x=a<<2|u>>4;if(s.push(x),f!==64){const E=u<<4&240|f>>2;if(s.push(E),_!==64){const S=f<<6&192|_;s.push(S)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class cM extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const uM=function(n){const t=r2(n);return a2.encodeByteArray(t,!0)},Bm=function(n){return uM(n).replace(/\./g,"")},o2=function(n){try{return a2.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function Fm(n,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const e=t;return new Date(e.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return t}for(const e in t)!t.hasOwnProperty(e)||!hM(e)||(n[e]=Fm(n[e],t[e]));return n}function hM(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B0(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dM=()=>B0().__FIREBASE_DEFAULTS__,fM=()=>{if(typeof process>"u"||typeof qT>"u")return;const n=qT.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},mM=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&o2(n[1]);return t&&JSON.parse(t)},l2=()=>{try{return oM()||dM()||fM()||mM()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},F0=()=>{var n;return(n=l2())==null?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gM{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,s)=>{e?this.reject(e):this.resolve(s),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U0(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function pM(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _M(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},s=t||"demo-project",i=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Bm(JSON.stringify(e)),Bm(JSON.stringify(l)),""].join(".")}const Eh={};function yM(){const n={prod:[],emulator:[]};for(const t of Object.keys(Eh))Eh[t]?n.emulator.push(t):n.prod.push(t);return n}function bM(n){let t=document.getElementById(n),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",n),e=!0),{created:e,element:t}}let GT=!1;function xM(n,t){if(typeof window>"u"||typeof document>"u"||!U0(window.location.host)||Eh[n]===t||Eh[n]||GT)return;Eh[n]=t;function e(x){return`__firebase__banner__${x}`}const s="__firebase__banner",a=yM().prod.length>0;function l(){const x=document.getElementById(s);x&&x.remove()}function u(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function h(x,E){x.setAttribute("width","24"),x.setAttribute("id",E),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function f(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{GT=!0,l()},x}function m(x,E){x.setAttribute("id",E),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function _(){const x=bM(s),E=e("text"),S=document.getElementById(E)||document.createElement("span"),T=e("learnmore"),R=document.getElementById(T)||document.createElement("a"),M=e("preprendIcon"),L=document.getElementById(M)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const O=x.element;u(O),m(R,T);const H=f();h(L,M),O.append(L,S,R,H),document.body.appendChild(O)}a?(S.innerText="Preview backend disconnected.",L.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(L.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Um(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function c2(){var t;const n=(t=l2())==null?void 0:t.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function vM(){return typeof window<"u"||u2()}function u2(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function h2(){return!c2()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function d2(){return!c2()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function f2(){try{return typeof indexedDB=="object"}catch{return!1}}function EM(){return new Promise((n,t)=>{try{let e=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(s),n(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{var a;t(((a=i.error)==null?void 0:a.message)||"")}}catch(e){t(e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TM="FirebaseError";class Zo extends Error{constructor(t,e,s){super(e),this.code=t,this.customData=s,this.name=TM,Object.setPrototypeOf(this,Zo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xg.prototype.create)}}class xg{constructor(t,e,s){this.service=t,this.serviceName=e,this.errors=s}create(t,...e){const s=e[0]||{},i=`${this.service}/${t}`,a=this.errors[t],l=a?wM(a,s):"Error",u=`${this.serviceName}: ${l} (${i}).`;return new Zo(i,u,s)}}function wM(n,t){return n.replace(SM,(e,s)=>{const i=t[s];return i!=null?String(i):`<${s}?>`})}const SM=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $T(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function lc(n,t){if(n===t)return!0;const e=Object.keys(n),s=Object.keys(t);for(const i of e){if(!s.includes(i))return!1;const a=n[i],l=t[i];if(WT(a)&&WT(l)){if(!lc(a,l))return!1}else if(a!==l)return!1}for(const i of s)if(!e.includes(i))return!1;return!0}function WT(n){return n!==null&&typeof n=="object"}function AM(n,t){const e=new IM(n,t);return e.subscribe.bind(e)}class IM{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(s=>{this.error(s)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,s){let i;if(t===void 0&&e===void 0&&s===void 0)throw new Error("Missing Observer.");RM(t,["next","error","complete"])?i=t:i={next:t,error:e,complete:s},i.next===void 0&&(i.next=ry),i.error===void 0&&(i.error=ry),i.complete===void 0&&(i.complete=ry);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function RM(n,t){if(typeof n!="object"||n===null)return!1;for(const e of t)if(e in n&&typeof n[e]=="function")return!0;return!1}function ry(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(n){return n&&n._delegate?n._delegate:n}class Bo{constructor(t,e,s){this.name=t,this.instanceFactory=e,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const s=new gM;if(this.instancesDeferred.set(e,s),this.isInitialized(e)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:e});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(t==null?void 0:t.optional)??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(CM(t))try{this.getOrInitializeService({instanceIdentifier:vo})}catch{}for(const[e,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const a=this.getOrInitializeService({instanceIdentifier:i});s.resolve(a)}catch{}}}}clearInstance(t=vo){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=vo){return this.instances.has(t)}getOptions(t=vo){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,s=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:e});for(const[a,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(a);s===u&&l.resolve(i)}return i}onInit(t,e){const s=this.normalizeInstanceIdentifier(e),i=this.onInitCallbacks.get(s)??new Set;i.add(t),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&t(a,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const s=this.onInitCallbacks.get(e);if(s)for(const i of s)try{i(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let s=this.instances.get(t);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:NM(t),options:e}),this.instances.set(t,s),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(s,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,s)}catch{}return s||null}normalizeInstanceIdentifier(t=vo){return this.component?this.component.multipleInstances?t:vo:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function NM(n){return n===vo?void 0:n}function CM(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new DM(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z0=[];var Xt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Xt||(Xt={}));const g2={debug:Xt.DEBUG,verbose:Xt.VERBOSE,info:Xt.INFO,warn:Xt.WARN,error:Xt.ERROR,silent:Xt.SILENT},MM=Xt.INFO,OM={[Xt.DEBUG]:"log",[Xt.VERBOSE]:"log",[Xt.INFO]:"info",[Xt.WARN]:"warn",[Xt.ERROR]:"error"},kM=(n,t,...e)=>{if(t<n.logLevel)return;const s=new Date().toISOString(),i=OM[t];if(i)console[i](`[${s}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class H0{constructor(t){this.name=t,this._logLevel=MM,this._logHandler=kM,this._userLogHandler=null,z0.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Xt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?g2[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Xt.DEBUG,...t),this._logHandler(this,Xt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Xt.VERBOSE,...t),this._logHandler(this,Xt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Xt.INFO,...t),this._logHandler(this,Xt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Xt.WARN,...t),this._logHandler(this,Xt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Xt.ERROR,...t),this._logHandler(this,Xt.ERROR,...t)}}function VM(n){z0.forEach(t=>{t.setLogLevel(n)})}function PM(n,t){for(const e of z0){let s=null;t&&t.level&&(s=g2[t.level]),n===null?e.userLogHandler=null:e.userLogHandler=(i,a,...l)=>{const u=l.map(h=>{if(h==null)return null;if(typeof h=="string")return h;if(typeof h=="number"||typeof h=="boolean")return h.toString();if(h instanceof Error)return h.message;try{return JSON.stringify(h)}catch{return null}}).filter(h=>h).join(" ");a>=(s??i.logLevel)&&n({level:Xt[a].toLowerCase(),message:u,args:l,type:i.name})}}}const LM=(n,t)=>t.some(e=>n instanceof e);let YT,KT;function jM(){return YT||(YT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function BM(){return KT||(KT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const p2=new WeakMap,Ly=new WeakMap,_2=new WeakMap,ay=new WeakMap,q0=new WeakMap;function FM(n){const t=new Promise((e,s)=>{const i=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{e(oa(n.result)),i()},l=()=>{s(n.error),i()};n.addEventListener("success",a),n.addEventListener("error",l)});return t.then(e=>{e instanceof IDBCursor&&p2.set(e,n)}).catch(()=>{}),q0.set(t,n),t}function UM(n){if(Ly.has(n))return;const t=new Promise((e,s)=>{const i=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{e(),i()},l=()=>{s(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});Ly.set(n,t)}let jy={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return Ly.get(n);if(t==="objectStoreNames")return n.objectStoreNames||_2.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return oa(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function zM(n){jy=n(jy)}function HM(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const s=n.call(oy(this),t,...e);return _2.set(s,t.sort?t.sort():[t]),oa(s)}:BM().includes(n)?function(...t){return n.apply(oy(this),t),oa(p2.get(this))}:function(...t){return oa(n.apply(oy(this),t))}}function qM(n){return typeof n=="function"?HM(n):(n instanceof IDBTransaction&&UM(n),LM(n,jM())?new Proxy(n,jy):n)}function oa(n){if(n instanceof IDBRequest)return FM(n);if(ay.has(n))return ay.get(n);const t=qM(n);return t!==n&&(ay.set(n,t),q0.set(t,n)),t}const oy=n=>q0.get(n);function GM(n,t,{blocked:e,upgrade:s,blocking:i,terminated:a}={}){const l=indexedDB.open(n,t),u=oa(l);return s&&l.addEventListener("upgradeneeded",h=>{s(oa(l.result),h.oldVersion,h.newVersion,oa(l.transaction),h)}),e&&l.addEventListener("blocked",h=>e(h.oldVersion,h.newVersion,h)),u.then(h=>{a&&h.addEventListener("close",()=>a()),i&&h.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),u}const $M=["get","getKey","getAll","getAllKeys","count"],WM=["put","add","delete","clear"],ly=new Map;function QT(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(ly.get(t))return ly.get(t);const e=t.replace(/FromIndex$/,""),s=t!==e,i=WM.includes(e);if(!(e in(s?IDBIndex:IDBObjectStore).prototype)||!(i||$M.includes(e)))return;const a=async function(l,...u){const h=this.transaction(l,i?"readwrite":"readonly");let f=h.store;return s&&(f=f.index(u.shift())),(await Promise.all([f[e](...u),i&&h.done]))[0]};return ly.set(t,a),a}zM(n=>({...n,get:(t,e,s)=>QT(t,e)||n.get(t,e,s),has:(t,e)=>!!QT(t,e)||n.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(KM(e)){const s=e.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(e=>e).join(" ")}}function KM(n){const t=n.getComponent();return(t==null?void 0:t.type)==="VERSION"}const zm="@firebase/app",By="0.14.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const er=new H0("@firebase/app"),QM="@firebase/app-compat",XM="@firebase/analytics-compat",ZM="@firebase/analytics",JM="@firebase/app-check-compat",tO="@firebase/app-check",eO="@firebase/auth",nO="@firebase/auth-compat",sO="@firebase/database",iO="@firebase/data-connect",rO="@firebase/database-compat",aO="@firebase/functions",oO="@firebase/functions-compat",lO="@firebase/installations",cO="@firebase/installations-compat",uO="@firebase/messaging",hO="@firebase/messaging-compat",dO="@firebase/performance",fO="@firebase/performance-compat",mO="@firebase/remote-config",gO="@firebase/remote-config-compat",pO="@firebase/storage",_O="@firebase/storage-compat",yO="@firebase/firestore",bO="@firebase/ai",xO="@firebase/firestore-compat",vO="firebase",EO="12.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa="[DEFAULT]",TO={[zm]:"fire-core",[QM]:"fire-core-compat",[ZM]:"fire-analytics",[XM]:"fire-analytics-compat",[tO]:"fire-app-check",[JM]:"fire-app-check-compat",[eO]:"fire-auth",[nO]:"fire-auth-compat",[sO]:"fire-rtdb",[iO]:"fire-data-connect",[rO]:"fire-rtdb-compat",[aO]:"fire-fn",[oO]:"fire-fn-compat",[lO]:"fire-iid",[cO]:"fire-iid-compat",[uO]:"fire-fcm",[hO]:"fire-fcm-compat",[dO]:"fire-perf",[fO]:"fire-perf-compat",[mO]:"fire-rc",[gO]:"fire-rc-compat",[pO]:"fire-gcs",[_O]:"fire-gcs-compat",[yO]:"fire-fst",[xO]:"fire-fst-compat",[bO]:"fire-vertex","fire-js":"fire-js",[vO]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ma=new Map,cc=new Map,uc=new Map;function jh(n,t){try{n.container.addComponent(t)}catch(e){er.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function y2(n,t){n.container.addOrOverwriteComponent(t)}function hc(n){const t=n.name;if(uc.has(t))return er.debug(`There were multiple attempts to register component ${t}.`),!1;uc.set(t,n);for(const e of ma.values())jh(e,n);for(const e of cc.values())jh(e,n);return!0}function b2(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}function wO(n,t,e=fa){b2(n,t).clearInstance(e)}function G0(n){return n.options!==void 0}function x2(n){return G0(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function v2(n){return n==null?!1:n.settings!==void 0}function SO(){uc.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AO={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ms=new xg("app","Firebase",AO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let E2=class{constructor(t,e,s){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Bo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ms.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XT(n,t){const e=o2(n.split(".")[1]);if(e===null){console.error(`FirebaseServerApp ${t} is invalid: second part could not be parsed.`);return}if(JSON.parse(e).exp===void 0){console.error(`FirebaseServerApp ${t} is invalid: expiration claim could not be parsed`);return}const i=JSON.parse(e).exp*1e3,a=new Date().getTime();i-a<=0&&console.error(`FirebaseServerApp ${t} is invalid: the token has expired.`)}class IO extends E2{constructor(t,e,s,i){const a=e.automaticDataCollectionEnabled!==void 0?e.automaticDataCollectionEnabled:!0,l={name:s,automaticDataCollectionEnabled:a};if(t.apiKey!==void 0)super(t,l,i);else{const u=t;super(u.options,l,i)}this._serverConfig={automaticDataCollectionEnabled:a,...e},this._serverConfig.authIdToken&&XT(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&XT(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,e.releaseOnDeref=void 0,tr(zm,By,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(t){this.isDeleted||(this._refCount++,t!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(t,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Y0(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw ms.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $0=EO;function W0(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const s={name:fa,automaticDataCollectionEnabled:!0,...t},i=s.name;if(typeof i!="string"||!i)throw ms.create("bad-app-name",{appName:String(i)});if(e||(e=F0()),!e)throw ms.create("no-options");const a=ma.get(i);if(a){if(lc(e,a.options)&&lc(s,a.config))return a;throw ms.create("duplicate-app",{appName:i})}const l=new m2(i);for(const h of uc.values())l.addComponent(h);const u=new E2(e,s,l);return ma.set(i,u),u}function RO(n,t={}){if(vM()&&!u2())throw ms.create("invalid-server-app-environment");let e,s=t||{};if(n&&(G0(n)?e=n.options:x2(n)?s=n:e=n),s.automaticDataCollectionEnabled===void 0&&(s.automaticDataCollectionEnabled=!0),e||(e=F0()),!e)throw ms.create("no-options");const i={...s,...e};i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;const a=m=>[...m].reduce((_,x)=>Math.imul(31,_)+x.charCodeAt(0)|0,0);if(s.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw ms.create("finalization-registry-not-supported",{});const l=""+a(JSON.stringify(i)),u=cc.get(l);if(u)return u.incRefCount(s.releaseOnDeref),u;const h=new m2(l);for(const m of uc.values())h.addComponent(m);const f=new IO(e,s,l,h);return cc.set(l,f),f}function DO(n=fa){const t=ma.get(n);if(!t&&n===fa&&F0())return W0();if(!t)throw ms.create("no-app",{appName:n});return t}function NO(){return Array.from(ma.values())}async function Y0(n){let t=!1;const e=n.name;ma.has(e)?(t=!0,ma.delete(e)):cc.has(e)&&n.decRefCount()<=0&&(cc.delete(e),t=!0),t&&(await Promise.all(n.container.getProviders().map(s=>s.delete())),n.isDeleted=!0)}function tr(n,t,e){let s=TO[n]??n;e&&(s+=`-${e}`);const i=s.match(/\s|\//),a=t.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${t}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${t}" contains illegal characters (whitespace or "/")`),er.warn(l.join(" "));return}hc(new Bo(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}function T2(n,t){if(n!==null&&typeof n!="function")throw ms.create("invalid-log-argument");PM(n,t)}function w2(n){VM(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CO="firebase-heartbeat-database",MO=1,Bh="firebase-heartbeat-store";let cy=null;function S2(){return cy||(cy=GM(CO,MO,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(Bh)}catch(e){console.warn(e)}}}}).catch(n=>{throw ms.create("idb-open",{originalErrorMessage:n.message})})),cy}async function OO(n){try{const e=(await S2()).transaction(Bh),s=await e.objectStore(Bh).get(A2(n));return await e.done,s}catch(t){if(t instanceof Zo)er.warn(t.message);else{const e=ms.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});er.warn(e.message)}}}async function ZT(n,t){try{const s=(await S2()).transaction(Bh,"readwrite");await s.objectStore(Bh).put(t,A2(n)),await s.done}catch(e){if(e instanceof Zo)er.warn(e.message);else{const s=ms.create("idb-set",{originalErrorMessage:e==null?void 0:e.message});er.warn(s.message)}}}function A2(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO=1024,VO=30;class PO{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new jO(e),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var t,e;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=JT();if(((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(l=>l.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats.length>VO){const l=BO(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){er.warn(s)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=JT(),{heartbeatsToSend:s,unsentEntries:i}=LO(this._heartbeatsCache.heartbeats),a=Bm(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return er.warn(e),""}}}function JT(){return new Date().toISOString().substring(0,10)}function LO(n,t=kO){const e=[];let s=n.slice();for(const i of n){const a=e.find(l=>l.agent===i.agent);if(a){if(a.dates.push(i.date),tw(e)>t){a.dates.pop();break}}else if(e.push({agent:i.agent,dates:[i.date]}),tw(e)>t){e.pop();break}s=s.slice(1)}return{heartbeatsToSend:e,unsentEntries:s}}class jO{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return f2()?EM().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await OO(this.app);return e!=null&&e.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const s=await this.read();return ZT(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const s=await this.read();return ZT(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function tw(n){return Bm(JSON.stringify({version:2,heartbeats:n})).length}function BO(n){if(n.length===0)return-1;let t=0,e=n[0].date;for(let s=1;s<n.length;s++)n[s].date<e&&(e=n[s].date,t=s);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FO(n){hc(new Bo("platform-logger",t=>new YM(t),"PRIVATE")),hc(new Bo("heartbeat",t=>new PO(t),"PRIVATE")),tr(zm,By,n),tr(zm,By,"esm2020"),tr("fire-js","")}FO("");const UO=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Zo,SDK_VERSION:$0,_DEFAULT_ENTRY_NAME:fa,_addComponent:jh,_addOrOverwriteComponent:y2,_apps:ma,_clearComponents:SO,_components:uc,_getProvider:b2,_isFirebaseApp:G0,_isFirebaseServerApp:v2,_isFirebaseServerAppSettings:x2,_registerComponent:hc,_removeServiceInstance:wO,_serverApps:cc,deleteApp:Y0,getApp:DO,getApps:NO,initializeApp:W0,initializeServerApp:RO,onLog:T2,registerVersion:tr,setLogLevel:w2},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(t,e){this._delegate=t,this.firebase=e,jh(t,new Bo("app-compat",()=>this,"PUBLIC")),this.container=t.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this._delegate.automaticDataCollectionEnabled=t}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(t=>{this._delegate.checkDestroyed(),t()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Y0(this._delegate)))}_getService(t,e=fa){var i;this._delegate.checkDestroyed();const s=this._delegate.container.getProvider(t);return!s.isInitialized()&&((i=s.getComponent())==null?void 0:i.instantiationMode)==="EXPLICIT"&&s.initialize(),s.getImmediate({identifier:e})}_removeServiceInstance(t,e=fa){this._delegate.container.getProvider(t).clearInstance(e)}_addComponent(t){jh(this._delegate,t)}_addOrOverwriteComponent(t){y2(this._delegate,t)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HO={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},ew=new xg("app-compat","Firebase",HO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qO(n){const t={},e={__esModule:!0,initializeApp:a,app:i,registerVersion:tr,setLogLevel:w2,onLog:T2,apps:null,SDK_VERSION:$0,INTERNAL:{registerComponent:u,removeApp:s,useAsService:h,modularAPIs:UO}};e.default=e,Object.defineProperty(e,"apps",{get:l});function s(f){delete t[f]}function i(f){if(f=f||fa,!$T(t,f))throw ew.create("no-app",{appName:f});return t[f]}i.App=n;function a(f,m={}){const _=W0(f,m);if($T(t,_.name))return t[_.name];const x=new n(_,e);return t[_.name]=x,x}function l(){return Object.keys(t).map(f=>t[f])}function u(f){const m=f.name,_=m.replace("-compat","");if(hc(f)&&f.type==="PUBLIC"){const x=(E=i())=>{if(typeof E[_]!="function")throw ew.create("invalid-app-argument",{appName:m});return E[_]()};f.serviceProps!==void 0&&Fm(x,f.serviceProps),e[_]=x,n.prototype[_]=function(...E){return this._getService.bind(this,m).apply(this,f.multipleInstances?E:[])}}return f.type==="PUBLIC"?e[_]:null}function h(f,m){return m==="serverAuth"?null:m}return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I2(){const n=qO(zO);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:I2,extendNamespace:t,createSubscribe:AM,ErrorFactory:xg,deepExtend:Fm};function t(e){Fm(n,e)}return n}const GO=I2();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nw=new H0("@firebase/app-compat"),$O="@firebase/app-compat",WO="0.5.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YO(n){tr($O,WO,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=B0();if(n.firebase!==void 0){nw.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const t=n.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&nw.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const Th=GO;YO();var KO="firebase",QO="12.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Th.registerVersion(KO,QO,"app-compat");var sw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var la,R2;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(D,I){function C(){}C.prototype=I.prototype,D.F=I.prototype,D.prototype=new C,D.prototype.constructor=D,D.D=function(P,j,F){for(var k=Array(arguments.length-2),nt=2;nt<arguments.length;nt++)k[nt-2]=arguments[nt];return I.prototype[j].apply(P,k)}}function e(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(s,e),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(D,I,C){C||(C=0);const P=Array(16);if(typeof I=="string")for(var j=0;j<16;++j)P[j]=I.charCodeAt(C++)|I.charCodeAt(C++)<<8|I.charCodeAt(C++)<<16|I.charCodeAt(C++)<<24;else for(j=0;j<16;++j)P[j]=I[C++]|I[C++]<<8|I[C++]<<16|I[C++]<<24;I=D.g[0],C=D.g[1],j=D.g[2];let F=D.g[3],k;k=I+(F^C&(j^F))+P[0]+3614090360&4294967295,I=C+(k<<7&4294967295|k>>>25),k=F+(j^I&(C^j))+P[1]+3905402710&4294967295,F=I+(k<<12&4294967295|k>>>20),k=j+(C^F&(I^C))+P[2]+606105819&4294967295,j=F+(k<<17&4294967295|k>>>15),k=C+(I^j&(F^I))+P[3]+3250441966&4294967295,C=j+(k<<22&4294967295|k>>>10),k=I+(F^C&(j^F))+P[4]+4118548399&4294967295,I=C+(k<<7&4294967295|k>>>25),k=F+(j^I&(C^j))+P[5]+1200080426&4294967295,F=I+(k<<12&4294967295|k>>>20),k=j+(C^F&(I^C))+P[6]+2821735955&4294967295,j=F+(k<<17&4294967295|k>>>15),k=C+(I^j&(F^I))+P[7]+4249261313&4294967295,C=j+(k<<22&4294967295|k>>>10),k=I+(F^C&(j^F))+P[8]+1770035416&4294967295,I=C+(k<<7&4294967295|k>>>25),k=F+(j^I&(C^j))+P[9]+2336552879&4294967295,F=I+(k<<12&4294967295|k>>>20),k=j+(C^F&(I^C))+P[10]+4294925233&4294967295,j=F+(k<<17&4294967295|k>>>15),k=C+(I^j&(F^I))+P[11]+2304563134&4294967295,C=j+(k<<22&4294967295|k>>>10),k=I+(F^C&(j^F))+P[12]+1804603682&4294967295,I=C+(k<<7&4294967295|k>>>25),k=F+(j^I&(C^j))+P[13]+4254626195&4294967295,F=I+(k<<12&4294967295|k>>>20),k=j+(C^F&(I^C))+P[14]+2792965006&4294967295,j=F+(k<<17&4294967295|k>>>15),k=C+(I^j&(F^I))+P[15]+1236535329&4294967295,C=j+(k<<22&4294967295|k>>>10),k=I+(j^F&(C^j))+P[1]+4129170786&4294967295,I=C+(k<<5&4294967295|k>>>27),k=F+(C^j&(I^C))+P[6]+3225465664&4294967295,F=I+(k<<9&4294967295|k>>>23),k=j+(I^C&(F^I))+P[11]+643717713&4294967295,j=F+(k<<14&4294967295|k>>>18),k=C+(F^I&(j^F))+P[0]+3921069994&4294967295,C=j+(k<<20&4294967295|k>>>12),k=I+(j^F&(C^j))+P[5]+3593408605&4294967295,I=C+(k<<5&4294967295|k>>>27),k=F+(C^j&(I^C))+P[10]+38016083&4294967295,F=I+(k<<9&4294967295|k>>>23),k=j+(I^C&(F^I))+P[15]+3634488961&4294967295,j=F+(k<<14&4294967295|k>>>18),k=C+(F^I&(j^F))+P[4]+3889429448&4294967295,C=j+(k<<20&4294967295|k>>>12),k=I+(j^F&(C^j))+P[9]+568446438&4294967295,I=C+(k<<5&4294967295|k>>>27),k=F+(C^j&(I^C))+P[14]+3275163606&4294967295,F=I+(k<<9&4294967295|k>>>23),k=j+(I^C&(F^I))+P[3]+4107603335&4294967295,j=F+(k<<14&4294967295|k>>>18),k=C+(F^I&(j^F))+P[8]+1163531501&4294967295,C=j+(k<<20&4294967295|k>>>12),k=I+(j^F&(C^j))+P[13]+2850285829&4294967295,I=C+(k<<5&4294967295|k>>>27),k=F+(C^j&(I^C))+P[2]+4243563512&4294967295,F=I+(k<<9&4294967295|k>>>23),k=j+(I^C&(F^I))+P[7]+1735328473&4294967295,j=F+(k<<14&4294967295|k>>>18),k=C+(F^I&(j^F))+P[12]+2368359562&4294967295,C=j+(k<<20&4294967295|k>>>12),k=I+(C^j^F)+P[5]+4294588738&4294967295,I=C+(k<<4&4294967295|k>>>28),k=F+(I^C^j)+P[8]+2272392833&4294967295,F=I+(k<<11&4294967295|k>>>21),k=j+(F^I^C)+P[11]+1839030562&4294967295,j=F+(k<<16&4294967295|k>>>16),k=C+(j^F^I)+P[14]+4259657740&4294967295,C=j+(k<<23&4294967295|k>>>9),k=I+(C^j^F)+P[1]+2763975236&4294967295,I=C+(k<<4&4294967295|k>>>28),k=F+(I^C^j)+P[4]+1272893353&4294967295,F=I+(k<<11&4294967295|k>>>21),k=j+(F^I^C)+P[7]+4139469664&4294967295,j=F+(k<<16&4294967295|k>>>16),k=C+(j^F^I)+P[10]+3200236656&4294967295,C=j+(k<<23&4294967295|k>>>9),k=I+(C^j^F)+P[13]+681279174&4294967295,I=C+(k<<4&4294967295|k>>>28),k=F+(I^C^j)+P[0]+3936430074&4294967295,F=I+(k<<11&4294967295|k>>>21),k=j+(F^I^C)+P[3]+3572445317&4294967295,j=F+(k<<16&4294967295|k>>>16),k=C+(j^F^I)+P[6]+76029189&4294967295,C=j+(k<<23&4294967295|k>>>9),k=I+(C^j^F)+P[9]+3654602809&4294967295,I=C+(k<<4&4294967295|k>>>28),k=F+(I^C^j)+P[12]+3873151461&4294967295,F=I+(k<<11&4294967295|k>>>21),k=j+(F^I^C)+P[15]+530742520&4294967295,j=F+(k<<16&4294967295|k>>>16),k=C+(j^F^I)+P[2]+3299628645&4294967295,C=j+(k<<23&4294967295|k>>>9),k=I+(j^(C|~F))+P[0]+4096336452&4294967295,I=C+(k<<6&4294967295|k>>>26),k=F+(C^(I|~j))+P[7]+1126891415&4294967295,F=I+(k<<10&4294967295|k>>>22),k=j+(I^(F|~C))+P[14]+2878612391&4294967295,j=F+(k<<15&4294967295|k>>>17),k=C+(F^(j|~I))+P[5]+4237533241&4294967295,C=j+(k<<21&4294967295|k>>>11),k=I+(j^(C|~F))+P[12]+1700485571&4294967295,I=C+(k<<6&4294967295|k>>>26),k=F+(C^(I|~j))+P[3]+2399980690&4294967295,F=I+(k<<10&4294967295|k>>>22),k=j+(I^(F|~C))+P[10]+4293915773&4294967295,j=F+(k<<15&4294967295|k>>>17),k=C+(F^(j|~I))+P[1]+2240044497&4294967295,C=j+(k<<21&4294967295|k>>>11),k=I+(j^(C|~F))+P[8]+1873313359&4294967295,I=C+(k<<6&4294967295|k>>>26),k=F+(C^(I|~j))+P[15]+4264355552&4294967295,F=I+(k<<10&4294967295|k>>>22),k=j+(I^(F|~C))+P[6]+2734768916&4294967295,j=F+(k<<15&4294967295|k>>>17),k=C+(F^(j|~I))+P[13]+1309151649&4294967295,C=j+(k<<21&4294967295|k>>>11),k=I+(j^(C|~F))+P[4]+4149444226&4294967295,I=C+(k<<6&4294967295|k>>>26),k=F+(C^(I|~j))+P[11]+3174756917&4294967295,F=I+(k<<10&4294967295|k>>>22),k=j+(I^(F|~C))+P[2]+718787259&4294967295,j=F+(k<<15&4294967295|k>>>17),k=C+(F^(j|~I))+P[9]+3951481745&4294967295,D.g[0]=D.g[0]+I&4294967295,D.g[1]=D.g[1]+(j+(k<<21&4294967295|k>>>11))&4294967295,D.g[2]=D.g[2]+j&4294967295,D.g[3]=D.g[3]+F&4294967295}s.prototype.v=function(D,I){I===void 0&&(I=D.length);const C=I-this.blockSize,P=this.C;let j=this.h,F=0;for(;F<I;){if(j==0)for(;F<=C;)i(this,D,F),F+=this.blockSize;if(typeof D=="string"){for(;F<I;)if(P[j++]=D.charCodeAt(F++),j==this.blockSize){i(this,P),j=0;break}}else for(;F<I;)if(P[j++]=D[F++],j==this.blockSize){i(this,P),j=0;break}}this.h=j,this.o+=I},s.prototype.A=function(){var D=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);D[0]=128;for(var I=1;I<D.length-8;++I)D[I]=0;I=this.o*8;for(var C=D.length-8;C<D.length;++C)D[C]=I&255,I/=256;for(this.v(D),D=Array(16),I=0,C=0;C<4;++C)for(let P=0;P<32;P+=8)D[I++]=this.g[C]>>>P&255;return D};function a(D,I){var C=u;return Object.prototype.hasOwnProperty.call(C,D)?C[D]:C[D]=I(D)}function l(D,I){this.h=I;const C=[];let P=!0;for(let j=D.length-1;j>=0;j--){const F=D[j]|0;P&&F==I||(C[j]=F,P=!1)}this.g=C}var u={};function h(D){return-128<=D&&D<128?a(D,function(I){return new l([I|0],I<0?-1:0)}):new l([D|0],D<0?-1:0)}function f(D){if(isNaN(D)||!isFinite(D))return _;if(D<0)return R(f(-D));const I=[];let C=1;for(let P=0;D>=C;P++)I[P]=D/C|0,C*=4294967296;return new l(I,0)}function m(D,I){if(D.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(D.charAt(0)=="-")return R(m(D.substring(1),I));if(D.indexOf("-")>=0)throw Error('number format error: interior "-" character');const C=f(Math.pow(I,8));let P=_;for(let F=0;F<D.length;F+=8){var j=Math.min(8,D.length-F);const k=parseInt(D.substring(F,F+j),I);j<8?(j=f(Math.pow(I,j)),P=P.j(j).add(f(k))):(P=P.j(C),P=P.add(f(k)))}return P}var _=h(0),x=h(1),E=h(16777216);n=l.prototype,n.m=function(){if(T(this))return-R(this).m();let D=0,I=1;for(let C=0;C<this.g.length;C++){const P=this.i(C);D+=(P>=0?P:4294967296+P)*I,I*=4294967296}return D},n.toString=function(D){if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(S(this))return"0";if(T(this))return"-"+R(this).toString(D);const I=f(Math.pow(D,6));var C=this;let P="";for(;;){const j=H(C,I).g;C=M(C,j.j(I));let F=((C.g.length>0?C.g[0]:C.h)>>>0).toString(D);if(C=j,S(C))return F+P;for(;F.length<6;)F="0"+F;P=F+P}},n.i=function(D){return D<0?0:D<this.g.length?this.g[D]:this.h};function S(D){if(D.h!=0)return!1;for(let I=0;I<D.g.length;I++)if(D.g[I]!=0)return!1;return!0}function T(D){return D.h==-1}n.l=function(D){return D=M(this,D),T(D)?-1:S(D)?0:1};function R(D){const I=D.g.length,C=[];for(let P=0;P<I;P++)C[P]=~D.g[P];return new l(C,~D.h).add(x)}n.abs=function(){return T(this)?R(this):this},n.add=function(D){const I=Math.max(this.g.length,D.g.length),C=[];let P=0;for(let j=0;j<=I;j++){let F=P+(this.i(j)&65535)+(D.i(j)&65535),k=(F>>>16)+(this.i(j)>>>16)+(D.i(j)>>>16);P=k>>>16,F&=65535,k&=65535,C[j]=k<<16|F}return new l(C,C[C.length-1]&-2147483648?-1:0)};function M(D,I){return D.add(R(I))}n.j=function(D){if(S(this)||S(D))return _;if(T(this))return T(D)?R(this).j(R(D)):R(R(this).j(D));if(T(D))return R(this.j(R(D)));if(this.l(E)<0&&D.l(E)<0)return f(this.m()*D.m());const I=this.g.length+D.g.length,C=[];for(var P=0;P<2*I;P++)C[P]=0;for(P=0;P<this.g.length;P++)for(let j=0;j<D.g.length;j++){const F=this.i(P)>>>16,k=this.i(P)&65535,nt=D.i(j)>>>16,bt=D.i(j)&65535;C[2*P+2*j]+=k*bt,L(C,2*P+2*j),C[2*P+2*j+1]+=F*bt,L(C,2*P+2*j+1),C[2*P+2*j+1]+=k*nt,L(C,2*P+2*j+1),C[2*P+2*j+2]+=F*nt,L(C,2*P+2*j+2)}for(D=0;D<I;D++)C[D]=C[2*D+1]<<16|C[2*D];for(D=I;D<2*I;D++)C[D]=0;return new l(C,0)};function L(D,I){for(;(D[I]&65535)!=D[I];)D[I+1]+=D[I]>>>16,D[I]&=65535,I++}function O(D,I){this.g=D,this.h=I}function H(D,I){if(S(I))throw Error("division by zero");if(S(D))return new O(_,_);if(T(D))return I=H(R(D),I),new O(R(I.g),R(I.h));if(T(I))return I=H(D,R(I)),new O(R(I.g),I.h);if(D.g.length>30){if(T(D)||T(I))throw Error("slowDivide_ only works with positive integers.");for(var C=x,P=I;P.l(D)<=0;)C=B(C),P=B(P);var j=z(C,1),F=z(P,1);for(P=z(P,2),C=z(C,2);!S(P);){var k=F.add(P);k.l(D)<=0&&(j=j.add(C),F=k),P=z(P,1),C=z(C,1)}return I=M(D,j.j(I)),new O(j,I)}for(j=_;D.l(I)>=0;){for(C=Math.max(1,Math.floor(D.m()/I.m())),P=Math.ceil(Math.log(C)/Math.LN2),P=P<=48?1:Math.pow(2,P-48),F=f(C),k=F.j(I);T(k)||k.l(D)>0;)C-=P,F=f(C),k=F.j(I);S(F)&&(F=x),j=j.add(F),D=M(D,k)}return new O(j,D)}n.B=function(D){return H(this,D).h},n.and=function(D){const I=Math.max(this.g.length,D.g.length),C=[];for(let P=0;P<I;P++)C[P]=this.i(P)&D.i(P);return new l(C,this.h&D.h)},n.or=function(D){const I=Math.max(this.g.length,D.g.length),C=[];for(let P=0;P<I;P++)C[P]=this.i(P)|D.i(P);return new l(C,this.h|D.h)},n.xor=function(D){const I=Math.max(this.g.length,D.g.length),C=[];for(let P=0;P<I;P++)C[P]=this.i(P)^D.i(P);return new l(C,this.h^D.h)};function B(D){const I=D.g.length+1,C=[];for(let P=0;P<I;P++)C[P]=D.i(P)<<1|D.i(P-1)>>>31;return new l(C,D.h)}function z(D,I){const C=I>>5;I%=32;const P=D.g.length-C,j=[];for(let F=0;F<P;F++)j[F]=I>0?D.i(F+C)>>>I|D.i(F+C+1)<<32-I:D.i(F+C);return new l(j,D.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,R2=s,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=f,l.fromString=m,la=l}).apply(typeof sw<"u"?sw:typeof self<"u"?self:typeof window<"u"?window:{});var Zf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var D2,uh,N2,bm,Fy,C2,M2,O2;(function(){var n,t=Object.defineProperty;function e(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zf=="object"&&Zf];for(var v=0;v<g.length;++v){var w=g[v];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var s=e(this);function i(g,v){if(v)t:{var w=s;g=g.split(".");for(var V=0;V<g.length-1;V++){var Q=g[V];if(!(Q in w))break t;w=w[Q]}g=g[g.length-1],V=w[g],v=v(V),v!=V&&v!=null&&t(w,g,{configurable:!0,writable:!0,value:v})}}i("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(g){return g||function(v){var w=[],V;for(V in v)Object.prototype.hasOwnProperty.call(v,V)&&w.push([V,v[V]]);return w}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function u(g){var v=typeof g;return v=="object"&&g!=null||v=="function"}function h(g,v,w){return g.call.apply(g.bind,arguments)}function f(g,v,w){return f=h,f.apply(null,arguments)}function m(g,v){var w=Array.prototype.slice.call(arguments,1);return function(){var V=w.slice();return V.push.apply(V,arguments),g.apply(this,V)}}function _(g,v){function w(){}w.prototype=v.prototype,g.Z=v.prototype,g.prototype=new w,g.prototype.constructor=g,g.Ob=function(V,Q,et){for(var gt=Array(arguments.length-2),Pt=2;Pt<arguments.length;Pt++)gt[Pt-2]=arguments[Pt];return v.prototype[Q].apply(V,gt)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function E(g){const v=g.length;if(v>0){const w=Array(v);for(let V=0;V<v;V++)w[V]=g[V];return w}return[]}function S(g,v){for(let V=1;V<arguments.length;V++){const Q=arguments[V];var w=typeof Q;if(w=w!="object"?w:Q?Array.isArray(Q)?"array":w:"null",w=="array"||w=="object"&&typeof Q.length=="number"){w=g.length||0;const et=Q.length||0;g.length=w+et;for(let gt=0;gt<et;gt++)g[w+gt]=Q[gt]}else g.push(Q)}}class T{constructor(v,w){this.i=v,this.j=w,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function R(g){l.setTimeout(()=>{throw g},0)}function M(){var g=D;let v=null;return g.g&&(v=g.g,g.g=g.g.next,g.g||(g.h=null),v.next=null),v}class L{constructor(){this.h=this.g=null}add(v,w){const V=O.get();V.set(v,w),this.h?this.h.next=V:this.g=V,this.h=V}}var O=new T(()=>new H,g=>g.reset());class H{constructor(){this.next=this.g=this.h=null}set(v,w){this.h=v,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let B,z=!1,D=new L,I=()=>{const g=Promise.resolve(void 0);B=()=>{g.then(C)}};function C(){for(var g;g=M();){try{g.h.call(g.g)}catch(w){R(w)}var v=O;v.j(g),v.h<100&&(v.h++,g.next=v.g,v.g=g)}z=!1}function P(){this.u=this.u,this.C=this.C}P.prototype.u=!1,P.prototype.dispose=function(){this.u||(this.u=!0,this.N())},P.prototype[Symbol.dispose]=function(){this.dispose()},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(g,v){this.type=g,this.g=this.target=v,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var F=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var g=!1,v=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const w=()=>{};l.addEventListener("test",w,v),l.removeEventListener("test",w,v)}catch{}return g})();function k(g){return/^[\s\xa0]*$/.test(g)}function nt(g,v){j.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,v)}_(nt,j),nt.prototype.init=function(g,v){const w=this.type=g.type,V=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=v,v=g.relatedTarget,v||(w=="mouseover"?v=g.fromElement:w=="mouseout"&&(v=g.toElement)),this.relatedTarget=v,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&nt.Z.h.call(this)},nt.prototype.h=function(){nt.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var bt="closure_listenable_"+(Math.random()*1e6|0),Y=0;function at(g,v,w,V,Q){this.listener=g,this.proxy=null,this.src=v,this.type=w,this.capture=!!V,this.ha=Q,this.key=++Y,this.da=this.fa=!1}function mt(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function Dt(g,v,w){for(const V in g)v.call(w,g[V],V,g)}function U(g,v){for(const w in g)v.call(void 0,g[w],w,g)}function st(g){const v={};for(const w in g)v[w]=g[w];return v}const ht="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function dt(g,v){let w,V;for(let Q=1;Q<arguments.length;Q++){V=arguments[Q];for(w in V)g[w]=V[w];for(let et=0;et<ht.length;et++)w=ht[et],Object.prototype.hasOwnProperty.call(V,w)&&(g[w]=V[w])}}function yt(g){this.src=g,this.g={},this.h=0}yt.prototype.add=function(g,v,w,V,Q){const et=g.toString();g=this.g[et],g||(g=this.g[et]=[],this.h++);const gt=At(g,v,V,Q);return gt>-1?(v=g[gt],w||(v.fa=!1)):(v=new at(v,this.src,et,!!V,Q),v.fa=w,g.push(v)),v};function kt(g,v){const w=v.type;if(w in g.g){var V=g.g[w],Q=Array.prototype.indexOf.call(V,v,void 0),et;(et=Q>=0)&&Array.prototype.splice.call(V,Q,1),et&&(mt(v),g.g[w].length==0&&(delete g.g[w],g.h--))}}function At(g,v,w,V){for(let Q=0;Q<g.length;++Q){const et=g[Q];if(!et.da&&et.listener==v&&et.capture==!!w&&et.ha==V)return Q}return-1}var Ie="closure_lm_"+(Math.random()*1e6|0),te={};function Fe(g,v,w,V,Q){if(Array.isArray(v)){for(let et=0;et<v.length;et++)Fe(g,v[et],w,V,Q);return null}return w=Md(w),g&&g[bt]?g.J(v,w,u(V)?!!V.capture:!1,Q):ur(g,v,w,!1,V,Q)}function ur(g,v,w,V,Q,et){if(!v)throw Error("Invalid event type");const gt=u(Q)?!!Q.capture:!!Q;let Pt=$c(g);if(Pt||(g[Ie]=Pt=new yt(g)),w=Pt.add(v,w,V,gt,et),w.proxy)return w;if(V=Ks(),w.proxy=V,V.src=g,V.listener=w,g.addEventListener)F||(Q=gt),Q===void 0&&(Q=!1),g.addEventListener(v.toString(),V,Q);else if(g.attachEvent)g.attachEvent(hr(v.toString()),V);else if(g.addListener&&g.removeListener)g.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return w}function Ks(){function g(w){return v.call(g.src,g.listener,w)}const v=tp;return g}function Ti(g,v,w,V,Q){if(Array.isArray(v))for(var et=0;et<v.length;et++)Ti(g,v[et],w,V,Q);else V=u(V)?!!V.capture:!!V,w=Md(w),g&&g[bt]?(g=g.i,et=String(v).toString(),et in g.g&&(v=g.g[et],w=At(v,w,V,Q),w>-1&&(mt(v[w]),Array.prototype.splice.call(v,w,1),v.length==0&&(delete g.g[et],g.h--)))):g&&(g=$c(g))&&(v=g.g[v.toString()],g=-1,v&&(g=At(v,w,V,Q)),(w=g>-1?v[g]:null)&&wi(w))}function wi(g){if(typeof g!="number"&&g&&!g.da){var v=g.src;if(v&&v[bt])kt(v.i,g);else{var w=g.type,V=g.proxy;v.removeEventListener?v.removeEventListener(w,V,g.capture):v.detachEvent?v.detachEvent(hr(w),V):v.addListener&&v.removeListener&&v.removeListener(V),(w=$c(v))?(kt(w,g),w.h==0&&(w.src=null,v[Ie]=null)):mt(g)}}}function hr(g){return g in te?te[g]:te[g]="on"+g}function tp(g,v){if(g.da)g=!0;else{v=new nt(v,this);const w=g.listener,V=g.ha||g.src;g.fa&&wi(g),g=w.call(V,v)}return g}function $c(g){return g=g[Ie],g instanceof yt?g:null}var Kn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Md(g){return typeof g=="function"?g:(g[Kn]||(g[Kn]=function(v){return g.handleEvent(v)}),g[Kn])}function nn(){P.call(this),this.i=new yt(this),this.M=this,this.G=null}_(nn,P),nn.prototype[bt]=!0,nn.prototype.removeEventListener=function(g,v,w,V){Ti(this,g,v,w,V)};function hn(g,v){var w,V=g.G;if(V)for(w=[];V;V=V.G)w.push(V);if(g=g.M,V=v.type||v,typeof v=="string")v=new j(v,g);else if(v instanceof j)v.target=v.target||g;else{var Q=v;v=new j(V,g),dt(v,Q)}Q=!0;let et,gt;if(w)for(gt=w.length-1;gt>=0;gt--)et=v.g=w[gt],Q=Si(et,V,!0,v)&&Q;if(et=v.g=g,Q=Si(et,V,!0,v)&&Q,Q=Si(et,V,!1,v)&&Q,w)for(gt=0;gt<w.length;gt++)et=v.g=w[gt],Q=Si(et,V,!1,v)&&Q}nn.prototype.N=function(){if(nn.Z.N.call(this),this.i){var g=this.i;for(const v in g.g){const w=g.g[v];for(let V=0;V<w.length;V++)mt(w[V]);delete g.g[v],g.h--}}this.G=null},nn.prototype.J=function(g,v,w,V){return this.i.add(String(g),v,!1,w,V)},nn.prototype.K=function(g,v,w,V){return this.i.add(String(g),v,!0,w,V)};function Si(g,v,w,V){if(v=g.i.g[String(v)],!v)return!0;v=v.concat();let Q=!0;for(let et=0;et<v.length;++et){const gt=v[et];if(gt&&!gt.da&&gt.capture==w){const Pt=gt.listener,we=gt.ha||gt.src;gt.fa&&kt(g.i,gt),Q=Pt.call(we,V)!==!1&&Q}}return Q&&!V.defaultPrevented}function ep(g,v){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=f(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:l.setTimeout(g,v||0)}function Wc(g){g.g=ep(()=>{g.g=null,g.i&&(g.i=!1,Wc(g))},g.l);const v=g.h;g.h=null,g.m.apply(null,v)}class np extends P{constructor(v,w){super(),this.m=v,this.l=w,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Wc(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Oa(g){P.call(this),this.h=g,this.g={}}_(Oa,P);var dr=[];function In(g){Dt(g.g,function(v,w){this.g.hasOwnProperty(w)&&wi(v)},g),g.g={}}Oa.prototype.N=function(){Oa.Z.N.call(this),In(this)},Oa.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _s=l.JSON.stringify,Fn=l.JSON.parse,sp=class{stringify(g){return l.JSON.stringify(g,void 0)}parse(g){return l.JSON.parse(g,void 0)}};function Od(){}function kd(){}var Qs={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function fr(){j.call(this,"d")}_(fr,j);function Os(){j.call(this,"c")}_(Os,j);var ys={},mr=null;function sl(){return mr=mr||new nn}ys.Ia="serverreachability";function Yc(g){j.call(this,ys.Ia,g)}_(Yc,j);function gr(g){const v=sl();hn(v,new Yc(v))}ys.STAT_EVENT="statevent";function il(g,v){j.call(this,ys.STAT_EVENT,g),this.stat=v}_(il,j);function Ue(g){const v=sl();hn(v,new il(v,g))}ys.Ja="timingevent";function Vd(g,v){j.call(this,ys.Ja,g),this.size=v}_(Vd,j);function pr(g,v){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){g()},v)}function _r(){this.g=!0}_r.prototype.ua=function(){this.g=!1};function Kc(g,v,w,V,Q,et){g.info(function(){if(g.g)if(et){var gt="",Pt=et.split("&");for(let le=0;le<Pt.length;le++){var we=Pt[le].split("=");if(we.length>1){const qe=we[0];we=we[1];const is=qe.split("_");gt=is.length>=2&&is[1]=="type"?gt+(qe+"="+we+"&"):gt+(qe+"=redacted&")}}}else gt=null;else gt=et;return"XMLHTTP REQ ("+V+") [attempt "+Q+"]: "+v+`
`+w+`
`+gt})}function Qc(g,v,w,V,Q,et,gt){g.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+Q+"]: "+v+`
`+w+`
`+et+" "+gt})}function Ai(g,v,w,V){g.info(function(){return"XMLHTTP TEXT ("+v+"): "+Xs(g,w)+(V?" "+V:"")})}function ip(g,v){g.info(function(){return"TIMEOUT: "+v})}_r.prototype.info=function(){};function Xs(g,v){if(!g.g)return v;if(!v)return null;try{const et=JSON.parse(v);if(et){for(g=0;g<et.length;g++)if(Array.isArray(et[g])){var w=et[g];if(!(w.length<2)){var V=w[1];if(Array.isArray(V)&&!(V.length<1)){var Q=V[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(let gt=1;gt<V.length;gt++)V[gt]=""}}}}return _s(et)}catch{return v}}var ze={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},bn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ii;function ka(){}_(ka,Od),ka.prototype.g=function(){return new XMLHttpRequest},Ii=new ka;function Va(g){return encodeURIComponent(String(g))}function rp(g){var v=1;g=g.split(":");const w=[];for(;v>0&&g.length;)w.push(g.shift()),v--;return g.length&&w.push(g.join(":")),w}function ks(g,v,w,V){this.j=g,this.i=v,this.l=w,this.S=V||1,this.V=new Oa(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new yr}function yr(){this.i=null,this.g="",this.h=!1}var rl={},Zs={};function Js(g,v,w){g.M=1,g.A=Di(ke(v)),g.u=w,g.R=!0,br(g,null)}function br(g,v){g.F=Date.now(),Pa(g),g.B=ke(g.A);var w=g.B,V=g.S;Array.isArray(V)||(V=[String(V)]),Bd(w.i,"t",V),g.C=0,w=g.j.L,g.h=new yr,g.g=gl(g.j,w?v:null,!g.u),g.P>0&&(g.O=new np(f(g.Y,g,g.g),g.P)),v=g.V,w=g.g,V=g.ba;var Q="readystatechange";Array.isArray(Q)||(Q&&(dr[0]=Q.toString()),Q=dr);for(let et=0;et<Q.length;et++){const gt=Fe(w,Q[et],V||v.handleEvent,!1,v.h||v);if(!gt)break;v.g[gt.key]=gt}v=g.J?st(g.J):{},g.u?(g.v||(g.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,v)):(g.v="GET",g.g.ea(g.B,g.v,null,v)),gr(),Kc(g.i,g.v,g.B,g.l,g.S,g.u)}ks.prototype.ba=function(g){g=g.target;const v=this.O;v&&Rn(g)==3?v.j():this.Y(g)},ks.prototype.Y=function(g){try{if(g==this.g)t:{const Pt=Rn(this.g),we=this.g.ya(),le=this.g.ca();if(!(Pt<3)&&(Pt!=3||this.g&&(this.h.h||this.g.la()||Wa(this.g)))){this.K||Pt!=4||we==7||(we==8||le<=0?gr(3):gr(2)),ei(this);var v=this.g.ca();this.X=v;var w=xr(this);if(this.o=v==200,Qc(this.i,this.v,this.B,this.l,this.S,Pt,v),this.o){if(this.U&&!this.L){e:{if(this.g){var V,Q=this.g;if((V=Q.g?Q.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(V)){var et=V;break e}}et=null}if(g=et)Ai(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,al(this,g);else{this.o=!1,this.m=3,Ue(12),ni(this),La(this);break t}}if(this.R){g=!0;let qe;for(;!this.K&&this.C<w.length;)if(qe=Pd(this,w),qe==Zs){Pt==4&&(this.m=4,Ue(14),g=!1),Ai(this.i,this.l,null,"[Incomplete Response]");break}else if(qe==rl){this.m=4,Ue(15),Ai(this.i,this.l,w,"[Invalid Chunk]"),g=!1;break}else Ai(this.i,this.l,qe,null),al(this,qe);if(He(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pt!=4||w.length!=0||this.h.h||(this.m=1,Ue(16),g=!1),this.o=this.o&&g,!g)Ai(this.i,this.l,w,"[Invalid Chunked Response]"),ni(this),La(this);else if(w.length>0&&!this.W){this.W=!0;var gt=this.j;gt.g==this&&gt.aa&&!gt.P&&(gt.j.info("Great, no buffering proxy detected. Bytes received: "+w.length),au(gt),gt.P=!0,Ue(11))}}else Ai(this.i,this.l,w,null),al(this,w);Pt==4&&ni(this),this.o&&!this.K&&(Pt==4?ou(this.j,this):(this.o=!1,Pa(this)))}else Ya(this.g),v==400&&w.indexOf("Unknown SID")>0?(this.m=3,Ue(12)):(this.m=0,Ue(13)),ni(this),La(this)}}}catch{}finally{}};function xr(g){if(!He(g))return g.g.la();const v=Wa(g.g);if(v==="")return"";let w="";const V=v.length,Q=Rn(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return ni(g),La(g),"";g.h.i=new l.TextDecoder}for(let et=0;et<V;et++)g.h.h=!0,w+=g.h.i.decode(v[et],{stream:!(Q&&et==V-1)});return v.length=0,g.h.g+=w,g.C=0,g.h.g}function He(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function Pd(g,v){var w=g.C,V=v.indexOf(`
`,w);return V==-1?Zs:(w=Number(v.substring(w,V)),isNaN(w)?rl:(V+=1,V+w>v.length?Zs:(v=v.slice(V,V+w),g.C=V+w,v)))}ks.prototype.cancel=function(){this.K=!0,ni(this)};function Pa(g){g.T=Date.now()+g.H,ti(g,g.H)}function ti(g,v){if(g.D!=null)throw Error("WatchDog timer not null");g.D=pr(f(g.aa,g),v)}function ei(g){g.D&&(l.clearTimeout(g.D),g.D=null)}ks.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(ip(this.i,this.B),this.M!=2&&(gr(),Ue(17)),ni(this),this.m=2,La(this)):ti(this,this.T-g)};function La(g){g.j.I==0||g.K||ou(g.j,g)}function ni(g){ei(g);var v=g.O;v&&typeof v.dispose=="function"&&v.dispose(),g.O=null,In(g.V),g.g&&(v=g.g,g.g=null,v.abort(),v.dispose())}function al(g,v){try{var w=g.j;if(w.I!=0&&(w.g==g||Fa(w.h,g))){if(!g.L&&Fa(w.h,g)&&w.I==3){try{var V=w.Ba.g.parse(v)}catch{V=null}if(Array.isArray(V)&&V.length==3){var Q=V;if(Q[0]==0){t:if(!w.v){if(w.g)if(w.g.F+3e3<g.F)ml(w),si(w);else break t;ru(w),Ue(18)}}else w.xa=Q[1],0<w.xa-w.K&&Q[2]<37500&&w.F&&w.A==0&&!w.C&&(w.C=pr(f(w.Va,w),6e3));bs(w.h)<=1&&w.ta&&(w.ta=void 0)}else Mi(w,11)}else if((g.L||w.g==g)&&ml(w),!k(v))for(Q=w.Ba.g.parse(v),v=0;v<Q.length;v++){let le=Q[v];const qe=le[0];if(!(qe<=w.K))if(w.K=qe,le=le[1],w.I==2)if(le[0]=="c"){w.M=le[1],w.ba=le[2];const is=le[3];is!=null&&(w.ka=is,w.j.info("VER="+w.ka));const ii=le[4];ii!=null&&(w.za=ii,w.j.info("SVER="+w.za));const Ls=le[5];Ls!=null&&typeof Ls=="number"&&Ls>0&&(V=1.5*Ls,w.O=V,w.j.info("backChannelRequestTimeoutMs_="+V)),V=w;const js=g.g;if(js){const Bs=js.g?js.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bs){var et=V.h;et.g||Bs.indexOf("spdy")==-1&&Bs.indexOf("quic")==-1&&Bs.indexOf("h2")==-1||(et.j=et.l,et.g=new Set,et.h&&(ol(et,et.h),et.h=null))}if(V.G){const cu=js.g?js.g.getResponseHeader("X-HTTP-Session-Id"):null;cu&&(V.wa=cu,me(V.J,V.G,cu))}}w.I=3,w.l&&w.l.ra(),w.aa&&(w.T=Date.now()-g.F,w.j.info("Handshake RTT: "+w.T+"ms")),V=w;var gt=g;if(V.na=Yd(V,V.L?V.ba:null,V.W),gt.L){Ri(V.h,gt);var Pt=gt,we=V.O;we&&(Pt.H=we),Pt.D&&(ei(Pt),Pa(Pt)),V.g=gt}else qd(V);w.i.length>0&&Za(w)}else le[0]!="stop"&&le[0]!="close"||Mi(w,7);else w.I==3&&(le[0]=="stop"||le[0]=="close"?le[0]=="stop"?Mi(w,7):Qa(w):le[0]!="noop"&&w.l&&w.l.qa(le),w.A=0)}}gr(4)}catch{}}var ap=class{constructor(g,v){this.g=g,this.map=v}};function ja(g){this.l=g||10,l.PerformanceNavigationTiming?(g=l.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ba(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function bs(g){return g.h?1:g.g?g.g.size:0}function Fa(g,v){return g.h?g.h==v:g.g?g.g.has(v):!1}function ol(g,v){g.g?g.g.add(v):g.h=v}function Ri(g,v){g.h&&g.h==v?g.h=null:g.g&&g.g.has(v)&&g.g.delete(v)}ja.prototype.cancel=function(){if(this.i=ll(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function ll(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let v=g.i;for(const w of g.g.values())v=v.concat(w.G);return v}return E(g.i)}var cl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function op(g,v){if(g){g=g.split("&");for(let w=0;w<g.length;w++){const V=g[w].indexOf("=");let Q,et=null;V>=0?(Q=g[w].substring(0,V),et=g[w].substring(V+1)):Q=g[w],v(Q,et?decodeURIComponent(et.replace(/\+/g," ")):"")}}}function Vs(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;g instanceof Vs?(this.l=g.l,vr(this,g.j),this.o=g.o,this.g=g.g,Ua(this,g.u),this.h=g.h,Er(this,Fd(g.i)),this.m=g.m):g&&(v=String(g).match(cl))?(this.l=!1,vr(this,v[1]||"",!0),this.o=za(v[2]||""),this.g=za(v[3]||"",!0),Ua(this,v[4]),this.h=za(v[5]||"",!0),Er(this,v[6]||"",!0),this.m=za(v[7]||"")):(this.l=!1,this.i=new xs(null,this.l))}Vs.prototype.toString=function(){const g=[];var v=this.j;v&&g.push(dn(v,Zc,!0),":");var w=this.g;return(w||v=="file")&&(g.push("//"),(v=this.o)&&g.push(dn(v,Zc,!0),"@"),g.push(Va(w).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.u,w!=null&&g.push(":",String(w))),(w=this.h)&&(this.g&&w.charAt(0)!="/"&&g.push("/"),g.push(dn(w,w.charAt(0)=="/"?Tr:Jc,!0))),(w=this.i.toString())&&g.push("?",w),(w=this.m)&&g.push("#",dn(w,jd)),g.join("")},Vs.prototype.resolve=function(g){const v=ke(this);let w=!!g.j;w?vr(v,g.j):w=!!g.o,w?v.o=g.o:w=!!g.g,w?v.g=g.g:w=g.u!=null;var V=g.h;if(w)Ua(v,g.u);else if(w=!!g.h){if(V.charAt(0)!="/")if(this.g&&!this.h)V="/"+V;else{var Q=v.h.lastIndexOf("/");Q!=-1&&(V=v.h.slice(0,Q+1)+V)}if(Q=V,Q==".."||Q==".")V="";else if(Q.indexOf("./")!=-1||Q.indexOf("/.")!=-1){V=Q.lastIndexOf("/",0)==0,Q=Q.split("/");const et=[];for(let gt=0;gt<Q.length;){const Pt=Q[gt++];Pt=="."?V&&gt==Q.length&&et.push(""):Pt==".."?((et.length>1||et.length==1&&et[0]!="")&&et.pop(),V&&gt==Q.length&&et.push("")):(et.push(Pt),V=!0)}V=et.join("/")}else V=Q}return w?v.h=V:w=g.i.toString()!=="",w?Er(v,Fd(g.i)):w=!!g.m,w&&(v.m=g.m),v};function ke(g){return new Vs(g)}function vr(g,v,w){g.j=w?za(v,!0):v,g.j&&(g.j=g.j.replace(/:$/,""))}function Ua(g,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);g.u=v}else g.u=null}function Er(g,v,w){v instanceof xs?(g.i=v,nu(g.i,g.l)):(w||(v=dn(v,Ld)),g.i=new xs(v,g.l))}function me(g,v,w){g.i.set(v,w)}function Di(g){return me(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function za(g,v){return g?v?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function dn(g,v,w){return typeof g=="string"?(g=encodeURI(g).replace(v,Xc),w&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Xc(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Zc=/[#\/\?@]/g,Jc=/[#\?:]/g,Tr=/[#\?]/g,Ld=/[#\?@]/g,jd=/#/g;function xs(g,v){this.h=this.g=null,this.i=g||null,this.j=!!v}function Ni(g){g.g||(g.g=new Map,g.h=0,g.i&&op(g.i,function(v,w){g.add(decodeURIComponent(v.replace(/\+/g," ")),w)}))}n=xs.prototype,n.add=function(g,v){Ni(this),this.i=null,g=Ps(this,g);let w=this.g.get(g);return w||this.g.set(g,w=[]),w.push(v),this.h+=1,this};function tu(g,v){Ni(g),v=Ps(g,v),g.g.has(v)&&(g.i=null,g.h-=g.g.get(v).length,g.g.delete(v))}function eu(g,v){return Ni(g),v=Ps(g,v),g.g.has(v)}n.forEach=function(g,v){Ni(this),this.g.forEach(function(w,V){w.forEach(function(Q){g.call(v,Q,V,this)},this)},this)};function ul(g,v){Ni(g);let w=[];if(typeof v=="string")eu(g,v)&&(w=w.concat(g.g.get(Ps(g,v))));else for(g=Array.from(g.g.values()),v=0;v<g.length;v++)w=w.concat(g[v]);return w}n.set=function(g,v){return Ni(this),this.i=null,g=Ps(this,g),eu(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[v]),this.h+=1,this},n.get=function(g,v){return g?(g=ul(this,g),g.length>0?String(g[0]):v):v};function Bd(g,v,w){tu(g,v),w.length>0&&(g.i=null,g.g.set(Ps(g,v),E(w)),g.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],v=Array.from(this.g.keys());for(let V=0;V<v.length;V++){var w=v[V];const Q=Va(w);w=ul(this,w);for(let et=0;et<w.length;et++){let gt=Q;w[et]!==""&&(gt+="="+Va(w[et])),g.push(gt)}}return this.i=g.join("&")};function Fd(g){const v=new xs;return v.i=g.i,g.g&&(v.g=new Map(g.g),v.h=g.h),v}function Ps(g,v){return v=String(v),g.j&&(v=v.toLowerCase()),v}function nu(g,v){v&&!g.j&&(Ni(g),g.i=null,g.g.forEach(function(w,V){const Q=V.toLowerCase();V!=Q&&(tu(this,V),Bd(this,Q,w))},g)),g.j=v}function su(g,v){const w=new _r;if(l.Image){const V=new Image;V.onload=m(Un,w,"TestLoadImage: loaded",!0,v,V),V.onerror=m(Un,w,"TestLoadImage: error",!1,v,V),V.onabort=m(Un,w,"TestLoadImage: abort",!1,v,V),V.ontimeout=m(Un,w,"TestLoadImage: timeout",!1,v,V),l.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=g}else v(!1)}function wr(g,v){const w=new _r,V=new AbortController,Q=setTimeout(()=>{V.abort(),Un(w,"TestPingServer: timeout",!1,v)},1e4);fetch(g,{signal:V.signal}).then(et=>{clearTimeout(Q),et.ok?Un(w,"TestPingServer: ok",!0,v):Un(w,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(Q),Un(w,"TestPingServer: error",!1,v)})}function Un(g,v,w,V,Q){try{Q&&(Q.onload=null,Q.onerror=null,Q.onabort=null,Q.ontimeout=null),V(w)}catch{}}function Ud(){this.g=new sp}function Ha(g){this.i=g.Sb||null,this.h=g.ab||!1}_(Ha,Od),Ha.prototype.g=function(){return new qa(this.i,this.h)};function qa(g,v){nn.call(this),this.H=g,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}_(qa,nn),n=qa.prototype,n.open=function(g,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=v,this.readyState=1,Ci(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(v.body=g),(this.H||l).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,zn(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,Ci(this)),this.g&&(this.readyState=3,Ci(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Sr(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function Sr(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var v=g.value?g.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!g.done}))&&(this.response=this.responseText+=v)}g.done?zn(this):Ci(this),this.readyState==3&&Sr(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,zn(this))},n.Na=function(g){this.g&&(this.response=g,zn(this))},n.ga=function(){this.g&&zn(this)};function zn(g){g.readyState=4,g.l=null,g.j=null,g.B=null,Ci(g)}n.setRequestHeader=function(g,v){this.A.append(g,v)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],v=this.h.entries();for(var w=v.next();!w.done;)w=w.value,g.push(w[0]+": "+w[1]),w=v.next();return g.join(`\r
`)};function Ci(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(qa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Ar(g){let v="";return Dt(g,function(w,V){v+=V,v+=":",v+=w,v+=`\r
`}),v}function vs(g,v,w){t:{for(V in w){var V=!1;break t}V=!0}V||(w=Ar(w),typeof g=="string"?w!=null&&Va(w):me(g,v,w))}function be(g){nn.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}_(be,nn);var hl=/^https?$/i,zd=["POST","PUT"];n=be.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,v,w,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);v=v?v.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ii.g(),this.g.onreadystatechange=x(f(this.Ca,this));try{this.B=!0,this.g.open(v,String(g),!0),this.B=!1}catch(et){Ga(this,et);return}if(g=w||"",w=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var Q in V)w.set(Q,V[Q]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const et of V.keys())w.set(et,V.get(et));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(w.keys()).find(et=>et.toLowerCase()=="content-type"),Q=l.FormData&&g instanceof l.FormData,!(Array.prototype.indexOf.call(zd,v,void 0)>=0)||V||Q||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[et,gt]of w)this.g.setRequestHeader(et,gt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(et){Ga(this,et)}};function Ga(g,v){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=v,g.o=5,$a(g),sn(g)}function $a(g){g.A||(g.A=!0,hn(g,"complete"),hn(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,hn(this,"complete"),hn(this,"abort"),sn(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),sn(this,!0)),be.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?iu(this):this.Xa())},n.Xa=function(){iu(this)};function iu(g){if(g.h&&typeof a<"u"){if(g.v&&Rn(g)==4)setTimeout(g.Ca.bind(g),0);else if(hn(g,"readystatechange"),Rn(g)==4){g.h=!1;try{const et=g.ca();t:switch(et){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break t;default:v=!1}var w;if(!(w=v)){var V;if(V=et===0){let gt=String(g.D).match(cl)[1]||null;!gt&&l.self&&l.self.location&&(gt=l.self.location.protocol.slice(0,-1)),V=!hl.test(gt?gt.toLowerCase():"")}w=V}if(w)hn(g,"complete"),hn(g,"success");else{g.o=6;try{var Q=Rn(g)>2?g.g.statusText:""}catch{Q=""}g.l=Q+" ["+g.ca()+"]",$a(g)}}finally{sn(g)}}}}function sn(g,v){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const w=g.g;g.g=null,v||hn(g,"ready");try{w.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Rn(g){return g.g?g.g.readyState:0}n.ca=function(){try{return Rn(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var v=this.g.responseText;return g&&v.indexOf(g)==0&&(v=v.substring(g.length)),Fn(v)}};function Wa(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function Ya(g){const v={};g=(g.g&&Rn(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<g.length;V++){if(k(g[V]))continue;var w=rp(g[V]);const Q=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const et=v[Q]||[];v[Q]=et,et.push(w)}U(v,function(V){return V.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ka(g,v,w){return w&&w.internalChannelParams&&w.internalChannelParams[g]||v}function dl(g){this.za=0,this.i=[],this.j=new _r,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ka("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ka("baseRetryDelayMs",5e3,g),this.Za=Ka("retryDelaySeedMs",1e4,g),this.Ta=Ka("forwardChannelMaxRetries",2,g),this.va=Ka("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new ja(g&&g.concurrentRequestLimit),this.Ba=new Ud,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=dl.prototype,n.ka=8,n.I=1,n.connect=function(g,v,w,V){Ue(0),this.W=g,this.H=v||{},w&&V!==void 0&&(this.H.OSID=w,this.H.OAID=V),this.F=this.X,this.J=Yd(this,null,this.W),Za(this)};function Qa(g){if(Xa(g),g.I==3){var v=g.V++,w=ke(g.J);if(me(w,"SID",g.M),me(w,"RID",v),me(w,"TYPE","terminate"),Ja(g,w),v=new ks(g,g.j,v),v.M=2,v.A=Di(ke(w)),w=!1,l.navigator&&l.navigator.sendBeacon)try{w=l.navigator.sendBeacon(v.A.toString(),"")}catch{}!w&&l.Image&&(new Image().src=v.A,w=!0),w||(v.g=gl(v.j,null),v.g.ea(v.A)),v.F=Date.now(),Pa(v)}Wd(g)}function si(g){g.g&&(au(g),g.g.cancel(),g.g=null)}function Xa(g){si(g),g.v&&(l.clearTimeout(g.v),g.v=null),ml(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&l.clearTimeout(g.m),g.m=null)}function Za(g){if(!Ba(g.h)&&!g.m){g.m=!0;var v=g.Ea;B||I(),z||(B(),z=!0),D.add(v,g),g.D=0}}function lp(g,v){return bs(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=v.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=pr(f(g.Ea,g,v),$d(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const Q=new ks(this,this.j,g);let et=this.o;if(this.U&&(et?(et=st(et),dt(et,this.U)):et=this.U),this.u!==null||this.R||(Q.J=et,et=null),this.S)t:{for(var v=0,w=0;w<this.i.length;w++){e:{var V=this.i[w];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break e}V=void 0}if(V===void 0)break;if(v+=V,v>4096){v=w;break t}if(v===4096||w===this.i.length-1){v=w+1;break t}}v=1e3}else v=1e3;v=fl(this,Q,v),w=ke(this.J),me(w,"RID",g),me(w,"CVER",22),this.G&&me(w,"X-HTTP-Session-Id",this.G),Ja(this,w),et&&(this.R?v="headers="+Va(Ar(et))+"&"+v:this.u&&vs(w,this.u,et)),ol(this.h,Q),this.Ra&&me(w,"TYPE","init"),this.S?(me(w,"$req",v),me(w,"SID","null"),Q.U=!0,Js(Q,w,null)):Js(Q,w,v),this.I=2}}else this.I==3&&(g?Hd(this,g):this.i.length==0||Ba(this.h)||Hd(this))};function Hd(g,v){var w;v?w=v.l:w=g.V++;const V=ke(g.J);me(V,"SID",g.M),me(V,"RID",w),me(V,"AID",g.K),Ja(g,V),g.u&&g.o&&vs(V,g.u,g.o),w=new ks(g,g.j,w,g.D+1),g.u===null&&(w.J=g.o),v&&(g.i=v.G.concat(g.i)),v=fl(g,w,1e3),w.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),ol(g.h,w),Js(w,V,v)}function Ja(g,v){g.H&&Dt(g.H,function(w,V){me(v,V,w)}),g.l&&Dt({},function(w,V){me(v,V,w)})}function fl(g,v,w){w=Math.min(g.i.length,w);const V=g.l?f(g.l.Ka,g.l,g):null;t:{var Q=g.i;let Pt=-1;for(;;){const we=["count="+w];Pt==-1?w>0?(Pt=Q[0].g,we.push("ofs="+Pt)):Pt=0:we.push("ofs="+Pt);let le=!0;for(let qe=0;qe<w;qe++){var et=Q[qe].g;const is=Q[qe].map;if(et-=Pt,et<0)Pt=Math.max(0,Q[qe].g-100),le=!1;else try{et="req"+et+"_"||"";try{var gt=is instanceof Map?is:Object.entries(is);for(const[ii,Ls]of gt){let js=Ls;u(Ls)&&(js=_s(Ls)),we.push(et+ii+"="+encodeURIComponent(js))}}catch(ii){throw we.push(et+"type="+encodeURIComponent("_badmap")),ii}}catch{V&&V(is)}}if(le){gt=we.join("&");break t}}gt=void 0}return g=g.i.splice(0,w),v.G=g,gt}function qd(g){if(!g.g&&!g.v){g.Y=1;var v=g.Da;B||I(),z||(B(),z=!0),D.add(v,g),g.A=0}}function ru(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=pr(f(g.Da,g),$d(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,Gd(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=pr(f(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ue(10),si(this),Gd(this))};function au(g){g.B!=null&&(l.clearTimeout(g.B),g.B=null)}function Gd(g){g.g=new ks(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var v=ke(g.na);me(v,"RID","rpc"),me(v,"SID",g.M),me(v,"AID",g.K),me(v,"CI",g.F?"0":"1"),!g.F&&g.ia&&me(v,"TO",g.ia),me(v,"TYPE","xmlhttp"),Ja(g,v),g.u&&g.o&&vs(v,g.u,g.o),g.O&&(g.g.H=g.O);var w=g.g;g=g.ba,w.M=1,w.A=Di(ke(v)),w.u=null,w.R=!0,br(w,g)}n.Va=function(){this.C!=null&&(this.C=null,si(this),ru(this),Ue(19))};function ml(g){g.C!=null&&(l.clearTimeout(g.C),g.C=null)}function ou(g,v){var w=null;if(g.g==v){ml(g),au(g),g.g=null;var V=2}else if(Fa(g.h,v))w=v.G,Ri(g.h,v),V=1;else return;if(g.I!=0){if(v.o)if(V==1){w=v.u?v.u.length:0,v=Date.now()-v.F;var Q=g.D;V=sl(),hn(V,new Vd(V,w)),Za(g)}else qd(g);else if(Q=v.m,Q==3||Q==0&&v.X>0||!(V==1&&lp(g,v)||V==2&&ru(g)))switch(w&&w.length>0&&(v=g.h,v.i=v.i.concat(w)),Q){case 1:Mi(g,5);break;case 4:Mi(g,10);break;case 3:Mi(g,6);break;default:Mi(g,2)}}}function $d(g,v){let w=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(w*=2),w*v}function Mi(g,v){if(g.j.info("Error code "+v),v==2){var w=f(g.bb,g),V=g.Ua;const Q=!V;V=new Vs(V||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||vr(V,"https"),Di(V),Q?su(V.toString(),w):wr(V.toString(),w)}else Ue(2);g.I=0,g.l&&g.l.pa(v),Wd(g),Xa(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),Ue(2)):(this.j.info("Failed to ping google.com"),Ue(1))};function Wd(g){if(g.I=0,g.ja=[],g.l){const v=ll(g.h);(v.length!=0||g.i.length!=0)&&(S(g.ja,v),S(g.ja,g.i),g.h.i.length=0,E(g.i),g.i.length=0),g.l.oa()}}function Yd(g,v,w){var V=w instanceof Vs?ke(w):new Vs(w);if(V.g!="")v&&(V.g=v+"."+V.g),Ua(V,V.u);else{var Q=l.location;V=Q.protocol,v=v?v+"."+Q.hostname:Q.hostname,Q=+Q.port;const et=new Vs(null);V&&vr(et,V),v&&(et.g=v),Q&&Ua(et,Q),w&&(et.h=w),V=et}return w=g.G,v=g.wa,w&&v&&me(V,w,v),me(V,"VER",g.ka),Ja(g,V),V}function gl(g,v,w){if(v&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=g.Aa&&!g.ma?new be(new Ha({ab:w})):new be(g.ma),v.Fa(g.L),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Kd(){}n=Kd.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function pl(){}pl.prototype.g=function(g,v){return new Hn(g,v)};function Hn(g,v){nn.call(this),this.g=new dl(v),this.l=g,this.h=v&&v.messageUrlParams||null,g=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(g?g["X-WebChannel-Content-Type"]=v.messageContentType:g={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(g?g["X-WebChannel-Client-Profile"]=v.sa:g={"X-WebChannel-Client-Profile":v.sa}),this.g.U=g,(g=v&&v.Qb)&&!k(g)&&(this.g.u=g),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!k(v)&&(this.g.G=v,g=this.h,g!==null&&v in g&&(g=this.h,v in g&&delete g[v])),this.j=new Ir(this)}_(Hn,nn),Hn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Hn.prototype.close=function(){Qa(this.g)},Hn.prototype.o=function(g){var v=this.g;if(typeof g=="string"){var w={};w.__data__=g,g=w}else this.v&&(w={},w.__data__=_s(g),g=w);v.i.push(new ap(v.Ya++,g)),v.I==3&&Za(v)},Hn.prototype.N=function(){this.g.l=null,delete this.j,Qa(this.g),delete this.g,Hn.Z.N.call(this)};function lu(g){fr.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var v=g.__sm__;if(v){t:{for(const w in v){g=w;break t}g=void 0}(this.i=g)&&(g=this.i,v=v!==null&&g in v?v[g]:void 0),this.data=v}else this.data=g}_(lu,fr);function Qd(){Os.call(this),this.status=1}_(Qd,Os);function Ir(g){this.g=g}_(Ir,Kd),Ir.prototype.ra=function(){hn(this.g,"a")},Ir.prototype.qa=function(g){hn(this.g,new lu(g))},Ir.prototype.pa=function(g){hn(this.g,new Qd)},Ir.prototype.oa=function(){hn(this.g,"b")},pl.prototype.createWebChannel=pl.prototype.g,Hn.prototype.send=Hn.prototype.o,Hn.prototype.open=Hn.prototype.m,Hn.prototype.close=Hn.prototype.close,O2=function(){return new pl},M2=function(){return sl()},C2=ys,Fy={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ze.NO_ERROR=0,ze.TIMEOUT=8,ze.HTTP_ERROR=6,bm=ze,bn.COMPLETE="complete",N2=bn,kd.EventType=Qs,Qs.OPEN="a",Qs.CLOSE="b",Qs.ERROR="c",Qs.MESSAGE="d",nn.prototype.listen=nn.prototype.J,uh=kd,be.prototype.listenOnce=be.prototype.K,be.prototype.getLastError=be.prototype.Ha,be.prototype.getLastErrorCode=be.prototype.ya,be.prototype.getStatus=be.prototype.ca,be.prototype.getResponseJson=be.prototype.La,be.prototype.getResponseText=be.prototype.la,be.prototype.send=be.prototype.ea,be.prototype.setWithCredentials=be.prototype.Fa,D2=be}).apply(typeof Zf<"u"?Zf:typeof self<"u"?self:typeof window<"u"?window:{});const iw="@firebase/firestore",rw="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}_n.UNAUTHENTICATED=new _n(null),_n.GOOGLE_CREDENTIALS=new _n("google-credentials-uid"),_n.FIRST_PARTY=new _n("first-party-uid"),_n.MOCK_USER=new _n("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jc="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ga=new H0("@firebase/firestore");function Jl(){return ga.logLevel}function XO(n){ga.setLogLevel(n)}function ct(n,...t){if(ga.logLevel<=Xt.DEBUG){const e=t.map(K0);ga.debug(`Firestore (${jc}): ${n}`,...e)}}function We(n,...t){if(ga.logLevel<=Xt.ERROR){const e=t.map(K0);ga.error(`Firestore (${jc}): ${n}`,...e)}}function vi(n,...t){if(ga.logLevel<=Xt.WARN){const e=t.map(K0);ga.warn(`Firestore (${jc}): ${n}`,...e)}}function K0(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(e){return JSON.stringify(e)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(n,t,e){let s="Unexpected state";typeof t=="string"?s=t:e=t,k2(n,s,e)}function k2(n,t,e){let s=`FIRESTORE (${jc}) INTERNAL ASSERTION FAILED: ${t} (ID: ${n.toString(16)})`;if(e!==void 0)try{s+=" CONTEXT: "+JSON.stringify(e)}catch{s+=" CONTEXT: "+e}throw We(s),new Error(s)}function wt(n,t,e,s){let i="Unexpected state";typeof e=="string"?i=e:s=e,n||k2(t,i,s)}function ZO(n,t){n||vt(57014,t)}function xt(n,t){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class lt extends Zo{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V2{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class JO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(_n.UNAUTHENTICATED)))}shutdown(){}}class tk{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class ek{constructor(t){this.t=t,this.currentUser=_n.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){wt(this.o===void 0,42304);let s=this.i;const i=h=>this.i!==s?(s=this.i,e(h)):Promise.resolve();let a=new An;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new An,t.enqueueRetryable((()=>i(this.currentUser)))};const l=()=>{const h=a;t.enqueueRetryable((async()=>{await h.promise,await i(this.currentUser)}))},u=h=>{ct("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((h=>u(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(ct("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new An)}}),0),l()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((s=>this.i!==t?(ct("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(wt(typeof s.accessToken=="string",31837,{l:s}),new V2(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return wt(t===null||typeof t=="string",2055,{h:t}),new _n(t)}}class nk{constructor(t,e,s){this.P=t,this.T=e,this.I=s,this.type="FirstParty",this.user=_n.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class sk{constructor(t,e,s){this.P=t,this.T=e,this.I=s}getToken(){return Promise.resolve(new nk(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(_n.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class aw{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ik{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,v2(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){wt(this.o===void 0,3512);const s=a=>{a.error!=null&&ct("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,ct("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?e(a.token):Promise.resolve()};this.o=a=>{t.enqueueRetryable((()=>s(a)))};const i=a=>{ct("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):ct("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new aw(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(wt(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new aw(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rk(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let s=0;s<n;s++)e[s]=Math.floor(256*Math.random());return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const i=rk(40);for(let a=0;a<i.length;++a)s.length<20&&i[a]<e&&(s+=t.charAt(i[a]%62))}return s}}function Vt(n,t){return n<t?-1:n>t?1:0}function Uy(n,t){const e=Math.min(n.length,t.length);for(let s=0;s<e;s++){const i=n.charAt(s),a=t.charAt(s);if(i!==a)return uy(i)===uy(a)?Vt(i,a):uy(i)?1:-1}return Vt(n.length,t.length)}const ak=55296,ok=57343;function uy(n){const t=n.charCodeAt(0);return t>=ak&&t<=ok}function dc(n,t,e){return n.length===t.length&&n.every(((s,i)=>e(s,t[i])))}function P2(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ow="__name__";class di{constructor(t,e,s){e===void 0?e=0:e>t.length&&vt(637,{offset:e,range:t.length}),s===void 0?s=t.length-e:s>t.length-e&&vt(1746,{length:s,range:t.length-e}),this.segments=t,this.offset=e,this.len=s}get length(){return this.len}isEqual(t){return di.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof di?t.forEach((s=>{e.push(s)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,s=this.limit();e<s;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const s=Math.min(t.length,e.length);for(let i=0;i<s;i++){const a=di.compareSegments(t.get(i),e.get(i));if(a!==0)return a}return Vt(t.length,e.length)}static compareSegments(t,e){const s=di.isNumericId(t),i=di.isNumericId(e);return s&&!i?-1:!s&&i?1:s&&i?di.extractNumericId(t).compare(di.extractNumericId(e)):Uy(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return la.fromString(t.substring(4,t.length-2))}}class Wt extends di{construct(t,e,s){return new Wt(t,e,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const s of t){if(s.indexOf("//")>=0)throw new lt(tt.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);e.push(...s.split("/").filter((i=>i.length>0)))}return new Wt(e)}static emptyPath(){return new Wt([])}}const lk=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ne extends di{construct(t,e,s){return new Ne(t,e,s)}static isValidIdentifier(t){return lk.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ne.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ow}static keyField(){return new Ne([ow])}static fromServerFormat(t){const e=[];let s="",i=0;const a=()=>{if(s.length===0)throw new lt(tt.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(s),s=""};let l=!1;for(;i<t.length;){const u=t[i];if(u==="\\"){if(i+1===t.length)throw new lt(tt.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const h=t[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new lt(tt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);s+=h,i+=2}else u==="`"?(l=!l,i++):u!=="."||l?(s+=u,i++):(a(),i++)}if(a(),l)throw new lt(tt.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ne(e)}static emptyPath(){return new Ne([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(t){this.path=t}static fromPath(t){return new pt(Wt.fromString(t))}static fromName(t){return new pt(Wt.fromString(t).popFirst(5))}static empty(){return new pt(Wt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Wt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return Wt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new pt(new Wt(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X0(n,t,e){if(!e)throw new lt(tt.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function L2(n,t,e,s){if(t===!0&&s===!0)throw new lt(tt.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function lw(n){if(!pt.isDocumentKey(n))throw new lt(tt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function cw(n){if(pt.isDocumentKey(n))throw new lt(tt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function j2(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function vg(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=(function(s){return s.constructor?s.constructor.name:null})(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":vt(12329,{type:typeof n})}function re(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new lt(tt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=vg(n);throw new lt(tt.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}function B2(n,t){if(t<=0)throw new lt(tt.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${t}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tn(n,t){const e={typeString:n};return t&&(e.value=t),e}function fd(n,t){if(!j2(n))throw new lt(tt.INVALID_ARGUMENT,"JSON must be an object");let e;for(const s in t)if(t[s]){const i=t[s].typeString,a="value"in t[s]?{value:t[s].value}:void 0;if(!(s in n)){e=`JSON missing required field: '${s}'`;break}const l=n[s];if(i&&typeof l!==i){e=`JSON field '${s}' must be a ${i}.`;break}if(a!==void 0&&l!==a.value){e=`Expected '${s}' field to equal '${a.value}'`;break}}if(e)throw new lt(tt.INVALID_ARGUMENT,e);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uw=-62135596800,hw=1e6;class oe{static now(){return oe.fromMillis(Date.now())}static fromDate(t){return oe.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),s=Math.floor((t-1e3*e)*hw);return new oe(e,s)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new lt(tt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new lt(tt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<uw)throw new lt(tt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new lt(tt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/hw}_compareTo(t){return this.seconds===t.seconds?Vt(this.nanoseconds,t.nanoseconds):Vt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:oe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(fd(t,oe._jsonSchema))return new oe(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-uw;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}oe._jsonSchemaVersion="firestore/timestamp/1.0",oe._jsonSchema={type:tn("string",oe._jsonSchemaVersion),seconds:tn("number"),nanoseconds:tn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{static fromTimestamp(t){return new Rt(t)}static min(){return new Rt(new oe(0,0))}static max(){return new Rt(new oe(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fc=-1;class Hm{constructor(t,e,s,i){this.indexId=t,this.collectionGroup=e,this.fields=s,this.indexState=i}}function zy(n){return n.fields.find((t=>t.kind===2))}function Eo(n){return n.fields.filter((t=>t.kind!==2))}Hm.UNKNOWN_ID=-1;class xm{constructor(t,e){this.fieldPath=t,this.kind=e}}class Fh{constructor(t,e){this.sequenceNumber=t,this.offset=e}static empty(){return new Fh(0,gs.min())}}function F2(n,t){const e=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,i=Rt.fromTimestamp(s===1e9?new oe(e+1,0):new oe(e,s));return new gs(i,pt.empty(),t)}function U2(n){return new gs(n.readTime,n.key,fc)}class gs{constructor(t,e,s){this.readTime=t,this.documentKey=e,this.largestBatchId=s}static min(){return new gs(Rt.min(),pt.empty(),fc)}static max(){return new gs(Rt.max(),pt.empty(),fc)}}function Z0(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=pt.comparator(n.documentKey,t.documentKey),e!==0?e:Vt(n.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class H2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ia(n){if(n.code!==tt.FAILED_PRECONDITION||n.message!==z2)throw n;ct("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&vt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new W(((s,i)=>{this.nextCallback=a=>{this.wrapSuccess(t,a).next(s,i)},this.catchCallback=a=>{this.wrapFailure(e,a).next(s,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof W?e:W.resolve(e)}catch(e){return W.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):W.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):W.reject(e)}static resolve(t){return new W(((e,s)=>{e(t)}))}static reject(t){return new W(((e,s)=>{s(t)}))}static waitFor(t){return new W(((e,s)=>{let i=0,a=0,l=!1;t.forEach((u=>{++i,u.next((()=>{++a,l&&a===i&&e()}),(h=>s(h)))})),l=!0,a===i&&e()}))}static or(t){let e=W.resolve(!1);for(const s of t)e=e.next((i=>i?W.resolve(i):s()));return e}static forEach(t,e){const s=[];return t.forEach(((i,a)=>{s.push(e.call(this,i,a))})),this.waitFor(s)}static mapArray(t,e){return new W(((s,i)=>{const a=t.length,l=new Array(a);let u=0;for(let h=0;h<a;h++){const f=h;e(t[f]).next((m=>{l[f]=m,++u,u===a&&s(l)}),(m=>i(m)))}}))}static doWhile(t,e){return new W(((s,i)=>{const a=()=>{t()===!0?e().next((()=>{a()}),i):s()};a()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fs="SimpleDb";class Eg{static open(t,e,s,i){try{return new Eg(e,t.transaction(i,s))}catch(a){throw new wh(e,a)}}constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.S=new An,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{e.error?this.S.reject(new wh(t,e.error)):this.S.resolve()},this.transaction.onerror=s=>{const i=J0(s.target.error);this.S.reject(new wh(t,i))}}get D(){return this.S.promise}abort(t){t&&this.S.reject(t),this.aborted||(ct(fs,"Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const t=this.transaction;this.aborted||typeof t.commit!="function"||t.commit()}store(t){const e=this.transaction.objectStore(t);return new uk(e)}}class pi{static delete(t){return ct(fs,"Removing database:",t),Ao(B0().indexedDB.deleteDatabase(t)).toPromise()}static v(){if(!f2())return!1;if(pi.F())return!0;const t=Um(),e=pi.M(t),s=0<e&&e<10,i=q2(t),a=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||s||a)}static F(){var t;return typeof process<"u"&&((t=process.__PRIVATE_env)==null?void 0:t.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(t,e){return t.store(e)}static M(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(s)}constructor(t,e,s){this.name=t,this.version=e,this.N=s,this.B=null,pi.M(Um())===12.2&&We("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(t){return this.db||(ct(fs,"Opening database:",this.name),this.db=await new Promise(((e,s)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=a=>{const l=a.target.result;e(l)},i.onblocked=()=>{s(new wh(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=a=>{const l=a.target.error;l.name==="VersionError"?s(new lt(tt.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?s(new lt(tt.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):s(new wh(t,l))},i.onupgradeneeded=a=>{ct(fs,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const l=a.target.result;this.N.k(l,i.transaction,a.oldVersion,this.version).next((()=>{ct(fs,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=e=>this.q(e)),this.db}$(t){this.q=t,this.db&&(this.db.onversionchange=e=>t(e))}async runTransaction(t,e,s,i){const a=e==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(t);const u=Eg.open(this.db,t,a?"readonly":"readwrite",s),h=i(u).next((f=>(u.C(),f))).catch((f=>(u.abort(f),W.reject(f)))).toPromise();return h.catch((()=>{})),await u.D,h}catch(u){const h=u,f=h.name!=="FirebaseError"&&l<3;if(ct(fs,"Transaction failed with error:",h.message,"Retrying:",f),this.close(),!f)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}function q2(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}class ck{constructor(t){this.U=t,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(t){this.U=t}done(){this.K=!0}j(t){this.W=t}delete(){return Ao(this.U.delete())}}class wh extends lt{constructor(t,e){super(tt.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function Ra(n){return n.name==="IndexedDbTransactionError"}class uk{constructor(t){this.store=t}put(t,e){let s;return e!==void 0?(ct(fs,"PUT",this.store.name,t,e),s=this.store.put(e,t)):(ct(fs,"PUT",this.store.name,"<auto-key>",t),s=this.store.put(t)),Ao(s)}add(t){return ct(fs,"ADD",this.store.name,t,t),Ao(this.store.add(t))}get(t){return Ao(this.store.get(t)).next((e=>(e===void 0&&(e=null),ct(fs,"GET",this.store.name,t,e),e)))}delete(t){return ct(fs,"DELETE",this.store.name,t),Ao(this.store.delete(t))}count(){return ct(fs,"COUNT",this.store.name),Ao(this.store.count())}J(t,e){const s=this.options(t,e),i=s.index?this.store.index(s.index):this.store;if(typeof i.getAll=="function"){const a=i.getAll(s.range);return new W(((l,u)=>{a.onerror=h=>{u(h.target.error)},a.onsuccess=h=>{l(h.target.result)}}))}{const a=this.cursor(s),l=[];return this.H(a,((u,h)=>{l.push(h)})).next((()=>l))}}Y(t,e){const s=this.store.getAll(t,e===null?void 0:e);return new W(((i,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{i(l.target.result)}}))}Z(t,e){ct(fs,"DELETE ALL",this.store.name);const s=this.options(t,e);s.X=!1;const i=this.cursor(s);return this.H(i,((a,l,u)=>u.delete()))}ee(t,e){let s;e?s=t:(s={},e=t);const i=this.cursor(s);return this.H(i,e)}te(t){const e=this.cursor({});return new W(((s,i)=>{e.onerror=a=>{const l=J0(a.target.error);i(l)},e.onsuccess=a=>{const l=a.target.result;l?t(l.primaryKey,l.value).next((u=>{u?l.continue():s()})):s()}}))}H(t,e){const s=[];return new W(((i,a)=>{t.onerror=l=>{a(l.target.error)},t.onsuccess=l=>{const u=l.target.result;if(!u)return void i();const h=new ck(u),f=e(u.primaryKey,u.value,h);if(f instanceof W){const m=f.catch((_=>(h.done(),W.reject(_))));s.push(m)}h.isDone?i():h.G===null?u.continue():u.continue(h.G)}})).next((()=>W.waitFor(s)))}options(t,e){let s;return t!==void 0&&(typeof t=="string"?s=t:e=t),{index:s,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const s=this.store.index(t.index);return t.X?s.openKeyCursor(t.range,e):s.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function Ao(n){return new W(((t,e)=>{n.onsuccess=s=>{const i=s.target.result;t(i)},n.onerror=s=>{const i=J0(s.target.error);e(i)}}))}let dw=!1;function J0(n){const t=pi.M(Um());if(t>=12.2&&t<13){const e="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(e)>=0){const s=new lt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return dw||(dw=!0,setTimeout((()=>{throw s}),0)),s}}return n}const Sh="IndexBackfiller";class hk{constructor(t,e){this.asyncQueue=t,this.ne=e,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(t){ct(Sh,`Scheduled in ${t}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",t,(async()=>{this.task=null;try{const e=await this.ne.ie();ct(Sh,`Documents written: ${e}`)}catch(e){Ra(e)?ct(Sh,"Ignoring IndexedDB error during index backfill: ",e):await Ia(e)}await this.re(6e4)}))}}class dk{constructor(t,e){this.localStore=t,this.persistence=e}async ie(t=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(e=>this.se(e,t)))}se(t,e){const s=new Set;let i=e,a=!0;return W.doWhile((()=>a===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(t).next((l=>{if(l!==null&&!s.has(l))return ct(Sh,`Processing collection: ${l}`),this.oe(t,l,i).next((u=>{i-=u,s.add(l)}));a=!1})))).next((()=>e-i))}oe(t,e,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(t,e).next((i=>this.localStore.localDocuments.getNextDocuments(t,e,i,s).next((a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(t,l).next((()=>this._e(i,a))).next((u=>(ct(Sh,`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(t,e,u)))).next((()=>l.size))}))))}_e(t,e){let s=t;return e.changes.forEach(((i,a)=>{const l=U2(a);Z0(l,s)>0&&(s=l)})),new gs(s.readTime,s.documentKey,Math.max(e.batchId,t.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>e.writeSequenceNumber(s))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}es.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ca=-1;function md(n){return n==null}function Uh(n){return n===0&&1/n==-1/0}function G2(n){return typeof n=="number"&&Number.isInteger(n)&&!Uh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qm="";function Ln(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=fw(t)),t=fk(n.get(e),t);return fw(t)}function fk(n,t){let e=t;const s=n.length;for(let i=0;i<s;i++){const a=n.charAt(i);switch(a){case"\0":e+="";break;case qm:e+="";break;default:e+=a}}return e}function fw(n){return n+qm+""}function mi(n){const t=n.length;if(wt(t>=2,64408,{path:n}),t===2)return wt(n.charAt(0)===qm&&n.charAt(1)==="",56145,{path:n}),Wt.emptyPath();const e=t-2,s=[];let i="";for(let a=0;a<t;){const l=n.indexOf(qm,a);switch((l<0||l>e)&&vt(50515,{path:n}),n.charAt(l+1)){case"":const u=n.substring(a,l);let h;i.length===0?h=u:(i+=u,h=i,i=""),s.push(h);break;case"":i+=n.substring(a,l),i+="\0";break;case"":i+=n.substring(a,l+1);break;default:vt(61167,{path:n})}a=l+2}return new Wt(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const To="remoteDocuments",gd="owner",Gl="owner",zh="mutationQueues",mk="userId",Hs="mutations",mw="batchId",Co="userMutationsIndex",gw=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vm(n,t){return[n,Ln(t)]}function $2(n,t,e){return[n,Ln(t),e]}const gk={},mc="documentMutations",Gm="remoteDocumentsV14",pk=["prefixPath","collectionGroup","readTime","documentId"],Em="documentKeyIndex",_k=["prefixPath","collectionGroup","documentId"],W2="collectionGroupIndex",yk=["collectionGroup","readTime","prefixPath","documentId"],Hh="remoteDocumentGlobal",Hy="remoteDocumentGlobalKey",gc="targets",Y2="queryTargetsIndex",bk=["canonicalId","targetId"],pc="targetDocuments",xk=["targetId","path"],tb="documentTargetsIndex",vk=["path","targetId"],$m="targetGlobalKey",Po="targetGlobal",qh="collectionParents",Ek=["collectionId","parent"],_c="clientMetadata",Tk="clientId",Tg="bundles",wk="bundleId",wg="namedQueries",Sk="name",eb="indexConfiguration",Ak="indexId",qy="collectionGroupIndex",Ik="collectionGroup",Ah="indexState",Rk=["indexId","uid"],K2="sequenceNumberIndex",Dk=["uid","sequenceNumber"],Ih="indexEntries",Nk=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Q2="documentKeyIndex",Ck=["indexId","uid","orderedDocumentKey"],Sg="documentOverlays",Mk=["userId","collectionPath","documentId"],Gy="collectionPathOverlayIndex",Ok=["userId","collectionPath","largestBatchId"],X2="collectionGroupOverlayIndex",kk=["userId","collectionGroup","largestBatchId"],nb="globals",Vk="name",Z2=[zh,Hs,mc,To,gc,gd,Po,pc,_c,Hh,qh,Tg,wg],Pk=[...Z2,Sg],J2=[zh,Hs,mc,Gm,gc,gd,Po,pc,_c,Hh,qh,Tg,wg,Sg],tI=J2,sb=[...tI,eb,Ah,Ih],Lk=sb,eI=[...sb,nb],jk=eI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y extends H2{constructor(t,e){super(),this.le=t,this.currentSequenceNumber=e}}function un(n,t){const e=xt(n);return pi.O(e.le,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pw(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function Da(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function nI(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(t,e){this.comparator=t,this.root=e||Tn.EMPTY}insert(t,e){return new Te(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Tn.BLACK,null,null))}remove(t){return new Te(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Tn.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const s=this.comparator(t,e.key);if(s===0)return e.value;s<0?e=e.left:s>0&&(e=e.right)}return null}indexOf(t){let e=0,s=this.root;for(;!s.isEmpty();){const i=this.comparator(t,s.key);if(i===0)return e+s.left.size;i<0?s=s.left:(e+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,s)=>(t(e,s),!1)))}toString(){const t=[];return this.inorderTraversal(((e,s)=>(t.push(`${e}:${s}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Jf(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Jf(this.root,t,this.comparator,!1)}getReverseIterator(){return new Jf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Jf(this.root,t,this.comparator,!0)}}class Jf{constructor(t,e,s,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!t.isEmpty();)if(a=e?s(t.key,e):1,e&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(a===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Tn{constructor(t,e,s,i,a){this.key=t,this.value=e,this.color=s??Tn.RED,this.left=i??Tn.EMPTY,this.right=a??Tn.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,s,i,a){return new Tn(t??this.key,e??this.value,s??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,s){let i=this;const a=s(t,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(t,e,s),null):a===0?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,s)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Tn.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let s,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),e(t,i.key)===0){if(i.right.isEmpty())return Tn.EMPTY;s=i.right.min(),i=i.copy(s.key,s.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Tn.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Tn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw vt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw vt(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw vt(27949);return t+(this.isRed()?0:1)}}Tn.EMPTY=null,Tn.RED=!0,Tn.BLACK=!1;Tn.EMPTY=new class{constructor(){this.size=0}get key(){throw vt(57766)}get value(){throw vt(16141)}get color(){throw vt(16727)}get left(){throw vt(29726)}get right(){throw vt(36894)}copy(t,e,s,i,a){return this}insert(t,e,s){return new Tn(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(t){this.comparator=t,this.data=new Te(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,s)=>(t(e),!1)))}forEachInRange(t,e){const s=this.data.getIteratorFrom(t[0]);for(;s.hasNext();){const i=s.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let s;for(s=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();s.hasNext();)if(!t(s.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new _w(this.data.getIterator())}getIteratorFrom(t){return new _w(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((s=>{e=e.add(s)})),e}isEqual(t){if(!(t instanceof fe)||this.size!==t.size)return!1;const e=this.data.getIterator(),s=t.data.getIterator();for(;e.hasNext();){const i=e.getNext().key,a=s.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new fe(this.comparator);return e.data=t,e}}class _w{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function $l(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(t){this.fields=t,t.sort(Ne.comparator)}static empty(){return new ns([])}unionWith(t){let e=new fe(Ne.comparator);for(const s of this.fields)e=e.add(s);for(const s of t)e=e.add(s);return new ns(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return dc(this.fields,t.fields,((e,s)=>e.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bk(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new sI("Invalid base64 string: "+a):a}})(t);return new Be(e)}static fromUint8Array(t){const e=(function(i){let a="";for(let l=0;l<i.length;++l)a+=String.fromCharCode(i[l]);return a})(t);return new Be(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const s=new Uint8Array(e.length);for(let i=0;i<e.length;i++)s[i]=e.charCodeAt(i);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Vt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Be.EMPTY_BYTE_STRING=new Be("");const Fk=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function nr(n){if(wt(!!n,39018),typeof n=="string"){let t=0;const e=Fk.exec(n);if(wt(!!e,46558,{timestamp:n}),e[1]){let i=e[1];i=(i+"000000000").substr(0,9),t=Number(i)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:t}}return{seconds:De(n.seconds),nanos:De(n.nanos)}}function De(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function sr(n){return typeof n=="string"?Be.fromBase64String(n):Be.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI="server_timestamp",rI="__type__",aI="__previous_value__",oI="__local_write_time__";function Ag(n){var e,s;return((s=(((e=n==null?void 0:n.mapValue)==null?void 0:e.fields)||{})[rI])==null?void 0:s.stringValue)===iI}function Ig(n){const t=n.mapValue.fields[aI];return Ag(t)?Ig(t):t}function Gh(n){const t=nr(n.mapValue.fields[oI].timestampValue);return new oe(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{constructor(t,e,s,i,a,l,u,h,f,m){this.databaseId=t,this.appId=e,this.persistenceKey=s,this.host=i,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=f,this.isUsingEmulator=m}}const Wy="(default)";class pa{constructor(t,e){this.projectId=t,this.database=e||Wy}static empty(){return new pa("","")}get isDefaultDatabase(){return this.database===Wy}isEqual(t){return t instanceof pa&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ib="__type__",lI="__max__",ea={mapValue:{fields:{__type__:{stringValue:lI}}}},rb="__vector__",yc="value",Tm={nullValue:"NULL_VALUE"};function _a(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ag(n)?4:cI(n)?9007199254740991:Rg(n)?10:11:vt(28295,{value:n})}function Ei(n,t){if(n===t)return!0;const e=_a(n);if(e!==_a(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Gh(n).isEqual(Gh(t));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const l=nr(i.timestampValue),u=nr(a.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos})(n,t);case 5:return n.stringValue===t.stringValue;case 6:return(function(i,a){return sr(i.bytesValue).isEqual(sr(a.bytesValue))})(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return(function(i,a){return De(i.geoPointValue.latitude)===De(a.geoPointValue.latitude)&&De(i.geoPointValue.longitude)===De(a.geoPointValue.longitude)})(n,t);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return De(i.integerValue)===De(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const l=De(i.doubleValue),u=De(a.doubleValue);return l===u?Uh(l)===Uh(u):isNaN(l)&&isNaN(u)}return!1})(n,t);case 9:return dc(n.arrayValue.values||[],t.arrayValue.values||[],Ei);case 10:case 11:return(function(i,a){const l=i.mapValue.fields||{},u=a.mapValue.fields||{};if(pw(l)!==pw(u))return!1;for(const h in l)if(l.hasOwnProperty(h)&&(u[h]===void 0||!Ei(l[h],u[h])))return!1;return!0})(n,t);default:return vt(52216,{left:n})}}function $h(n,t){return(n.values||[]).find((e=>Ei(e,t)))!==void 0}function ya(n,t){if(n===t)return 0;const e=_a(n),s=_a(t);if(e!==s)return Vt(e,s);switch(e){case 0:case 9007199254740991:return 0;case 1:return Vt(n.booleanValue,t.booleanValue);case 2:return(function(a,l){const u=De(a.integerValue||a.doubleValue),h=De(l.integerValue||l.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1})(n,t);case 3:return yw(n.timestampValue,t.timestampValue);case 4:return yw(Gh(n),Gh(t));case 5:return Uy(n.stringValue,t.stringValue);case 6:return(function(a,l){const u=sr(a),h=sr(l);return u.compareTo(h)})(n.bytesValue,t.bytesValue);case 7:return(function(a,l){const u=a.split("/"),h=l.split("/");for(let f=0;f<u.length&&f<h.length;f++){const m=Vt(u[f],h[f]);if(m!==0)return m}return Vt(u.length,h.length)})(n.referenceValue,t.referenceValue);case 8:return(function(a,l){const u=Vt(De(a.latitude),De(l.latitude));return u!==0?u:Vt(De(a.longitude),De(l.longitude))})(n.geoPointValue,t.geoPointValue);case 9:return bw(n.arrayValue,t.arrayValue);case 10:return(function(a,l){var x,E,S,T;const u=a.fields||{},h=l.fields||{},f=(x=u[yc])==null?void 0:x.arrayValue,m=(E=h[yc])==null?void 0:E.arrayValue,_=Vt(((S=f==null?void 0:f.values)==null?void 0:S.length)||0,((T=m==null?void 0:m.values)==null?void 0:T.length)||0);return _!==0?_:bw(f,m)})(n.mapValue,t.mapValue);case 11:return(function(a,l){if(a===ea.mapValue&&l===ea.mapValue)return 0;if(a===ea.mapValue)return 1;if(l===ea.mapValue)return-1;const u=a.fields||{},h=Object.keys(u),f=l.fields||{},m=Object.keys(f);h.sort(),m.sort();for(let _=0;_<h.length&&_<m.length;++_){const x=Uy(h[_],m[_]);if(x!==0)return x;const E=ya(u[h[_]],f[m[_]]);if(E!==0)return E}return Vt(h.length,m.length)})(n.mapValue,t.mapValue);default:throw vt(23264,{he:e})}}function yw(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return Vt(n,t);const e=nr(n),s=nr(t),i=Vt(e.seconds,s.seconds);return i!==0?i:Vt(e.nanos,s.nanos)}function bw(n,t){const e=n.values||[],s=t.values||[];for(let i=0;i<e.length&&i<s.length;++i){const a=ya(e[i],s[i]);if(a)return a}return Vt(e.length,s.length)}function bc(n){return Yy(n)}function Yy(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(e){const s=nr(e);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(e){return sr(e).toBase64()})(n.bytesValue):"referenceValue"in n?(function(e){return pt.fromName(e).toString()})(n.referenceValue):"geoPointValue"in n?(function(e){return`geo(${e.latitude},${e.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(e){let s="[",i=!0;for(const a of e.values||[])i?i=!1:s+=",",s+=Yy(a);return s+"]"})(n.arrayValue):"mapValue"in n?(function(e){const s=Object.keys(e.fields||{}).sort();let i="{",a=!0;for(const l of s)a?a=!1:i+=",",i+=`${l}:${Yy(e.fields[l])}`;return i+"}"})(n.mapValue):vt(61005,{value:n})}function wm(n){switch(_a(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Ig(n);return t?16+wm(t):16;case 5:return 2*n.stringValue.length;case 6:return sr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((i,a)=>i+wm(a)),0)})(n.arrayValue);case 10:case 11:return(function(s){let i=0;return Da(s.fields,((a,l)=>{i+=a.length+wm(l)})),i})(n.mapValue);default:throw vt(13486,{value:n})}}function Fo(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function Ky(n){return!!n&&"integerValue"in n}function Wh(n){return!!n&&"arrayValue"in n}function xw(n){return!!n&&"nullValue"in n}function vw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Sm(n){return!!n&&"mapValue"in n}function Rg(n){var e,s;return((s=(((e=n==null?void 0:n.mapValue)==null?void 0:e.fields)||{})[ib])==null?void 0:s.stringValue)===rb}function Rh(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const t={mapValue:{fields:{}}};return Da(n.mapValue.fields,((e,s)=>t.mapValue.fields[e]=Rh(s))),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Rh(n.arrayValue.values[e]);return t}return{...n}}function cI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===lI}const uI={mapValue:{fields:{[ib]:{stringValue:rb},[yc]:{arrayValue:{}}}}};function zk(n){return"nullValue"in n?Tm:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Fo(pa.empty(),pt.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Rg(n)?uI:{mapValue:{}}:vt(35942,{value:n})}function Hk(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Fo(pa.empty(),pt.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?uI:"mapValue"in n?Rg(n)?{mapValue:{}}:ea:vt(61959,{value:n})}function Ew(n,t){const e=ya(n.value,t.value);return e!==0?e:n.inclusive&&!t.inclusive?-1:!n.inclusive&&t.inclusive?1:0}function Tw(n,t){const e=ya(n.value,t.value);return e!==0?e:n.inclusive&&!t.inclusive?1:!n.inclusive&&t.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(t){this.value=t}static empty(){return new Sn({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let s=0;s<t.length-1;++s)if(e=(e.mapValue.fields||{})[t.get(s)],!Sm(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Rh(e)}setAll(t){let e=Ne.emptyPath(),s={},i=[];t.forEach(((l,u)=>{if(!e.isImmediateParentOf(u)){const h=this.getFieldsMap(e);this.applyChanges(h,s,i),s={},i=[],e=u.popLast()}l?s[u.lastSegment()]=Rh(l):i.push(u.lastSegment())}));const a=this.getFieldsMap(e);this.applyChanges(a,s,i)}delete(t){const e=this.field(t.popLast());Sm(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Ei(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let s=0;s<t.length;++s){let i=e.mapValue.fields[t.get(s)];Sm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(s)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,s){Da(e,((i,a)=>t[i]=a));for(const i of s)delete t[i]}clone(){return new Sn(Rh(this.value))}}function hI(n){const t=[];return Da(n.fields,((e,s)=>{const i=new Ne([e]);if(Sm(s)){const a=hI(s.mapValue).fields;if(a.length===0)t.push(i);else for(const l of a)t.push(i.child(l))}else t.push(i)})),new ns(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(t,e,s,i,a,l,u){this.key=t,this.documentType=e,this.version=s,this.readTime=i,this.createTime=a,this.data=l,this.documentState=u}static newInvalidDocument(t){return new Se(t,0,Rt.min(),Rt.min(),Rt.min(),Sn.empty(),0)}static newFoundDocument(t,e,s,i){return new Se(t,1,e,Rt.min(),s,i,0)}static newNoDocument(t,e){return new Se(t,2,e,Rt.min(),Rt.min(),Sn.empty(),0)}static newUnknownDocument(t,e){return new Se(t,3,e,Rt.min(),Rt.min(),Sn.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Rt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Sn.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Sn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Rt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Se&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Se(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(t,e){this.position=t,this.inclusive=e}}function ww(n,t,e){let s=0;for(let i=0;i<n.position.length;i++){const a=t[i],l=n.position[i];if(a.field.isKeyField()?s=pt.comparator(pt.fromName(l.referenceValue),e.key):s=ya(l,e.data.field(a.field)),a.dir==="desc"&&(s*=-1),s!==0)break}return s}function Sw(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!Ei(n.position[e],t.position[e]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(t,e="asc"){this.field=t,this.dir=e}}function qk(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI{}class Kt extends dI{constructor(t,e,s){super(),this.field=t,this.op=e,this.value=s}static create(t,e,s){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,s):new Gk(t,e,s):e==="array-contains"?new Yk(t,s):e==="in"?new yI(t,s):e==="not-in"?new Kk(t,s):e==="array-contains-any"?new Qk(t,s):new Kt(t,e,s)}static createKeyFieldInFilter(t,e,s){return e==="in"?new $k(t,s):new Wk(t,s)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(ya(e,this.value)):e!==null&&_a(this.value)===_a(e)&&this.matchesComparison(ya(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return vt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class de extends dI{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new de(t,e)}matches(t){return xc(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function xc(n){return n.op==="and"}function Qy(n){return n.op==="or"}function ab(n){return fI(n)&&xc(n)}function fI(n){for(const t of n.filters)if(t instanceof de)return!1;return!0}function Xy(n){if(n instanceof Kt)return n.field.canonicalString()+n.op.toString()+bc(n.value);if(ab(n))return n.filters.map((t=>Xy(t))).join(",");{const t=n.filters.map((e=>Xy(e))).join(",");return`${n.op}(${t})`}}function mI(n,t){return n instanceof Kt?(function(s,i){return i instanceof Kt&&s.op===i.op&&s.field.isEqual(i.field)&&Ei(s.value,i.value)})(n,t):n instanceof de?(function(s,i){return i instanceof de&&s.op===i.op&&s.filters.length===i.filters.length?s.filters.reduce(((a,l,u)=>a&&mI(l,i.filters[u])),!0):!1})(n,t):void vt(19439)}function gI(n,t){const e=n.filters.concat(t);return de.create(e,n.op)}function pI(n){return n instanceof Kt?(function(e){return`${e.field.canonicalString()} ${e.op} ${bc(e.value)}`})(n):n instanceof de?(function(e){return e.op.toString()+" {"+e.getFilters().map(pI).join(" ,")+"}"})(n):"Filter"}class Gk extends Kt{constructor(t,e,s){super(t,e,s),this.key=pt.fromName(s.referenceValue)}matches(t){const e=pt.comparator(t.key,this.key);return this.matchesComparison(e)}}class $k extends Kt{constructor(t,e){super(t,"in",e),this.keys=_I("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Wk extends Kt{constructor(t,e){super(t,"not-in",e),this.keys=_I("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function _I(n,t){var e;return(((e=t.arrayValue)==null?void 0:e.values)||[]).map((s=>pt.fromName(s.referenceValue)))}class Yk extends Kt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Wh(e)&&$h(e.arrayValue,this.value)}}class yI extends Kt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&$h(this.value.arrayValue,e)}}class Kk extends Kt{constructor(t,e){super(t,"not-in",e)}matches(t){if($h(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!$h(this.value.arrayValue,e)}}class Qk extends Kt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Wh(e)||!e.arrayValue.values)&&e.arrayValue.values.some((s=>$h(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk{constructor(t,e=null,s=[],i=[],a=null,l=null,u=null){this.path=t,this.collectionGroup=e,this.orderBy=s,this.filters=i,this.limit=a,this.startAt=l,this.endAt=u,this.Te=null}}function Zy(n,t=null,e=[],s=[],i=null,a=null,l=null){return new Xk(n,t,e,s,i,a,l)}function Uo(n){const t=xt(n);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((s=>Xy(s))).join(","),e+="|ob:",e+=t.orderBy.map((s=>(function(a){return a.field.canonicalString()+a.dir})(s))).join(","),md(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((s=>bc(s))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((s=>bc(s))).join(",")),t.Te=e}return t.Te}function pd(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!qk(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!mI(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!Sw(n.startAt,t.startAt)&&Sw(n.endAt,t.endAt)}function Wm(n){return pt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Ym(n,t){return n.filters.filter((e=>e instanceof Kt&&e.field.isEqual(t)))}function Aw(n,t,e){let s=Tm,i=!0;for(const a of Ym(n,t)){let l=Tm,u=!0;switch(a.op){case"<":case"<=":l=zk(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,u=!1;break;case"!=":case"not-in":l=Tm}Ew({value:s,inclusive:i},{value:l,inclusive:u})<0&&(s=l,i=u)}if(e!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(t)){const l=e.position[a];Ew({value:s,inclusive:i},{value:l,inclusive:e.inclusive})<0&&(s=l,i=e.inclusive);break}}return{value:s,inclusive:i}}function Iw(n,t,e){let s=ea,i=!0;for(const a of Ym(n,t)){let l=ea,u=!0;switch(a.op){case">=":case">":l=Hk(a.value),u=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,u=!1;break;case"!=":case"not-in":l=ea}Tw({value:s,inclusive:i},{value:l,inclusive:u})>0&&(s=l,i=u)}if(e!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(t)){const l=e.position[a];Tw({value:s,inclusive:i},{value:l,inclusive:e.inclusive})>0&&(s=l,i=e.inclusive);break}}return{value:s,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(t,e=null,s=[],i=[],a=null,l="F",u=null,h=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=s,this.filters=i,this.limit=a,this.limitType=l,this.startAt=u,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function bI(n,t,e,s,i,a,l,u){return new rr(n,t,e,s,i,a,l,u)}function Bc(n){return new rr(n)}function Rw(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function ob(n){return n.collectionGroup!==null}function rc(n){const t=xt(n);if(t.Ie===null){t.Ie=[];const e=new Set;for(const a of t.explicitOrderBy)t.Ie.push(a),e.add(a.field.canonicalString());const s=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new fe(Ne.comparator);return l.filters.forEach((h=>{h.getFlattenedFilters().forEach((f=>{f.isInequality()&&(u=u.add(f.field))}))})),u})(t).forEach((a=>{e.has(a.canonicalString())||a.isKeyField()||t.Ie.push(new Yh(a,s))})),e.has(Ne.keyField().canonicalString())||t.Ie.push(new Yh(Ne.keyField(),s))}return t.Ie}function Wn(n){const t=xt(n);return t.Ee||(t.Ee=Zk(t,rc(n))),t.Ee}function Zk(n,t){if(n.limitType==="F")return Zy(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new Yh(i.field,a)}));const e=n.endAt?new ba(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new ba(n.startAt.position,n.startAt.inclusive):null;return Zy(n.path,n.collectionGroup,t,n.filters,n.limit,e,s)}}function Jy(n,t){const e=n.filters.concat([t]);return new rr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function Km(n,t,e){return new rr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function _d(n,t){return pd(Wn(n),Wn(t))&&n.limitType===t.limitType}function xI(n){return`${Uo(Wn(n))}|lt:${n.limitType}`}function tc(n){return`Query(target=${(function(e){let s=e.path.canonicalString();return e.collectionGroup!==null&&(s+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(s+=`, filters: [${e.filters.map((i=>pI(i))).join(", ")}]`),md(e.limit)||(s+=", limit: "+e.limit),e.orderBy.length>0&&(s+=`, orderBy: [${e.orderBy.map((i=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(i))).join(", ")}]`),e.startAt&&(s+=", startAt: ",s+=e.startAt.inclusive?"b:":"a:",s+=e.startAt.position.map((i=>bc(i))).join(",")),e.endAt&&(s+=", endAt: ",s+=e.endAt.inclusive?"a:":"b:",s+=e.endAt.position.map((i=>bc(i))).join(",")),`Target(${s})`})(Wn(n))}; limitType=${n.limitType})`}function yd(n,t){return t.isFoundDocument()&&(function(s,i){const a=i.key.path;return s.collectionGroup!==null?i.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(a):pt.isDocumentKey(s.path)?s.path.isEqual(a):s.path.isImmediateParentOf(a)})(n,t)&&(function(s,i){for(const a of rc(s))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(n,t)&&(function(s,i){for(const a of s.filters)if(!a.matches(i))return!1;return!0})(n,t)&&(function(s,i){return!(s.startAt&&!(function(l,u,h){const f=ww(l,u,h);return l.inclusive?f<=0:f<0})(s.startAt,rc(s),i)||s.endAt&&!(function(l,u,h){const f=ww(l,u,h);return l.inclusive?f>=0:f>0})(s.endAt,rc(s),i))})(n,t)}function vI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function EI(n){return(t,e)=>{let s=!1;for(const i of rc(n)){const a=Jk(i,t,e);if(a!==0)return a;s=s||i.field.isKeyField()}return 0}}function Jk(n,t,e){const s=n.field.isKeyField()?pt.comparator(t.key,e.key):(function(a,l,u){const h=l.data.field(a),f=u.data.field(a);return h!==null&&f!==null?ya(h,f):vt(42886)})(n.field,t,e);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return vt(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),s=this.inner[e];if(s!==void 0){for(const[i,a]of s)if(this.equalsFn(i,t))return a}}has(t){return this.get(t)!==void 0}set(t,e){const s=this.mapKeyFn(t),i=this.inner[s];if(i===void 0)return this.inner[s]=[[t,e]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],t))return void(i[a]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),s=this.inner[e];if(s===void 0)return!1;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return s.length===1?delete this.inner[e]:s.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Da(this.inner,((e,s)=>{for(const[i,a]of s)t(i,a)}))}isEmpty(){return nI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t4=new Te(pt.comparator);function ss(){return t4}const TI=new Te(pt.comparator);function hh(...n){let t=TI;for(const e of n)t=t.insert(e.key,e);return t}function wI(n){let t=TI;return n.forEach(((e,s)=>t=t.insert(e,s.overlayedDocument))),t}function gi(){return Dh()}function SI(){return Dh()}function Dh(){return new ar((n=>n.toString()),((n,t)=>n.isEqual(t)))}const e4=new Te(pt.comparator),n4=new fe(pt.comparator);function Ft(...n){let t=n4;for(const e of n)t=t.add(e);return t}const s4=new fe(Vt);function lb(){return s4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cb(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Uh(t)?"-0":t}}function AI(n){return{integerValue:""+n}}function II(n,t){return G2(t)?AI(t):cb(n,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dg{constructor(){this._=void 0}}function i4(n,t,e){return n instanceof vc?(function(i,a){const l={fields:{[rI]:{stringValue:iI},[oI]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Ag(a)&&(a=Ig(a)),a&&(l.fields[aI]=a),{mapValue:l}})(e,t):n instanceof zo?DI(n,t):n instanceof Ho?NI(n,t):(function(i,a){const l=RI(i,a),u=Dw(l)+Dw(i.Ae);return Ky(l)&&Ky(i.Ae)?AI(u):cb(i.serializer,u)})(n,t)}function r4(n,t,e){return n instanceof zo?DI(n,t):n instanceof Ho?NI(n,t):e}function RI(n,t){return n instanceof Ec?(function(s){return Ky(s)||(function(a){return!!a&&"doubleValue"in a})(s)})(t)?t:{integerValue:0}:null}class vc extends Dg{}class zo extends Dg{constructor(t){super(),this.elements=t}}function DI(n,t){const e=CI(t);for(const s of n.elements)e.some((i=>Ei(i,s)))||e.push(s);return{arrayValue:{values:e}}}class Ho extends Dg{constructor(t){super(),this.elements=t}}function NI(n,t){let e=CI(t);for(const s of n.elements)e=e.filter((i=>!Ei(i,s)));return{arrayValue:{values:e}}}class Ec extends Dg{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function Dw(n){return De(n.integerValue||n.doubleValue)}function CI(n){return Wh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(t,e){this.field=t,this.transform=e}}function a4(n,t){return n.field.isEqual(t.field)&&(function(s,i){return s instanceof zo&&i instanceof zo||s instanceof Ho&&i instanceof Ho?dc(s.elements,i.elements,Ei):s instanceof Ec&&i instanceof Ec?Ei(s.Ae,i.Ae):s instanceof vc&&i instanceof vc})(n.transform,t.transform)}class o4{constructor(t,e){this.version=t,this.transformResults=e}}class Ce{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Ce}static exists(t){return new Ce(void 0,t)}static updateTime(t){return new Ce(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Am(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class Ng{}function MI(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new Uc(n.key,Ce.none()):new Fc(n.key,n.data,Ce.none());{const e=n.data,s=Sn.empty();let i=new fe(Ne.comparator);for(let a of t.fields)if(!i.has(a)){let l=e.field(a);l===null&&a.length>1&&(a=a.popLast(),l=e.field(a)),l===null?s.delete(a):s.set(a,l),i=i.add(a)}return new or(n.key,s,new ns(i.toArray()),Ce.none())}}function l4(n,t,e){n instanceof Fc?(function(i,a,l){const u=i.value.clone(),h=Cw(i.fieldTransforms,a,l.transformResults);u.setAll(h),a.convertToFoundDocument(l.version,u).setHasCommittedMutations()})(n,t,e):n instanceof or?(function(i,a,l){if(!Am(i.precondition,a))return void a.convertToUnknownDocument(l.version);const u=Cw(i.fieldTransforms,a,l.transformResults),h=a.data;h.setAll(OI(i)),h.setAll(u),a.convertToFoundDocument(l.version,h).setHasCommittedMutations()})(n,t,e):(function(i,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()})(0,t,e)}function Nh(n,t,e,s){return n instanceof Fc?(function(a,l,u,h){if(!Am(a.precondition,l))return u;const f=a.value.clone(),m=Mw(a.fieldTransforms,h,l);return f.setAll(m),l.convertToFoundDocument(l.version,f).setHasLocalMutations(),null})(n,t,e,s):n instanceof or?(function(a,l,u,h){if(!Am(a.precondition,l))return u;const f=Mw(a.fieldTransforms,h,l),m=l.data;return m.setAll(OI(a)),m.setAll(f),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),u===null?null:u.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((_=>_.field)))})(n,t,e,s):(function(a,l,u){return Am(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u})(n,t,e)}function c4(n,t){let e=null;for(const s of n.fieldTransforms){const i=t.data.field(s.field),a=RI(s.transform,i||null);a!=null&&(e===null&&(e=Sn.empty()),e.set(s.field,a))}return e||null}function Nw(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!(function(s,i){return s===void 0&&i===void 0||!(!s||!i)&&dc(s,i,((a,l)=>a4(a,l)))})(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class Fc extends Ng{constructor(t,e,s,i=[]){super(),this.key=t,this.value=e,this.precondition=s,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class or extends Ng{constructor(t,e,s,i,a=[]){super(),this.key=t,this.data=e,this.fieldMask=s,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function OI(n){const t=new Map;return n.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const s=n.data.field(e);t.set(e,s)}})),t}function Cw(n,t,e){const s=new Map;wt(n.length===e.length,32656,{Re:e.length,Ve:n.length});for(let i=0;i<e.length;i++){const a=n[i],l=a.transform,u=t.data.field(a.field);s.set(a.field,r4(l,u,e[i]))}return s}function Mw(n,t,e){const s=new Map;for(const i of n){const a=i.transform,l=e.data.field(i.field);s.set(i.field,i4(a,l,t))}return s}class Uc extends Ng{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ub extends Ng{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{constructor(t,e,s,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=s,this.mutations=i}applyToRemoteDocument(t,e){const s=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(t.key)&&l4(a,t,s[i])}}applyToLocalView(t,e){for(const s of this.baseMutations)s.key.isEqual(t.key)&&(e=Nh(s,t,e,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(t.key)&&(e=Nh(s,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const s=SI();return this.mutations.forEach((i=>{const a=t.get(i.key),l=a.overlayedDocument;let u=this.applyToLocalView(l,a.mutatedFields);u=e.has(i.key)?null:u;const h=MI(l,u);h!==null&&s.set(i.key,h),l.isValidDocument()||l.convertToNoDocument(Rt.min())})),s}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),Ft())}isEqual(t){return this.batchId===t.batchId&&dc(this.mutations,t.mutations,((e,s)=>Nw(e,s)))&&dc(this.baseMutations,t.baseMutations,((e,s)=>Nw(e,s)))}}class db{constructor(t,e,s,i){this.batch=t,this.commitVersion=e,this.mutationResults=s,this.docVersions=i}static from(t,e,s){wt(t.mutations.length===s.length,58842,{me:t.mutations.length,fe:s.length});let i=(function(){return e4})();const a=t.mutations;for(let l=0;l<a.length;l++)i=i.insert(a[l].key,s[l].version);return new db(t,e,s,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u4{constructor(t,e){this.count=t,this.unchangedNames=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Je,Jt;function kI(n){switch(n){case tt.OK:return vt(64938);case tt.CANCELLED:case tt.UNKNOWN:case tt.DEADLINE_EXCEEDED:case tt.RESOURCE_EXHAUSTED:case tt.INTERNAL:case tt.UNAVAILABLE:case tt.UNAUTHENTICATED:return!1;case tt.INVALID_ARGUMENT:case tt.NOT_FOUND:case tt.ALREADY_EXISTS:case tt.PERMISSION_DENIED:case tt.FAILED_PRECONDITION:case tt.ABORTED:case tt.OUT_OF_RANGE:case tt.UNIMPLEMENTED:case tt.DATA_LOSS:return!0;default:return vt(15467,{code:n})}}function VI(n){if(n===void 0)return We("GRPC error has no .code"),tt.UNKNOWN;switch(n){case Je.OK:return tt.OK;case Je.CANCELLED:return tt.CANCELLED;case Je.UNKNOWN:return tt.UNKNOWN;case Je.DEADLINE_EXCEEDED:return tt.DEADLINE_EXCEEDED;case Je.RESOURCE_EXHAUSTED:return tt.RESOURCE_EXHAUSTED;case Je.INTERNAL:return tt.INTERNAL;case Je.UNAVAILABLE:return tt.UNAVAILABLE;case Je.UNAUTHENTICATED:return tt.UNAUTHENTICATED;case Je.INVALID_ARGUMENT:return tt.INVALID_ARGUMENT;case Je.NOT_FOUND:return tt.NOT_FOUND;case Je.ALREADY_EXISTS:return tt.ALREADY_EXISTS;case Je.PERMISSION_DENIED:return tt.PERMISSION_DENIED;case Je.FAILED_PRECONDITION:return tt.FAILED_PRECONDITION;case Je.ABORTED:return tt.ABORTED;case Je.OUT_OF_RANGE:return tt.OUT_OF_RANGE;case Je.UNIMPLEMENTED:return tt.UNIMPLEMENTED;case Je.DATA_LOSS:return tt.DATA_LOSS;default:return vt(39323,{code:n})}}(Jt=Je||(Je={}))[Jt.OK=0]="OK",Jt[Jt.CANCELLED=1]="CANCELLED",Jt[Jt.UNKNOWN=2]="UNKNOWN",Jt[Jt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Jt[Jt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Jt[Jt.NOT_FOUND=5]="NOT_FOUND",Jt[Jt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Jt[Jt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Jt[Jt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Jt[Jt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Jt[Jt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Jt[Jt.ABORTED=10]="ABORTED",Jt[Jt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Jt[Jt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Jt[Jt.INTERNAL=13]="INTERNAL",Jt[Jt.UNAVAILABLE=14]="UNAVAILABLE",Jt[Jt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PI(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h4=new la([4294967295,4294967295],0);function Ow(n){const t=PI().encode(n),e=new R2;return e.update(t),new Uint8Array(e.digest())}function kw(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),s=t.getUint32(4,!0),i=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new la([e,s],0),new la([i,a],0)]}class mb{constructor(t,e,s){if(this.bitmap=t,this.padding=e,this.hashCount=s,e<0||e>=8)throw new dh(`Invalid padding: ${e}`);if(s<0)throw new dh(`Invalid hash count: ${s}`);if(t.length>0&&this.hashCount===0)throw new dh(`Invalid hash count: ${s}`);if(t.length===0&&e!==0)throw new dh(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=la.fromNumber(this.ge)}ye(t,e,s){let i=t.add(e.multiply(la.fromNumber(s)));return i.compare(h4)===1&&(i=new la([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=Ow(t),[s,i]=kw(e);for(let a=0;a<this.hashCount;a++){const l=this.ye(s,i,a);if(!this.we(l))return!1}return!0}static create(t,e,s){const i=t%8==0?0:8-t%8,a=new Uint8Array(Math.ceil(t/8)),l=new mb(a,i,e);return s.forEach((u=>l.insert(u))),l}insert(t){if(this.ge===0)return;const e=Ow(t),[s,i]=kw(e);for(let a=0;a<this.hashCount;a++){const l=this.ye(s,i,a);this.Se(l)}}Se(t){const e=Math.floor(t/8),s=t%8;this.bitmap[e]|=1<<s}}class dh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(t,e,s,i,a){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=s,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(t,e,s){const i=new Map;return i.set(t,vd.createSynthesizedTargetChangeForCurrentChange(t,e,s)),new xd(Rt.min(),i,new Te(Vt),ss(),Ft())}}class vd{constructor(t,e,s,i,a){this.resumeToken=t,this.current=e,this.addedDocuments=s,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(t,e,s){return new vd(s,e,Ft(),Ft(),Ft())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Im{constructor(t,e,s,i){this.be=t,this.removedTargetIds=e,this.key=s,this.De=i}}class LI{constructor(t,e){this.targetId=t,this.Ce=e}}class jI{constructor(t,e,s=Be.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=s,this.cause=i}}class Vw{constructor(){this.ve=0,this.Fe=Pw(),this.Me=Be.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=Ft(),e=Ft(),s=Ft();return this.Fe.forEach(((i,a)=>{switch(a){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:s=s.add(i);break;default:vt(38017,{changeType:a})}})),new vd(this.Me,this.xe,t,e,s)}qe(){this.Oe=!1,this.Fe=Pw()}Qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,wt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class d4{constructor(t){this.Ge=t,this.ze=new Map,this.je=ss(),this.Je=tm(),this.He=tm(),this.Ye=new Te(Vt)}Ze(t){for(const e of t.be)t.De&&t.De.isFoundDocument()?this.Xe(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,(e=>{const s=this.nt(e);switch(t.state){case 0:this.rt(e)&&s.Le(t.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(t.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(s.We(),s.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),s.Le(t.resumeToken));break;default:vt(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach(((s,i)=>{this.rt(i)&&e(i)}))}st(t){const e=t.targetId,s=t.Ce.count,i=this.ot(e);if(i){const a=i.target;if(Wm(a))if(s===0){const l=new pt(a.path);this.et(e,l,Se.newNoDocument(l,Rt.min()))}else wt(s===1,20013,{expectedCount:s});else{const l=this._t(e);if(l!==s){const u=this.ut(t),h=u?this.ct(u,t,l):1;if(h!==0){this.it(e);const f=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(e,f)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:s="",padding:i=0},hashCount:a=0}=e;let l,u;try{l=sr(s).toUint8Array()}catch(h){if(h instanceof sI)return vi("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new mb(l,i,a)}catch(h){return vi(h instanceof dh?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.ge===0?null:u}ct(t,e,s){return e.Ce.count===s-this.Pt(t,e.targetId)?0:2}Pt(t,e){const s=this.Ge.getRemoteKeysForTarget(e);let i=0;return s.forEach((a=>{const l=this.Ge.ht(),u=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;t.mightContain(u)||(this.et(e,a,null),i++)})),i}Tt(t){const e=new Map;this.ze.forEach(((a,l)=>{const u=this.ot(l);if(u){if(a.current&&Wm(u.target)){const h=new pt(u.target.path);this.It(h).has(l)||this.Et(l,h)||this.et(l,h,Se.newNoDocument(h,t))}a.Be&&(e.set(l,a.ke()),a.qe())}}));let s=Ft();this.He.forEach(((a,l)=>{let u=!0;l.forEachWhile((h=>{const f=this.ot(h);return!f||f.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(s=s.add(a))})),this.je.forEach(((a,l)=>l.setReadTime(t)));const i=new xd(t,e,this.Ye,this.je,s);return this.je=ss(),this.Je=tm(),this.He=tm(),this.Ye=new Te(Vt),i}Xe(t,e){if(!this.rt(t))return;const s=this.Et(t,e.key)?2:0;this.nt(t).Qe(e.key,s),this.je=this.je.insert(e.key,e),this.Je=this.Je.insert(e.key,this.It(e.key).add(t)),this.He=this.He.insert(e.key,this.dt(e.key).add(t))}et(t,e,s){if(!this.rt(t))return;const i=this.nt(t);this.Et(t,e)?i.Qe(e,1):i.$e(e),this.He=this.He.insert(e,this.dt(e).delete(t)),this.He=this.He.insert(e,this.dt(e).add(t)),s&&(this.je=this.je.insert(e,s))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let e=this.ze.get(t);return e||(e=new Vw,this.ze.set(t,e)),e}dt(t){let e=this.He.get(t);return e||(e=new fe(Vt),this.He=this.He.insert(t,e)),e}It(t){let e=this.Je.get(t);return e||(e=new fe(Vt),this.Je=this.Je.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||ct("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new Vw),this.Ge.getRemoteKeysForTarget(t).forEach((e=>{this.et(t,e,null)}))}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function tm(){return new Te(pt.comparator)}function Pw(){return new Te(pt.comparator)}const f4={asc:"ASCENDING",desc:"DESCENDING"},m4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},g4={and:"AND",or:"OR"};class p4{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function t0(n,t){return n.useProto3Json||md(t)?t:{value:t}}function Tc(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function BI(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function _4(n,t){return Tc(n,t.toTimestamp())}function Ke(n){return wt(!!n,49232),Rt.fromTimestamp((function(e){const s=nr(e);return new oe(s.seconds,s.nanos)})(n))}function gb(n,t){return e0(n,t).canonicalString()}function e0(n,t){const e=(function(i){return new Wt(["projects",i.projectId,"databases",i.database])})(n).child("documents");return t===void 0?e:e.child(t)}function FI(n){const t=Wt.fromString(n);return wt(QI(t),10190,{key:t.toString()}),t}function Kh(n,t){return gb(n.databaseId,t.path)}function _i(n,t){const e=FI(t);if(e.get(1)!==n.databaseId.projectId)throw new lt(tt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new lt(tt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new pt(HI(e))}function UI(n,t){return gb(n.databaseId,t)}function zI(n){const t=FI(n);return t.length===4?Wt.emptyPath():HI(t)}function n0(n){return new Wt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function HI(n){return wt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Lw(n,t,e){return{name:Kh(n,t),fields:e.value.mapValue.fields}}function qI(n,t,e){const s=_i(n,t.name),i=Ke(t.updateTime),a=t.createTime?Ke(t.createTime):Rt.min(),l=new Sn({mapValue:{fields:t.fields}}),u=Se.newFoundDocument(s,i,a,l);return e&&u.setHasCommittedMutations(),e?u.setHasCommittedMutations():u}function y4(n,t){return"found"in t?(function(s,i){wt(!!i.found,43571),i.found.name,i.found.updateTime;const a=_i(s,i.found.name),l=Ke(i.found.updateTime),u=i.found.createTime?Ke(i.found.createTime):Rt.min(),h=new Sn({mapValue:{fields:i.found.fields}});return Se.newFoundDocument(a,l,u,h)})(n,t):"missing"in t?(function(s,i){wt(!!i.missing,3894),wt(!!i.readTime,22933);const a=_i(s,i.missing),l=Ke(i.readTime);return Se.newNoDocument(a,l)})(n,t):vt(7234,{result:t})}function b4(n,t){let e;if("targetChange"in t){t.targetChange;const s=(function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:vt(39313,{state:f})})(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],a=(function(f,m){return f.useProto3Json?(wt(m===void 0||typeof m=="string",58123),Be.fromBase64String(m||"")):(wt(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),Be.fromUint8Array(m||new Uint8Array))})(n,t.targetChange.resumeToken),l=t.targetChange.cause,u=l&&(function(f){const m=f.code===void 0?tt.UNKNOWN:VI(f.code);return new lt(m,f.message||"")})(l);e=new jI(s,i,a,u||null)}else if("documentChange"in t){t.documentChange;const s=t.documentChange;s.document,s.document.name,s.document.updateTime;const i=_i(n,s.document.name),a=Ke(s.document.updateTime),l=s.document.createTime?Ke(s.document.createTime):Rt.min(),u=new Sn({mapValue:{fields:s.document.fields}}),h=Se.newFoundDocument(i,a,l,u),f=s.targetIds||[],m=s.removedTargetIds||[];e=new Im(f,m,h.key,h)}else if("documentDelete"in t){t.documentDelete;const s=t.documentDelete;s.document;const i=_i(n,s.document),a=s.readTime?Ke(s.readTime):Rt.min(),l=Se.newNoDocument(i,a),u=s.removedTargetIds||[];e=new Im([],u,l.key,l)}else if("documentRemove"in t){t.documentRemove;const s=t.documentRemove;s.document;const i=_i(n,s.document),a=s.removedTargetIds||[];e=new Im([],a,i,null)}else{if(!("filter"in t))return vt(11601,{Rt:t});{t.filter;const s=t.filter;s.targetId;const{count:i=0,unchangedNames:a}=s,l=new u4(i,a),u=s.targetId;e=new LI(u,l)}}return e}function Qh(n,t){let e;if(t instanceof Fc)e={update:Lw(n,t.key,t.value)};else if(t instanceof Uc)e={delete:Kh(n,t.key)};else if(t instanceof or)e={update:Lw(n,t.key,t.data),updateMask:S4(t.fieldMask)};else{if(!(t instanceof ub))return vt(16599,{Vt:t.type});e={verify:Kh(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map((s=>(function(a,l){const u=l.transform;if(u instanceof vc)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof zo)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Ho)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Ec)return{fieldPath:l.field.canonicalString(),increment:u.Ae};throw vt(20930,{transform:l.transform})})(0,s)))),t.precondition.isNone||(e.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:_4(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:vt(27497)})(n,t.precondition)),e}function s0(n,t){const e=t.currentDocument?(function(a){return a.updateTime!==void 0?Ce.updateTime(Ke(a.updateTime)):a.exists!==void 0?Ce.exists(a.exists):Ce.none()})(t.currentDocument):Ce.none(),s=t.updateTransforms?t.updateTransforms.map((i=>(function(l,u){let h=null;if("setToServerValue"in u)wt(u.setToServerValue==="REQUEST_TIME",16630,{proto:u}),h=new vc;else if("appendMissingElements"in u){const m=u.appendMissingElements.values||[];h=new zo(m)}else if("removeAllFromArray"in u){const m=u.removeAllFromArray.values||[];h=new Ho(m)}else"increment"in u?h=new Ec(l,u.increment):vt(16584,{proto:u});const f=Ne.fromServerFormat(u.fieldPath);return new bd(f,h)})(n,i))):[];if(t.update){t.update.name;const i=_i(n,t.update.name),a=new Sn({mapValue:{fields:t.update.fields}});if(t.updateMask){const l=(function(h){const f=h.fieldPaths||[];return new ns(f.map((m=>Ne.fromServerFormat(m))))})(t.updateMask);return new or(i,a,l,e,s)}return new Fc(i,a,e,s)}if(t.delete){const i=_i(n,t.delete);return new Uc(i,e)}if(t.verify){const i=_i(n,t.verify);return new ub(i,e)}return vt(1463,{proto:t})}function x4(n,t){return n&&n.length>0?(wt(t!==void 0,14353),n.map((e=>(function(i,a){let l=i.updateTime?Ke(i.updateTime):Ke(a);return l.isEqual(Rt.min())&&(l=Ke(a)),new o4(l,i.transformResults||[])})(e,t)))):[]}function GI(n,t){return{documents:[UI(n,t.path)]}}function $I(n,t){const e={structuredQuery:{}},s=t.path;let i;t.collectionGroup!==null?(i=s,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=s.popLast(),e.structuredQuery.from=[{collectionId:s.lastSegment()}]),e.parent=UI(n,i);const a=(function(f){if(f.length!==0)return KI(de.create(f,"and"))})(t.filters);a&&(e.structuredQuery.where=a);const l=(function(f){if(f.length!==0)return f.map((m=>(function(x){return{field:ec(x.field),direction:E4(x.dir)}})(m)))})(t.orderBy);l&&(e.structuredQuery.orderBy=l);const u=t0(n,t.limit);return u!==null&&(e.structuredQuery.limit=u),t.startAt&&(e.structuredQuery.startAt=(function(f){return{before:f.inclusive,values:f.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(f){return{before:!f.inclusive,values:f.position}})(t.endAt)),{ft:e,parent:i}}function WI(n){let t=zI(n.parent);const e=n.structuredQuery,s=e.from?e.from.length:0;let i=null;if(s>0){wt(s===1,65062);const m=e.from[0];m.allDescendants?i=m.collectionId:t=t.child(m.collectionId)}let a=[];e.where&&(a=(function(_){const x=YI(_);return x instanceof de&&ab(x)?x.getFilters():[x]})(e.where));let l=[];e.orderBy&&(l=(function(_){return _.map((x=>(function(S){return new Yh(nc(S.field),(function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(x)))})(e.orderBy));let u=null;e.limit&&(u=(function(_){let x;return x=typeof _=="object"?_.value:_,md(x)?null:x})(e.limit));let h=null;e.startAt&&(h=(function(_){const x=!!_.before,E=_.values||[];return new ba(E,x)})(e.startAt));let f=null;return e.endAt&&(f=(function(_){const x=!_.before,E=_.values||[];return new ba(E,x)})(e.endAt)),bI(t,i,l,a,u,"F",h,f)}function v4(n,t){const e=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return vt(28987,{purpose:i})}})(t.purpose);return e==null?null:{"goog-listen-tags":e}}function YI(n){return n.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const s=nc(e.unaryFilter.field);return Kt.create(s,"==",{doubleValue:NaN});case"IS_NULL":const i=nc(e.unaryFilter.field);return Kt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=nc(e.unaryFilter.field);return Kt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=nc(e.unaryFilter.field);return Kt.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return vt(61313);default:return vt(60726)}})(n):n.fieldFilter!==void 0?(function(e){return Kt.create(nc(e.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return vt(58110);default:return vt(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(e){return de.create(e.compositeFilter.filters.map((s=>YI(s))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return vt(1026)}})(e.compositeFilter.op))})(n):vt(30097,{filter:n})}function E4(n){return f4[n]}function T4(n){return m4[n]}function w4(n){return g4[n]}function ec(n){return{fieldPath:n.canonicalString()}}function nc(n){return Ne.fromServerFormat(n.fieldPath)}function KI(n){return n instanceof Kt?(function(e){if(e.op==="=="){if(vw(e.value))return{unaryFilter:{field:ec(e.field),op:"IS_NAN"}};if(xw(e.value))return{unaryFilter:{field:ec(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(vw(e.value))return{unaryFilter:{field:ec(e.field),op:"IS_NOT_NAN"}};if(xw(e.value))return{unaryFilter:{field:ec(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ec(e.field),op:T4(e.op),value:e.value}}})(n):n instanceof de?(function(e){const s=e.getFilters().map((i=>KI(i)));return s.length===1?s[0]:{compositeFilter:{op:w4(e.op),filters:s}}})(n):vt(54877,{filter:n})}function S4(n){const t=[];return n.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function QI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(t,e,s,i,a=Rt.min(),l=Rt.min(),u=Be.EMPTY_BYTE_STRING,h=null){this.target=t,this.targetId=e,this.purpose=s,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(t){return new Qi(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(t){this.yt=t}}function A4(n,t){let e;if(t.document)e=qI(n.yt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const s=pt.fromSegments(t.noDocument.path),i=Go(t.noDocument.readTime);e=Se.newNoDocument(s,i),t.hasCommittedMutations&&e.setHasCommittedMutations()}else{if(!t.unknownDocument)return vt(56709);{const s=pt.fromSegments(t.unknownDocument.path),i=Go(t.unknownDocument.version);e=Se.newUnknownDocument(s,i)}}return t.readTime&&e.setReadTime((function(i){const a=new oe(i[0],i[1]);return Rt.fromTimestamp(a)})(t.readTime)),e}function jw(n,t){const e=t.key,s={prefixPath:e.getCollectionPath().popLast().toArray(),collectionGroup:e.collectionGroup,documentId:e.path.lastSegment(),readTime:Qm(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())s.document=(function(a,l){return{name:Kh(a,l.key),fields:l.data.value.mapValue.fields,updateTime:Tc(a,l.version.toTimestamp()),createTime:Tc(a,l.createTime.toTimestamp())}})(n.yt,t);else if(t.isNoDocument())s.noDocument={path:e.path.toArray(),readTime:qo(t.version)};else{if(!t.isUnknownDocument())return vt(57904,{document:t});s.unknownDocument={path:e.path.toArray(),version:qo(t.version)}}return s}function Qm(n){const t=n.toTimestamp();return[t.seconds,t.nanoseconds]}function qo(n){const t=n.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Go(n){const t=new oe(n.seconds,n.nanoseconds);return Rt.fromTimestamp(t)}function Io(n,t){const e=(t.baseMutations||[]).map((a=>s0(n.yt,a)));for(let a=0;a<t.mutations.length-1;++a){const l=t.mutations[a];if(a+1<t.mutations.length&&t.mutations[a+1].transform!==void 0){const u=t.mutations[a+1];l.updateTransforms=u.transform.fieldTransforms,t.mutations.splice(a+1,1),++a}}const s=t.mutations.map((a=>s0(n.yt,a))),i=oe.fromMillis(t.localWriteTimeMs);return new hb(t.batchId,i,e,s)}function fh(n){const t=Go(n.readTime),e=n.lastLimboFreeSnapshotVersion!==void 0?Go(n.lastLimboFreeSnapshotVersion):Rt.min();let s;return s=(function(a){return a.documents!==void 0})(n.query)?(function(a){const l=a.documents.length;return wt(l===1,1966,{count:l}),Wn(Bc(zI(a.documents[0])))})(n.query):(function(a){return Wn(WI(a))})(n.query),new Qi(s,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,t,e,Be.fromBase64String(n.resumeToken))}function ZI(n,t){const e=qo(t.snapshotVersion),s=qo(t.lastLimboFreeSnapshotVersion);let i;i=Wm(t.target)?GI(n.yt,t.target):$I(n.yt,t.target).ft;const a=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Uo(t.target),readTime:e,resumeToken:a,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:i}}function pb(n){const t=WI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Km(t,t.limit,"L"):t}function hy(n,t){return new fb(t.largestBatchId,s0(n.yt,t.overlayMutation))}function Bw(n,t){const e=t.path.lastSegment();return[n,Ln(t.path.popLast()),e]}function Fw(n,t,e,s){return{indexId:n,uid:t,sequenceNumber:e,readTime:qo(s.readTime),documentKey:Ln(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I4{getBundleMetadata(t,e){return Uw(t).get(e).next((s=>{if(s)return(function(a){return{id:a.bundleId,createTime:Go(a.createTime),version:a.version}})(s)}))}saveBundleMetadata(t,e){return Uw(t).put((function(i){return{bundleId:i.id,createTime:qo(Ke(i.createTime)),version:i.version}})(e))}getNamedQuery(t,e){return zw(t).get(e).next((s=>{if(s)return(function(a){return{name:a.name,query:pb(a.bundledQuery),readTime:Go(a.readTime)}})(s)}))}saveNamedQuery(t,e){return zw(t).put((function(i){return{name:i.name,readTime:qo(Ke(i.readTime)),bundledQuery:i.bundledQuery}})(e))}}function Uw(n){return un(n,Tg)}function zw(n){return un(n,wg)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg{constructor(t,e){this.serializer=t,this.userId=e}static wt(t,e){const s=e.uid||"";return new Cg(t,s)}getOverlay(t,e){return Ju(t).get(Bw(this.userId,e)).next((s=>s?hy(this.serializer,s):null))}getOverlays(t,e){const s=gi();return W.forEach(e,(i=>this.getOverlay(t,i).next((a=>{a!==null&&s.set(i,a)})))).next((()=>s))}saveOverlays(t,e,s){const i=[];return s.forEach(((a,l)=>{const u=new fb(e,l);i.push(this.St(t,u))})),W.waitFor(i)}removeOverlaysForBatchId(t,e,s){const i=new Set;e.forEach((l=>i.add(Ln(l.getCollectionPath()))));const a=[];return i.forEach((l=>{const u=IDBKeyRange.bound([this.userId,l,s],[this.userId,l,s+1],!1,!0);a.push(Ju(t).Z(Gy,u))})),W.waitFor(a)}getOverlaysForCollection(t,e,s){const i=gi(),a=Ln(e),l=IDBKeyRange.bound([this.userId,a,s],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Ju(t).J(Gy,l).next((u=>{for(const h of u){const f=hy(this.serializer,h);i.set(f.getKey(),f)}return i}))}getOverlaysForCollectionGroup(t,e,s,i){const a=gi();let l;const u=IDBKeyRange.bound([this.userId,e,s],[this.userId,e,Number.POSITIVE_INFINITY],!0);return Ju(t).ee({index:X2,range:u},((h,f,m)=>{const _=hy(this.serializer,f);a.size()<i||_.largestBatchId===l?(a.set(_.getKey(),_),l=_.largestBatchId):m.done()})).next((()=>a))}St(t,e){return Ju(t).put((function(i,a,l){const[u,h,f]=Bw(a,l.mutation.key);return{userId:a,collectionPath:h,documentId:f,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:Qh(i.yt,l.mutation)}})(this.serializer,this.userId,e))}}function Ju(n){return un(n,Sg)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R4{bt(t){return un(t,nb)}getSessionToken(t){return this.bt(t).get("sessionToken").next((e=>{const s=e==null?void 0:e.value;return s?Be.fromUint8Array(s):Be.EMPTY_BYTE_STRING}))}setSessionToken(t,e){return this.bt(t).put({name:"sessionToken",value:e.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(){}Dt(t,e){this.Ct(t,e),e.vt()}Ct(t,e){if("nullValue"in t)this.Ft(e,5);else if("booleanValue"in t)this.Ft(e,10),e.Mt(t.booleanValue?1:0);else if("integerValue"in t)this.Ft(e,15),e.Mt(De(t.integerValue));else if("doubleValue"in t){const s=De(t.doubleValue);isNaN(s)?this.Ft(e,13):(this.Ft(e,15),Uh(s)?e.Mt(0):e.Mt(s))}else if("timestampValue"in t){let s=t.timestampValue;this.Ft(e,20),typeof s=="string"&&(s=nr(s)),e.xt(`${s.seconds||""}`),e.Mt(s.nanos||0)}else if("stringValue"in t)this.Ot(t.stringValue,e),this.Nt(e);else if("bytesValue"in t)this.Ft(e,30),e.Bt(sr(t.bytesValue)),this.Nt(e);else if("referenceValue"in t)this.Lt(t.referenceValue,e);else if("geoPointValue"in t){const s=t.geoPointValue;this.Ft(e,45),e.Mt(s.latitude||0),e.Mt(s.longitude||0)}else"mapValue"in t?cI(t)?this.Ft(e,Number.MAX_SAFE_INTEGER):Rg(t)?this.kt(t.mapValue,e):(this.qt(t.mapValue,e),this.Nt(e)):"arrayValue"in t?(this.Qt(t.arrayValue,e),this.Nt(e)):vt(19022,{$t:t})}Ot(t,e){this.Ft(e,25),this.Ut(t,e)}Ut(t,e){e.xt(t)}qt(t,e){const s=t.fields||{};this.Ft(e,55);for(const i of Object.keys(s))this.Ot(i,e),this.Ct(s[i],e)}kt(t,e){var l,u;const s=t.fields||{};this.Ft(e,53);const i=yc,a=((u=(l=s[i].arrayValue)==null?void 0:l.values)==null?void 0:u.length)||0;this.Ft(e,15),e.Mt(De(a)),this.Ot(i,e),this.Ct(s[i],e)}Qt(t,e){const s=t.values||[];this.Ft(e,50);for(const i of s)this.Ct(i,e)}Lt(t,e){this.Ft(e,37),pt.fromName(t).path.forEach((s=>{this.Ft(e,60),this.Ut(s,e)}))}Ft(t,e){t.Mt(e)}Nt(t){t.Mt(2)}}Ro.Kt=new Ro;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wl=255;function D4(n){if(n===0)return 8;let t=0;return n>>4||(t+=4,n<<=4),n>>6||(t+=2,n<<=2),n>>7||(t+=1),t}function Hw(n){const t=64-(function(s){let i=0;for(let a=0;a<8;++a){const l=D4(255&s[a]);if(i+=l,l!==8)break}return i})(n);return Math.ceil(t/8)}class N4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(t){const e=t[Symbol.iterator]();let s=e.next();for(;!s.done;)this.Gt(s.value),s=e.next();this.zt()}jt(t){const e=t[Symbol.iterator]();let s=e.next();for(;!s.done;)this.Jt(s.value),s=e.next();this.Ht()}Yt(t){for(const e of t){const s=e.charCodeAt(0);if(s<128)this.Gt(s);else if(s<2048)this.Gt(960|s>>>6),this.Gt(128|63&s);else if(e<"\uD800"||"\uDBFF"<e)this.Gt(480|s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s);else{const i=e.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(t){for(const e of t){const s=e.charCodeAt(0);if(s<128)this.Jt(s);else if(s<2048)this.Jt(960|s>>>6),this.Jt(128|63&s);else if(e<"\uD800"||"\uDBFF"<e)this.Jt(480|s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s);else{const i=e.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(t){const e=this.en(t),s=Hw(e);this.tn(1+s),this.buffer[this.position++]=255&s;for(let i=e.length-s;i<e.length;++i)this.buffer[this.position++]=255&e[i]}nn(t){const e=this.en(t),s=Hw(e);this.tn(1+s),this.buffer[this.position++]=~(255&s);for(let i=e.length-s;i<e.length;++i)this.buffer[this.position++]=~(255&e[i])}rn(){this.sn(Wl),this.sn(255)}_n(){this.an(Wl),this.an(255)}reset(){this.position=0}seed(t){this.tn(t.length),this.buffer.set(t,this.position),this.position+=t.length}un(){return this.buffer.slice(0,this.position)}en(t){const e=(function(a){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,a,!1),new Uint8Array(l.buffer)})(t),s=!!(128&e[0]);e[0]^=s?255:128;for(let i=1;i<e.length;++i)e[i]^=s?255:0;return e}Gt(t){const e=255&t;e===0?(this.sn(0),this.sn(255)):e===Wl?(this.sn(Wl),this.sn(0)):this.sn(e)}Jt(t){const e=255&t;e===0?(this.an(0),this.an(255)):e===Wl?(this.an(Wl),this.an(0)):this.an(t)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(t){this.tn(1),this.buffer[this.position++]=t}an(t){this.tn(1),this.buffer[this.position++]=~t}tn(t){const e=t+this.position;if(e<=this.buffer.length)return;let s=2*this.buffer.length;s<e&&(s=e);const i=new Uint8Array(s);i.set(this.buffer),this.buffer=i}}class C4{constructor(t){this.cn=t}Bt(t){this.cn.Wt(t)}xt(t){this.cn.Yt(t)}Mt(t){this.cn.Xt(t)}vt(){this.cn.rn()}}class M4{constructor(t){this.cn=t}Bt(t){this.cn.jt(t)}xt(t){this.cn.Zt(t)}Mt(t){this.cn.nn(t)}vt(){this.cn._n()}}class th{constructor(){this.cn=new N4,this.ln=new C4(this.cn),this.hn=new M4(this.cn)}seed(t){this.cn.seed(t)}Pn(t){return t===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(t,e,s,i){this.Tn=t,this.In=e,this.En=s,this.dn=i}An(){const t=this.dn.length,e=t===0||this.dn[t-1]===255?t+1:t,s=new Uint8Array(e);return s.set(this.dn,0),e!==t?s.set([0],this.dn.length):++s[s.length-1],new Do(this.Tn,this.In,this.En,s)}Rn(t,e,s){return{indexId:this.Tn,uid:t,arrayValue:Rm(this.En),directionalValue:Rm(this.dn),orderedDocumentKey:Rm(e),documentKey:s.path.toArray()}}Vn(t,e,s){const i=this.Rn(t,e,s);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Kr(n,t){let e=n.Tn-t.Tn;return e!==0?e:(e=qw(n.En,t.En),e!==0?e:(e=qw(n.dn,t.dn),e!==0?e:pt.comparator(n.In,t.In)))}function qw(n,t){for(let e=0;e<n.length&&e<t.length;++e){const s=n[e]-t[e];if(s!==0)return s}return n.length-t.length}function Rm(n){return d2()?(function(e){let s="";for(let i=0;i<e.length;i++)s+=String.fromCharCode(e[i]);return s})(n):n}function Gw(n){return typeof n!="string"?n:(function(e){const s=new Uint8Array(e.length);for(let i=0;i<e.length;i++)s[i]=e.charCodeAt(i);return s})(n)}class $w{constructor(t){this.mn=new fe(((e,s)=>Ne.comparator(e.field,s.field))),this.collectionId=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment(),this.fn=t.orderBy,this.gn=[];for(const e of t.filters){const s=e;s.isInequality()?this.mn=this.mn.add(s):this.gn.push(s)}}get pn(){return this.mn.size>1}yn(t){if(wt(t.collectionGroup===this.collectionId,49279),this.pn)return!1;const e=zy(t);if(e!==void 0&&!this.wn(e))return!1;const s=Eo(t);let i=new Set,a=0,l=0;for(;a<s.length&&this.wn(s[a]);++a)i=i.add(s[a].fieldPath.canonicalString());if(a===s.length)return!0;if(this.mn.size>0){const u=this.mn.getIterator().getNext();if(!i.has(u.field.canonicalString())){const h=s[a];if(!this.Sn(u,h)||!this.bn(this.fn[l++],h))return!1}++a}for(;a<s.length;++a){const u=s[a];if(l>=this.fn.length||!this.bn(this.fn[l++],u))return!1}return!0}Dn(){if(this.pn)return null;let t=new fe(Ne.comparator);const e=[];for(const s of this.gn)if(!s.field.isKeyField())if(s.op==="array-contains"||s.op==="array-contains-any")e.push(new xm(s.field,2));else{if(t.has(s.field))continue;t=t.add(s.field),e.push(new xm(s.field,0))}for(const s of this.fn)s.field.isKeyField()||t.has(s.field)||(t=t.add(s.field),e.push(new xm(s.field,s.dir==="asc"?0:1)));return new Hm(Hm.UNKNOWN_ID,this.collectionId,e,Fh.empty())}wn(t){for(const e of this.gn)if(this.Sn(e,t))return!0;return!1}Sn(t,e){if(t===void 0||!t.field.isEqual(e.fieldPath))return!1;const s=t.op==="array-contains"||t.op==="array-contains-any";return e.kind===2===s}bn(t,e){return!!t.field.isEqual(e.fieldPath)&&(e.kind===0&&t.dir==="asc"||e.kind===1&&t.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JI(n){var e,s;if(wt(n instanceof Kt||n instanceof de,20012),n instanceof Kt){if(n instanceof yI){const i=((s=(e=n.value.arrayValue)==null?void 0:e.values)==null?void 0:s.map((a=>Kt.create(n.field,"==",a))))||[];return de.create(i,"or")}return n}const t=n.filters.map((i=>JI(i)));return de.create(t,n.op)}function O4(n){if(n.getFilters().length===0)return[];const t=a0(JI(n));return wt(tR(t),7391),i0(t)||r0(t)?[t]:t.getFilters()}function i0(n){return n instanceof Kt}function r0(n){return n instanceof de&&ab(n)}function tR(n){return i0(n)||r0(n)||(function(e){if(e instanceof de&&Qy(e)){for(const s of e.getFilters())if(!i0(s)&&!r0(s))return!1;return!0}return!1})(n)}function a0(n){if(wt(n instanceof Kt||n instanceof de,34018),n instanceof Kt)return n;if(n.filters.length===1)return a0(n.filters[0]);const t=n.filters.map((s=>a0(s)));let e=de.create(t,n.op);return e=Xm(e),tR(e)?e:(wt(e instanceof de,64498),wt(xc(e),40251),wt(e.filters.length>1,57927),e.filters.reduce(((s,i)=>_b(s,i))))}function _b(n,t){let e;return wt(n instanceof Kt||n instanceof de,38388),wt(t instanceof Kt||t instanceof de,25473),e=n instanceof Kt?t instanceof Kt?(function(i,a){return de.create([i,a],"and")})(n,t):Ww(n,t):t instanceof Kt?Ww(t,n):(function(i,a){if(wt(i.filters.length>0&&a.filters.length>0,48005),xc(i)&&xc(a))return gI(i,a.getFilters());const l=Qy(i)?i:a,u=Qy(i)?a:i,h=l.filters.map((f=>_b(f,u)));return de.create(h,"or")})(n,t),Xm(e)}function Ww(n,t){if(xc(t))return gI(t,n.getFilters());{const e=t.filters.map((s=>_b(n,s)));return de.create(e,"or")}}function Xm(n){if(wt(n instanceof Kt||n instanceof de,11850),n instanceof Kt)return n;const t=n.getFilters();if(t.length===1)return Xm(t[0]);if(fI(n))return n;const e=t.map((i=>Xm(i))),s=[];return e.forEach((i=>{i instanceof Kt?s.push(i):i instanceof de&&(i.op===n.op?s.push(...i.filters):s.push(i))})),s.length===1?s[0]:de.create(s,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4{constructor(){this.Cn=new yb}addToCollectionParentIndex(t,e){return this.Cn.add(e),W.resolve()}getCollectionParents(t,e){return W.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return W.resolve()}deleteFieldIndex(t,e){return W.resolve()}deleteAllFieldIndexes(t){return W.resolve()}createTargetIndexes(t,e){return W.resolve()}getDocumentsMatchingTarget(t,e){return W.resolve(null)}getIndexType(t,e){return W.resolve(0)}getFieldIndexes(t,e){return W.resolve([])}getNextCollectionGroupToUpdate(t){return W.resolve(null)}getMinOffset(t,e){return W.resolve(gs.min())}getMinOffsetFromCollectionGroup(t,e){return W.resolve(gs.min())}updateCollectionGroup(t,e,s){return W.resolve()}updateIndexEntries(t,e){return W.resolve()}}class yb{constructor(){this.index={}}add(t){const e=t.lastSegment(),s=t.popLast(),i=this.index[e]||new fe(Wt.comparator),a=!i.has(s);return this.index[e]=i.add(s),a}has(t){const e=t.lastSegment(),s=t.popLast(),i=this.index[e];return i&&i.has(s)}getEntries(t){return(this.index[t]||new fe(Wt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yw="IndexedDbIndexManager",em=new Uint8Array(0);class V4{constructor(t,e){this.databaseId=e,this.vn=new yb,this.Fn=new ar((s=>Uo(s)),((s,i)=>pd(s,i))),this.uid=t.uid||""}addToCollectionParentIndex(t,e){if(!this.vn.has(e)){const s=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((()=>{this.vn.add(e)}));const a={collectionId:s,parent:Ln(i)};return Kw(t).put(a)}return W.resolve()}getCollectionParents(t,e){const s=[],i=IDBKeyRange.bound([e,""],[P2(e),""],!1,!0);return Kw(t).J(i).next((a=>{for(const l of a){if(l.collectionId!==e)break;s.push(mi(l.parent))}return s}))}addFieldIndex(t,e){const s=eh(t),i=(function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map((h=>[h.fieldPath.canonicalString(),h.kind]))}})(e);delete i.indexId;const a=s.add(i);if(e.indexState){const l=Kl(t);return a.next((u=>{l.put(Fw(u,this.uid,e.indexState.sequenceNumber,e.indexState.offset))}))}return a.next()}deleteFieldIndex(t,e){const s=eh(t),i=Kl(t),a=Yl(t);return s.delete(e.indexId).next((()=>i.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0))))}deleteAllFieldIndexes(t){const e=eh(t),s=Yl(t),i=Kl(t);return e.Z().next((()=>s.Z())).next((()=>i.Z()))}createTargetIndexes(t,e){return W.forEach(this.Mn(e),(s=>this.getIndexType(t,s).next((i=>{if(i===0||i===1){const a=new $w(s).Dn();if(a!=null)return this.addFieldIndex(t,a)}}))))}getDocumentsMatchingTarget(t,e){const s=Yl(t);let i=!0;const a=new Map;return W.forEach(this.Mn(e),(l=>this.xn(t,l).next((u=>{i&&(i=!!u),a.set(l,u)})))).next((()=>{if(i){let l=Ft();const u=[];return W.forEach(a,((h,f)=>{ct(Yw,`Using index ${(function(O){return`id=${O.indexId}|cg=${O.collectionGroup}|f=${O.fields.map((H=>`${H.fieldPath}:${H.kind}`)).join(",")}`})(h)} to execute ${Uo(e)}`);const m=(function(O,H){const B=zy(H);if(B===void 0)return null;for(const z of Ym(O,B.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null})(f,h),_=(function(O,H){const B=new Map;for(const z of Eo(H))for(const D of Ym(O,z.fieldPath))switch(D.op){case"==":case"in":B.set(z.fieldPath.canonicalString(),D.value);break;case"not-in":case"!=":return B.set(z.fieldPath.canonicalString(),D.value),Array.from(B.values())}return null})(f,h),x=(function(O,H){const B=[];let z=!0;for(const D of Eo(H)){const I=D.kind===0?Aw(O,D.fieldPath,O.startAt):Iw(O,D.fieldPath,O.startAt);B.push(I.value),z&&(z=I.inclusive)}return new ba(B,z)})(f,h),E=(function(O,H){const B=[];let z=!0;for(const D of Eo(H)){const I=D.kind===0?Iw(O,D.fieldPath,O.endAt):Aw(O,D.fieldPath,O.endAt);B.push(I.value),z&&(z=I.inclusive)}return new ba(B,z)})(f,h),S=this.On(h,f,x),T=this.On(h,f,E),R=this.Nn(h,f,_),M=this.Bn(h.indexId,m,S,x.inclusive,T,E.inclusive,R);return W.forEach(M,(L=>s.Y(L,e.limit).next((O=>{O.forEach((H=>{const B=pt.fromSegments(H.documentKey);l.has(B)||(l=l.add(B),u.push(B))}))}))))})).next((()=>u))}return W.resolve(null)}))}Mn(t){let e=this.Fn.get(t);return e||(t.filters.length===0?e=[t]:e=O4(de.create(t.filters,"and")).map((s=>Zy(t.path,t.collectionGroup,t.orderBy,s.getFilters(),t.limit,t.startAt,t.endAt))),this.Fn.set(t,e),e)}Bn(t,e,s,i,a,l,u){const h=(e!=null?e.length:1)*Math.max(s.length,a.length),f=h/(e!=null?e.length:1),m=[];for(let _=0;_<h;++_){const x=e?this.Ln(e[_/f]):em,E=this.kn(t,x,s[_%f],i),S=this.qn(t,x,a[_%f],l),T=u.map((R=>this.kn(t,x,R,!0)));m.push(...this.createRange(E,S,T))}return m}kn(t,e,s,i){const a=new Do(t,pt.empty(),e,s);return i?a:a.An()}qn(t,e,s,i){const a=new Do(t,pt.empty(),e,s);return i?a.An():a}xn(t,e){const s=new $w(e),i=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment();return this.getFieldIndexes(t,i).next((a=>{let l=null;for(const u of a)s.yn(u)&&(!l||u.fields.length>l.fields.length)&&(l=u);return l}))}getIndexType(t,e){let s=2;const i=this.Mn(e);return W.forEach(i,(a=>this.xn(t,a).next((l=>{l?s!==0&&l.fields.length<(function(h){let f=new fe(Ne.comparator),m=!1;for(const _ of h.filters)for(const x of _.getFlattenedFilters())x.field.isKeyField()||(x.op==="array-contains"||x.op==="array-contains-any"?m=!0:f=f.add(x.field));for(const _ of h.orderBy)_.field.isKeyField()||(f=f.add(_.field));return f.size+(m?1:0)})(a)&&(s=1):s=0})))).next((()=>(function(l){return l.limit!==null})(e)&&i.length>1&&s===2?1:s))}Qn(t,e){const s=new th;for(const i of Eo(t)){const a=e.data.field(i.fieldPath);if(a==null)return null;const l=s.Pn(i.kind);Ro.Kt.Dt(a,l)}return s.un()}Ln(t){const e=new th;return Ro.Kt.Dt(t,e.Pn(0)),e.un()}$n(t,e){const s=new th;return Ro.Kt.Dt(Fo(this.databaseId,e),s.Pn((function(a){const l=Eo(a);return l.length===0?0:l[l.length-1].kind})(t))),s.un()}Nn(t,e,s){if(s===null)return[];let i=[];i.push(new th);let a=0;for(const l of Eo(t)){const u=s[a++];for(const h of i)if(this.Un(e,l.fieldPath)&&Wh(u))i=this.Kn(i,l,u);else{const f=h.Pn(l.kind);Ro.Kt.Dt(u,f)}}return this.Wn(i)}On(t,e,s){return this.Nn(t,e,s.position)}Wn(t){const e=[];for(let s=0;s<t.length;++s)e[s]=t[s].un();return e}Kn(t,e,s){const i=[...t],a=[];for(const l of s.arrayValue.values||[])for(const u of i){const h=new th;h.seed(u.un()),Ro.Kt.Dt(l,h.Pn(e.kind)),a.push(h)}return a}Un(t,e){return!!t.filters.find((s=>s instanceof Kt&&s.field.isEqual(e)&&(s.op==="in"||s.op==="not-in")))}getFieldIndexes(t,e){const s=eh(t),i=Kl(t);return(e?s.J(qy,IDBKeyRange.bound(e,e)):s.J()).next((a=>{const l=[];return W.forEach(a,(u=>i.get([u.indexId,this.uid]).next((h=>{l.push((function(m,_){const x=_?new Fh(_.sequenceNumber,new gs(Go(_.readTime),new pt(mi(_.documentKey)),_.largestBatchId)):Fh.empty(),E=m.fields.map((([S,T])=>new xm(Ne.fromServerFormat(S),T)));return new Hm(m.indexId,m.collectionGroup,E,x)})(u,h))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(t){return this.getFieldIndexes(t).next((e=>e.length===0?null:(e.sort(((s,i)=>{const a=s.indexState.sequenceNumber-i.indexState.sequenceNumber;return a!==0?a:Vt(s.collectionGroup,i.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(t,e,s){const i=eh(t),a=Kl(t);return this.Gn(t).next((l=>i.J(qy,IDBKeyRange.bound(e,e)).next((u=>W.forEach(u,(h=>a.put(Fw(h.indexId,this.uid,l,s))))))))}updateIndexEntries(t,e){const s=new Map;return W.forEach(e,((i,a)=>{const l=s.get(i.collectionGroup);return(l?W.resolve(l):this.getFieldIndexes(t,i.collectionGroup)).next((u=>(s.set(i.collectionGroup,u),W.forEach(u,(h=>this.zn(t,i,h).next((f=>{const m=this.jn(a,h);return f.isEqual(m)?W.resolve():this.Jn(t,a,h,f,m)})))))))}))}Hn(t,e,s,i){return Yl(t).put(i.Rn(this.uid,this.$n(s,e.key),e.key))}Yn(t,e,s,i){return Yl(t).delete(i.Vn(this.uid,this.$n(s,e.key),e.key))}zn(t,e,s){const i=Yl(t);let a=new fe(Kr);return i.ee({index:Q2,range:IDBKeyRange.only([s.indexId,this.uid,Rm(this.$n(s,e))])},((l,u)=>{a=a.add(new Do(s.indexId,e,Gw(u.arrayValue),Gw(u.directionalValue)))})).next((()=>a))}jn(t,e){let s=new fe(Kr);const i=this.Qn(e,t);if(i==null)return s;const a=zy(e);if(a!=null){const l=t.data.field(a.fieldPath);if(Wh(l))for(const u of l.arrayValue.values||[])s=s.add(new Do(e.indexId,t.key,this.Ln(u),i))}else s=s.add(new Do(e.indexId,t.key,em,i));return s}Jn(t,e,s,i,a){ct(Yw,"Updating index entries for document '%s'",e.key);const l=[];return(function(h,f,m,_,x){const E=h.getIterator(),S=f.getIterator();let T=$l(E),R=$l(S);for(;T||R;){let M=!1,L=!1;if(T&&R){const O=m(T,R);O<0?L=!0:O>0&&(M=!0)}else T!=null?L=!0:M=!0;M?(_(R),R=$l(S)):L?(x(T),T=$l(E)):(T=$l(E),R=$l(S))}})(i,a,Kr,(u=>{l.push(this.Hn(t,e,s,u))}),(u=>{l.push(this.Yn(t,e,s,u))})),W.waitFor(l)}Gn(t){let e=1;return Kl(t).ee({index:K2,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((s,i,a)=>{a.done(),e=i.sequenceNumber+1})).next((()=>e))}createRange(t,e,s){s=s.sort(((l,u)=>Kr(l,u))).filter(((l,u,h)=>!u||Kr(l,h[u-1])!==0));const i=[];i.push(t);for(const l of s){const u=Kr(l,t),h=Kr(l,e);if(u===0)i[0]=t.An();else if(u>0&&h<0)i.push(l),i.push(l.An());else if(h>0)break}i.push(e);const a=[];for(let l=0;l<i.length;l+=2){if(this.Zn(i[l],i[l+1]))return[];const u=i[l].Vn(this.uid,em,pt.empty()),h=i[l+1].Vn(this.uid,em,pt.empty());a.push(IDBKeyRange.bound(u,h))}return a}Zn(t,e){return Kr(t,e)>0}getMinOffsetFromCollectionGroup(t,e){return this.getFieldIndexes(t,e).next(Qw)}getMinOffset(t,e){return W.mapArray(this.Mn(e),(s=>this.xn(t,s).next((i=>i||vt(44426))))).next(Qw)}}function Kw(n){return un(n,qh)}function Yl(n){return un(n,Ih)}function eh(n){return un(n,eb)}function Kl(n){return un(n,Ah)}function Qw(n){wt(n.length!==0,28825);let t=n[0].indexState.offset,e=t.largestBatchId;for(let s=1;s<n.length;s++){const i=n[s].indexState.offset;Z0(i,t)<0&&(t=i),e<i.largestBatchId&&(e=i.largestBatchId)}return new gs(t.readTime,t.documentKey,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},eR=41943040;class On{static withCacheSize(t){return new On(t,On.DEFAULT_COLLECTION_PERCENTILE,On.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,s){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nR(n,t,e){const s=n.store(Hs),i=n.store(mc),a=[],l=IDBKeyRange.only(e.batchId);let u=0;const h=s.ee({range:l},((m,_,x)=>(u++,x.delete())));a.push(h.next((()=>{wt(u===1,47070,{batchId:e.batchId})})));const f=[];for(const m of e.mutations){const _=$2(t,m.key.path,e.batchId);a.push(i.delete(_)),f.push(m.key)}return W.waitFor(a).next((()=>f))}function Zm(n){if(!n)return 0;let t;if(n.document)t=n.document;else if(n.unknownDocument)t=n.unknownDocument;else{if(!n.noDocument)throw vt(14731);t=n.noDocument}return JSON.stringify(t).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */On.DEFAULT_COLLECTION_PERCENTILE=10,On.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,On.DEFAULT=new On(eR,On.DEFAULT_COLLECTION_PERCENTILE,On.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),On.DISABLED=new On(-1,0,0);class Mg{constructor(t,e,s,i){this.userId=t,this.serializer=e,this.indexManager=s,this.referenceDelegate=i,this.Xn={}}static wt(t,e,s,i){wt(t.uid!=="",64387);const a=t.isAuthenticated()?t.uid:"";return new Mg(a,e,s,i)}checkEmpty(t){let e=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Qr(t).ee({index:Co,range:s},((i,a,l)=>{e=!1,l.done()})).next((()=>e))}addMutationBatch(t,e,s,i){const a=sc(t),l=Qr(t);return l.add({}).next((u=>{wt(typeof u=="number",49019);const h=new hb(u,e,s,i),f=(function(E,S,T){const R=T.baseMutations.map((L=>Qh(E.yt,L))),M=T.mutations.map((L=>Qh(E.yt,L)));return{userId:S,batchId:T.batchId,localWriteTimeMs:T.localWriteTime.toMillis(),baseMutations:R,mutations:M}})(this.serializer,this.userId,h),m=[];let _=new fe(((x,E)=>Vt(x.canonicalString(),E.canonicalString())));for(const x of i){const E=$2(this.userId,x.key.path,u);_=_.add(x.key.path.popLast()),m.push(l.put(f)),m.push(a.put(E,gk))}return _.forEach((x=>{m.push(this.indexManager.addToCollectionParentIndex(t,x))})),t.addOnCommittedListener((()=>{this.Xn[u]=h.keys()})),W.waitFor(m).next((()=>h))}))}lookupMutationBatch(t,e){return Qr(t).get(e).next((s=>s?(wt(s.userId===this.userId,48,"Unexpected user for mutation batch",{userId:s.userId,batchId:e}),Io(this.serializer,s)):null))}er(t,e){return this.Xn[e]?W.resolve(this.Xn[e]):this.lookupMutationBatch(t,e).next((s=>{if(s){const i=s.keys();return this.Xn[e]=i,i}return null}))}getNextMutationBatchAfterBatchId(t,e){const s=e+1,i=IDBKeyRange.lowerBound([this.userId,s]);let a=null;return Qr(t).ee({index:Co,range:i},((l,u,h)=>{u.userId===this.userId&&(wt(u.batchId>=s,47524,{tr:s}),a=Io(this.serializer,u)),h.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(t){const e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=ca;return Qr(t).ee({index:Co,range:e,reverse:!0},((i,a,l)=>{s=a.batchId,l.done()})).next((()=>s))}getAllMutationBatches(t){const e=IDBKeyRange.bound([this.userId,ca],[this.userId,Number.POSITIVE_INFINITY]);return Qr(t).J(Co,e).next((s=>s.map((i=>Io(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(t,e){const s=vm(this.userId,e.path),i=IDBKeyRange.lowerBound(s),a=[];return sc(t).ee({range:i},((l,u,h)=>{const[f,m,_]=l,x=mi(m);if(f===this.userId&&e.path.isEqual(x))return Qr(t).get(_).next((E=>{if(!E)throw vt(61480,{nr:l,batchId:_});wt(E.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:E.userId,batchId:_}),a.push(Io(this.serializer,E))}));h.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(t,e){let s=new fe(Vt);const i=[];return e.forEach((a=>{const l=vm(this.userId,a.path),u=IDBKeyRange.lowerBound(l),h=sc(t).ee({range:u},((f,m,_)=>{const[x,E,S]=f,T=mi(E);x===this.userId&&a.path.isEqual(T)?s=s.add(S):_.done()}));i.push(h)})),W.waitFor(i).next((()=>this.rr(t,s)))}getAllMutationBatchesAffectingQuery(t,e){const s=e.path,i=s.length+1,a=vm(this.userId,s),l=IDBKeyRange.lowerBound(a);let u=new fe(Vt);return sc(t).ee({range:l},((h,f,m)=>{const[_,x,E]=h,S=mi(x);_===this.userId&&s.isPrefixOf(S)?S.length===i&&(u=u.add(E)):m.done()})).next((()=>this.rr(t,u)))}rr(t,e){const s=[],i=[];return e.forEach((a=>{i.push(Qr(t).get(a).next((l=>{if(l===null)throw vt(35274,{batchId:a});wt(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:a}),s.push(Io(this.serializer,l))})))})),W.waitFor(i).next((()=>s))}removeMutationBatch(t,e){return nR(t.le,this.userId,e).next((s=>(t.addOnCommittedListener((()=>{this.ir(e.batchId)})),W.forEach(s,(i=>this.referenceDelegate.markPotentiallyOrphaned(t,i))))))}ir(t){delete this.Xn[t]}performConsistencyCheck(t){return this.checkEmpty(t).next((e=>{if(!e)return W.resolve();const s=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),i=[];return sc(t).ee({range:s},((a,l,u)=>{if(a[0]===this.userId){const h=mi(a[1]);i.push(h)}else u.done()})).next((()=>{wt(i.length===0,56720,{sr:i.map((a=>a.canonicalString()))})}))}))}containsKey(t,e){return sR(t,this.userId,e)}_r(t){return iR(t).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:ca,lastStreamToken:""}))}}function sR(n,t,e){const s=vm(t,e.path),i=s[1],a=IDBKeyRange.lowerBound(s);let l=!1;return sc(n).ee({range:a,X:!0},((u,h,f)=>{const[m,_,x]=u;m===t&&_===i&&(l=!0),f.done()})).next((()=>l))}function Qr(n){return un(n,Hs)}function sc(n){return un(n,mc)}function iR(n){return un(n,zh)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new $o(0)}static cr(){return new $o(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P4{constructor(t,e){this.referenceDelegate=t,this.serializer=e}allocateTargetId(t){return this.lr(t).next((e=>{const s=new $o(e.highestTargetId);return e.highestTargetId=s.next(),this.hr(t,e).next((()=>e.highestTargetId))}))}getLastRemoteSnapshotVersion(t){return this.lr(t).next((e=>Rt.fromTimestamp(new oe(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(t){return this.lr(t).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(t,e,s){return this.lr(t).next((i=>(i.highestListenSequenceNumber=e,s&&(i.lastRemoteSnapshotVersion=s.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),this.hr(t,i))))}addTargetData(t,e){return this.Pr(t,e).next((()=>this.lr(t).next((s=>(s.targetCount+=1,this.Tr(e,s),this.hr(t,s))))))}updateTargetData(t,e){return this.Pr(t,e)}removeTargetData(t,e){return this.removeMatchingKeysForTargetId(t,e.targetId).next((()=>Ql(t).delete(e.targetId))).next((()=>this.lr(t))).next((s=>(wt(s.targetCount>0,8065),s.targetCount-=1,this.hr(t,s))))}removeTargets(t,e,s){let i=0;const a=[];return Ql(t).ee(((l,u)=>{const h=fh(u);h.sequenceNumber<=e&&s.get(h.targetId)===null&&(i++,a.push(this.removeTargetData(t,h)))})).next((()=>W.waitFor(a))).next((()=>i))}forEachTarget(t,e){return Ql(t).ee(((s,i)=>{const a=fh(i);e(a)}))}lr(t){return Zw(t).get($m).next((e=>(wt(e!==null,2888),e)))}hr(t,e){return Zw(t).put($m,e)}Pr(t,e){return Ql(t).put(ZI(this.serializer,e))}Tr(t,e){let s=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,s=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,s=!0),s}getTargetCount(t){return this.lr(t).next((e=>e.targetCount))}getTargetData(t,e){const s=Uo(e),i=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let a=null;return Ql(t).ee({range:i,index:Y2},((l,u,h)=>{const f=fh(u);pd(e,f.target)&&(a=f,h.done())})).next((()=>a))}addMatchingKeys(t,e,s){const i=[],a=ta(t);return e.forEach((l=>{const u=Ln(l.path);i.push(a.put({targetId:s,path:u})),i.push(this.referenceDelegate.addReference(t,s,l))})),W.waitFor(i)}removeMatchingKeys(t,e,s){const i=ta(t);return W.forEach(e,(a=>{const l=Ln(a.path);return W.waitFor([i.delete([s,l]),this.referenceDelegate.removeReference(t,s,a)])}))}removeMatchingKeysForTargetId(t,e){const s=ta(t),i=IDBKeyRange.bound([e],[e+1],!1,!0);return s.delete(i)}getMatchingKeysForTargetId(t,e){const s=IDBKeyRange.bound([e],[e+1],!1,!0),i=ta(t);let a=Ft();return i.ee({range:s,X:!0},((l,u,h)=>{const f=mi(l[1]),m=new pt(f);a=a.add(m)})).next((()=>a))}containsKey(t,e){const s=Ln(e.path),i=IDBKeyRange.bound([s],[P2(s)],!1,!0);let a=0;return ta(t).ee({index:tb,X:!0,range:i},(([l,u],h,f)=>{l!==0&&(a++,f.done())})).next((()=>a>0))}At(t,e){return Ql(t).get(e).next((s=>s?fh(s):null))}}function Ql(n){return un(n,gc)}function Zw(n){return un(n,Po)}function ta(n){return un(n,pc)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw="LruGarbageCollector",L4=1048576;function t1([n,t],[e,s]){const i=Vt(n,e);return i===0?Vt(t,s):i}class j4{constructor(t){this.Ir=t,this.buffer=new fe(t1),this.Er=0}dr(){return++this.Er}Ar(t){const e=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(e);else{const s=this.buffer.last();t1(e,s)<0&&(this.buffer=this.buffer.delete(s).add(e))}}get maxValue(){return this.buffer.last()[0]}}class rR{constructor(t,e,s){this.garbageCollector=t,this.asyncQueue=e,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){ct(Jw,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Ra(e)?ct(Jw,"Ignoring IndexedDB error during garbage collection: ",e):await Ia(e)}await this.Vr(3e5)}))}}class B4{constructor(t,e){this.mr=t,this.params=e}calculateTargetCount(t,e){return this.mr.gr(t).next((s=>Math.floor(e/100*s)))}nthSequenceNumber(t,e){if(e===0)return W.resolve(es.ce);const s=new j4(e);return this.mr.forEachTarget(t,(i=>s.Ar(i.sequenceNumber))).next((()=>this.mr.pr(t,(i=>s.Ar(i))))).next((()=>s.maxValue))}removeTargets(t,e,s){return this.mr.removeTargets(t,e,s)}removeOrphanedDocuments(t,e){return this.mr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(ct("LruGarbageCollector","Garbage collection skipped; disabled"),W.resolve(Xw)):this.getCacheSize(t).next((s=>s<this.params.cacheSizeCollectionThreshold?(ct("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Xw):this.yr(t,e)))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,e){let s,i,a,l,u,h,f;const m=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(ct("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),i=this.params.maximumSequenceNumbersToCollect):i=_,l=Date.now(),this.nthSequenceNumber(t,i)))).next((_=>(s=_,u=Date.now(),this.removeTargets(t,s,e)))).next((_=>(a=_,h=Date.now(),this.removeOrphanedDocuments(t,s)))).next((_=>(f=Date.now(),Jl()<=Xt.DEBUG&&ct("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-m}ms
	Determined least recently used ${i} in `+(u-l)+`ms
	Removed ${a} targets in `+(h-u)+`ms
	Removed ${_} documents in `+(f-h)+`ms
Total Duration: ${f-m}ms`),W.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:_}))))}}function aR(n,t){return new B4(n,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(t,e){this.db=t,this.garbageCollector=aR(this,e)}gr(t){const e=this.wr(t);return this.db.getTargetCache().getTargetCount(t).next((s=>e.next((i=>s+i))))}wr(t){let e=0;return this.pr(t,(s=>{e++})).next((()=>e))}forEachTarget(t,e){return this.db.getTargetCache().forEachTarget(t,e)}pr(t,e){return this.Sr(t,((s,i)=>e(i)))}addReference(t,e,s){return nm(t,s)}removeReference(t,e,s){return nm(t,s)}removeTargets(t,e,s){return this.db.getTargetCache().removeTargets(t,e,s)}markPotentiallyOrphaned(t,e){return nm(t,e)}br(t,e){return(function(i,a){let l=!1;return iR(i).te((u=>sR(i,u,a).next((h=>(h&&(l=!0),W.resolve(!h)))))).next((()=>l))})(t,e)}removeOrphanedDocuments(t,e){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Sr(t,((l,u)=>{if(u<=e){const h=this.br(t,l).next((f=>{if(!f)return a++,s.getEntry(t,l).next((()=>(s.removeEntry(l,Rt.min()),ta(t).delete((function(_){return[0,Ln(_.path)]})(l)))))}));i.push(h)}})).next((()=>W.waitFor(i))).next((()=>s.apply(t))).next((()=>a))}removeTarget(t,e){const s=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,s)}updateLimboDocument(t,e){return nm(t,e)}Sr(t,e){const s=ta(t);let i,a=es.ce;return s.ee({index:tb},(([l,u],{path:h,sequenceNumber:f})=>{l===0?(a!==es.ce&&e(new pt(mi(i)),a),a=f,i=h):a=es.ce})).next((()=>{a!==es.ce&&e(new pt(mi(i)),a)}))}getCacheSize(t){return this.db.getRemoteDocumentCache().getSize(t)}}function nm(n,t){return ta(n).put((function(s,i){return{targetId:0,path:Ln(s.path),sequenceNumber:i}})(t,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR{constructor(){this.changes=new ar((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Se.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const s=this.changes.get(e);return s!==void 0?W.resolve(s):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U4{constructor(t){this.serializer=t}setIndexManager(t){this.indexManager=t}addEntry(t,e,s){return po(t).put(s)}removeEntry(t,e,s){return po(t).delete((function(a,l){const u=a.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],Qm(l),u[u.length-1]]})(e,s))}updateMetadata(t,e){return this.getMetadata(t).next((s=>(s.byteSize+=e,this.Dr(t,s))))}getEntry(t,e){let s=Se.newInvalidDocument(e);return po(t).ee({index:Em,range:IDBKeyRange.only(nh(e))},((i,a)=>{s=this.Cr(e,a)})).next((()=>s))}vr(t,e){let s={size:0,document:Se.newInvalidDocument(e)};return po(t).ee({index:Em,range:IDBKeyRange.only(nh(e))},((i,a)=>{s={document:this.Cr(e,a),size:Zm(a)}})).next((()=>s))}getEntries(t,e){let s=ss();return this.Fr(t,e,((i,a)=>{const l=this.Cr(i,a);s=s.insert(i,l)})).next((()=>s))}Mr(t,e){let s=ss(),i=new Te(pt.comparator);return this.Fr(t,e,((a,l)=>{const u=this.Cr(a,l);s=s.insert(a,u),i=i.insert(a,Zm(l))})).next((()=>({documents:s,Or:i})))}Fr(t,e,s){if(e.isEmpty())return W.resolve();let i=new fe(s1);e.forEach((h=>i=i.add(h)));const a=IDBKeyRange.bound(nh(i.first()),nh(i.last())),l=i.getIterator();let u=l.getNext();return po(t).ee({index:Em,range:a},((h,f,m)=>{const _=pt.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;u&&s1(u,_)<0;)s(u,null),u=l.getNext();u&&u.isEqual(_)&&(s(u,f),u=l.hasNext()?l.getNext():null),u?m.j(nh(u)):m.done()})).next((()=>{for(;u;)s(u,null),u=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(t,e,s,i,a){const l=e.path,u=[l.popLast().toArray(),l.lastSegment(),Qm(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],h=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return po(t).J(IDBKeyRange.bound(u,h,!0)).next((f=>{a==null||a.incrementDocumentReadCount(f.length);let m=ss();for(const _ of f){const x=this.Cr(pt.fromSegments(_.prefixPath.concat(_.collectionGroup,_.documentId)),_);x.isFoundDocument()&&(yd(e,x)||i.has(x.key))&&(m=m.insert(x.key,x))}return m}))}getAllFromCollectionGroup(t,e,s,i){let a=ss();const l=n1(e,s),u=n1(e,gs.max());return po(t).ee({index:W2,range:IDBKeyRange.bound(l,u,!0)},((h,f,m)=>{const _=this.Cr(pt.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);a=a.insert(_.key,_),a.size===i&&m.done()})).next((()=>a))}newChangeBuffer(t){return new z4(this,!!t&&t.trackRemovals)}getSize(t){return this.getMetadata(t).next((e=>e.byteSize))}getMetadata(t){return e1(t).get(Hy).next((e=>(wt(!!e,20021),e)))}Dr(t,e){return e1(t).put(Hy,e)}Cr(t,e){if(e){const s=A4(this.serializer,e);if(!(s.isNoDocument()&&s.version.isEqual(Rt.min())))return s}return Se.newInvalidDocument(t)}}function lR(n){return new U4(n)}class z4 extends oR{constructor(t,e){super(),this.Nr=t,this.trackRemovals=e,this.Br=new ar((s=>s.toString()),((s,i)=>s.isEqual(i)))}applyChanges(t){const e=[];let s=0,i=new fe(((a,l)=>Vt(a.canonicalString(),l.canonicalString())));return this.changes.forEach(((a,l)=>{const u=this.Br.get(a);if(e.push(this.Nr.removeEntry(t,a,u.readTime)),l.isValidDocument()){const h=jw(this.Nr.serializer,l);i=i.add(a.path.popLast());const f=Zm(h);s+=f-u.size,e.push(this.Nr.addEntry(t,a,h))}else if(s-=u.size,this.trackRemovals){const h=jw(this.Nr.serializer,l.convertToNoDocument(Rt.min()));e.push(this.Nr.addEntry(t,a,h))}})),i.forEach((a=>{e.push(this.Nr.indexManager.addToCollectionParentIndex(t,a))})),e.push(this.Nr.updateMetadata(t,s)),W.waitFor(e)}getFromCache(t,e){return this.Nr.vr(t,e).next((s=>(this.Br.set(e,{size:s.size,readTime:s.document.readTime}),s.document)))}getAllFromCache(t,e){return this.Nr.Mr(t,e).next((({documents:s,Or:i})=>(i.forEach(((a,l)=>{this.Br.set(a,{size:l,readTime:s.get(a).readTime})})),s)))}}function e1(n){return un(n,Hh)}function po(n){return un(n,Gm)}function nh(n){const t=n.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function n1(n,t){const e=t.documentKey.path.toArray();return[n,Qm(t.readTime),e.slice(0,e.length-2),e.length>0?e[e.length-1]:""]}function s1(n,t){const e=n.path.toArray(),s=t.path.toArray();let i=0;for(let a=0;a<e.length-2&&a<s.length-2;++a)if(i=Vt(e[a],s[a]),i)return i;return i=Vt(e.length,s.length),i||(i=Vt(e[e.length-2],s[s.length-2]),i||Vt(e[e.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(t,e,s,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=s,this.indexManager=i}getDocument(t,e){let s=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(s=i,this.remoteDocumentCache.getEntry(t,e)))).next((i=>(s!==null&&Nh(s.mutation,i,ns.empty(),oe.now()),i)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((s=>this.getLocalViewOfDocuments(t,s,Ft()).next((()=>s))))}getLocalViewOfDocuments(t,e,s=Ft()){const i=gi();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,s).next((a=>{let l=hh();return a.forEach(((u,h)=>{l=l.insert(u,h.overlayedDocument)})),l}))))}getOverlayedDocuments(t,e){const s=gi();return this.populateOverlays(t,s,e).next((()=>this.computeViews(t,e,s,Ft())))}populateOverlays(t,e,s){const i=[];return s.forEach((a=>{e.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(t,i).next((a=>{a.forEach(((l,u)=>{e.set(l,u)}))}))}computeViews(t,e,s,i){let a=ss();const l=Dh(),u=(function(){return Dh()})();return e.forEach(((h,f)=>{const m=s.get(f.key);i.has(f.key)&&(m===void 0||m.mutation instanceof or)?a=a.insert(f.key,f):m!==void 0?(l.set(f.key,m.mutation.getFieldMask()),Nh(m.mutation,f,m.mutation.getFieldMask(),oe.now())):l.set(f.key,ns.empty())})),this.recalculateAndSaveOverlays(t,a).next((h=>(h.forEach(((f,m)=>l.set(f,m))),e.forEach(((f,m)=>u.set(f,new H4(m,l.get(f)??null)))),u)))}recalculateAndSaveOverlays(t,e){const s=Dh();let i=new Te(((l,u)=>l-u)),a=Ft();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((l=>{for(const u of l)u.keys().forEach((h=>{const f=e.get(h);if(f===null)return;let m=s.get(h)||ns.empty();m=u.applyToLocalView(f,m),s.set(h,m);const _=(i.get(u.batchId)||Ft()).add(h);i=i.insert(u.batchId,_)}))})).next((()=>{const l=[],u=i.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),f=h.key,m=h.value,_=SI();m.forEach((x=>{if(!a.has(x)){const E=MI(e.get(x),s.get(x));E!==null&&_.set(x,E),a=a.add(x)}})),l.push(this.documentOverlayCache.saveOverlays(t,f,_))}return W.waitFor(l)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((s=>this.recalculateAndSaveOverlays(t,s)))}getDocumentsMatchingQuery(t,e,s,i){return(function(l){return pt.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):ob(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,s,i):this.getDocumentsMatchingCollectionQuery(t,e,s,i)}getNextDocuments(t,e,s,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,s,i).next((a=>{const l=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,s.largestBatchId,i-a.size):W.resolve(gi());let u=fc,h=a;return l.next((f=>W.forEach(f,((m,_)=>(u<_.largestBatchId&&(u=_.largestBatchId),a.get(m)?W.resolve():this.remoteDocumentCache.getEntry(t,m).next((x=>{h=h.insert(m,x)}))))).next((()=>this.populateOverlays(t,f,a))).next((()=>this.computeViews(t,h,f,Ft()))).next((m=>({batchId:u,changes:wI(m)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new pt(e)).next((s=>{let i=hh();return s.isFoundDocument()&&(i=i.insert(s.key,s)),i}))}getDocumentsMatchingCollectionGroupQuery(t,e,s,i){const a=e.collectionGroup;let l=hh();return this.indexManager.getCollectionParents(t,a).next((u=>W.forEach(u,(h=>{const f=(function(_,x){return new rr(x,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(e,h.child(a));return this.getDocumentsMatchingCollectionQuery(t,f,s,i).next((m=>{m.forEach(((_,x)=>{l=l.insert(_,x)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(t,e,s,i){let a;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,s.largestBatchId).next((l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,s,a,i)))).next((l=>{a.forEach(((h,f)=>{const m=f.getKey();l.get(m)===null&&(l=l.insert(m,Se.newInvalidDocument(m)))}));let u=hh();return l.forEach(((h,f)=>{const m=a.get(h);m!==void 0&&Nh(m.mutation,f,ns.empty(),oe.now()),yd(e,f)&&(u=u.insert(h,f))})),u}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,e){return W.resolve(this.Lr.get(e))}saveBundleMetadata(t,e){return this.Lr.set(e.id,(function(i){return{id:i.id,version:i.version,createTime:Ke(i.createTime)}})(e)),W.resolve()}getNamedQuery(t,e){return W.resolve(this.kr.get(e))}saveNamedQuery(t,e){return this.kr.set(e.name,(function(i){return{name:i.name,query:pb(i.bundledQuery),readTime:Ke(i.readTime)}})(e)),W.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(){this.overlays=new Te(pt.comparator),this.qr=new Map}getOverlay(t,e){return W.resolve(this.overlays.get(e))}getOverlays(t,e){const s=gi();return W.forEach(e,(i=>this.getOverlay(t,i).next((a=>{a!==null&&s.set(i,a)})))).next((()=>s))}saveOverlays(t,e,s){return s.forEach(((i,a)=>{this.St(t,e,a)})),W.resolve()}removeOverlaysForBatchId(t,e,s){const i=this.qr.get(s);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(s)),W.resolve()}getOverlaysForCollection(t,e,s){const i=gi(),a=e.length+1,l=new pt(e.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const h=u.getNext().value,f=h.getKey();if(!e.isPrefixOf(f.path))break;f.path.length===a&&h.largestBatchId>s&&i.set(h.getKey(),h)}return W.resolve(i)}getOverlaysForCollectionGroup(t,e,s,i){let a=new Te(((f,m)=>f-m));const l=this.overlays.getIterator();for(;l.hasNext();){const f=l.getNext().value;if(f.getKey().getCollectionGroup()===e&&f.largestBatchId>s){let m=a.get(f.largestBatchId);m===null&&(m=gi(),a=a.insert(f.largestBatchId,m)),m.set(f.getKey(),f)}}const u=gi(),h=a.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((f,m)=>u.set(f,m))),!(u.size()>=i)););return W.resolve(u)}St(t,e,s){const i=this.overlays.get(s.key);if(i!==null){const l=this.qr.get(i.largestBatchId).delete(s.key);this.qr.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(s.key,new fb(e,s));let a=this.qr.get(e);a===void 0&&(a=Ft(),this.qr.set(e,a)),this.qr.set(e,a.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{constructor(){this.sessionToken=Be.EMPTY_BYTE_STRING}getSessionToken(t){return W.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,W.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{constructor(){this.Qr=new fe(pn.$r),this.Ur=new fe(pn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,e){const s=new pn(t,e);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(t,e){t.forEach((s=>this.addReference(s,e)))}removeReference(t,e){this.Gr(new pn(t,e))}zr(t,e){t.forEach((s=>this.removeReference(s,e)))}jr(t){const e=new pt(new Wt([])),s=new pn(e,t),i=new pn(e,t+1),a=[];return this.Ur.forEachInRange([s,i],(l=>{this.Gr(l),a.push(l.key)})),a}Jr(){this.Qr.forEach((t=>this.Gr(t)))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const e=new pt(new Wt([])),s=new pn(e,t),i=new pn(e,t+1);let a=Ft();return this.Ur.forEachInRange([s,i],(l=>{a=a.add(l.key)})),a}containsKey(t){const e=new pn(t,0),s=this.Qr.firstAfterOrEqual(e);return s!==null&&t.isEqual(s.key)}}class pn{constructor(t,e){this.key=t,this.Yr=e}static $r(t,e){return pt.comparator(t.key,e.key)||Vt(t.Yr,e.Yr)}static Kr(t,e){return Vt(t.Yr,e.Yr)||pt.comparator(t.key,e.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.tr=1,this.Zr=new fe(pn.$r)}checkEmpty(t){return W.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,s,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new hb(a,e,s,i);this.mutationQueue.push(l);for(const u of i)this.Zr=this.Zr.add(new pn(u.key,a)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast());return W.resolve(l)}lookupMutationBatch(t,e){return W.resolve(this.Xr(e))}getNextMutationBatchAfterBatchId(t,e){const s=e+1,i=this.ei(s),a=i<0?0:i;return W.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return W.resolve(this.mutationQueue.length===0?ca:this.tr-1)}getAllMutationBatches(t){return W.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const s=new pn(e,0),i=new pn(e,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([s,i],(l=>{const u=this.Xr(l.Yr);a.push(u)})),W.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(t,e){let s=new fe(Vt);return e.forEach((i=>{const a=new pn(i,0),l=new pn(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,l],(u=>{s=s.add(u.Yr)}))})),W.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(t,e){const s=e.path,i=s.length+1;let a=s;pt.isDocumentKey(a)||(a=a.child(""));const l=new pn(new pt(a),0);let u=new fe(Vt);return this.Zr.forEachWhile((h=>{const f=h.key.path;return!!s.isPrefixOf(f)&&(f.length===i&&(u=u.add(h.Yr)),!0)}),l),W.resolve(this.ti(u))}ti(t){const e=[];return t.forEach((s=>{const i=this.Xr(s);i!==null&&e.push(i)})),e}removeMutationBatch(t,e){wt(this.ni(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return W.forEach(e.mutations,(i=>{const a=new pn(i.key,e.batchId);return s=s.delete(a),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.Zr=s}))}ir(t){}containsKey(t,e){const s=new pn(e,0),i=this.Zr.firstAfterOrEqual(s);return W.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,W.resolve()}ni(t,e){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const e=this.ei(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(t){this.ri=t,this.docs=(function(){return new Te(pt.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const s=e.key,i=this.docs.get(s),a=i?i.size:0,l=this.ri(e);return this.docs=this.docs.insert(s,{document:e.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(t,s.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const s=this.docs.get(e);return W.resolve(s?s.document.mutableCopy():Se.newInvalidDocument(e))}getEntries(t,e){let s=ss();return e.forEach((i=>{const a=this.docs.get(i);s=s.insert(i,a?a.document.mutableCopy():Se.newInvalidDocument(i))})),W.resolve(s)}getDocumentsMatchingQuery(t,e,s,i){let a=ss();const l=e.path,u=new pt(l.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:f,value:{document:m}}=h.getNext();if(!l.isPrefixOf(f.path))break;f.path.length>l.length+1||Z0(U2(m),s)<=0||(i.has(m.key)||yd(e,m))&&(a=a.insert(m.key,m.mutableCopy()))}return W.resolve(a)}getAllFromCollectionGroup(t,e,s,i){vt(9500)}ii(t,e){return W.forEach(this.docs,(s=>e(s)))}newChangeBuffer(t){return new K4(this)}getSize(t){return W.resolve(this.size)}}class K4 extends oR{constructor(t){super(),this.Nr=t}applyChanges(t){const e=[];return this.changes.forEach(((s,i)=>{i.isValidDocument()?e.push(this.Nr.addEntry(t,i)):this.Nr.removeEntry(s)})),W.waitFor(e)}getFromCache(t,e){return this.Nr.getEntry(t,e)}getAllFromCache(t,e){return this.Nr.getEntries(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(t){this.persistence=t,this.si=new ar((e=>Uo(e)),pd),this.lastRemoteSnapshotVersion=Rt.min(),this.highestTargetId=0,this.oi=0,this._i=new bb,this.targetCount=0,this.ai=$o.ur()}forEachTarget(t,e){return this.si.forEach(((s,i)=>e(i))),W.resolve()}getLastRemoteSnapshotVersion(t){return W.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return W.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),W.resolve(this.highestTargetId)}setTargetsMetadata(t,e,s){return s&&(this.lastRemoteSnapshotVersion=s),e>this.oi&&(this.oi=e),W.resolve()}Pr(t){this.si.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ai=new $o(e),this.highestTargetId=e),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,e){return this.Pr(e),this.targetCount+=1,W.resolve()}updateTargetData(t,e){return this.Pr(e),W.resolve()}removeTargetData(t,e){return this.si.delete(e.target),this._i.jr(e.targetId),this.targetCount-=1,W.resolve()}removeTargets(t,e,s){let i=0;const a=[];return this.si.forEach(((l,u)=>{u.sequenceNumber<=e&&s.get(u.targetId)===null&&(this.si.delete(l),a.push(this.removeMatchingKeysForTargetId(t,u.targetId)),i++)})),W.waitFor(a).next((()=>i))}getTargetCount(t){return W.resolve(this.targetCount)}getTargetData(t,e){const s=this.si.get(e)||null;return W.resolve(s)}addMatchingKeys(t,e,s){return this._i.Wr(e,s),W.resolve()}removeMatchingKeys(t,e,s){this._i.zr(e,s);const i=this.persistence.referenceDelegate,a=[];return i&&e.forEach((l=>{a.push(i.markPotentiallyOrphaned(t,l))})),W.waitFor(a)}removeMatchingKeysForTargetId(t,e){return this._i.jr(e),W.resolve()}getMatchingKeysForTargetId(t,e){const s=this._i.Hr(e);return W.resolve(s)}containsKey(t,e){return W.resolve(this._i.containsKey(e))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{constructor(t,e){this.ui={},this.overlays={},this.ci=new es(0),this.li=!1,this.li=!0,this.hi=new $4,this.referenceDelegate=t(this),this.Pi=new Q4(this),this.indexManager=new k4,this.remoteDocumentCache=(function(i){return new Y4(i)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new XI(e),this.Ii=new q4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new G4,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let s=this.ui[t.toKey()];return s||(s=new W4(e,this.referenceDelegate),this.ui[t.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,e,s){ct("MemoryPersistence","Starting transaction:",t);const i=new X4(this.ci.next());return this.referenceDelegate.Ei(),s(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(t,e){return W.or(Object.values(this.ui).map((s=>()=>s.containsKey(t,e))))}}class X4 extends H2{constructor(t){super(),this.currentSequenceNumber=t}}class Og{constructor(t){this.persistence=t,this.Ri=new bb,this.Vi=null}static mi(t){return new Og(t)}get fi(){if(this.Vi)return this.Vi;throw vt(60996)}addReference(t,e,s){return this.Ri.addReference(s,e),this.fi.delete(s.toString()),W.resolve()}removeReference(t,e,s){return this.Ri.removeReference(s,e),this.fi.add(s.toString()),W.resolve()}markPotentiallyOrphaned(t,e){return this.fi.add(e.toString()),W.resolve()}removeTarget(t,e){this.Ri.jr(e.targetId).forEach((i=>this.fi.add(i.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(t,e.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>s.removeTargetData(t,e)))}Ei(){this.Vi=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return W.forEach(this.fi,(s=>{const i=pt.fromPath(s);return this.gi(t,i).next((a=>{a||e.removeEntry(i,Rt.min())}))})).next((()=>(this.Vi=null,e.apply(t))))}updateLimboDocument(t,e){return this.gi(t,e).next((s=>{s?this.fi.delete(e.toString()):this.fi.add(e.toString())}))}Ti(t){return 0}gi(t,e){return W.or([()=>W.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class Jm{constructor(t,e){this.persistence=t,this.pi=new ar((s=>Ln(s.path)),((s,i)=>s.isEqual(i))),this.garbageCollector=aR(this,e)}static mi(t,e){return new Jm(t,e)}Ei(){}di(t){return W.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}gr(t){const e=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next((s=>e.next((i=>s+i))))}wr(t){let e=0;return this.pr(t,(s=>{e++})).next((()=>e))}pr(t,e){return W.forEach(this.pi,((s,i)=>this.br(t,s,i).next((a=>a?W.resolve():e(i)))))}removeTargets(t,e,s){return this.persistence.getTargetCache().removeTargets(t,e,s)}removeOrphanedDocuments(t,e){let s=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(t,(l=>this.br(t,l,e).next((u=>{u||(s++,a.removeEntry(l,Rt.min()))})))).next((()=>a.apply(t))).next((()=>s))}markPotentiallyOrphaned(t,e){return this.pi.set(e,t.currentSequenceNumber),W.resolve()}removeTarget(t,e){const s=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,s)}addReference(t,e,s){return this.pi.set(s,t.currentSequenceNumber),W.resolve()}removeReference(t,e,s){return this.pi.set(s,t.currentSequenceNumber),W.resolve()}updateLimboDocument(t,e){return this.pi.set(e,t.currentSequenceNumber),W.resolve()}Ti(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=wm(t.data.value)),e}br(t,e,s){return W.or([()=>this.persistence.Ai(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const i=this.pi.get(e);return W.resolve(i!==void 0&&i>s)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(t){this.serializer=t}k(t,e,s,i){const a=new Eg("createOrUpgrade",e);s<1&&i>=1&&((function(h){h.createObjectStore(gd)})(t),(function(h){h.createObjectStore(zh,{keyPath:mk}),h.createObjectStore(Hs,{keyPath:mw,autoIncrement:!0}).createIndex(Co,gw,{unique:!0}),h.createObjectStore(mc)})(t),i1(t),(function(h){h.createObjectStore(To)})(t));let l=W.resolve();return s<3&&i>=3&&(s!==0&&((function(h){h.deleteObjectStore(pc),h.deleteObjectStore(gc),h.deleteObjectStore(Po)})(t),i1(t)),l=l.next((()=>(function(h){const f=h.store(Po),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Rt.min().toTimestamp(),targetCount:0};return f.put($m,m)})(a)))),s<4&&i>=4&&(s!==0&&(l=l.next((()=>(function(h,f){return f.store(Hs).J().next((_=>{h.deleteObjectStore(Hs),h.createObjectStore(Hs,{keyPath:mw,autoIncrement:!0}).createIndex(Co,gw,{unique:!0});const x=f.store(Hs),E=_.map((S=>x.put(S)));return W.waitFor(E)}))})(t,a)))),l=l.next((()=>{(function(h){h.createObjectStore(_c,{keyPath:Tk})})(t)}))),s<5&&i>=5&&(l=l.next((()=>this.yi(a)))),s<6&&i>=6&&(l=l.next((()=>((function(h){h.createObjectStore(Hh)})(t),this.wi(a))))),s<7&&i>=7&&(l=l.next((()=>this.Si(a)))),s<8&&i>=8&&(l=l.next((()=>this.bi(t,a)))),s<9&&i>=9&&(l=l.next((()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(t)}))),s<10&&i>=10&&(l=l.next((()=>this.Di(a)))),s<11&&i>=11&&(l=l.next((()=>{(function(h){h.createObjectStore(Tg,{keyPath:wk})})(t),(function(h){h.createObjectStore(wg,{keyPath:Sk})})(t)}))),s<12&&i>=12&&(l=l.next((()=>{(function(h){const f=h.createObjectStore(Sg,{keyPath:Mk});f.createIndex(Gy,Ok,{unique:!1}),f.createIndex(X2,kk,{unique:!1})})(t)}))),s<13&&i>=13&&(l=l.next((()=>(function(h){const f=h.createObjectStore(Gm,{keyPath:pk});f.createIndex(Em,_k),f.createIndex(W2,yk)})(t))).next((()=>this.Ci(t,a))).next((()=>t.deleteObjectStore(To)))),s<14&&i>=14&&(l=l.next((()=>this.Fi(t,a)))),s<15&&i>=15&&(l=l.next((()=>(function(h){h.createObjectStore(eb,{keyPath:Ak,autoIncrement:!0}).createIndex(qy,Ik,{unique:!1}),h.createObjectStore(Ah,{keyPath:Rk}).createIndex(K2,Dk,{unique:!1}),h.createObjectStore(Ih,{keyPath:Nk}).createIndex(Q2,Ck,{unique:!1})})(t)))),s<16&&i>=16&&(l=l.next((()=>{e.objectStore(Ah).clear()})).next((()=>{e.objectStore(Ih).clear()}))),s<17&&i>=17&&(l=l.next((()=>{(function(h){h.createObjectStore(nb,{keyPath:Vk})})(t)}))),s<18&&i>=18&&d2()&&(l=l.next((()=>{e.objectStore(Ah).clear()})).next((()=>{e.objectStore(Ih).clear()}))),l}wi(t){let e=0;return t.store(To).ee(((s,i)=>{e+=Zm(i)})).next((()=>{const s={byteSize:e};return t.store(Hh).put(Hy,s)}))}yi(t){const e=t.store(zh),s=t.store(Hs);return e.J().next((i=>W.forEach(i,(a=>{const l=IDBKeyRange.bound([a.userId,ca],[a.userId,a.lastAcknowledgedBatchId]);return s.J(Co,l).next((u=>W.forEach(u,(h=>{wt(h.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:h.batchId});const f=Io(this.serializer,h);return nR(t,a.userId,f).next((()=>{}))}))))}))))}Si(t){const e=t.store(pc),s=t.store(To);return t.store(Po).get($m).next((i=>{const a=[];return s.ee(((l,u)=>{const h=new Wt(l),f=(function(_){return[0,Ln(_)]})(h);a.push(e.get(f).next((m=>m?W.resolve():(_=>e.put({targetId:0,path:Ln(_),sequenceNumber:i.highestListenSequenceNumber}))(h))))})).next((()=>W.waitFor(a)))}))}bi(t,e){t.createObjectStore(qh,{keyPath:Ek});const s=e.store(qh),i=new yb,a=l=>{if(i.add(l)){const u=l.lastSegment(),h=l.popLast();return s.put({collectionId:u,parent:Ln(h)})}};return e.store(To).ee({X:!0},((l,u)=>{const h=new Wt(l);return a(h.popLast())})).next((()=>e.store(mc).ee({X:!0},(([l,u,h],f)=>{const m=mi(u);return a(m.popLast())}))))}Di(t){const e=t.store(gc);return e.ee(((s,i)=>{const a=fh(i),l=ZI(this.serializer,a);return e.put(l)}))}Ci(t,e){const s=e.store(To),i=[];return s.ee(((a,l)=>{const u=e.store(Gm),h=(function(_){return _.document?new pt(Wt.fromString(_.document.name).popFirst(5)):_.noDocument?pt.fromSegments(_.noDocument.path):_.unknownDocument?pt.fromSegments(_.unknownDocument.path):vt(36783)})(l).path.toArray(),f={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(u.put(f))})).next((()=>W.waitFor(i)))}Fi(t,e){const s=e.store(Hs),i=lR(this.serializer),a=new xb(Og.mi,this.serializer.yt);return s.J().next((l=>{const u=new Map;return l.forEach((h=>{let f=u.get(h.userId)??Ft();Io(this.serializer,h).keys().forEach((m=>f=f.add(m))),u.set(h.userId,f)})),W.forEach(u,((h,f)=>{const m=new _n(f),_=Cg.wt(this.serializer,m),x=a.getIndexManager(m),E=Mg.wt(m,this.serializer,x,a.referenceDelegate);return new cR(i,E,_,x).recalculateAndSaveOverlaysForDocumentKeys(new $y(e,es.ce),h).next()}))}))}}function i1(n){n.createObjectStore(pc,{keyPath:xk}).createIndex(tb,vk,{unique:!0}),n.createObjectStore(gc,{keyPath:"targetId"}).createIndex(Y2,bk,{unique:!0}),n.createObjectStore(Po)}const Xr="IndexedDbPersistence",dy=18e5,fy=5e3,my="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",uR="main";class vb{constructor(t,e,s,i,a,l,u,h,f,m,_=18){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=s,this.Mi=a,this.window=l,this.document=u,this.xi=f,this.Oi=m,this.Ni=_,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=x=>Promise.resolve(),!vb.v())throw new lt(tt.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new F4(this,i),this.$i=e+uR,this.serializer=new XI(h),this.Ui=new pi(this.$i,this.Ni,new Z4(this.serializer)),this.hi=new R4,this.Pi=new P4(this.referenceDelegate,this.serializer),this.remoteDocumentCache=lR(this.serializer),this.Ii=new I4,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,m===!1&&We(Xr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new lt(tt.FAILED_PRECONDITION,my);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(t=>this.Pi.getHighestSequenceNumber(t)))})).then((t=>{this.ci=new es(t,this.xi)})).then((()=>{this.li=!0})).catch((t=>(this.Ui&&this.Ui.close(),Promise.reject(t))))}Ji(t){return this.Qi=async e=>{if(this.started)return t(e)},t(this.isPrimary)}setDatabaseDeletedListener(t){this.Ui.$((async e=>{e.newVersion===null&&await t()}))}setNetworkEnabled(t){this.networkEnabled!==t&&(this.networkEnabled=t,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(t=>sm(t).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(t).next((e=>{e||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(t))).next((e=>this.isPrimary&&!e?this.Zi(t).next((()=>!1)):!!e&&this.Xi(t).next((()=>!0)))))).catch((t=>{if(Ra(t))return ct(Xr,"Failed to extend owner lease: ",t),this.isPrimary;if(!this.allowTabSynchronization)throw t;return ct(Xr,"Releasing owner lease after error during lease refresh",t),!1})).then((t=>{this.isPrimary!==t&&this.Mi.enqueueRetryable((()=>this.Qi(t))),this.isPrimary=t}))}Hi(t){return sh(t).get(Gl).next((e=>W.resolve(this.es(e))))}ts(t){return sm(t).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,dy)){this.qi=Date.now();const t=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const s=un(e,_c);return s.J().next((i=>{const a=this.ss(i,dy),l=i.filter((u=>a.indexOf(u)===-1));return W.forEach(l,(u=>s.delete(u.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ki)for(const e of t)this.Ki.removeItem(this._s(e.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(t){return!!t&&t.ownerId===this.clientId}Yi(t){return this.Oi?W.resolve(!0):sh(t).get(Gl).next((e=>{if(e!==null&&this.rs(e.leaseTimestampMs,fy)&&!this.us(e.ownerId)){if(this.es(e)&&this.networkEnabled)return!0;if(!this.es(e)){if(!e.allowTabSynchronization)throw new lt(tt.FAILED_PRECONDITION,my);return!1}}return!(!this.networkEnabled||!this.inForeground)||sm(t).J().next((s=>this.ss(s,fy).find((i=>{if(this.clientId!==i.clientId){const a=!this.networkEnabled&&i.networkEnabled,l=!this.inForeground&&i.inForeground,u=this.networkEnabled===i.networkEnabled;if(a||l&&u)return!0}return!1}))===void 0))})).next((e=>(this.isPrimary!==e&&ct(Xr,`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[gd,_c],(t=>{const e=new $y(t,es.ce);return this.Zi(e).next((()=>this.ts(e)))})),this.Ui.close(),this.Ps()}ss(t,e){return t.filter((s=>this.rs(s.updateTimeMs,e)&&!this.us(s.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(t=>sm(t).J().next((e=>this.ss(e,dy).map((s=>s.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(t,e){return Mg.wt(t,this.serializer,e,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(t){return new V4(t,this.serializer.yt.databaseId)}getDocumentOverlayCache(t){return Cg.wt(this.serializer,t)}getBundleCache(){return this.Ii}runTransaction(t,e,s){ct(Xr,"Starting transaction:",t);const i=e==="readonly"?"readonly":"readwrite",a=(function(h){return h===18?jk:h===17?eI:h===16?Lk:h===15?sb:h===14?tI:h===13?J2:h===12?Pk:h===11?Z2:void vt(60245)})(this.Ni);let l;return this.Ui.runTransaction(t,i,a,(u=>(l=new $y(u,this.ci?this.ci.next():es.ce),e==="readwrite-primary"?this.Hi(l).next((h=>!!h||this.Yi(l))).next((h=>{if(!h)throw We(`Failed to obtain primary lease for action '${t}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new lt(tt.FAILED_PRECONDITION,z2);return s(l)})).next((h=>this.Xi(l).next((()=>h)))):this.Is(l).next((()=>s(l)))))).then((u=>(l.raiseOnCommittedEvent(),u)))}Is(t){return sh(t).get(Gl).next((e=>{if(e!==null&&this.rs(e.leaseTimestampMs,fy)&&!this.us(e.ownerId)&&!this.es(e)&&!(this.Oi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new lt(tt.FAILED_PRECONDITION,my)}))}Xi(t){const e={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return sh(t).put(Gl,e)}static v(){return pi.v()}Zi(t){const e=sh(t);return e.get(Gl).next((s=>this.es(s)?(ct(Xr,"Releasing primary lease."),e.delete(Gl)):W.resolve()))}rs(t,e){const s=Date.now();return!(t<s-e)&&(!(t>s)||(We(`Detected an update time that is in the future: ${t} > ${s}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var t;typeof((t=this.window)==null?void 0:t.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;h2()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(t){var e;try{const s=((e=this.Ki)==null?void 0:e.getItem(this._s(t)))!==null;return ct(Xr,`Client '${t}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return We(Xr,"Failed to get zombied client id.",s),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(t){We("Failed to set zombie client id.",t)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(t){return`firestore_zombie_${this.persistenceKey}_${t}`}}function sh(n){return un(n,gd)}function sm(n){return un(n,_c)}function Eb(n,t){let e=n.projectId;return n.isDefaultDatabase||(e+="."+n.database),"firestore/"+t+"/"+e+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(t,e,s,i){this.targetId=t,this.fromCache=e,this.Es=s,this.ds=i}static As(t,e){let s=Ft(),i=Ft();for(const a of e.docChanges)switch(a.type){case 0:s=s.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Tb(t,e.fromCache,s,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return h2()?8:q2(Um())>0?6:4})()}initialize(t,e){this.ps=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,s,i){const a={result:null};return this.ys(t,e).next((l=>{a.result=l})).next((()=>{if(!a.result)return this.ws(t,e,i,s).next((l=>{a.result=l}))})).next((()=>{if(a.result)return;const l=new J4;return this.Ss(t,e,l).next((u=>{if(a.result=u,this.Vs)return this.bs(t,e,l,u.size)}))})).next((()=>a.result))}bs(t,e,s,i){return s.documentReadCount<this.fs?(Jl()<=Xt.DEBUG&&ct("QueryEngine","SDK will not create cache indexes for query:",tc(e),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),W.resolve()):(Jl()<=Xt.DEBUG&&ct("QueryEngine","Query:",tc(e),"scans",s.documentReadCount,"local documents and returns",i,"documents as results."),s.documentReadCount>this.gs*i?(Jl()<=Xt.DEBUG&&ct("QueryEngine","The SDK decides to create cache indexes for query:",tc(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Wn(e))):W.resolve())}ys(t,e){if(Rw(e))return W.resolve(null);let s=Wn(e);return this.indexManager.getIndexType(t,s).next((i=>i===0?null:(e.limit!==null&&i===1&&(e=Km(e,null,"F"),s=Wn(e)),this.indexManager.getDocumentsMatchingTarget(t,s).next((a=>{const l=Ft(...a);return this.ps.getDocuments(t,l).next((u=>this.indexManager.getMinOffset(t,s).next((h=>{const f=this.Ds(e,u);return this.Cs(e,f,l,h.readTime)?this.ys(t,Km(e,null,"F")):this.vs(t,f,e,h)}))))})))))}ws(t,e,s,i){return Rw(e)||i.isEqual(Rt.min())?W.resolve(null):this.ps.getDocuments(t,s).next((a=>{const l=this.Ds(e,a);return this.Cs(e,l,s,i)?W.resolve(null):(Jl()<=Xt.DEBUG&&ct("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),tc(e)),this.vs(t,l,e,F2(i,fc)).next((u=>u)))}))}Ds(t,e){let s=new fe(EI(t));return e.forEach(((i,a)=>{yd(t,a)&&(s=s.add(a))})),s}Cs(t,e,s,i){if(t.limit===null)return!1;if(s.size!==e.size)return!0;const a=t.limitType==="F"?e.last():e.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(t,e,s){return Jl()<=Xt.DEBUG&&ct("QueryEngine","Using full collection scan to execute query:",tc(e)),this.ps.getDocumentsMatchingQuery(t,e,gs.min(),s)}vs(t,e,s,i){return this.ps.getDocumentsMatchingQuery(t,s,i).next((a=>(e.forEach((l=>{a=a.insert(l.key,l)})),a)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wb="LocalStore",tV=3e8;class eV{constructor(t,e,s,i){this.persistence=t,this.Fs=e,this.serializer=i,this.Ms=new Te(Vt),this.xs=new ar((a=>Uo(a)),pd),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(s)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new cR(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ms)))}}function dR(n,t,e,s){return new eV(n,t,e,s)}async function fR(n,t){const e=xt(n);return await e.persistence.runTransaction("Handle user change","readonly",(s=>{let i;return e.mutationQueue.getAllMutationBatches(s).next((a=>(i=a,e.Bs(t),e.mutationQueue.getAllMutationBatches(s)))).next((a=>{const l=[],u=[];let h=Ft();for(const f of i){l.push(f.batchId);for(const m of f.mutations)h=h.add(m.key)}for(const f of a){u.push(f.batchId);for(const m of f.mutations)h=h.add(m.key)}return e.localDocuments.getDocuments(s,h).next((f=>({Ls:f,removedBatchIds:l,addedBatchIds:u})))}))}))}function nV(n,t){const e=xt(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const i=t.batch.keys(),a=e.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,h,f,m){const _=f.batch,x=_.keys();let E=W.resolve();return x.forEach((S=>{E=E.next((()=>m.getEntry(h,S))).next((T=>{const R=f.docVersions.get(S);wt(R!==null,48541),T.version.compareTo(R)<0&&(_.applyToRemoteDocument(T,f),T.isValidDocument()&&(T.setReadTime(f.commitVersion),m.addEntry(T)))}))})),E.next((()=>u.mutationQueue.removeMutationBatch(h,_)))})(e,s,t,a).next((()=>a.apply(s))).next((()=>e.mutationQueue.performConsistencyCheck(s))).next((()=>e.documentOverlayCache.removeOverlaysForBatchId(s,i,t.batch.batchId))).next((()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(u){let h=Ft();for(let f=0;f<u.mutationResults.length;++f)u.mutationResults[f].transformResults.length>0&&(h=h.add(u.batch.mutations[f].key));return h})(t)))).next((()=>e.localDocuments.getDocuments(s,i)))}))}function mR(n){const t=xt(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function sV(n,t){const e=xt(n),s=t.snapshotVersion;let i=e.Ms;return e.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const l=e.Ns.newChangeBuffer({trackRemovals:!0});i=e.Ms;const u=[];t.targetChanges.forEach(((m,_)=>{const x=i.get(_);if(!x)return;u.push(e.Pi.removeMatchingKeys(a,m.removedDocuments,_).next((()=>e.Pi.addMatchingKeys(a,m.addedDocuments,_))));let E=x.withSequenceNumber(a.currentSequenceNumber);t.targetMismatches.get(_)!==null?E=E.withResumeToken(Be.EMPTY_BYTE_STRING,Rt.min()).withLastLimboFreeSnapshotVersion(Rt.min()):m.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(m.resumeToken,s)),i=i.insert(_,E),(function(T,R,M){return T.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=tV?!0:M.addedDocuments.size+M.modifiedDocuments.size+M.removedDocuments.size>0})(x,E,m)&&u.push(e.Pi.updateTargetData(a,E))}));let h=ss(),f=Ft();if(t.documentUpdates.forEach((m=>{t.resolvedLimboDocuments.has(m)&&u.push(e.persistence.referenceDelegate.updateLimboDocument(a,m))})),u.push(gR(a,l,t.documentUpdates).next((m=>{h=m.ks,f=m.qs}))),!s.isEqual(Rt.min())){const m=e.Pi.getLastRemoteSnapshotVersion(a).next((_=>e.Pi.setTargetsMetadata(a,a.currentSequenceNumber,s)));u.push(m)}return W.waitFor(u).next((()=>l.apply(a))).next((()=>e.localDocuments.getLocalViewOfDocuments(a,h,f))).next((()=>h))})).then((a=>(e.Ms=i,a)))}function gR(n,t,e){let s=Ft(),i=Ft();return e.forEach((a=>s=s.add(a))),t.getEntries(n,s).next((a=>{let l=ss();return e.forEach(((u,h)=>{const f=a.get(u);h.isFoundDocument()!==f.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(Rt.min())?(t.removeEntry(u,h.readTime),l=l.insert(u,h)):!f.isValidDocument()||h.version.compareTo(f.version)>0||h.version.compareTo(f.version)===0&&f.hasPendingWrites?(t.addEntry(h),l=l.insert(u,h)):ct(wb,"Ignoring outdated watch update for ",u,". Current version:",f.version," Watch version:",h.version)})),{ks:l,qs:i}}))}function iV(n,t){const e=xt(n);return e.persistence.runTransaction("Get next mutation batch","readonly",(s=>(t===void 0&&(t=ca),e.mutationQueue.getNextMutationBatchAfterBatchId(s,t))))}function wc(n,t){const e=xt(n);return e.persistence.runTransaction("Allocate target","readwrite",(s=>{let i;return e.Pi.getTargetData(s,t).next((a=>a?(i=a,W.resolve(i)):e.Pi.allocateTargetId(s).next((l=>(i=new Qi(t,l,"TargetPurposeListen",s.currentSequenceNumber),e.Pi.addTargetData(s,i).next((()=>i)))))))})).then((s=>{const i=e.Ms.get(s.targetId);return(i===null||s.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(e.Ms=e.Ms.insert(s.targetId,s),e.xs.set(t,s.targetId)),s}))}async function Sc(n,t,e){const s=xt(n),i=s.Ms.get(t),a=e?"readwrite":"readwrite-primary";try{e||await s.persistence.runTransaction("Release target",a,(l=>s.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!Ra(l))throw l;ct(wb,`Failed to update sequence numbers for target ${t}: ${l}`)}s.Ms=s.Ms.remove(t),s.xs.delete(i.target)}function tg(n,t,e){const s=xt(n);let i=Rt.min(),a=Ft();return s.persistence.runTransaction("Execute query","readwrite",(l=>(function(h,f,m){const _=xt(h),x=_.xs.get(m);return x!==void 0?W.resolve(_.Ms.get(x)):_.Pi.getTargetData(f,m)})(s,l,Wn(t)).next((u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(l,u.targetId).next((h=>{a=h}))})).next((()=>s.Fs.getDocumentsMatchingQuery(l,t,e?i:Rt.min(),e?a:Ft()))).next((u=>(yR(s,vI(t),u),{documents:u,Qs:a})))))}function pR(n,t){const e=xt(n),s=xt(e.Pi),i=e.Ms.get(t);return i?Promise.resolve(i.target):e.persistence.runTransaction("Get target data","readonly",(a=>s.At(a,t).next((l=>l?l.target:null))))}function _R(n,t){const e=xt(n),s=e.Os.get(t)||Rt.min();return e.persistence.runTransaction("Get new document changes","readonly",(i=>e.Ns.getAllFromCollectionGroup(i,t,F2(s,fc),Number.MAX_SAFE_INTEGER))).then((i=>(yR(e,t,i),i)))}function yR(n,t,e){let s=n.Os.get(t)||Rt.min();e.forEach(((i,a)=>{a.readTime.compareTo(s)>0&&(s=a.readTime)})),n.Os.set(t,s)}async function rV(n,t,e,s){const i=xt(n);let a=Ft(),l=ss();for(const f of e){const m=t.$s(f.metadata.name);f.document&&(a=a.add(m));const _=t.Us(f);_.setReadTime(t.Ks(f.metadata.readTime)),l=l.insert(m,_)}const u=i.Ns.newChangeBuffer({trackRemovals:!0}),h=await wc(i,(function(m){return Wn(Bc(Wt.fromString(`__bundle__/docs/${m}`)))})(s));return i.persistence.runTransaction("Apply bundle documents","readwrite",(f=>gR(f,u,l).next((m=>(u.apply(f),m))).next((m=>i.Pi.removeMatchingKeysForTargetId(f,h.targetId).next((()=>i.Pi.addMatchingKeys(f,a,h.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(f,m.ks,m.qs))).next((()=>m.ks))))))}async function aV(n,t,e=Ft()){const s=await wc(n,Wn(pb(t.bundledQuery))),i=xt(n);return i.persistence.runTransaction("Save named query","readwrite",(a=>{const l=Ke(t.readTime);if(s.snapshotVersion.compareTo(l)>=0)return i.Ii.saveNamedQuery(a,t);const u=s.withResumeToken(Be.EMPTY_BYTE_STRING,l);return i.Ms=i.Ms.insert(u.targetId,u),i.Pi.updateTargetData(a,u).next((()=>i.Pi.removeMatchingKeysForTargetId(a,s.targetId))).next((()=>i.Pi.addMatchingKeys(a,e,s.targetId))).next((()=>i.Ii.saveNamedQuery(a,t)))}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR="firestore_clients";function r1(n,t){return`${bR}_${n}_${t}`}const xR="firestore_mutations";function a1(n,t,e){let s=`${xR}_${n}_${e}`;return t.isAuthenticated()&&(s+=`_${t.uid}`),s}const vR="firestore_targets";function gy(n,t){return`${vR}_${n}_${t}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi="SharedClientState";class eg{constructor(t,e,s,i){this.user=t,this.batchId=e,this.state=s,this.error=i}static Ws(t,e,s){const i=JSON.parse(s);let a,l=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return l&&i.error&&(l=typeof i.error.message=="string"&&typeof i.error.code=="string",l&&(a=new lt(i.error.code,i.error.message))),l?new eg(t,e,i.state,a):(We(fi,`Failed to parse mutation state for ID '${e}': ${s}`),null)}Gs(){const t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}}class Ch{constructor(t,e,s){this.targetId=t,this.state=e,this.error=s}static Ws(t,e){const s=JSON.parse(e);let i,a=typeof s=="object"&&["not-current","current","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return a&&s.error&&(a=typeof s.error.message=="string"&&typeof s.error.code=="string",a&&(i=new lt(s.error.code,s.error.message))),a?new Ch(t,s.state,i):(We(fi,`Failed to parse target state for ID '${t}': ${e}`),null)}Gs(){const t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}}class ng{constructor(t,e){this.clientId=t,this.activeTargetIds=e}static Ws(t,e){const s=JSON.parse(e);let i=typeof s=="object"&&s.activeTargetIds instanceof Array,a=lb();for(let l=0;i&&l<s.activeTargetIds.length;++l)i=G2(s.activeTargetIds[l]),a=a.add(s.activeTargetIds[l]);return i?new ng(t,a):(We(fi,`Failed to parse client data for instance '${t}': ${e}`),null)}}class Sb{constructor(t,e){this.clientId=t,this.onlineState=e}static Ws(t){const e=JSON.parse(t);return typeof e=="object"&&["Unknown","Online","Offline"].indexOf(e.onlineState)!==-1&&typeof e.clientId=="string"?new Sb(e.clientId,e.onlineState):(We(fi,`Failed to parse online state: ${t}`),null)}}class o0{constructor(){this.activeTargetIds=lb()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class py{constructor(t,e,s,i,a){this.window=t,this.Mi=e,this.persistenceKey=s,this.Js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new Te(Vt),this.started=!1,this.Xs=[];const l=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.eo=r1(this.persistenceKey,this.Js),this.no=(function(h){return`firestore_sequence_number_${h}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new o0),this.ro=new RegExp(`^${bR}_${l}_([^_]*)$`),this.io=new RegExp(`^${xR}_${l}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${vR}_${l}_(\\d+)$`),this.oo=(function(h){return`firestore_online_state_${h}`})(this.persistenceKey),this._o=(function(h){return`firestore_bundle_loaded_v2_${h}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(t){return!(!t||!t.localStorage)}async start(){const t=await this.syncEngine.Ts();for(const s of t){if(s===this.Js)continue;const i=this.getItem(r1(this.persistenceKey,s));if(i){const a=ng.Ws(s,i);a&&(this.Zs=this.Zs.insert(a.clientId,a))}}this.ao();const e=this.storage.getItem(this.oo);if(e){const s=this.uo(e);s&&this.co(s)}for(const s of this.Xs)this.Ys(s);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(t){this.setItem(this.no,JSON.stringify(t))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(t){let e=!1;return this.Zs.forEach(((s,i)=>{i.activeTargetIds.has(t)&&(e=!0)})),e}addPendingMutation(t){this.ho(t,"pending")}updateMutationState(t,e,s){this.ho(t,e,s),this.Po(t)}addLocalQueryTarget(t,e=!0){let s="not-current";if(this.isActiveQueryTarget(t)){const i=this.storage.getItem(gy(this.persistenceKey,t));if(i){const a=Ch.Ws(t,i);a&&(s=a.state)}}return e&&this.To.zs(t),this.ao(),s}removeLocalQueryTarget(t){this.To.js(t),this.ao()}isLocalQueryTarget(t){return this.To.activeTargetIds.has(t)}clearQueryState(t){this.removeItem(gy(this.persistenceKey,t))}updateQueryState(t,e,s){this.Io(t,e,s)}handleUserChange(t,e,s){e.forEach((i=>{this.Po(i)})),this.currentUser=t,s.forEach((i=>{this.addPendingMutation(i)}))}setOnlineState(t){this.Eo(t)}notifyBundleLoaded(t){this.Ao(t)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(t){const e=this.storage.getItem(t);return ct(fi,"READ",t,e),e}setItem(t,e){ct(fi,"SET",t,e),this.storage.setItem(t,e)}removeItem(t){ct(fi,"REMOVE",t),this.storage.removeItem(t)}Ys(t){const e=t;if(e.storageArea===this.storage){if(ct(fi,"EVENT",e.key,e.newValue),e.key===this.eo)return void We("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(e.key!==null){if(this.ro.test(e.key)){if(e.newValue==null){const s=this.Ro(e.key);return this.Vo(s,null)}{const s=this.mo(e.key,e.newValue);if(s)return this.Vo(s.clientId,s)}}else if(this.io.test(e.key)){if(e.newValue!==null){const s=this.fo(e.key,e.newValue);if(s)return this.po(s)}}else if(this.so.test(e.key)){if(e.newValue!==null){const s=this.yo(e.key,e.newValue);if(s)return this.wo(s)}}else if(e.key===this.oo){if(e.newValue!==null){const s=this.uo(e.newValue);if(s)return this.co(s)}}else if(e.key===this.no){const s=(function(a){let l=es.ce;if(a!=null)try{const u=JSON.parse(a);wt(typeof u=="number",30636,{So:a}),l=u}catch(u){We(fi,"Failed to read sequence number from WebStorage",u)}return l})(e.newValue);s!==es.ce&&this.sequenceNumberHandler(s)}else if(e.key===this._o){const s=this.bo(e.newValue);await Promise.all(s.map((i=>this.syncEngine.Do(i))))}}}else this.Xs.push(e)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(t,e,s){const i=new eg(this.currentUser,t,e,s),a=a1(this.persistenceKey,this.currentUser,t);this.setItem(a,i.Gs())}Po(t){const e=a1(this.persistenceKey,this.currentUser,t);this.removeItem(e)}Eo(t){const e={clientId:this.Js,onlineState:t};this.storage.setItem(this.oo,JSON.stringify(e))}Io(t,e,s){const i=gy(this.persistenceKey,t),a=new Ch(t,e,s);this.setItem(i,a.Gs())}Ao(t){const e=JSON.stringify(Array.from(t));this.setItem(this._o,e)}Ro(t){const e=this.ro.exec(t);return e?e[1]:null}mo(t,e){const s=this.Ro(t);return ng.Ws(s,e)}fo(t,e){const s=this.io.exec(t),i=Number(s[1]),a=s[2]!==void 0?s[2]:null;return eg.Ws(new _n(a),i,e)}yo(t,e){const s=this.so.exec(t),i=Number(s[1]);return Ch.Ws(i,e)}uo(t){return Sb.Ws(t)}bo(t){return JSON.parse(t)}async po(t){if(t.user.uid===this.currentUser.uid)return this.syncEngine.Co(t.batchId,t.state,t.error);ct(fi,`Ignoring mutation for non-active user ${t.user.uid}`)}wo(t){return this.syncEngine.vo(t.targetId,t.state,t.error)}Vo(t,e){const s=e?this.Zs.insert(t,e):this.Zs.remove(t),i=this.lo(this.Zs),a=this.lo(s),l=[],u=[];return a.forEach((h=>{i.has(h)||l.push(h)})),i.forEach((h=>{a.has(h)||u.push(h)})),this.syncEngine.Fo(l,u).then((()=>{this.Zs=s}))}co(t){this.Zs.get(t.clientId)&&this.onlineStateHandler(t.onlineState)}lo(t){let e=lb();return t.forEach(((s,i)=>{e=e.unionWith(i.activeTargetIds)})),e}}class ER{constructor(){this.Mo=new o0,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,s){}addLocalQueryTarget(t,e=!0){return e&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,e,s){this.xo[t]=e}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new o0,Promise.resolve()}handleUserChange(t,e,s){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{Oo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1="ConnectivityMonitor";class l1{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ct(o1,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){ct(o1,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let im=null;function l0(){return im===null?im=(function(){return 268435456+Math.round(2147483648*Math.random())})():im++,"0x"+im.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _y="RestConnection",lV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class cV{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=e+"://"+t.host,this.Ko=`projects/${s}/databases/${i}`,this.Wo=this.databaseId.database===Wy?`project_id=${s}`:`project_id=${s}&database_id=${i}`}Go(t,e,s,i,a){const l=l0(),u=this.zo(t,e.toUriEncodedString());ct(_y,`Sending RPC '${t}' ${l}:`,u,s);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,i,a);const{host:f}=new URL(u),m=U0(f);return this.Jo(t,u,h,s,m).then((_=>(ct(_y,`Received RPC '${t}' ${l}: `,_),_)),(_=>{throw vi(_y,`RPC '${t}' ${l} failed with error: `,_,"url: ",u,"request:",s),_}))}Ho(t,e,s,i,a,l){return this.Go(t,e,s,i,a)}jo(t,e,s){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+jc})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((i,a)=>t[a]=i)),s&&s.headers.forEach(((i,a)=>t[a]=i))}zo(t,e){const s=lV[t];return`${this.Uo}/v1/${e}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cn="WebChannelConnection";class hV extends cV{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,s,i,a){const l=l0();return new Promise(((u,h)=>{const f=new D2;f.setWithCredentials(!0),f.listenOnce(N2.COMPLETE,(()=>{try{switch(f.getLastErrorCode()){case bm.NO_ERROR:const _=f.getResponseJson();ct(Cn,`XHR for RPC '${t}' ${l} received:`,JSON.stringify(_)),u(_);break;case bm.TIMEOUT:ct(Cn,`RPC '${t}' ${l} timed out`),h(new lt(tt.DEADLINE_EXCEEDED,"Request time out"));break;case bm.HTTP_ERROR:const x=f.getStatus();if(ct(Cn,`RPC '${t}' ${l} failed with status:`,x,"response text:",f.getResponseText()),x>0){let E=f.getResponseJson();Array.isArray(E)&&(E=E[0]);const S=E==null?void 0:E.error;if(S&&S.status&&S.message){const T=(function(M){const L=M.toLowerCase().replace(/_/g,"-");return Object.values(tt).indexOf(L)>=0?L:tt.UNKNOWN})(S.status);h(new lt(T,S.message))}else h(new lt(tt.UNKNOWN,"Server responded with status "+f.getStatus()))}else h(new lt(tt.UNAVAILABLE,"Connection failed."));break;default:vt(9055,{l_:t,streamId:l,h_:f.getLastErrorCode(),P_:f.getLastError()})}}finally{ct(Cn,`RPC '${t}' ${l} completed.`)}}));const m=JSON.stringify(i);ct(Cn,`RPC '${t}' ${l} sending request:`,i),f.send(e,"POST",m,s,15)}))}T_(t,e,s){const i=l0(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],l=O2(),u=M2(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(h.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,e,s),h.encodeInitMessageHeaders=!0;const m=a.join("");ct(Cn,`Creating RPC '${t}' stream ${i}: ${m}`,h);const _=l.createWebChannel(m,h);this.I_(_);let x=!1,E=!1;const S=new uV({Yo:R=>{E?ct(Cn,`Not sending because RPC '${t}' stream ${i} is closed:`,R):(x||(ct(Cn,`Opening RPC '${t}' stream ${i} transport.`),_.open(),x=!0),ct(Cn,`RPC '${t}' stream ${i} sending:`,R),_.send(R))},Zo:()=>_.close()}),T=(R,M,L)=>{R.listen(M,(O=>{try{L(O)}catch(H){setTimeout((()=>{throw H}),0)}}))};return T(_,uh.EventType.OPEN,(()=>{E||(ct(Cn,`RPC '${t}' stream ${i} transport opened.`),S.o_())})),T(_,uh.EventType.CLOSE,(()=>{E||(E=!0,ct(Cn,`RPC '${t}' stream ${i} transport closed`),S.a_(),this.E_(_))})),T(_,uh.EventType.ERROR,(R=>{E||(E=!0,vi(Cn,`RPC '${t}' stream ${i} transport errored. Name:`,R.name,"Message:",R.message),S.a_(new lt(tt.UNAVAILABLE,"The operation could not be completed")))})),T(_,uh.EventType.MESSAGE,(R=>{var M;if(!E){const L=R.data[0];wt(!!L,16349);const O=L,H=(O==null?void 0:O.error)||((M=O[0])==null?void 0:M.error);if(H){ct(Cn,`RPC '${t}' stream ${i} received error:`,H);const B=H.status;let z=(function(C){const P=Je[C];if(P!==void 0)return VI(P)})(B),D=H.message;z===void 0&&(z=tt.INTERNAL,D="Unknown error status: "+B+" with message "+H.message),E=!0,S.a_(new lt(z,D)),_.close()}else ct(Cn,`RPC '${t}' stream ${i} received:`,L),S.u_(L)}})),T(u,C2.STAT_EVENT,(R=>{R.stat===Fy.PROXY?ct(Cn,`RPC '${t}' stream ${i} detected buffering proxy`):R.stat===Fy.NOPROXY&&ct(Cn,`RPC '${t}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((t=>t.close())),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter((e=>e===t))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TR(){return typeof window<"u"?window:null}function Dm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ed(n){return new p4(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(t,e,s=1e3,i=1.5,a=6e4){this.Mi=t,this.timerId=e,this.d_=s,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const e=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),i=Math.max(0,e-s);i>0&&ct("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${e} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),t()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c1="PersistentStream";class wR{constructor(t,e,s,i,a,l,u,h){this.Mi=t,this.S_=s,this.b_=i,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ab(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===tt.RESOURCE_EXHAUSTED?(We(e.toString()),We("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===tt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(e)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,i])=>{this.D_===e&&this.G_(s,i)}),(s=>{t((()=>{const i=new lt(tt.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(i)}))}))}G_(t,e){const s=this.W_(this.D_);this.stream=this.j_(t,e),this.stream.Xo((()=>{s((()=>this.listener.Xo()))})),this.stream.t_((()=>{s((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{s((()=>this.z_(i)))})),this.stream.onMessage((i=>{s((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return ct(c1,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return e=>{this.Mi.enqueueAndForget((()=>this.D_===t?e():(ct(c1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class dV extends wR{constructor(t,e,s,i,a,l){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,s,i,l),this.serializer=a}j_(t,e){return this.connection.T_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=b4(this.serializer,t),s=(function(a){if(!("targetChange"in a))return Rt.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?Rt.min():l.readTime?Ke(l.readTime):Rt.min()})(t);return this.listener.H_(e,s)}Y_(t){const e={};e.database=n0(this.serializer),e.addTarget=(function(a,l){let u;const h=l.target;if(u=Wm(h)?{documents:GI(a,h)}:{query:$I(a,h).ft},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=BI(a,l.resumeToken);const f=t0(a,l.expectedCount);f!==null&&(u.expectedCount=f)}else if(l.snapshotVersion.compareTo(Rt.min())>0){u.readTime=Tc(a,l.snapshotVersion.toTimestamp());const f=t0(a,l.expectedCount);f!==null&&(u.expectedCount=f)}return u})(this.serializer,t);const s=v4(this.serializer,t);s&&(e.labels=s),this.q_(e)}Z_(t){const e={};e.database=n0(this.serializer),e.removeTarget=t,this.q_(e)}}class fV extends wR{constructor(t,e,s,i,a,l){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,s,i,l),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}J_(t){return wt(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,wt(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){wt(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=x4(t.writeResults,t.commitTime),s=Ke(t.commitTime);return this.listener.na(s,e)}ra(){const t={};t.database=n0(this.serializer),this.q_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map((s=>Qh(this.serializer,s)))};this.q_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mV{}class gV extends mV{constructor(t,e,s,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=s,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new lt(tt.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,e,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Go(t,e0(e,s),i,a,l))).catch((a=>{throw a.name==="FirebaseError"?(a.code===tt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new lt(tt.UNKNOWN,a.toString())}))}Ho(t,e,s,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Ho(t,e0(e,s),i,l,u,a))).catch((l=>{throw l.name==="FirebaseError"?(l.code===tt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new lt(tt.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class pV{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(We(e),this.aa=!1):ct("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wo="RemoteStore";class _V{constructor(t,e,s,i,a){this.localStore=t,this.datastore=e,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((l=>{s.enqueueAndForget((async()=>{Na(this)&&(ct(Wo,"Restarting streams for network reachability change."),await(async function(h){const f=xt(h);f.Ea.add(4),await zc(f),f.Ra.set("Unknown"),f.Ea.delete(4),await Td(f)})(this))}))})),this.Ra=new pV(s,i)}}async function Td(n){if(Na(n))for(const t of n.da)await t(!0)}async function zc(n){for(const t of n.da)await t(!1)}function kg(n,t){const e=xt(n);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),Db(e)?Rb(e):qc(e).O_()&&Ib(e,t))}function Ac(n,t){const e=xt(n),s=qc(e);e.Ia.delete(t),s.O_()&&SR(e,t),e.Ia.size===0&&(s.O_()?s.L_():Na(e)&&e.Ra.set("Unknown"))}function Ib(n,t){if(n.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Rt.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}qc(n).Y_(t)}function SR(n,t){n.Va.Ue(t),qc(n).Z_(t)}function Rb(n){n.Va=new d4({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),At:t=>n.Ia.get(t)||null,ht:()=>n.datastore.serializer.databaseId}),qc(n).start(),n.Ra.ua()}function Db(n){return Na(n)&&!qc(n).x_()&&n.Ia.size>0}function Na(n){return xt(n).Ea.size===0}function AR(n){n.Va=void 0}async function yV(n){n.Ra.set("Online")}async function bV(n){n.Ia.forEach(((t,e)=>{Ib(n,t)}))}async function xV(n,t){AR(n),Db(n)?(n.Ra.ha(t),Rb(n)):n.Ra.set("Unknown")}async function vV(n,t,e){if(n.Ra.set("Online"),t instanceof jI&&t.state===2&&t.cause)try{await(async function(i,a){const l=a.cause;for(const u of a.targetIds)i.Ia.has(u)&&(await i.remoteSyncer.rejectListen(u,l),i.Ia.delete(u),i.Va.removeTarget(u))})(n,t)}catch(s){ct(Wo,"Failed to remove targets %s: %s ",t.targetIds.join(","),s),await sg(n,s)}else if(t instanceof Im?n.Va.Ze(t):t instanceof LI?n.Va.st(t):n.Va.tt(t),!e.isEqual(Rt.min()))try{const s=await mR(n.localStore);e.compareTo(s)>=0&&await(function(a,l){const u=a.Va.Tt(l);return u.targetChanges.forEach(((h,f)=>{if(h.resumeToken.approximateByteSize()>0){const m=a.Ia.get(f);m&&a.Ia.set(f,m.withResumeToken(h.resumeToken,l))}})),u.targetMismatches.forEach(((h,f)=>{const m=a.Ia.get(h);if(!m)return;a.Ia.set(h,m.withResumeToken(Be.EMPTY_BYTE_STRING,m.snapshotVersion)),SR(a,h);const _=new Qi(m.target,h,f,m.sequenceNumber);Ib(a,_)})),a.remoteSyncer.applyRemoteEvent(u)})(n,e)}catch(s){ct(Wo,"Failed to raise snapshot:",s),await sg(n,s)}}async function sg(n,t,e){if(!Ra(t))throw t;n.Ea.add(1),await zc(n),n.Ra.set("Offline"),e||(e=()=>mR(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ct(Wo,"Retrying IndexedDB access"),await e(),n.Ea.delete(1),await Td(n)}))}function IR(n,t){return t().catch((e=>sg(n,e,t)))}async function Hc(n){const t=xt(n),e=xa(t);let s=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:ca;for(;EV(t);)try{const i=await iV(t.localStore,s);if(i===null){t.Ta.length===0&&e.L_();break}s=i.batchId,TV(t,i)}catch(i){await sg(t,i)}RR(t)&&DR(t)}function EV(n){return Na(n)&&n.Ta.length<10}function TV(n,t){n.Ta.push(t);const e=xa(n);e.O_()&&e.X_&&e.ea(t.mutations)}function RR(n){return Na(n)&&!xa(n).x_()&&n.Ta.length>0}function DR(n){xa(n).start()}async function wV(n){xa(n).ra()}async function SV(n){const t=xa(n);for(const e of n.Ta)t.ea(e.mutations)}async function AV(n,t,e){const s=n.Ta.shift(),i=db.from(s,t,e);await IR(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Hc(n)}async function IV(n,t){t&&xa(n).X_&&await(async function(s,i){if((function(l){return kI(l)&&l!==tt.ABORTED})(i.code)){const a=s.Ta.shift();xa(s).B_(),await IR(s,(()=>s.remoteSyncer.rejectFailedWrite(a.batchId,i))),await Hc(s)}})(n,t),RR(n)&&DR(n)}async function u1(n,t){const e=xt(n);e.asyncQueue.verifyOperationInProgress(),ct(Wo,"RemoteStore received new credentials");const s=Na(e);e.Ea.add(3),await zc(e),s&&e.Ra.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await Td(e)}async function c0(n,t){const e=xt(n);t?(e.Ea.delete(2),await Td(e)):t||(e.Ea.add(2),await zc(e),e.Ra.set("Unknown"))}function qc(n){return n.ma||(n.ma=(function(e,s,i){const a=xt(e);return a.sa(),new dV(s,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:yV.bind(null,n),t_:bV.bind(null,n),r_:xV.bind(null,n),H_:vV.bind(null,n)}),n.da.push((async t=>{t?(n.ma.B_(),Db(n)?Rb(n):n.Ra.set("Unknown")):(await n.ma.stop(),AR(n))}))),n.ma}function xa(n){return n.fa||(n.fa=(function(e,s,i){const a=xt(e);return a.sa(),new fV(s,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:wV.bind(null,n),r_:IV.bind(null,n),ta:SV.bind(null,n),na:AV.bind(null,n)}),n.da.push((async t=>{t?(n.fa.B_(),await Hc(n)):(await n.fa.stop(),n.Ta.length>0&&(ct(Wo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(t,e,s,i,a){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=s,this.op=i,this.removalCallback=a,this.deferred=new An,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,s,i,a){const l=Date.now()+s,u=new Nb(t,e,l,i,a);return u.start(s),u}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new lt(tt.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Gc(n,t){if(We("AsyncQueue",`${t}: ${n}`),Ra(n))return new lt(tt.UNAVAILABLE,`${t}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{static emptySet(t){return new ac(t.comparator)}constructor(t){this.comparator=t?(e,s)=>t(e,s)||pt.comparator(e.key,s.key):(e,s)=>pt.comparator(e.key,s.key),this.keyedMap=hh(),this.sortedSet=new Te(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,s)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof ac)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),s=t.sortedSet.getIterator();for(;e.hasNext();){const i=e.getNext().key,a=s.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const s=new ac;return s.comparator=this.comparator,s.keyedMap=t,s.sortedSet=e,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(){this.ga=new Te(pt.comparator)}track(t){const e=t.doc.key,s=this.ga.get(e);s?t.type!==0&&s.type===3?this.ga=this.ga.insert(e,t):t.type===3&&s.type!==1?this.ga=this.ga.insert(e,{type:s.type,doc:t.doc}):t.type===2&&s.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&s.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&s.type===0?this.ga=this.ga.remove(e):t.type===1&&s.type===2?this.ga=this.ga.insert(e,{type:1,doc:s.doc}):t.type===0&&s.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):vt(63341,{Rt:t,pa:s}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal(((e,s)=>{t.push(s)})),t}}class Ic{constructor(t,e,s,i,a,l,u,h,f){this.query=t,this.docs=e,this.oldDocs=s,this.docChanges=i,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=f}static fromInitialDocuments(t,e,s,i,a){const l=[];return e.forEach((u=>{l.push({type:0,doc:u})})),new Ic(t,e,ac.emptySet(e),l,s,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&_d(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,s=t.docChanges;if(e.length!==s.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==s[i].type||!e[i].doc.isEqual(s[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RV{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((t=>t.Da()))}}class DV{constructor(){this.queries=d1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,s){const i=xt(e),a=i.queries;i.queries=d1(),a.forEach(((l,u)=>{for(const h of u.Sa)h.onError(s)}))})(this,new lt(tt.ABORTED,"Firestore shutting down"))}}function d1(){return new ar((n=>xI(n)),_d)}async function Cb(n,t){const e=xt(n);let s=3;const i=t.query;let a=e.queries.get(i);a?!a.ba()&&t.Da()&&(s=2):(a=new RV,s=t.Da()?0:1);try{switch(s){case 0:a.wa=await e.onListen(i,!0);break;case 1:a.wa=await e.onListen(i,!1);break;case 2:await e.onFirstRemoteStoreListen(i)}}catch(l){const u=Gc(l,`Initialization of query '${tc(t.query)}' failed`);return void t.onError(u)}e.queries.set(i,a),a.Sa.push(t),t.va(e.onlineState),a.wa&&t.Fa(a.wa)&&Ob(e)}async function Mb(n,t){const e=xt(n),s=t.query;let i=3;const a=e.queries.get(s);if(a){const l=a.Sa.indexOf(t);l>=0&&(a.Sa.splice(l,1),a.Sa.length===0?i=t.Da()?0:1:!a.ba()&&t.Da()&&(i=2))}switch(i){case 0:return e.queries.delete(s),e.onUnlisten(s,!0);case 1:return e.queries.delete(s),e.onUnlisten(s,!1);case 2:return e.onLastRemoteStoreUnlisten(s);default:return}}function NV(n,t){const e=xt(n);let s=!1;for(const i of t){const a=i.query,l=e.queries.get(a);if(l){for(const u of l.Sa)u.Fa(i)&&(s=!0);l.wa=i}}s&&Ob(e)}function CV(n,t,e){const s=xt(n),i=s.queries.get(t);if(i)for(const a of i.Sa)a.onError(e);s.queries.delete(t)}function Ob(n){n.Ca.forEach((t=>{t.next()}))}var u0,f1;(f1=u0||(u0={})).Ma="default",f1.Cache="cache";class kb{constructor(t,e,s){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(t){if(!this.options.includeMetadataChanges){const s=[];for(const i of t.docChanges)i.type!==3&&s.push(i);t=new Ic(t.query,t.docs,t.oldDocs,s,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const s=e!=="Offline";return(!this.options.qa||!s)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=Ic.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==u0.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MV{constructor(t,e){this.Qa=t,this.byteLength=e}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(t){this.serializer=t}$s(t){return _i(this.serializer,t)}Us(t){return t.metadata.exists?qI(this.serializer,t.document,!1):Se.newNoDocument(this.$s(t.metadata.name),this.Ks(t.metadata.readTime))}Ks(t){return Ke(t)}}class OV{constructor(t,e){this.Ua=t,this.serializer=e,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=NR(t)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(t){this.progress.bytesLoaded+=t.byteLength;let e=this.progress.documentsLoaded;if(t.Qa.namedQuery)this.Ka.push(t.Qa.namedQuery);else if(t.Qa.documentMetadata){this.Wa.push({metadata:t.Qa.documentMetadata}),t.Qa.documentMetadata.exists||++e;const s=Wt.fromString(t.Qa.documentMetadata.name);this.collectionGroups.add(s.get(s.length-2))}else t.Qa.document&&(this.Wa[this.Wa.length-1].document=t.Qa.document,++e);return e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,{...this.progress}):null}za(t){const e=new Map,s=new m1(this.serializer);for(const i of t)if(i.metadata.queries){const a=s.$s(i.metadata.name);for(const l of i.metadata.queries){const u=(e.get(l)||Ft()).add(a);e.set(l,u)}}return e}async ja(t){const e=await rV(t,new m1(this.serializer),this.Wa,this.Ua.id),s=this.za(this.documents);for(const i of this.Ka)await aV(t,i,s.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:e}}}function NR(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(t){this.key=t}}class MR{constructor(t){this.key=t}}class OR{constructor(t,e){this.query=t,this.Ya=e,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ft(),this.mutatedKeys=Ft(),this.eu=EI(t),this.tu=new ac(this.eu)}get nu(){return this.Ya}ru(t,e){const s=e?e.iu:new h1,i=e?e.tu:this.tu;let a=e?e.mutatedKeys:this.mutatedKeys,l=i,u=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,f=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((m,_)=>{const x=i.get(m),E=yd(this.query,_)?_:null,S=!!x&&this.mutatedKeys.has(x.key),T=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let R=!1;x&&E?x.data.isEqual(E.data)?S!==T&&(s.track({type:3,doc:E}),R=!0):this.su(x,E)||(s.track({type:2,doc:E}),R=!0,(h&&this.eu(E,h)>0||f&&this.eu(E,f)<0)&&(u=!0)):!x&&E?(s.track({type:0,doc:E}),R=!0):x&&!E&&(s.track({type:1,doc:x}),R=!0,(h||f)&&(u=!0)),R&&(E?(l=l.add(E),a=T?a.add(m):a.delete(m)):(l=l.delete(m),a=a.delete(m)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const m=this.query.limitType==="F"?l.last():l.first();l=l.delete(m.key),a=a.delete(m.key),s.track({type:1,doc:m})}return{tu:l,iu:s,Cs:u,mutatedKeys:a}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,s,i){const a=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const l=t.iu.ya();l.sort(((m,_)=>(function(E,S){const T=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return vt(20277,{Rt:R})}};return T(E)-T(S)})(m.type,_.type)||this.eu(m.doc,_.doc))),this.ou(s),i=i??!1;const u=e&&!i?this._u():[],h=this.Xa.size===0&&this.current&&!i?1:0,f=h!==this.Za;return this.Za=h,l.length!==0||f?{snapshot:new Ic(this.query,t.tu,a,l,t.mutatedKeys,h===0,f,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new h1,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach((e=>this.Ya=this.Ya.add(e))),t.modifiedDocuments.forEach((e=>{})),t.removedDocuments.forEach((e=>this.Ya=this.Ya.delete(e))),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=Ft(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))}));const e=[];return t.forEach((s=>{this.Xa.has(s)||e.push(new MR(s))})),this.Xa.forEach((s=>{t.has(s)||e.push(new CR(s))})),e}cu(t){this.Ya=t.Qs,this.Xa=Ft();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return Ic.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Ca="SyncEngine";class kV{constructor(t,e,s){this.query=t,this.targetId=e,this.view=s}}class VV{constructor(t){this.key=t,this.hu=!1}}class PV{constructor(t,e,s,i,a,l){this.localStore=t,this.remoteStore=e,this.eventManager=s,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new ar((u=>xI(u)),_d),this.Iu=new Map,this.Eu=new Set,this.du=new Te(pt.comparator),this.Au=new Map,this.Ru=new bb,this.Vu={},this.mu=new Map,this.fu=$o.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function LV(n,t,e=!0){const s=Vg(n);let i;const a=s.Tu.get(t);return a?(s.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await kR(s,t,e,!0),i}async function jV(n,t){const e=Vg(n);await kR(e,t,!0,!1)}async function kR(n,t,e,s){const i=await wc(n.localStore,Wn(t)),a=i.targetId,l=n.sharedClientState.addLocalQueryTarget(a,e);let u;return s&&(u=await Vb(n,t,a,l==="current",i.resumeToken)),n.isPrimaryClient&&e&&kg(n.remoteStore,i),u}async function Vb(n,t,e,s,i){n.pu=(_,x,E)=>(async function(T,R,M,L){let O=R.view.ru(M);O.Cs&&(O=await tg(T.localStore,R.query,!1).then((({documents:D})=>R.view.ru(D,O))));const H=L&&L.targetChanges.get(R.targetId),B=L&&L.targetMismatches.get(R.targetId)!=null,z=R.view.applyChanges(O,T.isPrimaryClient,H,B);return h0(T,R.targetId,z.au),z.snapshot})(n,_,x,E);const a=await tg(n.localStore,t,!0),l=new OR(t,a.Qs),u=l.ru(a.documents),h=vd.createSynthesizedTargetChangeForCurrentChange(e,s&&n.onlineState!=="Offline",i),f=l.applyChanges(u,n.isPrimaryClient,h);h0(n,e,f.au);const m=new kV(t,e,l);return n.Tu.set(t,m),n.Iu.has(e)?n.Iu.get(e).push(t):n.Iu.set(e,[t]),f.snapshot}async function BV(n,t,e){const s=xt(n),i=s.Tu.get(t),a=s.Iu.get(i.targetId);if(a.length>1)return s.Iu.set(i.targetId,a.filter((l=>!_d(l,t)))),void s.Tu.delete(t);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(i.targetId),s.sharedClientState.isActiveQueryTarget(i.targetId)||await Sc(s.localStore,i.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(i.targetId),e&&Ac(s.remoteStore,i.targetId),Rc(s,i.targetId)})).catch(Ia)):(Rc(s,i.targetId),await Sc(s.localStore,i.targetId,!0))}async function FV(n,t){const e=xt(n),s=e.Tu.get(t),i=e.Iu.get(s.targetId);e.isPrimaryClient&&i.length===1&&(e.sharedClientState.removeLocalQueryTarget(s.targetId),Ac(e.remoteStore,s.targetId))}async function UV(n,t,e){const s=Bb(n);try{const i=await(function(l,u){const h=xt(l),f=oe.now(),m=u.reduce(((E,S)=>E.add(S.key)),Ft());let _,x;return h.persistence.runTransaction("Locally write mutations","readwrite",(E=>{let S=ss(),T=Ft();return h.Ns.getEntries(E,m).next((R=>{S=R,S.forEach(((M,L)=>{L.isValidDocument()||(T=T.add(M))}))})).next((()=>h.localDocuments.getOverlayedDocuments(E,S))).next((R=>{_=R;const M=[];for(const L of u){const O=c4(L,_.get(L.key).overlayedDocument);O!=null&&M.push(new or(L.key,O,hI(O.value.mapValue),Ce.exists(!0)))}return h.mutationQueue.addMutationBatch(E,f,M,u)})).next((R=>{x=R;const M=R.applyToLocalDocumentSet(_,T);return h.documentOverlayCache.saveOverlays(E,R.batchId,M)}))})).then((()=>({batchId:x.batchId,changes:wI(_)})))})(s.localStore,t);s.sharedClientState.addPendingMutation(i.batchId),(function(l,u,h){let f=l.Vu[l.currentUser.toKey()];f||(f=new Te(Vt)),f=f.insert(u,h),l.Vu[l.currentUser.toKey()]=f})(s,i.batchId,e),await lr(s,i.changes),await Hc(s.remoteStore)}catch(i){const a=Gc(i,"Failed to persist write");e.reject(a)}}async function VR(n,t){const e=xt(n);try{const s=await sV(e.localStore,t);t.targetChanges.forEach(((i,a)=>{const l=e.Au.get(a);l&&(wt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?l.hu=!0:i.modifiedDocuments.size>0?wt(l.hu,14607):i.removedDocuments.size>0&&(wt(l.hu,42227),l.hu=!1))})),await lr(e,s,t)}catch(s){await Ia(s)}}function g1(n,t,e){const s=xt(n);if(s.isPrimaryClient&&e===0||!s.isPrimaryClient&&e===1){const i=[];s.Tu.forEach(((a,l)=>{const u=l.view.va(t);u.snapshot&&i.push(u.snapshot)})),(function(l,u){const h=xt(l);h.onlineState=u;let f=!1;h.queries.forEach(((m,_)=>{for(const x of _.Sa)x.va(u)&&(f=!0)})),f&&Ob(h)})(s.eventManager,t),i.length&&s.Pu.H_(i),s.onlineState=t,s.isPrimaryClient&&s.sharedClientState.setOnlineState(t)}}async function zV(n,t,e){const s=xt(n);s.sharedClientState.updateQueryState(t,"rejected",e);const i=s.Au.get(t),a=i&&i.key;if(a){let l=new Te(pt.comparator);l=l.insert(a,Se.newNoDocument(a,Rt.min()));const u=Ft().add(a),h=new xd(Rt.min(),new Map,new Te(Vt),l,u);await VR(s,h),s.du=s.du.remove(a),s.Au.delete(t),jb(s)}else await Sc(s.localStore,t,!1).then((()=>Rc(s,t,e))).catch(Ia)}async function HV(n,t){const e=xt(n),s=t.batch.batchId;try{const i=await nV(e.localStore,t);Lb(e,s,null),Pb(e,s),e.sharedClientState.updateMutationState(s,"acknowledged"),await lr(e,i)}catch(i){await Ia(i)}}async function qV(n,t,e){const s=xt(n);try{const i=await(function(l,u){const h=xt(l);return h.persistence.runTransaction("Reject batch","readwrite-primary",(f=>{let m;return h.mutationQueue.lookupMutationBatch(f,u).next((_=>(wt(_!==null,37113),m=_.keys(),h.mutationQueue.removeMutationBatch(f,_)))).next((()=>h.mutationQueue.performConsistencyCheck(f))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(f,m,u))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,m))).next((()=>h.localDocuments.getDocuments(f,m)))}))})(s.localStore,t);Lb(s,t,e),Pb(s,t),s.sharedClientState.updateMutationState(t,"rejected",e),await lr(s,i)}catch(i){await Ia(i)}}async function GV(n,t){const e=xt(n);Na(e.remoteStore)||ct(Ca,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const s=await(function(l){const u=xt(l);return u.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(h=>u.mutationQueue.getHighestUnacknowledgedBatchId(h)))})(e.localStore);if(s===ca)return void t.resolve();const i=e.mu.get(s)||[];i.push(t),e.mu.set(s,i)}catch(s){const i=Gc(s,"Initialization of waitForPendingWrites() operation failed");t.reject(i)}}function Pb(n,t){(n.mu.get(t)||[]).forEach((e=>{e.resolve()})),n.mu.delete(t)}function Lb(n,t,e){const s=xt(n);let i=s.Vu[s.currentUser.toKey()];if(i){const a=i.get(t);a&&(e?a.reject(e):a.resolve(),i=i.remove(t)),s.Vu[s.currentUser.toKey()]=i}}function Rc(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const s of n.Iu.get(t))n.Tu.delete(s),e&&n.Pu.yu(s,e);n.Iu.delete(t),n.isPrimaryClient&&n.Ru.jr(t).forEach((s=>{n.Ru.containsKey(s)||PR(n,s)}))}function PR(n,t){n.Eu.delete(t.path.canonicalString());const e=n.du.get(t);e!==null&&(Ac(n.remoteStore,e),n.du=n.du.remove(t),n.Au.delete(e),jb(n))}function h0(n,t,e){for(const s of e)s instanceof CR?(n.Ru.addReference(s.key,t),$V(n,s)):s instanceof MR?(ct(Ca,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,t),n.Ru.containsKey(s.key)||PR(n,s.key)):vt(19791,{wu:s})}function $V(n,t){const e=t.key,s=e.path.canonicalString();n.du.get(e)||n.Eu.has(s)||(ct(Ca,"New document in limbo: "+e),n.Eu.add(s),jb(n))}function jb(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const t=n.Eu.values().next().value;n.Eu.delete(t);const e=new pt(Wt.fromString(t)),s=n.fu.next();n.Au.set(s,new VV(e)),n.du=n.du.insert(e,s),kg(n.remoteStore,new Qi(Wn(Bc(e.path)),s,"TargetPurposeLimboResolution",es.ce))}}async function lr(n,t,e){const s=xt(n),i=[],a=[],l=[];s.Tu.isEmpty()||(s.Tu.forEach(((u,h)=>{l.push(s.pu(h,t,e).then((f=>{var m;if((f||e)&&s.isPrimaryClient){const _=f?!f.fromCache:(m=e==null?void 0:e.targetChanges.get(h.targetId))==null?void 0:m.current;s.sharedClientState.updateQueryState(h.targetId,_?"current":"not-current")}if(f){i.push(f);const _=Tb.As(h.targetId,f);a.push(_)}})))})),await Promise.all(l),s.Pu.H_(i),await(async function(h,f){const m=xt(h);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>W.forEach(f,(x=>W.forEach(x.Es,(E=>m.persistence.referenceDelegate.addReference(_,x.targetId,E))).next((()=>W.forEach(x.ds,(E=>m.persistence.referenceDelegate.removeReference(_,x.targetId,E)))))))))}catch(_){if(!Ra(_))throw _;ct(wb,"Failed to update sequence numbers: "+_)}for(const _ of f){const x=_.targetId;if(!_.fromCache){const E=m.Ms.get(x),S=E.snapshotVersion,T=E.withLastLimboFreeSnapshotVersion(S);m.Ms=m.Ms.insert(x,T)}}})(s.localStore,a))}async function WV(n,t){const e=xt(n);if(!e.currentUser.isEqual(t)){ct(Ca,"User change. New user:",t.toKey());const s=await fR(e.localStore,t);e.currentUser=t,(function(a,l){a.mu.forEach((u=>{u.forEach((h=>{h.reject(new lt(tt.CANCELLED,l))}))})),a.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,s.removedBatchIds,s.addedBatchIds),await lr(e,s.Ls)}}function YV(n,t){const e=xt(n),s=e.Au.get(t);if(s&&s.hu)return Ft().add(s.key);{let i=Ft();const a=e.Iu.get(t);if(!a)return i;for(const l of a){const u=e.Tu.get(l);i=i.unionWith(u.view.nu)}return i}}async function KV(n,t){const e=xt(n),s=await tg(e.localStore,t.query,!0),i=t.view.cu(s);return e.isPrimaryClient&&h0(e,t.targetId,i.au),i}async function QV(n,t){const e=xt(n);return _R(e.localStore,t).then((s=>lr(e,s)))}async function XV(n,t,e,s){const i=xt(n),a=await(function(u,h){const f=xt(u),m=xt(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",(_=>m.er(_,h).next((x=>x?f.localDocuments.getDocuments(_,x):W.resolve(null)))))})(i.localStore,t);a!==null?(e==="pending"?await Hc(i.remoteStore):e==="acknowledged"||e==="rejected"?(Lb(i,t,s||null),Pb(i,t),(function(u,h){xt(xt(u).mutationQueue).ir(h)})(i.localStore,t)):vt(6720,"Unknown batchState",{Su:e}),await lr(i,a)):ct(Ca,"Cannot apply mutation batch with id: "+t)}async function ZV(n,t){const e=xt(n);if(Vg(e),Bb(e),t===!0&&e.gu!==!0){const s=e.sharedClientState.getAllActiveQueryTargets(),i=await p1(e,s.toArray());e.gu=!0,await c0(e.remoteStore,!0);for(const a of i)kg(e.remoteStore,a)}else if(t===!1&&e.gu!==!1){const s=[];let i=Promise.resolve();e.Iu.forEach(((a,l)=>{e.sharedClientState.isLocalQueryTarget(l)?s.push(l):i=i.then((()=>(Rc(e,l),Sc(e.localStore,l,!0)))),Ac(e.remoteStore,l)})),await i,await p1(e,s),(function(l){const u=xt(l);u.Au.forEach(((h,f)=>{Ac(u.remoteStore,f)})),u.Ru.Jr(),u.Au=new Map,u.du=new Te(pt.comparator)})(e),e.gu=!1,await c0(e.remoteStore,!1)}}async function p1(n,t,e){const s=xt(n),i=[],a=[];for(const l of t){let u;const h=s.Iu.get(l);if(h&&h.length!==0){u=await wc(s.localStore,Wn(h[0]));for(const f of h){const m=s.Tu.get(f),_=await KV(s,m);_.snapshot&&a.push(_.snapshot)}}else{const f=await pR(s.localStore,l);u=await wc(s.localStore,f),await Vb(s,LR(f),l,!1,u.resumeToken)}i.push(u)}return s.Pu.H_(a),i}function LR(n){return bI(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function JV(n){return(function(e){return xt(xt(e).persistence).Ts()})(xt(n).localStore)}async function tP(n,t,e,s){const i=xt(n);if(i.gu)return void ct(Ca,"Ignoring unexpected query state notification.");const a=i.Iu.get(t);if(a&&a.length>0)switch(e){case"current":case"not-current":{const l=await _R(i.localStore,vI(a[0])),u=xd.createSynthesizedRemoteEventForCurrentChange(t,e==="current",Be.EMPTY_BYTE_STRING);await lr(i,l,u);break}case"rejected":await Sc(i.localStore,t,!0),Rc(i,t,s);break;default:vt(64155,e)}}async function eP(n,t,e){const s=Vg(n);if(s.gu){for(const i of t){if(s.Iu.has(i)&&s.sharedClientState.isActiveQueryTarget(i)){ct(Ca,"Adding an already active target "+i);continue}const a=await pR(s.localStore,i),l=await wc(s.localStore,a);await Vb(s,LR(a),l.targetId,!1,l.resumeToken),kg(s.remoteStore,l)}for(const i of e)s.Iu.has(i)&&await Sc(s.localStore,i,!1).then((()=>{Ac(s.remoteStore,i),Rc(s,i)})).catch(Ia)}}function Vg(n){const t=xt(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=VR.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=YV.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=zV.bind(null,t),t.Pu.H_=NV.bind(null,t.eventManager),t.Pu.yu=CV.bind(null,t.eventManager),t}function Bb(n){const t=xt(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=HV.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=qV.bind(null,t),t}function nP(n,t,e){const s=xt(n);(async function(a,l,u){try{const h=await l.getMetadata();if(await(function(E,S){const T=xt(E),R=Ke(S.createTime);return T.persistence.runTransaction("hasNewerBundle","readonly",(M=>T.Ii.getBundleMetadata(M,S.id))).then((M=>!!M&&M.createTime.compareTo(R)>=0))})(a.localStore,h))return await l.close(),u._completeWith((function(E){return{taskState:"Success",documentsLoaded:E.totalDocuments,bytesLoaded:E.totalBytes,totalDocuments:E.totalDocuments,totalBytes:E.totalBytes}})(h)),Promise.resolve(new Set);u._updateProgress(NR(h));const f=new OV(h,l.serializer);let m=await l.bu();for(;m;){const x=await f.Ga(m);x&&u._updateProgress(x),m=await l.bu()}const _=await f.ja(a.localStore);return await lr(a,_.Ha,void 0),await(function(E,S){const T=xt(E);return T.persistence.runTransaction("Save bundle","readwrite",(R=>T.Ii.saveBundleMetadata(R,S)))})(a.localStore,h),u._completeWith(_.progress),Promise.resolve(_.Ja)}catch(h){return vi(Ca,`Loading bundle failed with ${h}`),u._failWith(h),Promise.resolve(new Set)}})(s,t,e).then((i=>{s.sharedClientState.notifyBundleLoaded(i)}))}class Xh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Ed(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return dR(this.persistence,new hR,t.initialUser,this.serializer)}Cu(t){return new xb(Og.mi,this.serializer)}Du(t){return new ER}async terminate(){var t,e;(t=this.gcScheduler)==null||t.stop(),(e=this.indexBackfillerScheduler)==null||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Xh.provider={build:()=>new Xh};class sP extends Xh{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){wt(this.persistence.referenceDelegate instanceof Jm,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new rR(s,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?On.withCacheSize(this.cacheSizeBytes):On.DEFAULT;return new xb((s=>Jm.mi(s,e)),this.serializer)}}class jR extends Xh{constructor(t,e,s){super(),this.xu=t,this.cacheSizeBytes=e,this.forceOwnership=s,this.kind="persistent",this.synchronizeTabs=!1}async initialize(t){await super.initialize(t),await this.xu.initialize(this,t),await Bb(this.xu.syncEngine),await Hc(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(t){return dR(this.persistence,new hR,t.initialUser,this.serializer)}Fu(t,e){const s=this.persistence.referenceDelegate.garbageCollector;return new rR(s,t.asyncQueue,e)}Mu(t,e){const s=new dk(e,this.persistence);return new hk(t.asyncQueue,s)}Cu(t){const e=Eb(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?On.withCacheSize(this.cacheSizeBytes):On.DEFAULT;return new vb(this.synchronizeTabs,e,t.clientId,s,t.asyncQueue,TR(),Dm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(t){return new ER}}class iP extends jR{constructor(t,e){super(t,e,!1),this.xu=t,this.cacheSizeBytes=e,this.synchronizeTabs=!0}async initialize(t){await super.initialize(t);const e=this.xu.syncEngine;this.sharedClientState instanceof py&&(this.sharedClientState.syncEngine={Co:XV.bind(null,e),vo:tP.bind(null,e),Fo:eP.bind(null,e),Ts:JV.bind(null,e),Do:QV.bind(null,e)},await this.sharedClientState.start()),await this.persistence.Ji((async s=>{await ZV(this.xu.syncEngine,s),this.gcScheduler&&(s&&!this.gcScheduler.started?this.gcScheduler.start():s||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(s&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():s||this.indexBackfillerScheduler.stop())}))}Du(t){const e=TR();if(!py.v(e))throw new lt(tt.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=Eb(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new py(e,t.asyncQueue,s,t.clientId,t.initialUser)}}class Zh{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>g1(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=WV.bind(null,this.syncEngine),await c0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new DV})()}createDatastore(t){const e=Ed(t.databaseInfo.databaseId),s=(function(a){return new hV(a)})(t.databaseInfo);return(function(a,l,u,h){return new gV(a,l,u,h)})(t.authCredentials,t.appCheckCredentials,s,e)}createRemoteStore(t){return(function(s,i,a,l,u){return new _V(s,i,a,l,u)})(this.localStore,this.datastore,t.asyncQueue,(e=>g1(this.syncEngine,e,0)),(function(){return l1.v()?new l1:new oV})())}createSyncEngine(t,e){return(function(i,a,l,u,h,f,m){const _=new PV(i,a,l,u,h,f);return m&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t,e;await(async function(i){const a=xt(i);ct(Wo,"RemoteStore shutting down."),a.Ea.add(5),await zc(a),a.Aa.shutdown(),a.Ra.set("Unknown")})(this.remoteStore),(t=this.datastore)==null||t.terminate(),(e=this.eventManager)==null||e.terminate()}}Zh.provider={build:()=>new Zh};function _1(n,t=10240){let e=0;return{async read(){if(e<n.byteLength){const s={value:n.slice(e,e+t),done:!1};return e+=t,s}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):We("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(t,e){this.Bu=t,this.serializer=e,this.metadata=new An,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((s=>{s&&s.$a()?this.metadata.resolve(s.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(s==null?void 0:s.Qa)}`))}),(s=>this.metadata.reject(s)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const t=await this.qu();if(t===null)return null;const e=this.Lu.decode(t),s=Number(e);isNaN(s)&&this.Qu(`length string (${e}) is not valid number`);const i=await this.$u(s);return new MV(JSON.parse(i),t.length+s)}Uu(){return this.buffer.findIndex((t=>t===123))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const t=this.Uu();t<0&&this.Qu("Reached the end of bundle when a length string is expected.");const e=this.buffer.slice(0,t);return this.buffer=this.buffer.slice(t),e}async $u(t){for(;this.buffer.length<t;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const e=this.Lu.decode(this.buffer.slice(0,t));return this.buffer=this.buffer.slice(t),e}Qu(t){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${t}`)}async Ku(){const t=await this.Bu.read();if(!t.done){const e=new Uint8Array(this.buffer.length+t.value.length);e.set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e}return t.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(t){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new lt(tt.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const e=await(async function(i,a){const l=xt(i),u={documents:a.map((_=>Kh(l.serializer,_)))},h=await l.Ho("BatchGetDocuments",l.serializer.databaseId,Wt.emptyPath(),u,a.length),f=new Map;h.forEach((_=>{const x=y4(l.serializer,_);f.set(x.key.toString(),x)}));const m=[];return a.forEach((_=>{const x=f.get(_.toString());wt(!!x,55234,{key:_}),m.push(x)})),m})(this.datastore,t);return e.forEach((s=>this.recordVersion(s))),e}set(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())}update(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(s){this.lastTransactionError=s}this.writtenDocs.add(t.toString())}delete(t){this.write(new Uc(t,this.precondition(t))),this.writtenDocs.add(t.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const t=this.readVersions;this.mutations.forEach((e=>{t.delete(e.key.toString())})),t.forEach(((e,s)=>{const i=pt.fromPath(s);this.mutations.push(new ub(i,this.precondition(i)))})),await(async function(s,i){const a=xt(s),l={writes:i.map((u=>Qh(a.serializer,u)))};await a.Go("Commit",a.serializer.databaseId,Wt.emptyPath(),l)})(this.datastore,this.mutations),this.committed=!0}recordVersion(t){let e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw vt(50498,{Gu:t.constructor.name});e=Rt.min()}const s=this.readVersions.get(t.key.toString());if(s){if(!e.isEqual(s))throw new lt(tt.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)}precondition(t){const e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?e.isEqual(Rt.min())?Ce.exists(!1):Ce.updateTime(e):Ce.none()}preconditionForUpdate(t){const e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(Rt.min()))throw new lt(tt.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ce.updateTime(e)}return Ce.exists(!0)}write(t){this.ensureCommitNotCalled(),this.mutations.push(t)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(t,e,s,i,a){this.asyncQueue=t,this.datastore=e,this.options=s,this.updateFunction=i,this.deferred=a,this.zu=s.maxAttempts,this.M_=new Ab(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const t=new aP(this.datastore),e=this.Hu(t);e&&e.then((s=>{this.asyncQueue.enqueueAndForget((()=>t.commit().then((()=>{this.deferred.resolve(s)})).catch((i=>{this.Yu(i)}))))})).catch((s=>{this.Yu(s)}))}))}Hu(t){try{const e=this.updateFunction(t);return!md(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Yu(t){this.zu>0&&this.Zu(t)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(t)}Zu(t){if((t==null?void 0:t.name)==="FirebaseError"){const e=t.code;return e==="aborted"||e==="failed-precondition"||e==="already-exists"||!kI(e)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const va="FirestoreClient";class lP{constructor(t,e,s,i,a){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=s,this.databaseInfo=i,this.user=_n.UNAUTHENTICATED,this.clientId=Q0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(s,(async l=>{ct(va,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(s,(l=>(ct(va,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new An;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const s=Gc(e,"Failed to shutdown persistence");t.reject(s)}})),t.promise}}async function yy(n,t){n.asyncQueue.verifyOperationInProgress(),ct(va,"Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let s=e.initialUser;n.setCredentialChangeListener((async i=>{s.isEqual(i)||(await fR(t.localStore,i),s=i)})),t.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=t}async function y1(n,t){n.asyncQueue.verifyOperationInProgress();const e=await Fb(n);ct(va,"Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener((s=>u1(t.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,i)=>u1(t.remoteStore,i))),n._onlineComponents=t}async function Fb(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ct(va,"Using user provided OfflineComponentProvider");try{await yy(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(i){return i.name==="FirebaseError"?i.code===tt.FAILED_PRECONDITION||i.code===tt.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(e))throw e;vi("Error using user provided cache. Falling back to memory cache: "+e),await yy(n,new Xh)}}else ct(va,"Using default OfflineComponentProvider"),await yy(n,new sP(void 0));return n._offlineComponents}async function Lg(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ct(va,"Using user provided OnlineComponentProvider"),await y1(n,n._uninitializedComponentsProvider._online)):(ct(va,"Using default OnlineComponentProvider"),await y1(n,new Zh))),n._onlineComponents}function BR(n){return Fb(n).then((t=>t.persistence))}function Ub(n){return Fb(n).then((t=>t.localStore))}function FR(n){return Lg(n).then((t=>t.remoteStore))}function zb(n){return Lg(n).then((t=>t.syncEngine))}function cP(n){return Lg(n).then((t=>t.datastore))}async function Dc(n){const t=await Lg(n),e=t.eventManager;return e.onListen=LV.bind(null,t.syncEngine),e.onUnlisten=BV.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=jV.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=FV.bind(null,t.syncEngine),e}function uP(n){return n.asyncQueue.enqueue((async()=>{const t=await BR(n),e=await FR(n);return t.setNetworkEnabled(!0),(function(i){const a=xt(i);return a.Ea.delete(0),Td(a)})(e)}))}function hP(n){return n.asyncQueue.enqueue((async()=>{const t=await BR(n),e=await FR(n);return t.setNetworkEnabled(!1),(async function(i){const a=xt(i);a.Ea.add(0),await zc(a),a.Ra.set("Offline")})(e)}))}function dP(n,t){const e=new An;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,a,l){try{const u=await(function(f,m){const _=xt(f);return _.persistence.runTransaction("read document","readonly",(x=>_.localDocuments.getDocument(x,m)))})(i,a);u.isFoundDocument()?l.resolve(u):u.isNoDocument()?l.resolve(null):l.reject(new lt(tt.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){const h=Gc(u,`Failed to get document '${a} from cache`);l.reject(h)}})(await Ub(n),t,e))),e.promise}function UR(n,t,e={}){const s=new An;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,u,h,f){const m=new Pg({next:x=>{m.Nu(),l.enqueueAndForget((()=>Mb(a,_)));const E=x.docs.has(u);!E&&x.fromCache?f.reject(new lt(tt.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&x.fromCache&&h&&h.source==="server"?f.reject(new lt(tt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(x)},error:x=>f.reject(x)}),_=new kb(Bc(u.path),m,{includeMetadataChanges:!0,qa:!0});return Cb(a,_)})(await Dc(n),n.asyncQueue,t,e,s))),s.promise}function fP(n,t){const e=new An;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,a,l){try{const u=await tg(i,a,!0),h=new OR(a,u.Qs),f=h.ru(u.documents),m=h.applyChanges(f,!1);l.resolve(m.snapshot)}catch(u){const h=Gc(u,`Failed to execute query '${a} against cache`);l.reject(h)}})(await Ub(n),t,e))),e.promise}function zR(n,t,e={}){const s=new An;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,u,h,f){const m=new Pg({next:x=>{m.Nu(),l.enqueueAndForget((()=>Mb(a,_))),x.fromCache&&h.source==="server"?f.reject(new lt(tt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(x)},error:x=>f.reject(x)}),_=new kb(u,m,{includeMetadataChanges:!0,qa:!0});return Cb(a,_)})(await Dc(n),n.asyncQueue,t,e,s))),s.promise}function mP(n,t){const e=new Pg(t);return n.asyncQueue.enqueueAndForget((async()=>(function(i,a){xt(i).Ca.add(a),a.next()})(await Dc(n),e))),()=>{e.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(i,a){xt(i).Ca.delete(a)})(await Dc(n),e)))}}function gP(n,t,e,s){const i=(function(l,u){let h;return h=typeof l=="string"?PI().encode(l):l,(function(m,_){return new rP(m,_)})((function(m,_){if(m instanceof Uint8Array)return _1(m,_);if(m instanceof ArrayBuffer)return _1(new Uint8Array(m),_);if(m instanceof ReadableStream)return m.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(h),u)})(e,Ed(t));n.asyncQueue.enqueueAndForget((async()=>{nP(await zb(n),i,s)}))}function pP(n,t){return n.asyncQueue.enqueue((async()=>(function(s,i){const a=xt(s);return a.persistence.runTransaction("Get named query","readonly",(l=>a.Ii.getNamedQuery(l,i)))})(await Ub(n),t)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HR(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b1=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qR="firestore.googleapis.com",x1=!0;class v1{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new lt(tt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=qR,this.ssl=x1}else this.host=t.host,this.ssl=t.ssl??x1;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=eR;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<L4)throw new lt(tt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}L2("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=HR(t.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new lt(tt.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new lt(tt.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new lt(tt.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(s,i){return s.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class wd{constructor(t,e,s,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=s,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new v1({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new lt(tt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new lt(tt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new v1(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new JO;switch(s.type){case"firstParty":return new sk(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new lt(tt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const s=b1.get(e);s&&(ct("ComponentProvider","Removing Datastore"),b1.delete(e),s.terminate())})(this),Promise.resolve()}}function _P(n,t,e,s={}){var f;n=re(n,wd);const i=U0(t),a=n._getSettings(),l={...a,emulatorOptions:n._getEmulatorOptions()},u=`${t}:${e}`;i&&(pM(`https://${u}`),xM("Firestore",!0)),a.host!==qR&&a.host!==u&&vi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...a,host:u,ssl:i,emulatorOptions:s};if(!lc(h,l)&&(n._setSettings(h),s.mockUserToken)){let m,_;if(typeof s.mockUserToken=="string")m=s.mockUserToken,_=_n.MOCK_USER;else{m=_M(s.mockUserToken,(f=n._app)==null?void 0:f.options.projectId);const x=s.mockUserToken.sub||s.mockUserToken.user_id;if(!x)throw new lt(tt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new _n(x)}n._authCredentials=new tk(new V2(m,_))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yn=class GR{constructor(t,e,s){this.converter=e,this._query=s,this.type="query",this.firestore=t}withConverter(t){return new GR(this.firestore,t,this._query)}},Ee=class mh{constructor(t,e,s){this.converter=e,this._key=s,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ua(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new mh(this.firestore,t,this._key)}toJSON(){return{type:mh._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,s){if(fd(e,mh._jsonSchema))return new mh(t,s||null,new pt(Wt.fromString(e.referencePath)))}};Ee._jsonSchemaVersion="firestore/documentReference/1.0",Ee._jsonSchema={type:tn("string",Ee._jsonSchemaVersion),referencePath:tn("string")};let ua=class $R extends Yn{constructor(t,e,s){super(t,e,Bc(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Ee(this.firestore,null,new pt(t))}withConverter(t){return new $R(this.firestore,t,this._path)}};function WR(n,t,...e){if(n=en(n),X0("collection","path",t),n instanceof wd){const s=Wt.fromString(t,...e);return cw(s),new ua(n,null,s)}{if(!(n instanceof Ee||n instanceof ua))throw new lt(tt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Wt.fromString(t,...e));return cw(s),new ua(n.firestore,null,s)}}function yP(n,t){if(n=re(n,wd),X0("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new lt(tt.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Yn(n,null,(function(s){return new rr(Wt.emptyPath(),s)})(t))}function ig(n,t,...e){if(n=en(n),arguments.length===1&&(t=Q0.newId()),X0("doc","path",t),n instanceof wd){const s=Wt.fromString(t,...e);return lw(s),new Ee(n,null,new pt(s))}{if(!(n instanceof Ee||n instanceof ua))throw new lt(tt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Wt.fromString(t,...e));return lw(s),new Ee(n.firestore,n instanceof ua?n.converter:null,new pt(s))}}function YR(n,t){return n=en(n),t=en(t),(n instanceof Ee||n instanceof ua)&&(t instanceof Ee||t instanceof ua)&&n.firestore===t.firestore&&n.path===t.path&&n.converter===t.converter}function KR(n,t){return n=en(n),t=en(t),n instanceof Yn&&t instanceof Yn&&n.firestore===t.firestore&&_d(n._query,t._query)&&n.converter===t.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1="AsyncQueue";class T1{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ab(this,"async_queue_retry"),this._c=()=>{const s=Dm();s&&ct(E1,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=t;const e=Dm();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=Dm();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new An;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Xu.push(t),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!Ra(t))throw t;ct(E1,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((s=>{throw this.nc=s,this.rc=!1,We("INTERNAL UNHANDLED ERROR: ",w1(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=e,e}enqueueAfterDelay(t,e,s){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const i=Nb.createAndSchedule(this,t,e,s,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&vt(47125,{Pc:w1(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,s)=>e.targetTimeMs-s.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}dc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function w1(n){let t=n.message||"";return n.stack&&(t=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d0(n){return(function(e,s){if(typeof e!="object"||e===null)return!1;const i=e;for(const a of s)if(a in i&&typeof i[a]=="function")return!0;return!1})(n,["next","error","complete"])}class bP{constructor(){this._progressObserver={},this._taskCompletionResolver=new An,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(t,e,s){this._progressObserver={next:t,error:e,complete:s}}catch(t){return this._taskCompletionResolver.promise.catch(t)}then(t,e){return this._taskCompletionResolver.promise.then(t,e)}_completeWith(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)}_failWith(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)}_updateProgress(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xP=-1;let Qe=class extends wd{constructor(t,e,s,i){super(t,e,s,i),this.type="firestore",this._queue=new T1,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new T1(t),this._firestoreClient=void 0,await t}}};function Bn(n){if(n._terminated)throw new lt(tt.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||QR(n),n._firestoreClient}function QR(n){var s,i,a;const t=n._freezeSettings(),e=(function(u,h,f,m){return new Uk(u,h,f,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,HR(m.experimentalLongPollingOptions),m.useFetchStreams,m.isUsingEmulator)})(n._databaseId,((s=n._app)==null?void 0:s.options.appId)||"",n._persistenceKey,t);n._componentsProvider||(i=t.localCache)!=null&&i._offlineComponentProvider&&((a=t.localCache)!=null&&a._onlineComponentProvider)&&(n._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),n._firestoreClient=new lP(n._authCredentials,n._appCheckCredentials,n._queue,e,n._componentsProvider&&(function(u){const h=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(h),_online:h}})(n._componentsProvider))}function vP(n,t){vi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();return XR(n,Zh.provider,{build:s=>new jR(s,e.cacheSizeBytes,t==null?void 0:t.forceOwnership)}),Promise.resolve()}async function EP(n){vi("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();XR(n,Zh.provider,{build:e=>new iP(e,t.cacheSizeBytes)})}function XR(n,t,e){if((n=re(n,Qe))._firestoreClient||n._terminated)throw new lt(tt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new lt(tt.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:t,_offline:e},QR(n)}function TP(n){if(n._initialized&&!n._terminated)throw new lt(tt.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new An;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(s){if(!pi.v())return Promise.resolve();const i=s+uR;await pi.delete(i)})(Eb(n._databaseId,n._persistenceKey)),t.resolve()}catch(e){t.reject(e)}})),t.promise}function wP(n){return(function(e){const s=new An;return e.asyncQueue.enqueueAndForget((async()=>GV(await zb(e),s))),s.promise})(Bn(n=re(n,Qe)))}function SP(n){return uP(Bn(n=re(n,Qe)))}function AP(n){return hP(Bn(n=re(n,Qe)))}function IP(n,t){const e=Bn(n=re(n,Qe)),s=new bP;return gP(e,n._databaseId,t,s),s}function RP(n,t){return pP(Bn(n=re(n,Qe)),t).then((e=>e?new Yn(n,null,e.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Vn(Be.fromBase64String(t))}catch(e){throw new lt(tt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new Vn(Be.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Vn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(fd(t,Vn._jsonSchema))return Vn.fromBase64String(t.bytes)}}Vn._jsonSchemaVersion="firestore/bytes/1.0",Vn._jsonSchema={type:tn("string",Vn._jsonSchemaVersion),bytes:tn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ea=class{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new lt(tt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ne(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jo=class{constructor(t){this._methodName=t}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new lt(tt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new lt(tt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Vt(this._lat,t._lat)||Vt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Gs._jsonSchemaVersion}}static fromJSON(t){if(fd(t,Gs._jsonSchema))return new Gs(t.latitude,t.longitude)}}Gs._jsonSchemaVersion="firestore/geoPoint/1.0",Gs._jsonSchema={type:tn("string",Gs._jsonSchemaVersion),latitude:tn("number"),longitude:tn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(s,i){if(s.length!==i.length)return!1;for(let a=0;a<s.length;++a)if(s[a]!==i[a])return!1;return!0})(this._values,t._values)}toJSON(){return{type:yi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(fd(t,yi._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new yi(t.vectorValues);throw new lt(tt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}yi._jsonSchemaVersion="firestore/vectorValue/1.0",yi._jsonSchema={type:tn("string",yi._jsonSchemaVersion),vectorValues:tn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DP=/^__.*__$/;class NP{constructor(t,e,s){this.data=t,this.fieldMask=e,this.fieldTransforms=s}toMutation(t,e){return this.fieldMask!==null?new or(t,this.data,this.fieldMask,e,this.fieldTransforms):new Fc(t,this.data,e,this.fieldTransforms)}}class ZR{constructor(t,e,s){this.data=t,this.fieldMask=e,this.fieldTransforms=s}toMutation(t,e){return new or(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function JR(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw vt(40011,{Ac:n})}}class jg{constructor(t,e,s,i,a,l){this.settings=t,this.databaseId=e,this.serializer=s,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new jg({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){var i;const e=(i=this.path)==null?void 0:i.child(t),s=this.Vc({path:e,fc:!1});return s.gc(t),s}yc(t){var i;const e=(i=this.path)==null?void 0:i.child(t),s=this.Vc({path:e,fc:!1});return s.Rc(),s}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return rg(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return this.fieldMask.find((e=>t.isPrefixOf(e)))!==void 0||this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))!==void 0}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(t.length===0)throw this.Sc("Document fields must not be empty");if(JR(this.Ac)&&DP.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class CP{constructor(t,e,s){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=s||Ed(t)}Cc(t,e,s,i=!1){return new jg({Ac:t,methodName:e,Dc:s,path:Ne.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function tl(n){const t=n._freezeSettings(),e=Ed(n._databaseId);return new CP(n._databaseId,!!t.ignoreUndefinedProperties,e)}function Bg(n,t,e,s,i,a={}){const l=n.Cc(a.merge||a.mergeFields?2:0,t,e,i);Kb("Data must be an object, but it was:",l,s);const u=nD(s,l);let h,f;if(a.merge)h=new ns(l.fieldMask),f=l.fieldTransforms;else if(a.mergeFields){const m=[];for(const _ of a.mergeFields){const x=f0(t,_,e);if(!l.contains(x))throw new lt(tt.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);iD(m,x)||m.push(x)}h=new ns(m),f=l.fieldTransforms.filter((_=>h.covers(_.field)))}else h=null,f=l.fieldTransforms;return new NP(new Sn(u),h,f)}class Sd extends Jo{_toFieldTransform(t){if(t.Ac!==2)throw t.Ac===1?t.Sc(`${this._methodName}() can only appear at the top level of your update data`):t.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Sd}}function tD(n,t,e){return new jg({Ac:3,Dc:t.settings.Dc,methodName:n._methodName,fc:e},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class Hb extends Jo{_toFieldTransform(t){return new bd(t.path,new vc)}isEqual(t){return t instanceof Hb}}class qb extends Jo{constructor(t,e){super(t),this.vc=e}_toFieldTransform(t){const e=tD(this,t,!0),s=this.vc.map((a=>el(a,e))),i=new zo(s);return new bd(t.path,i)}isEqual(t){return t instanceof qb&&lc(this.vc,t.vc)}}class Gb extends Jo{constructor(t,e){super(t),this.vc=e}_toFieldTransform(t){const e=tD(this,t,!0),s=this.vc.map((a=>el(a,e))),i=new Ho(s);return new bd(t.path,i)}isEqual(t){return t instanceof Gb&&lc(this.vc,t.vc)}}class $b extends Jo{constructor(t,e){super(t),this.Fc=e}_toFieldTransform(t){const e=new Ec(t.serializer,II(t.serializer,this.Fc));return new bd(t.path,e)}isEqual(t){return t instanceof $b&&this.Fc===t.Fc}}function Wb(n,t,e,s){const i=n.Cc(1,t,e);Kb("Data must be an object, but it was:",i,s);const a=[],l=Sn.empty();Da(s,((h,f)=>{const m=Qb(t,h,e);f=en(f);const _=i.yc(m);if(f instanceof Sd)a.push(m);else{const x=el(f,_);x!=null&&(a.push(m),l.set(m,x))}}));const u=new ns(a);return new ZR(l,u,i.fieldTransforms)}function Yb(n,t,e,s,i,a){const l=n.Cc(1,t,e),u=[f0(t,s,e)],h=[i];if(a.length%2!=0)throw new lt(tt.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<a.length;x+=2)u.push(f0(t,a[x])),h.push(a[x+1]);const f=[],m=Sn.empty();for(let x=u.length-1;x>=0;--x)if(!iD(f,u[x])){const E=u[x];let S=h[x];S=en(S);const T=l.yc(E);if(S instanceof Sd)f.push(E);else{const R=el(S,T);R!=null&&(f.push(E),m.set(E,R))}}const _=new ns(f);return new ZR(m,_,l.fieldTransforms)}function eD(n,t,e,s=!1){return el(e,n.Cc(s?4:3,t))}function el(n,t){if(sD(n=en(n)))return Kb("Unsupported field value:",t,n),nD(n,t);if(n instanceof Jo)return(function(s,i){if(!JR(i.Ac))throw i.Sc(`${s._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${s._methodName}() is not currently supported inside arrays`);const a=s._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc("Nested arrays are not supported");return(function(s,i){const a=[];let l=0;for(const u of s){let h=el(u,i.wc(l));h==null&&(h={nullValue:"NULL_VALUE"}),a.push(h),l++}return{arrayValue:{values:a}}})(n,t)}return(function(s,i){if((s=en(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return II(i.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const a=oe.fromDate(s);return{timestampValue:Tc(i.serializer,a)}}if(s instanceof oe){const a=new oe(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Tc(i.serializer,a)}}if(s instanceof Gs)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Vn)return{bytesValue:BI(i.serializer,s._byteString)};if(s instanceof Ee){const a=i.databaseId,l=s.firestore._databaseId;if(!l.isEqual(a))throw i.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:gb(s.firestore._databaseId||i.databaseId,s._key.path)}}if(s instanceof yi)return(function(l,u){return{mapValue:{fields:{[ib]:{stringValue:rb},[yc]:{arrayValue:{values:l.toArray().map((f=>{if(typeof f!="number")throw u.Sc("VectorValues must only contain numeric values.");return cb(u.serializer,f)}))}}}}}})(s,i);throw i.Sc(`Unsupported field value: ${vg(s)}`)})(n,t)}function nD(n,t){const e={};return nI(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Da(n,((s,i)=>{const a=el(i,t.mc(s));a!=null&&(e[s]=a)})),{mapValue:{fields:e}}}function sD(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof oe||n instanceof Gs||n instanceof Vn||n instanceof Ee||n instanceof Jo||n instanceof yi)}function Kb(n,t,e){if(!sD(e)||!j2(e)){const s=vg(e);throw s==="an object"?t.Sc(n+" a custom object"):t.Sc(n+" "+s)}}function f0(n,t,e){if((t=en(t))instanceof Ea)return t._internalPath;if(typeof t=="string")return Qb(n,t);throw rg("Field path arguments must be of type string or ",n,!1,void 0,e)}const MP=new RegExp("[~\\*/\\[\\]]");function Qb(n,t,e){if(t.search(MP)>=0)throw rg(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new Ea(...t.split("."))._internalPath}catch{throw rg(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function rg(n,t,e,s,i){const a=s&&!s.isEmpty(),l=i!==void 0;let u=`Function ${t}() called with invalid data`;e&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(a||l)&&(h+=" (found",a&&(h+=` in field ${s}`),l&&(h+=` in document ${i}`),h+=")"),new lt(tt.INVALID_ARGUMENT,u+n+h)}function iD(n,t){return n.some((e=>e.isEqual(t)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(t,e,s,i,a){this._firestore=t,this._userDataWriter=e,this._key=s,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Ee(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new OP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Fg("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class OP extends Jh{data(){return super.data()}}function Fg(n,t){return typeof t=="string"?Qb(n,t):t instanceof Ea?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rD(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new lt(tt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Xb{}class Ad extends Xb{}function Zr(n,t,...e){let s=[];t instanceof Xb&&s.push(t),s=s.concat(e),(function(a){const l=a.filter((h=>h instanceof Zb)).length,u=a.filter((h=>h instanceof Ug)).length;if(l>1||l>0&&u>0)throw new lt(tt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const i of s)n=i._apply(n);return n}class Ug extends Ad{constructor(t,e,s){super(),this._field=t,this._op=e,this._value=s,this.type="where"}static _create(t,e,s){return new Ug(t,e,s)}_apply(t){const e=this._parse(t);return oD(t._query,e),new Yn(t.firestore,t.converter,Jy(t._query,e))}_parse(t){const e=tl(t.firestore);return(function(a,l,u,h,f,m,_){let x;if(f.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new lt(tt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){A1(_,m);const S=[];for(const T of _)S.push(S1(h,a,T));x={arrayValue:{values:S}}}else x=S1(h,a,_)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||A1(_,m),x=eD(u,l,_,m==="in"||m==="not-in");return Kt.create(f,m,x)})(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}}function kP(n,t,e){const s=t,i=Fg("where",n);return Ug._create(i,s,e)}class Zb extends Xb{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new Zb(t,e)}_parse(t){const e=this._queryConstraints.map((s=>s._parse(t))).filter((s=>s.getFilters().length>0));return e.length===1?e[0]:de.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return e.getFilters().length===0?t:((function(i,a){let l=i;const u=a.getFlattenedFilters();for(const h of u)oD(l,h),l=Jy(l,h)})(t._query,e),new Yn(t.firestore,t.converter,Jy(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Jb extends Ad{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new Jb(t,e)}_apply(t){const e=(function(i,a,l){if(i.startAt!==null)throw new lt(tt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new lt(tt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Yh(a,l)})(t._query,this._field,this._direction);return new Yn(t.firestore,t.converter,(function(i,a){const l=i.explicitOrderBy.concat([a]);return new rr(i.path,i.collectionGroup,l,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(t._query,e))}}function VP(n,t="asc"){const e=t,s=Fg("orderBy",n);return Jb._create(s,e)}class zg extends Ad{constructor(t,e,s){super(),this.type=t,this._limit=e,this._limitType=s}static _create(t,e,s){return new zg(t,e,s)}_apply(t){return new Yn(t.firestore,t.converter,Km(t._query,this._limit,this._limitType))}}function PP(n){return B2("limit",n),zg._create("limit",n,"F")}function LP(n){return B2("limitToLast",n),zg._create("limitToLast",n,"L")}class Hg extends Ad{constructor(t,e,s){super(),this.type=t,this._docOrFields=e,this._inclusive=s}static _create(t,e,s){return new Hg(t,e,s)}_apply(t){const e=aD(t,this.type,this._docOrFields,this._inclusive);return new Yn(t.firestore,t.converter,(function(i,a){return new rr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,a,i.endAt)})(t._query,e))}}function jP(...n){return Hg._create("startAt",n,!0)}function BP(...n){return Hg._create("startAfter",n,!1)}class qg extends Ad{constructor(t,e,s){super(),this.type=t,this._docOrFields=e,this._inclusive=s}static _create(t,e,s){return new qg(t,e,s)}_apply(t){const e=aD(t,this.type,this._docOrFields,this._inclusive);return new Yn(t.firestore,t.converter,(function(i,a){return new rr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,a)})(t._query,e))}}function FP(...n){return qg._create("endBefore",n,!1)}function UP(...n){return qg._create("endAt",n,!0)}function aD(n,t,e,s){if(e[0]=en(e[0]),e[0]instanceof Jh)return(function(a,l,u,h,f){if(!h)throw new lt(tt.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${u}().`);const m=[];for(const _ of rc(a))if(_.field.isKeyField())m.push(Fo(l,h.key));else{const x=h.data.field(_.field);if(Ag(x))throw new lt(tt.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+_.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(x===null){const E=_.field.canonicalString();throw new lt(tt.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${E}' (used as the orderBy) does not exist.`)}m.push(x)}return new ba(m,f)})(n._query,n.firestore._databaseId,t,e[0]._document,s);{const i=tl(n.firestore);return(function(l,u,h,f,m,_){const x=l.explicitOrderBy;if(m.length>x.length)throw new lt(tt.INVALID_ARGUMENT,`Too many arguments provided to ${f}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const E=[];for(let S=0;S<m.length;S++){const T=m[S];if(x[S].field.isKeyField()){if(typeof T!="string")throw new lt(tt.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${f}(), but got a ${typeof T}`);if(!ob(l)&&T.indexOf("/")!==-1)throw new lt(tt.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${f}() must be a plain document ID, but '${T}' contains a slash.`);const R=l.path.child(Wt.fromString(T));if(!pt.isDocumentKey(R))throw new lt(tt.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${f}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);const M=new pt(R);E.push(Fo(u,M))}else{const R=eD(h,f,T);E.push(R)}}return new ba(E,_)})(n._query,n.firestore._databaseId,i,t,e,s)}}function S1(n,t,e){if(typeof(e=en(e))=="string"){if(e==="")throw new lt(tt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ob(t)&&e.indexOf("/")!==-1)throw new lt(tt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const s=t.path.child(Wt.fromString(e));if(!pt.isDocumentKey(s))throw new lt(tt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Fo(n,new pt(s))}if(e instanceof Ee)return Fo(n,e._key);throw new lt(tt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${vg(e)}.`)}function A1(n,t){if(!Array.isArray(n)||n.length===0)throw new lt(tt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function oD(n,t){const e=(function(i,a){for(const l of i)for(const u of l.getFlattenedFilters())if(a.indexOf(u.op)>=0)return u.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(t.op));if(e!==null)throw e===t.op?new lt(tt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new lt(tt.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}class tx{convertValue(t,e="none"){switch(_a(t)){case 0:return null;case 1:return t.booleanValue;case 2:return De(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(sr(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw vt(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const s={};return Da(t,((i,a)=>{s[i]=this.convertValue(a,e)})),s}convertVectorValue(t){var s,i,a;const e=(a=(i=(s=t.fields)==null?void 0:s[yc].arrayValue)==null?void 0:i.values)==null?void 0:a.map((l=>De(l.doubleValue)));return new yi(e)}convertGeoPoint(t){return new Gs(De(t.latitude),De(t.longitude))}convertArray(t,e){return(t.values||[]).map((s=>this.convertValue(s,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const s=Ig(t);return s==null?null:this.convertValue(s,e);case"estimate":return this.convertTimestamp(Gh(t));default:return null}}convertTimestamp(t){const e=nr(t);return new oe(e.seconds,e.nanos)}convertDocumentKey(t,e){const s=Wt.fromString(t);wt(QI(s),9688,{name:t});const i=new pa(s.get(1),s.get(3)),a=new pt(s.popFirst(5));return i.isEqual(e)||We(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gg(n,t,e){let s;return s=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,s}class zP extends tx{constructor(t){super(),this.firestore=t}convertBytes(t){return new Vn(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Ee(this.firestore,null,e)}}class Mo{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}let Cs=class lD extends Jh{constructor(t,e,s,i,a,l){super(t,e,s,i,l),this._firestore=t,this._firestoreImpl=t,this.metadata=a}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Mh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const s=this._document.data.field(Fg("DocumentSnapshot.get",t));if(s!==null)return this._userDataWriter.convertValue(s,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new lt(tt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=lD._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}};Cs._jsonSchemaVersion="firestore/documentSnapshot/1.0",Cs._jsonSchema={type:tn("string",Cs._jsonSchemaVersion),bundleSource:tn("string","DocumentSnapshot"),bundleName:tn("string"),bundle:tn("string")};let Mh=class extends Cs{data(t={}){return super.data(t)}},$s=class cD{constructor(t,e,s,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new Mo(i.hasPendingWrites,i.fromCache),this.query=s}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((s=>{t.call(e,new Mh(this._firestore,this._userDataWriter,s.key,s,new Mo(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new lt(tt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let l=0;return i._snapshot.docChanges.map((u=>{const h=new Mh(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Mo(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:l++}}))}{let l=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((u=>a||u.type!==3)).map((u=>{const h=new Mh(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Mo(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let f=-1,m=-1;return u.type!==0&&(f=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),m=l.indexOf(u.doc.key)),{type:HP(u.type),doc:h,oldIndex:f,newIndex:m}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new lt(tt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=cD._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Q0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],s=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(e.push(a._document),s.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}};function HP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return vt(61501,{type:n})}}function uD(n,t){return n instanceof Cs&&t instanceof Cs?n._firestore===t._firestore&&n._key.isEqual(t._key)&&(n._document===null?t._document===null:n._document.isEqual(t._document))&&n._converter===t._converter:n instanceof $s&&t instanceof $s&&n._firestore===t._firestore&&KR(n.query,t.query)&&n.metadata.isEqual(t.metadata)&&n._snapshot.isEqual(t._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qP(n){n=re(n,Ee);const t=re(n.firestore,Qe);return UR(Bn(t),n._key).then((e=>ex(t,n,e)))}$s._jsonSchemaVersion="firestore/querySnapshot/1.0",$s._jsonSchema={type:tn("string",$s._jsonSchemaVersion),bundleSource:tn("string","QuerySnapshot"),bundleName:tn("string"),bundle:tn("string")};class nl extends tx{constructor(t){super(),this.firestore=t}convertBytes(t){return new Vn(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Ee(this.firestore,null,e)}}function GP(n){n=re(n,Ee);const t=re(n.firestore,Qe),e=Bn(t),s=new nl(t);return dP(e,n._key).then((i=>new Cs(t,s,n._key,i,new Mo(i!==null&&i.hasLocalMutations,!0),n.converter)))}function $P(n){n=re(n,Ee);const t=re(n.firestore,Qe);return UR(Bn(t),n._key,{source:"server"}).then((e=>ex(t,n,e)))}function WP(n){n=re(n,Yn);const t=re(n.firestore,Qe),e=Bn(t),s=new nl(t);return rD(n._query),zR(e,n._query).then((i=>new $s(t,s,n,i)))}function YP(n){n=re(n,Yn);const t=re(n.firestore,Qe),e=Bn(t),s=new nl(t);return fP(e,n._query).then((i=>new $s(t,s,n,i)))}function KP(n){n=re(n,Yn);const t=re(n.firestore,Qe),e=Bn(t),s=new nl(t);return zR(e,n._query,{source:"server"}).then((i=>new $s(t,s,n,i)))}function I1(n,t,e){n=re(n,Ee);const s=re(n.firestore,Qe),i=Gg(n.converter,t,e);return Id(s,[Bg(tl(s),"setDoc",n._key,i,n.converter!==null,e).toMutation(n._key,Ce.none())])}function R1(n,t,e,...s){n=re(n,Ee);const i=re(n.firestore,Qe),a=tl(i);let l;return l=typeof(t=en(t))=="string"||t instanceof Ea?Yb(a,"updateDoc",n._key,t,e,s):Wb(a,"updateDoc",n._key,t),Id(i,[l.toMutation(n._key,Ce.exists(!0))])}function QP(n){return Id(re(n.firestore,Qe),[new Uc(n._key,Ce.none())])}function XP(n,t){const e=re(n.firestore,Qe),s=ig(n),i=Gg(n.converter,t);return Id(e,[Bg(tl(n.firestore),"addDoc",s._key,i,n.converter!==null,{}).toMutation(s._key,Ce.exists(!1))]).then((()=>s))}function hD(n,...t){var h,f,m;n=en(n);let e={includeMetadataChanges:!1,source:"default"},s=0;typeof t[s]!="object"||d0(t[s])||(e=t[s++]);const i={includeMetadataChanges:e.includeMetadataChanges,source:e.source};if(d0(t[s])){const _=t[s];t[s]=(h=_.next)==null?void 0:h.bind(_),t[s+1]=(f=_.error)==null?void 0:f.bind(_),t[s+2]=(m=_.complete)==null?void 0:m.bind(_)}let a,l,u;if(n instanceof Ee)l=re(n.firestore,Qe),u=Bc(n._key.path),a={next:_=>{t[s]&&t[s](ex(l,n,_))},error:t[s+1],complete:t[s+2]};else{const _=re(n,Yn);l=re(_.firestore,Qe),u=_._query;const x=new nl(l);a={next:E=>{t[s]&&t[s](new $s(l,x,_,E))},error:t[s+1],complete:t[s+2]},rD(n._query)}return(function(x,E,S,T){const R=new Pg(T),M=new kb(E,R,S);return x.asyncQueue.enqueueAndForget((async()=>Cb(await Dc(x),M))),()=>{R.Nu(),x.asyncQueue.enqueueAndForget((async()=>Mb(await Dc(x),M)))}})(Bn(l),u,i,a)}function ZP(n,t){return mP(Bn(n=re(n,Qe)),d0(t)?t:{next:t})}function Id(n,t){return(function(s,i){const a=new An;return s.asyncQueue.enqueueAndForget((async()=>UV(await zb(s),i,a))),a.promise})(Bn(n),t)}function ex(n,t,e){const s=e.docs.get(t._key),i=new nl(n);return new Cs(n,i,t._key,s,new Mo(e.hasPendingWrites,e.fromCache),t.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JP={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tL=class{constructor(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=tl(t)}set(t,e,s){this._verifyNotCommitted();const i=na(t,this._firestore),a=Gg(i.converter,e,s),l=Bg(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,s);return this._mutations.push(l.toMutation(i._key,Ce.none())),this}update(t,e,s,...i){this._verifyNotCommitted();const a=na(t,this._firestore);let l;return l=typeof(e=en(e))=="string"||e instanceof Ea?Yb(this._dataReader,"WriteBatch.update",a._key,e,s,i):Wb(this._dataReader,"WriteBatch.update",a._key,e),this._mutations.push(l.toMutation(a._key,Ce.exists(!0))),this}delete(t){this._verifyNotCommitted();const e=na(t,this._firestore);return this._mutations=this._mutations.concat(new Uc(e._key,Ce.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new lt(tt.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function na(n,t){if((n=en(n)).firestore!==t)throw new lt(tt.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(t,e){this._firestore=t,this._transaction=e,this._dataReader=tl(t)}get(t){const e=na(t,this._firestore),s=new zP(this._firestore);return this._transaction.lookup([e._key]).then((i=>{if(!i||i.length!==1)return vt(24041);const a=i[0];if(a.isFoundDocument())return new Jh(this._firestore,s,a.key,a,e.converter);if(a.isNoDocument())return new Jh(this._firestore,s,e._key,null,e.converter);throw vt(18433,{doc:a})}))}set(t,e,s){const i=na(t,this._firestore),a=Gg(i.converter,e,s),l=Bg(this._dataReader,"Transaction.set",i._key,a,i.converter!==null,s);return this._transaction.set(i._key,l),this}update(t,e,s,...i){const a=na(t,this._firestore);let l;return l=typeof(e=en(e))=="string"||e instanceof Ea?Yb(this._dataReader,"Transaction.update",a._key,e,s,i):Wb(this._dataReader,"Transaction.update",a._key,e),this._transaction.update(a._key,l),this}delete(t){const e=na(t,this._firestore);return this._transaction.delete(e._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nL=class extends eL{constructor(t,e){super(t,e),this._firestore=t}get(t){const e=na(t,this._firestore),s=new nl(this._firestore);return super.get(t).then((i=>new Cs(this._firestore,s,e._key,i._document,new Mo(!1,!1),e.converter)))}};function sL(n,t,e){n=re(n,Qe);const s={...JP,...e};return(function(a){if(a.maxAttempts<1)throw new lt(tt.INVALID_ARGUMENT,"Max attempts must be at least 1")})(s),(function(a,l,u){const h=new An;return a.asyncQueue.enqueueAndForget((async()=>{const f=await cP(a);new oP(a.asyncQueue,f,u,l,h).ju()})),h.promise})(Bn(n),(i=>t(new nL(n,i))),s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iL(){return new Sd("deleteField")}function rL(){return new Hb("serverTimestamp")}function aL(...n){return new qb("arrayUnion",n)}function oL(...n){return new Gb("arrayRemove",n)}function lL(n){return new $b("increment",n)}(function(t,e=!0){(function(i){jc=i})($0),hc(new Bo("firestore",((s,{instanceIdentifier:i,options:a})=>{const l=s.getProvider("app").getImmediate(),u=new Qe(new ek(s.getProvider("auth-internal")),new ik(l,s.getProvider("app-check-internal")),(function(f,m){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new lt(tt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pa(f.options.projectId,m)})(l,i),l);return a={useFetchStreams:e,...a},u._setSettings(a),u}),"PUBLIC").setMultipleInstances(!0)),tr(iw,rw,t),tr(iw,rw,"esm2020")})();const cL="@firebase/firestore-compat",uL="0.4.2";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nx(n,t){if(t===void 0)return{merge:!1};if(t.mergeFields!==void 0&&t.merge!==void 0)throw new lt("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D1(){if(typeof Uint8Array>"u")throw new lt("unimplemented","Uint8Arrays are not available in this environment.")}function N1(){if(!Bk())throw new lt("unimplemented","Blobs are unavailable in Firestore in this environment.")}let dD=class m0{constructor(t){this._delegate=t}static fromBase64String(t){return N1(),new m0(Vn.fromBase64String(t))}static fromUint8Array(t){return D1(),new m0(Vn.fromUint8Array(t))}toBase64(){return N1(),this._delegate.toBase64()}toUint8Array(){return D1(),this._delegate.toUint8Array()}isEqual(t){return this._delegate.isEqual(t._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(n){return hL(n,["next","error","complete"])}function hL(n,t){if(typeof n!="object"||n===null)return!1;const e=n;for(const s of t)if(s in e&&typeof e[s]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{enableIndexedDbPersistence(t,e){return vP(t._delegate,{forceOwnership:e})}enableMultiTabIndexedDbPersistence(t){return EP(t._delegate)}clearIndexedDbPersistence(t){return TP(t._delegate)}}class fD{constructor(t,e,s){this._delegate=e,this._persistenceProvider=s,this.INTERNAL={delete:()=>this.terminate()},t instanceof pa||(this._appCompat=t)}get _databaseId(){return this._delegate._databaseId}settings(t){const e=this._delegate._getSettings();!t.merge&&e.host!==t.host&&vi("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&(t={...e,...t},delete t.merge),this._delegate._setSettings(t)}useEmulator(t,e,s={}){_P(this._delegate,t,e,s)}enableNetwork(){return SP(this._delegate)}disableNetwork(){return AP(this._delegate)}enablePersistence(t){let e=!1,s=!1;return t&&(e=!!t.synchronizeTabs,s=!!t.experimentalForceOwningTab,L2("synchronizeTabs",e,"experimentalForceOwningTab",s)),e?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,s)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return wP(this._delegate)}onSnapshotsInSync(t){return ZP(this._delegate,t)}get app(){if(!this._appCompat)throw new lt("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(t){try{return new Nc(this,WR(this._delegate,t))}catch(e){throw $n(e,"collection()","Firestore.collection()")}}doc(t){try{return new Ns(this,ig(this._delegate,t))}catch(e){throw $n(e,"doc()","Firestore.doc()")}}collectionGroup(t){try{return new Gn(this,yP(this._delegate,t))}catch(e){throw $n(e,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(t){return sL(this._delegate,e=>t(new mD(this,e)))}batch(){return Bn(this._delegate),new gD(new tL(this._delegate,t=>Id(this._delegate,t)))}loadBundle(t){return IP(this._delegate,t)}namedQuery(t){return RP(this._delegate,t).then(e=>e?new Gn(this,e):null)}}class $g extends tx{constructor(t){super(),this.firestore=t}convertBytes(t){return new dD(new Vn(t))}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return Ns.forKey(e,this.firestore,null)}}function fL(n){XO(n)}class mD{constructor(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new $g(t)}get(t){const e=Oo(t);return this._delegate.get(e).then(s=>new td(this._firestore,new Cs(this._firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,e.converter)))}set(t,e,s){const i=Oo(t);return s?(nx("Transaction.set",s),this._delegate.set(i,e,s)):this._delegate.set(i,e),this}update(t,e,s,...i){const a=Oo(t);return arguments.length===2?this._delegate.update(a,e):this._delegate.update(a,e,s,...i),this}delete(t){const e=Oo(t);return this._delegate.delete(e),this}}class gD{constructor(t){this._delegate=t}set(t,e,s){const i=Oo(t);return s?(nx("WriteBatch.set",s),this._delegate.set(i,e,s)):this._delegate.set(i,e),this}update(t,e,s,...i){const a=Oo(t);return arguments.length===2?this._delegate.update(a,e):this._delegate.update(a,e,s,...i),this}delete(t){const e=Oo(t);return this._delegate.delete(e),this}commit(){return this._delegate.commit()}}class Yo{constructor(t,e,s){this._firestore=t,this._userDataWriter=e,this._delegate=s}fromFirestore(t,e){const s=new Mh(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new ed(this._firestore,s),e??{})}toFirestore(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)}static getInstance(t,e){const s=Yo.INSTANCES;let i=s.get(t);i||(i=new WeakMap,s.set(t,i));let a=i.get(e);return a||(a=new Yo(t,new $g(t),e),i.set(e,a)),a}}Yo.INSTANCES=new WeakMap;class Ns{constructor(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new $g(t)}static forPath(t,e,s){if(t.length%2!==0)throw new lt("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${t.canonicalString()} has ${t.length}`);return new Ns(e,new Ee(e._delegate,s,new pt(t)))}static forKey(t,e,s){return new Ns(e,new Ee(e._delegate,s,t))}get id(){return this._delegate.id}get parent(){return new Nc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(t){try{return new Nc(this.firestore,WR(this._delegate,t))}catch(e){throw $n(e,"collection()","DocumentReference.collection()")}}isEqual(t){return t=en(t),t instanceof Ee?YR(this._delegate,t):!1}set(t,e){e=nx("DocumentReference.set",e);try{return e?I1(this._delegate,t,e):I1(this._delegate,t)}catch(s){throw $n(s,"setDoc()","DocumentReference.set()")}}update(t,e,...s){try{return arguments.length===1?R1(this._delegate,t):R1(this._delegate,t,e,...s)}catch(i){throw $n(i,"updateDoc()","DocumentReference.update()")}}delete(){return QP(this._delegate)}onSnapshot(...t){const e=pD(t),s=_D(t,i=>new td(this.firestore,new Cs(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return hD(this._delegate,e,s)}get(t){let e;return(t==null?void 0:t.source)==="cache"?e=GP(this._delegate):(t==null?void 0:t.source)==="server"?e=$P(this._delegate):e=qP(this._delegate),e.then(s=>new td(this.firestore,new Cs(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)))}withConverter(t){return new Ns(this.firestore,t?this._delegate.withConverter(Yo.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}function $n(n,t,e){return n.message=n.message.replace(t,e),n}function pD(n){for(const t of n)if(typeof t=="object"&&!g0(t))return t;return{}}function _D(n,t){var s,i;let e;return g0(n[0])?e=n[0]:g0(n[1])?e=n[1]:typeof n[0]=="function"?e={next:n[0],error:n[1],complete:n[2]}:e={next:n[1],error:n[2],complete:n[3]},{next:a=>{e.next&&e.next(t(a))},error:(s=e.error)==null?void 0:s.bind(e),complete:(i=e.complete)==null?void 0:i.bind(e)}}class td{constructor(t,e){this._firestore=t,this._delegate=e}get ref(){return new Ns(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(t){return this._delegate.data(t)}get(t,e){return this._delegate.get(t,e)}isEqual(t){return uD(this._delegate,t._delegate)}}class ed extends td{data(t){const e=this._delegate.data(t);return this._delegate._converter||ZO(e!==void 0,"Document in a QueryDocumentSnapshot should exist"),e}}class Gn{constructor(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new $g(t)}where(t,e,s){try{return new Gn(this.firestore,Zr(this._delegate,kP(t,e,s)))}catch(i){throw $n(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(t,e){try{return new Gn(this.firestore,Zr(this._delegate,VP(t,e)))}catch(s){throw $n(s,/(orderBy|where)\(\)/,"Query.$1()")}}limit(t){try{return new Gn(this.firestore,Zr(this._delegate,PP(t)))}catch(e){throw $n(e,"limit()","Query.limit()")}}limitToLast(t){try{return new Gn(this.firestore,Zr(this._delegate,LP(t)))}catch(e){throw $n(e,"limitToLast()","Query.limitToLast()")}}startAt(...t){try{return new Gn(this.firestore,Zr(this._delegate,jP(...t)))}catch(e){throw $n(e,"startAt()","Query.startAt()")}}startAfter(...t){try{return new Gn(this.firestore,Zr(this._delegate,BP(...t)))}catch(e){throw $n(e,"startAfter()","Query.startAfter()")}}endBefore(...t){try{return new Gn(this.firestore,Zr(this._delegate,FP(...t)))}catch(e){throw $n(e,"endBefore()","Query.endBefore()")}}endAt(...t){try{return new Gn(this.firestore,Zr(this._delegate,UP(...t)))}catch(e){throw $n(e,"endAt()","Query.endAt()")}}isEqual(t){return KR(this._delegate,t._delegate)}get(t){let e;return(t==null?void 0:t.source)==="cache"?e=YP(this._delegate):(t==null?void 0:t.source)==="server"?e=KP(this._delegate):e=WP(this._delegate),e.then(s=>new p0(this.firestore,new $s(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)))}onSnapshot(...t){const e=pD(t),s=_D(t,i=>new p0(this.firestore,new $s(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return hD(this._delegate,e,s)}withConverter(t){return new Gn(this.firestore,t?this._delegate.withConverter(Yo.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}class mL{constructor(t,e){this._firestore=t,this._delegate=e}get type(){return this._delegate.type}get doc(){return new ed(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class p0{constructor(t,e){this._firestore=t,this._delegate=e}get query(){return new Gn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(t=>new ed(this._firestore,t))}docChanges(t){return this._delegate.docChanges(t).map(e=>new mL(this._firestore,e))}forEach(t,e){this._delegate.forEach(s=>{t.call(e,new ed(this._firestore,s))})}isEqual(t){return uD(this._delegate,t._delegate)}}class Nc extends Gn{constructor(t,e){super(t,e),this.firestore=t,this._delegate=e}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const t=this._delegate.parent;return t?new Ns(this.firestore,t):null}doc(t){try{return t===void 0?new Ns(this.firestore,ig(this._delegate)):new Ns(this.firestore,ig(this._delegate,t))}catch(e){throw $n(e,"doc()","CollectionReference.doc()")}}add(t){return XP(this._delegate,t).then(e=>new Ns(this.firestore,e))}isEqual(t){return YR(this._delegate,t._delegate)}withConverter(t){return new Nc(this.firestore,t?this._delegate.withConverter(Yo.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}function Oo(n){return re(n,Ee)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sx{constructor(...t){this._delegate=new Ea(...t)}static documentId(){return new sx(Ne.keyField().canonicalString())}isEqual(t){return t=en(t),t instanceof Ea?this._delegate._internalPath.isEqual(t._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{static serverTimestamp(){const t=rL();return t._methodName="FieldValue.serverTimestamp",new No(t)}static delete(){const t=iL();return t._methodName="FieldValue.delete",new No(t)}static arrayUnion(...t){const e=aL(...t);return e._methodName="FieldValue.arrayUnion",new No(e)}static arrayRemove(...t){const e=oL(...t);return e._methodName="FieldValue.arrayRemove",new No(e)}static increment(t){const e=lL(t);return e._methodName="FieldValue.increment",new No(e)}constructor(t){this._delegate=t}isEqual(t){return this._delegate.isEqual(t._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gL={Firestore:fD,GeoPoint:Gs,Timestamp:oe,Blob:dD,Transaction:mD,WriteBatch:gD,DocumentReference:Ns,DocumentSnapshot:td,Query:Gn,QueryDocumentSnapshot:ed,QuerySnapshot:p0,CollectionReference:Nc,FieldPath:sx,FieldValue:No,setLogLevel:fL,CACHE_SIZE_UNLIMITED:xP};function pL(n,t){n.INTERNAL.registerComponent(new Bo("firestore-compat",e=>{const s=e.getProvider("app-compat").getImmediate(),i=e.getProvider("firestore").getImmediate();return t(s,i)},"PUBLIC").setServiceProps({...gL}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _L(n){pL(n,(t,e)=>new fD(t,e,new dL)),n.registerVersion(cL,uL)}_L(Th);const yL=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),bL=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"})}),xL=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),vL=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),EL=n=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]}),TL=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),wL=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6H8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"})}),SL=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),AL=({page:n,currentPage:t,setCurrentPage:e,children:s,Icon:i})=>{const a=t===n;return y.jsxs("button",{onClick:()=>e(n),className:`flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200 ease-in-out ${a?"bg-white/15 text-white font-semibold":"text-indigo-100 hover:bg-white/10 hover:text-white"}`,children:[y.jsx(i,{className:"h-5 w-5 mr-2 flex-shrink-0"}),s]})},IL=({currentPage:n,setCurrentPage:t})=>{const[e,s]=ut.useState(!1),i=[{page:"dashboard",label:"首頁",icon:yL},{page:"data-manager",label:"資料管理",icon:bL},{page:"asset-management",label:"資產總覽",icon:xL},{page:"cashflow-management",label:"收支帳本",icon:vL},{page:"budget-missions",label:"預算檢視",icon:EL},{page:"investment-tracking",label:"投資追蹤",icon:TL},{page:"financial-goals",label:"目標進度",icon:wL},{page:"report-analysis",label:"報表分析",icon:SL}];return y.jsxs("nav",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 shadow-lg sticky top-0 z-40",children:[y.jsx("div",{className:"container mx-auto px-4 sm:px-6",children:y.jsxs("div",{className:"flex items-center justify-between h-16",children:[y.jsx("div",{className:"flex items-center",children:y.jsx("h1",{className:"text-xl font-bold text-white",children:"個人財務導航中心"})}),y.jsx("div",{className:"hidden md:block",children:y.jsx("div",{className:"ml-10 flex flex-wrap items-baseline justify-end gap-x-2 gap-y-1",children:i.map(a=>y.jsx(AL,{page:a.page,currentPage:n,setCurrentPage:t,Icon:a.icon,children:a.label},a.page))})}),y.jsx("div",{className:"-mr-2 flex md:hidden",children:y.jsxs("button",{onClick:()=>s(!e),type:"button",className:"bg-indigo-600 inline-flex items-center justify-center p-2 rounded-md text-indigo-200 hover:text-white hover:bg-indigo-500 focus:outline-none","aria-controls":"mobile-menu","aria-expanded":"false",children:[y.jsx("span",{className:"sr-only",children:"開啟主選單"}),e?y.jsx("svg",{className:"block h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}):y.jsx("svg",{className:"block h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})]})})]})}),e&&y.jsx("div",{className:"md:hidden",id:"mobile-menu",children:y.jsx("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3",children:i.map(a=>{const l=a.icon;return y.jsxs("button",{onClick:()=>{t(a.page),s(!1)},className:`w-full text-left flex items-center px-3 py-2 rounded-md text-base font-medium transition-colors duration-200 ${n===a.page?"bg-indigo-700 text-white":"text-indigo-200 hover:bg-indigo-600 hover:text-white"}`,children:[y.jsx(l,{className:"h-5 w-5 mr-3 flex-shrink-0"}),a.label]},a.page)})})})]})},RL=()=>y.jsx("footer",{className:"bg-gray-800 text-white p-4 mt-8",children:y.jsxs("div",{className:"container mx-auto text-center text-sm",children:["© ",new Date().getFullYear()," 個人財務導航中心。"]})}),DL=({notification:n})=>{if(!n.show)return null;const t="fixed top-5 right-5 text-white px-6 py-3 rounded-lg shadow-2xl z-50 transform transition-all duration-300",e=n.show?"translate-x-0 opacity-100":"translate-x-full opacity-0",s={success:"bg-green-500",error:"bg-red-500",info:"bg-blue-500"};return y.jsx("div",{className:`${t} ${s[n.type]} ${e}`,children:n.message})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Rd(n){return n+.5|0}const sa=(n,t,e)=>Math.max(Math.min(n,e),t);function gh(n){return sa(Rd(n*2.55),0,255)}function ha(n){return sa(Rd(n*255),0,255)}function Ki(n){return sa(Rd(n/2.55)/100,0,1)}function C1(n){return sa(Rd(n*100),0,100)}const Ds={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},_0=[..."0123456789ABCDEF"],NL=n=>_0[n&15],CL=n=>_0[(n&240)>>4]+_0[n&15],rm=n=>(n&240)>>4===(n&15),ML=n=>rm(n.r)&&rm(n.g)&&rm(n.b)&&rm(n.a);function OL(n){var t=n.length,e;return n[0]==="#"&&(t===4||t===5?e={r:255&Ds[n[1]]*17,g:255&Ds[n[2]]*17,b:255&Ds[n[3]]*17,a:t===5?Ds[n[4]]*17:255}:(t===7||t===9)&&(e={r:Ds[n[1]]<<4|Ds[n[2]],g:Ds[n[3]]<<4|Ds[n[4]],b:Ds[n[5]]<<4|Ds[n[6]],a:t===9?Ds[n[7]]<<4|Ds[n[8]]:255})),e}const kL=(n,t)=>n<255?t(n):"";function VL(n){var t=ML(n)?NL:CL;return n?"#"+t(n.r)+t(n.g)+t(n.b)+kL(n.a,t):void 0}const PL=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function yD(n,t,e){const s=t*Math.min(e,1-e),i=(a,l=(a+n/30)%12)=>e-s*Math.max(Math.min(l-3,9-l,1),-1);return[i(0),i(8),i(4)]}function LL(n,t,e){const s=(i,a=(i+n/60)%6)=>e-e*t*Math.max(Math.min(a,4-a,1),0);return[s(5),s(3),s(1)]}function jL(n,t,e){const s=yD(n,1,.5);let i;for(t+e>1&&(i=1/(t+e),t*=i,e*=i),i=0;i<3;i++)s[i]*=1-t-e,s[i]+=t;return s}function BL(n,t,e,s,i){return n===i?(t-e)/s+(t<e?6:0):t===i?(e-n)/s+2:(n-t)/s+4}function ix(n){const e=n.r/255,s=n.g/255,i=n.b/255,a=Math.max(e,s,i),l=Math.min(e,s,i),u=(a+l)/2;let h,f,m;return a!==l&&(m=a-l,f=u>.5?m/(2-a-l):m/(a+l),h=BL(e,s,i,m,a),h=h*60+.5),[h|0,f||0,u]}function rx(n,t,e,s){return(Array.isArray(t)?n(t[0],t[1],t[2]):n(t,e,s)).map(ha)}function ax(n,t,e){return rx(yD,n,t,e)}function FL(n,t,e){return rx(jL,n,t,e)}function UL(n,t,e){return rx(LL,n,t,e)}function bD(n){return(n%360+360)%360}function zL(n){const t=PL.exec(n);let e=255,s;if(!t)return;t[5]!==s&&(e=t[6]?gh(+t[5]):ha(+t[5]));const i=bD(+t[2]),a=+t[3]/100,l=+t[4]/100;return t[1]==="hwb"?s=FL(i,a,l):t[1]==="hsv"?s=UL(i,a,l):s=ax(i,a,l),{r:s[0],g:s[1],b:s[2],a:e}}function HL(n,t){var e=ix(n);e[0]=bD(e[0]+t),e=ax(e),n.r=e[0],n.g=e[1],n.b=e[2]}function qL(n){if(!n)return;const t=ix(n),e=t[0],s=C1(t[1]),i=C1(t[2]);return n.a<255?`hsla(${e}, ${s}%, ${i}%, ${Ki(n.a)})`:`hsl(${e}, ${s}%, ${i}%)`}const M1={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},O1={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function GL(){const n={},t=Object.keys(O1),e=Object.keys(M1);let s,i,a,l,u;for(s=0;s<t.length;s++){for(l=u=t[s],i=0;i<e.length;i++)a=e[i],u=u.replace(a,M1[a]);a=parseInt(O1[l],16),n[u]=[a>>16&255,a>>8&255,a&255]}return n}let am;function $L(n){am||(am=GL(),am.transparent=[0,0,0,0]);const t=am[n.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const WL=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function YL(n){const t=WL.exec(n);let e=255,s,i,a;if(t){if(t[7]!==s){const l=+t[7];e=t[8]?gh(l):sa(l*255,0,255)}return s=+t[1],i=+t[3],a=+t[5],s=255&(t[2]?gh(s):sa(s,0,255)),i=255&(t[4]?gh(i):sa(i,0,255)),a=255&(t[6]?gh(a):sa(a,0,255)),{r:s,g:i,b:a,a:e}}}function KL(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${Ki(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const by=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,Xl=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function QL(n,t,e){const s=Xl(Ki(n.r)),i=Xl(Ki(n.g)),a=Xl(Ki(n.b));return{r:ha(by(s+e*(Xl(Ki(t.r))-s))),g:ha(by(i+e*(Xl(Ki(t.g))-i))),b:ha(by(a+e*(Xl(Ki(t.b))-a))),a:n.a+e*(t.a-n.a)}}function om(n,t,e){if(n){let s=ix(n);s[t]=Math.max(0,Math.min(s[t]+s[t]*e,t===0?360:1)),s=ax(s),n.r=s[0],n.g=s[1],n.b=s[2]}}function xD(n,t){return n&&Object.assign(t||{},n)}function k1(n){var t={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(t={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(t.a=ha(n[3]))):(t=xD(n,{r:0,g:0,b:0,a:1}),t.a=ha(t.a)),t}function XL(n){return n.charAt(0)==="r"?YL(n):zL(n)}class nd{constructor(t){if(t instanceof nd)return t;const e=typeof t;let s;e==="object"?s=k1(t):e==="string"&&(s=OL(t)||$L(t)||XL(t)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var t=xD(this._rgb);return t&&(t.a=Ki(t.a)),t}set rgb(t){this._rgb=k1(t)}rgbString(){return this._valid?KL(this._rgb):void 0}hexString(){return this._valid?VL(this._rgb):void 0}hslString(){return this._valid?qL(this._rgb):void 0}mix(t,e){if(t){const s=this.rgb,i=t.rgb;let a;const l=e===a?.5:e,u=2*l-1,h=s.a-i.a,f=((u*h===-1?u:(u+h)/(1+u*h))+1)/2;a=1-f,s.r=255&f*s.r+a*i.r+.5,s.g=255&f*s.g+a*i.g+.5,s.b=255&f*s.b+a*i.b+.5,s.a=l*s.a+(1-l)*i.a,this.rgb=s}return this}interpolate(t,e){return t&&(this._rgb=QL(this._rgb,t._rgb,e)),this}clone(){return new nd(this.rgb)}alpha(t){return this._rgb.a=ha(t),this}clearer(t){const e=this._rgb;return e.a*=1-t,this}greyscale(){const t=this._rgb,e=Rd(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){const e=this._rgb;return e.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return om(this._rgb,2,t),this}darken(t){return om(this._rgb,2,-t),this}saturate(t){return om(this._rgb,1,t),this}desaturate(t){return om(this._rgb,1,-t),this}rotate(t){return HL(this._rgb,t),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function $i(){}const ZL=(()=>{let n=0;return()=>n++})();function Yt(n){return n==null}function Me(n){if(Array.isArray&&Array.isArray(n))return!0;const t=Object.prototype.toString.call(n);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Qt(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function je(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function ds(n,t){return je(n)?n:t}function jt(n,t){return typeof n>"u"?t:n}const JL=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/t,vD=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*t:+n;function ve(n,t,e){if(n&&typeof n.call=="function")return n.apply(e,t)}function he(n,t,e,s){let i,a,l;if(Me(n))for(a=n.length,i=0;i<a;i++)t.call(e,n[i],i);else if(Qt(n))for(l=Object.keys(n),a=l.length,i=0;i<a;i++)t.call(e,n[l[i]],l[i])}function ag(n,t){let e,s,i,a;if(!n||!t||n.length!==t.length)return!1;for(e=0,s=n.length;e<s;++e)if(i=n[e],a=t[e],i.datasetIndex!==a.datasetIndex||i.index!==a.index)return!1;return!0}function og(n){if(Me(n))return n.map(og);if(Qt(n)){const t=Object.create(null),e=Object.keys(n),s=e.length;let i=0;for(;i<s;++i)t[e[i]]=og(n[e[i]]);return t}return n}function ED(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function tj(n,t,e,s){if(!ED(n))return;const i=t[n],a=e[n];Qt(i)&&Qt(a)?sd(i,a,s):t[n]=og(a)}function sd(n,t,e){const s=Me(t)?t:[t],i=s.length;if(!Qt(n))return n;e=e||{};const a=e.merger||tj;let l;for(let u=0;u<i;++u){if(l=s[u],!Qt(l))continue;const h=Object.keys(l);for(let f=0,m=h.length;f<m;++f)a(h[f],n,l,e)}return n}function Oh(n,t){return sd(n,t,{merger:ej})}function ej(n,t,e){if(!ED(n))return;const s=t[n],i=e[n];Qt(s)&&Qt(i)?Oh(s,i):Object.prototype.hasOwnProperty.call(t,n)||(t[n]=og(i))}const V1={"":n=>n,x:n=>n.x,y:n=>n.y};function nj(n){const t=n.split("."),e=[];let s="";for(const i of t)s+=i,s.endsWith("\\")?s=s.slice(0,-1)+".":(e.push(s),s="");return e}function sj(n){const t=nj(n);return e=>{for(const s of t){if(s==="")break;e=e&&e[s]}return e}}function Ta(n,t){return(V1[t]||(V1[t]=sj(t)))(n)}function ox(n){return n.charAt(0).toUpperCase()+n.slice(1)}const id=n=>typeof n<"u",wa=n=>typeof n=="function",P1=(n,t)=>{if(n.size!==t.size)return!1;for(const e of n)if(!t.has(e))return!1;return!0};function ij(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const se=Math.PI,Ae=2*se,rj=Ae+se,lg=Number.POSITIVE_INFINITY,aj=se/180,Ye=se/2,_o=se/4,L1=se*2/3,ia=Math.log10,bi=Math.sign;function kh(n,t,e){return Math.abs(n-t)<e}function j1(n){const t=Math.round(n);n=kh(n,t,n/1e3)?t:n;const e=Math.pow(10,Math.floor(ia(n))),s=n/e;return(s<=1?1:s<=2?2:s<=5?5:10)*e}function oj(n){const t=[],e=Math.sqrt(n);let s;for(s=1;s<e;s++)n%s===0&&(t.push(s),t.push(n/s));return e===(e|0)&&t.push(e),t.sort((i,a)=>i-a).pop(),t}function lj(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function Cc(n){return!lj(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function cj(n,t){const e=Math.round(n);return e-t<=n&&e+t>=n}function TD(n,t,e){let s,i,a;for(s=0,i=n.length;s<i;s++)a=n[s][e],isNaN(a)||(t.min=Math.min(t.min,a),t.max=Math.max(t.max,a))}function qs(n){return n*(se/180)}function lx(n){return n*(180/se)}function B1(n){if(!je(n))return;let t=1,e=0;for(;Math.round(n*t)/t!==n;)t*=10,e++;return e}function wD(n,t){const e=t.x-n.x,s=t.y-n.y,i=Math.sqrt(e*e+s*s);let a=Math.atan2(s,e);return a<-.5*se&&(a+=Ae),{angle:a,distance:i}}function y0(n,t){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function uj(n,t){return(n-t+rj)%Ae-se}function kn(n){return(n%Ae+Ae)%Ae}function rd(n,t,e,s){const i=kn(n),a=kn(t),l=kn(e),u=kn(a-i),h=kn(l-i),f=kn(i-a),m=kn(i-l);return i===a||i===l||s&&a===l||u>h&&f<m}function yn(n,t,e){return Math.max(t,Math.min(e,n))}function hj(n){return yn(n,-32768,32767)}function Xi(n,t,e,s=1e-6){return n>=Math.min(t,e)-s&&n<=Math.max(t,e)+s}function cx(n,t,e){e=e||(l=>n[l]<t);let s=n.length-1,i=0,a;for(;s-i>1;)a=i+s>>1,e(a)?i=a:s=a;return{lo:i,hi:s}}const Zi=(n,t,e,s)=>cx(n,e,s?i=>{const a=n[i][t];return a<e||a===e&&n[i+1][t]===e}:i=>n[i][t]<e),dj=(n,t,e)=>cx(n,e,s=>n[s][t]>=e);function fj(n,t,e){let s=0,i=n.length;for(;s<i&&n[s]<t;)s++;for(;i>s&&n[i-1]>e;)i--;return s>0||i<n.length?n.slice(s,i):n}const SD=["push","pop","shift","splice","unshift"];function mj(n,t){if(n._chartjs){n._chartjs.listeners.push(t);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),SD.forEach(e=>{const s="_onData"+ox(e),i=n[e];Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value(...a){const l=i.apply(this,a);return n._chartjs.listeners.forEach(u=>{typeof u[s]=="function"&&u[s](...a)}),l}})})}function F1(n,t){const e=n._chartjs;if(!e)return;const s=e.listeners,i=s.indexOf(t);i!==-1&&s.splice(i,1),!(s.length>0)&&(SD.forEach(a=>{delete n[a]}),delete n._chartjs)}function AD(n){const t=new Set(n);return t.size===n.length?n:Array.from(t)}const ID=(function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame})();function RD(n,t){let e=[],s=!1;return function(...i){e=i,s||(s=!0,ID.call(window,()=>{s=!1,n.apply(t,e)}))}}function gj(n,t){let e;return function(...s){return t?(clearTimeout(e),e=setTimeout(n,t,s)):n.apply(this,s),t}}const ux=n=>n==="start"?"left":n==="end"?"right":"center",Mn=(n,t,e)=>n==="start"?t:n==="end"?e:(t+e)/2,pj=(n,t,e,s)=>n===(s?"left":"right")?e:n==="center"?(t+e)/2:t;function DD(n,t,e){const s=t.length;let i=0,a=s;if(n._sorted){const{iScale:l,vScale:u,_parsed:h}=n,f=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,m=l.axis,{min:_,max:x,minDefined:E,maxDefined:S}=l.getUserBounds();if(E){if(i=Math.min(Zi(h,m,_).lo,e?s:Zi(t,m,l.getPixelForValue(_)).lo),f){const T=h.slice(0,i+1).reverse().findIndex(R=>!Yt(R[u.axis]));i-=Math.max(0,T)}i=yn(i,0,s-1)}if(S){let T=Math.max(Zi(h,l.axis,x,!0).hi+1,e?0:Zi(t,m,l.getPixelForValue(x),!0).hi+1);if(f){const R=h.slice(T-1).findIndex(M=>!Yt(M[u.axis]));T+=Math.max(0,R)}a=yn(T,i,s)-i}else a=s-i}return{start:i,count:a}}function ND(n){const{xScale:t,yScale:e,_scaleRanges:s}=n,i={xmin:t.min,xmax:t.max,ymin:e.min,ymax:e.max};if(!s)return n._scaleRanges=i,!0;const a=s.xmin!==t.min||s.xmax!==t.max||s.ymin!==e.min||s.ymax!==e.max;return Object.assign(s,i),a}const lm=n=>n===0||n===1,U1=(n,t,e)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-t)*Ae/e)),z1=(n,t,e)=>Math.pow(2,-10*n)*Math.sin((n-t)*Ae/e)+1,Vh={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*Ye)+1,easeOutSine:n=>Math.sin(n*Ye),easeInOutSine:n=>-.5*(Math.cos(se*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>lm(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>lm(n)?n:U1(n,.075,.3),easeOutElastic:n=>lm(n)?n:z1(n,.075,.3),easeInOutElastic(n){return lm(n)?n:n<.5?.5*U1(n*2,.1125,.45):.5+.5*z1(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let t=1.70158;return(n/=.5)<1?.5*(n*n*(((t*=1.525)+1)*n-t)):.5*((n-=2)*n*(((t*=1.525)+1)*n+t)+2)},easeInBounce:n=>1-Vh.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Vh.easeInBounce(n*2)*.5:Vh.easeOutBounce(n*2-1)*.5+.5};function hx(n){if(n&&typeof n=="object"){const t=n.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function H1(n){return hx(n)?n:new nd(n)}function xy(n){return hx(n)?n:new nd(n).saturate(.5).darken(.1).hexString()}const _j=["x","y","borderWidth","radius","tension"],yj=["color","borderColor","backgroundColor"];function bj(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),n.set("animations",{colors:{type:"color",properties:yj},numbers:{type:"number",properties:_j}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function xj(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const q1=new Map;function vj(n,t){t=t||{};const e=n+JSON.stringify(t);let s=q1.get(e);return s||(s=new Intl.NumberFormat(n,t),q1.set(e,s)),s}function Dd(n,t,e){return vj(t,e).format(n)}const CD={values(n){return Me(n)?n:""+n},numeric(n,t,e){if(n===0)return"0";const s=this.chart.options.locale;let i,a=n;if(e.length>1){const f=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(f<1e-4||f>1e15)&&(i="scientific"),a=Ej(n,e)}const l=ia(Math.abs(a)),u=isNaN(l)?1:Math.max(Math.min(-1*Math.floor(l),20),0),h={notation:i,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(h,this.options.ticks.format),Dd(n,s,h)},logarithmic(n,t,e){if(n===0)return"0";const s=e[t].significand||n/Math.pow(10,Math.floor(ia(n)));return[1,2,3,5,10,15].includes(s)||t>.8*e.length?CD.numeric.call(this,n,t,e):""}};function Ej(n,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&n!==Math.floor(n)&&(e=n-Math.floor(n)),e}var Wg={formatters:CD};function Tj(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Wg.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Ko=Object.create(null),b0=Object.create(null);function Ph(n,t){if(!t)return n;const e=t.split(".");for(let s=0,i=e.length;s<i;++s){const a=e[s];n=n[a]||(n[a]=Object.create(null))}return n}function vy(n,t,e){return typeof t=="string"?sd(Ph(n,t),e):sd(Ph(n,""),t)}class wj{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,i)=>xy(i.backgroundColor),this.hoverBorderColor=(s,i)=>xy(i.borderColor),this.hoverColor=(s,i)=>xy(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return vy(this,t,e)}get(t){return Ph(this,t)}describe(t,e){return vy(b0,t,e)}override(t,e){return vy(Ko,t,e)}route(t,e,s,i){const a=Ph(this,t),l=Ph(this,s),u="_"+e;Object.defineProperties(a,{[u]:{value:a[e],writable:!0},[e]:{enumerable:!0,get(){const h=this[u],f=l[i];return Qt(h)?Object.assign({},f,h):jt(h,f)},set(h){this[u]=h}}})}apply(t){t.forEach(e=>e(this))}}var Oe=new wj({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[bj,xj,Tj]);function Sj(n){return!n||Yt(n.size)||Yt(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function cg(n,t,e,s,i){let a=t[i];return a||(a=t[i]=n.measureText(i).width,e.push(i)),a>s&&(s=a),s}function Aj(n,t,e,s){s=s||{};let i=s.data=s.data||{},a=s.garbageCollect=s.garbageCollect||[];s.font!==t&&(i=s.data={},a=s.garbageCollect=[],s.font=t),n.save(),n.font=t;let l=0;const u=e.length;let h,f,m,_,x;for(h=0;h<u;h++)if(_=e[h],_!=null&&!Me(_))l=cg(n,i,a,l,_);else if(Me(_))for(f=0,m=_.length;f<m;f++)x=_[f],x!=null&&!Me(x)&&(l=cg(n,i,a,l,x));n.restore();const E=a.length/2;if(E>e.length){for(h=0;h<E;h++)delete i[a[h]];a.splice(0,E)}return l}function yo(n,t,e){const s=n.currentDevicePixelRatio,i=e!==0?Math.max(e/2,.5):0;return Math.round((t-i)*s)/s+i}function G1(n,t){!t&&!n||(t=t||n.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,n.width,n.height),t.restore())}function x0(n,t,e,s){MD(n,t,e,s,null)}function MD(n,t,e,s,i){let a,l,u,h,f,m,_,x;const E=t.pointStyle,S=t.rotation,T=t.radius;let R=(S||0)*aj;if(E&&typeof E=="object"&&(a=E.toString(),a==="[object HTMLImageElement]"||a==="[object HTMLCanvasElement]")){n.save(),n.translate(e,s),n.rotate(R),n.drawImage(E,-E.width/2,-E.height/2,E.width,E.height),n.restore();return}if(!(isNaN(T)||T<=0)){switch(n.beginPath(),E){default:i?n.ellipse(e,s,i/2,T,0,0,Ae):n.arc(e,s,T,0,Ae),n.closePath();break;case"triangle":m=i?i/2:T,n.moveTo(e+Math.sin(R)*m,s-Math.cos(R)*T),R+=L1,n.lineTo(e+Math.sin(R)*m,s-Math.cos(R)*T),R+=L1,n.lineTo(e+Math.sin(R)*m,s-Math.cos(R)*T),n.closePath();break;case"rectRounded":f=T*.516,h=T-f,l=Math.cos(R+_o)*h,_=Math.cos(R+_o)*(i?i/2-f:h),u=Math.sin(R+_o)*h,x=Math.sin(R+_o)*(i?i/2-f:h),n.arc(e-_,s-u,f,R-se,R-Ye),n.arc(e+x,s-l,f,R-Ye,R),n.arc(e+_,s+u,f,R,R+Ye),n.arc(e-x,s+l,f,R+Ye,R+se),n.closePath();break;case"rect":if(!S){h=Math.SQRT1_2*T,m=i?i/2:h,n.rect(e-m,s-h,2*m,2*h);break}R+=_o;case"rectRot":_=Math.cos(R)*(i?i/2:T),l=Math.cos(R)*T,u=Math.sin(R)*T,x=Math.sin(R)*(i?i/2:T),n.moveTo(e-_,s-u),n.lineTo(e+x,s-l),n.lineTo(e+_,s+u),n.lineTo(e-x,s+l),n.closePath();break;case"crossRot":R+=_o;case"cross":_=Math.cos(R)*(i?i/2:T),l=Math.cos(R)*T,u=Math.sin(R)*T,x=Math.sin(R)*(i?i/2:T),n.moveTo(e-_,s-u),n.lineTo(e+_,s+u),n.moveTo(e+x,s-l),n.lineTo(e-x,s+l);break;case"star":_=Math.cos(R)*(i?i/2:T),l=Math.cos(R)*T,u=Math.sin(R)*T,x=Math.sin(R)*(i?i/2:T),n.moveTo(e-_,s-u),n.lineTo(e+_,s+u),n.moveTo(e+x,s-l),n.lineTo(e-x,s+l),R+=_o,_=Math.cos(R)*(i?i/2:T),l=Math.cos(R)*T,u=Math.sin(R)*T,x=Math.sin(R)*(i?i/2:T),n.moveTo(e-_,s-u),n.lineTo(e+_,s+u),n.moveTo(e+x,s-l),n.lineTo(e-x,s+l);break;case"line":l=i?i/2:Math.cos(R)*T,u=Math.sin(R)*T,n.moveTo(e-l,s-u),n.lineTo(e+l,s+u);break;case"dash":n.moveTo(e,s),n.lineTo(e+Math.cos(R)*(i?i/2:T),s+Math.sin(R)*T);break;case!1:n.closePath();break}n.fill(),t.borderWidth>0&&n.stroke()}}function Ji(n,t,e){return e=e||.5,!t||n&&n.x>t.left-e&&n.x<t.right+e&&n.y>t.top-e&&n.y<t.bottom+e}function Yg(n,t){n.save(),n.beginPath(),n.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),n.clip()}function Kg(n){n.restore()}function Ij(n,t,e,s,i){if(!t)return n.lineTo(e.x,e.y);if(i==="middle"){const a=(t.x+e.x)/2;n.lineTo(a,t.y),n.lineTo(a,e.y)}else i==="after"!=!!s?n.lineTo(t.x,e.y):n.lineTo(e.x,t.y);n.lineTo(e.x,e.y)}function Rj(n,t,e,s){if(!t)return n.lineTo(e.x,e.y);n.bezierCurveTo(s?t.cp1x:t.cp2x,s?t.cp1y:t.cp2y,s?e.cp2x:e.cp1x,s?e.cp2y:e.cp1y,e.x,e.y)}function Dj(n,t){t.translation&&n.translate(t.translation[0],t.translation[1]),Yt(t.rotation)||n.rotate(t.rotation),t.color&&(n.fillStyle=t.color),t.textAlign&&(n.textAlign=t.textAlign),t.textBaseline&&(n.textBaseline=t.textBaseline)}function Nj(n,t,e,s,i){if(i.strikethrough||i.underline){const a=n.measureText(s),l=t-a.actualBoundingBoxLeft,u=t+a.actualBoundingBoxRight,h=e-a.actualBoundingBoxAscent,f=e+a.actualBoundingBoxDescent,m=i.strikethrough?(h+f)/2:f;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=i.decorationWidth||2,n.moveTo(l,m),n.lineTo(u,m),n.stroke()}}function Cj(n,t){const e=n.fillStyle;n.fillStyle=t.color,n.fillRect(t.left,t.top,t.width,t.height),n.fillStyle=e}function Qo(n,t,e,s,i,a={}){const l=Me(t)?t:[t],u=a.strokeWidth>0&&a.strokeColor!=="";let h,f;for(n.save(),n.font=i.string,Dj(n,a),h=0;h<l.length;++h)f=l[h],a.backdrop&&Cj(n,a.backdrop),u&&(a.strokeColor&&(n.strokeStyle=a.strokeColor),Yt(a.strokeWidth)||(n.lineWidth=a.strokeWidth),n.strokeText(f,e,s,a.maxWidth)),n.fillText(f,e,s,a.maxWidth),Nj(n,e,s,f,a),s+=Number(i.lineHeight);n.restore()}function ad(n,t){const{x:e,y:s,w:i,h:a,radius:l}=t;n.arc(e+l.topLeft,s+l.topLeft,l.topLeft,1.5*se,se,!0),n.lineTo(e,s+a-l.bottomLeft),n.arc(e+l.bottomLeft,s+a-l.bottomLeft,l.bottomLeft,se,Ye,!0),n.lineTo(e+i-l.bottomRight,s+a),n.arc(e+i-l.bottomRight,s+a-l.bottomRight,l.bottomRight,Ye,0,!0),n.lineTo(e+i,s+l.topRight),n.arc(e+i-l.topRight,s+l.topRight,l.topRight,0,-Ye,!0),n.lineTo(e+l.topLeft,s)}const Mj=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Oj=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function kj(n,t){const e=(""+n).match(Mj);if(!e||e[1]==="normal")return t*1.2;switch(n=+e[2],e[3]){case"px":return n;case"%":n/=100;break}return t*n}const Vj=n=>+n||0;function dx(n,t){const e={},s=Qt(t),i=s?Object.keys(t):t,a=Qt(n)?s?l=>jt(n[l],n[t[l]]):l=>n[l]:()=>n;for(const l of i)e[l]=Vj(a(l));return e}function OD(n){return dx(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Lo(n){return dx(n,["topLeft","topRight","bottomLeft","bottomRight"])}function jn(n){const t=OD(n);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function cn(n,t){n=n||{},t=t||Oe.font;let e=jt(n.size,t.size);typeof e=="string"&&(e=parseInt(e,10));let s=jt(n.style,t.style);s&&!(""+s).match(Oj)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const i={family:jt(n.family,t.family),lineHeight:kj(jt(n.lineHeight,t.lineHeight),e),size:e,style:s,weight:jt(n.weight,t.weight),string:""};return i.string=Sj(i),i}function ph(n,t,e,s){let i,a,l;for(i=0,a=n.length;i<a;++i)if(l=n[i],l!==void 0&&l!==void 0)return l}function Pj(n,t,e){const{min:s,max:i}=n,a=vD(t,(i-s)/2),l=(u,h)=>e&&u===0?0:u+h;return{min:l(s,-Math.abs(a)),max:l(i,a)}}function Ma(n,t){return Object.assign(Object.create(n),t)}function fx(n,t=[""],e,s,i=()=>n[0]){const a=e||n;typeof s>"u"&&(s=LD("_fallback",n));const l={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:a,_fallback:s,_getTarget:i,override:u=>fx([u,...n],t,a,s)};return new Proxy(l,{deleteProperty(u,h){return delete u[h],delete u._keys,delete n[0][h],!0},get(u,h){return VD(u,h,()=>qj(h,t,n,u))},getOwnPropertyDescriptor(u,h){return Reflect.getOwnPropertyDescriptor(u._scopes[0],h)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(u,h){return W1(u).includes(h)},ownKeys(u){return W1(u)},set(u,h,f){const m=u._storage||(u._storage=i());return u[h]=m[h]=f,delete u._keys,!0}})}function Mc(n,t,e,s){const i={_cacheable:!1,_proxy:n,_context:t,_subProxy:e,_stack:new Set,_descriptors:kD(n,s),setContext:a=>Mc(n,a,e,s),override:a=>Mc(n.override(a),t,e,s)};return new Proxy(i,{deleteProperty(a,l){return delete a[l],delete n[l],!0},get(a,l,u){return VD(a,l,()=>jj(a,l,u))},getOwnPropertyDescriptor(a,l){return a._descriptors.allKeys?Reflect.has(n,l)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,l)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(a,l){return Reflect.has(n,l)},ownKeys(){return Reflect.ownKeys(n)},set(a,l,u){return n[l]=u,delete a[l],!0}})}function kD(n,t={scriptable:!0,indexable:!0}){const{_scriptable:e=t.scriptable,_indexable:s=t.indexable,_allKeys:i=t.allKeys}=n;return{allKeys:i,scriptable:e,indexable:s,isScriptable:wa(e)?e:()=>e,isIndexable:wa(s)?s:()=>s}}const Lj=(n,t)=>n?n+ox(t):t,mx=(n,t)=>Qt(t)&&n!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function VD(n,t,e){if(Object.prototype.hasOwnProperty.call(n,t)||t==="constructor")return n[t];const s=e();return n[t]=s,s}function jj(n,t,e){const{_proxy:s,_context:i,_subProxy:a,_descriptors:l}=n;let u=s[t];return wa(u)&&l.isScriptable(t)&&(u=Bj(t,u,n,e)),Me(u)&&u.length&&(u=Fj(t,u,n,l.isIndexable)),mx(t,u)&&(u=Mc(u,i,a&&a[t],l)),u}function Bj(n,t,e,s){const{_proxy:i,_context:a,_subProxy:l,_stack:u}=e;if(u.has(n))throw new Error("Recursion detected: "+Array.from(u).join("->")+"->"+n);u.add(n);let h=t(a,l||s);return u.delete(n),mx(n,h)&&(h=gx(i._scopes,i,n,h)),h}function Fj(n,t,e,s){const{_proxy:i,_context:a,_subProxy:l,_descriptors:u}=e;if(typeof a.index<"u"&&s(n))return t[a.index%t.length];if(Qt(t[0])){const h=t,f=i._scopes.filter(m=>m!==h);t=[];for(const m of h){const _=gx(f,i,n,m);t.push(Mc(_,a,l&&l[n],u))}}return t}function PD(n,t,e){return wa(n)?n(t,e):n}const Uj=(n,t)=>n===!0?t:typeof n=="string"?Ta(t,n):void 0;function zj(n,t,e,s,i){for(const a of t){const l=Uj(e,a);if(l){n.add(l);const u=PD(l._fallback,e,i);if(typeof u<"u"&&u!==e&&u!==s)return u}else if(l===!1&&typeof s<"u"&&e!==s)return null}return!1}function gx(n,t,e,s){const i=t._rootScopes,a=PD(t._fallback,e,s),l=[...n,...i],u=new Set;u.add(s);let h=$1(u,l,e,a||e,s);return h===null||typeof a<"u"&&a!==e&&(h=$1(u,l,a,h,s),h===null)?!1:fx(Array.from(u),[""],i,a,()=>Hj(t,e,s))}function $1(n,t,e,s,i){for(;e;)e=zj(n,t,e,s,i);return e}function Hj(n,t,e){const s=n._getTarget();t in s||(s[t]={});const i=s[t];return Me(i)&&Qt(e)?e:i||{}}function qj(n,t,e,s){let i;for(const a of t)if(i=LD(Lj(a,n),e),typeof i<"u")return mx(n,i)?gx(e,s,n,i):i}function LD(n,t){for(const e of t){if(!e)continue;const s=e[n];if(typeof s<"u")return s}}function W1(n){let t=n._keys;return t||(t=n._keys=Gj(n._scopes)),t}function Gj(n){const t=new Set;for(const e of n)for(const s of Object.keys(e).filter(i=>!i.startsWith("_")))t.add(s);return Array.from(t)}function jD(n,t,e,s){const{iScale:i}=n,{key:a="r"}=this._parsing,l=new Array(s);let u,h,f,m;for(u=0,h=s;u<h;++u)f=u+e,m=t[f],l[u]={r:i.parse(Ta(m,a),f)};return l}const $j=Number.EPSILON||1e-14,Oc=(n,t)=>t<n.length&&!n[t].skip&&n[t],BD=n=>n==="x"?"y":"x";function Wj(n,t,e,s){const i=n.skip?t:n,a=t,l=e.skip?t:e,u=y0(a,i),h=y0(l,a);let f=u/(u+h),m=h/(u+h);f=isNaN(f)?0:f,m=isNaN(m)?0:m;const _=s*f,x=s*m;return{previous:{x:a.x-_*(l.x-i.x),y:a.y-_*(l.y-i.y)},next:{x:a.x+x*(l.x-i.x),y:a.y+x*(l.y-i.y)}}}function Yj(n,t,e){const s=n.length;let i,a,l,u,h,f=Oc(n,0);for(let m=0;m<s-1;++m)if(h=f,f=Oc(n,m+1),!(!h||!f)){if(kh(t[m],0,$j)){e[m]=e[m+1]=0;continue}i=e[m]/t[m],a=e[m+1]/t[m],u=Math.pow(i,2)+Math.pow(a,2),!(u<=9)&&(l=3/Math.sqrt(u),e[m]=i*l*t[m],e[m+1]=a*l*t[m])}}function Kj(n,t,e="x"){const s=BD(e),i=n.length;let a,l,u,h=Oc(n,0);for(let f=0;f<i;++f){if(l=u,u=h,h=Oc(n,f+1),!u)continue;const m=u[e],_=u[s];l&&(a=(m-l[e])/3,u[`cp1${e}`]=m-a,u[`cp1${s}`]=_-a*t[f]),h&&(a=(h[e]-m)/3,u[`cp2${e}`]=m+a,u[`cp2${s}`]=_+a*t[f])}}function Qj(n,t="x"){const e=BD(t),s=n.length,i=Array(s).fill(0),a=Array(s);let l,u,h,f=Oc(n,0);for(l=0;l<s;++l)if(u=h,h=f,f=Oc(n,l+1),!!h){if(f){const m=f[t]-h[t];i[l]=m!==0?(f[e]-h[e])/m:0}a[l]=u?f?bi(i[l-1])!==bi(i[l])?0:(i[l-1]+i[l])/2:i[l-1]:i[l]}Yj(n,i,a),Kj(n,a,t)}function cm(n,t,e){return Math.max(Math.min(n,e),t)}function Xj(n,t){let e,s,i,a,l,u=Ji(n[0],t);for(e=0,s=n.length;e<s;++e)l=a,a=u,u=e<s-1&&Ji(n[e+1],t),a&&(i=n[e],l&&(i.cp1x=cm(i.cp1x,t.left,t.right),i.cp1y=cm(i.cp1y,t.top,t.bottom)),u&&(i.cp2x=cm(i.cp2x,t.left,t.right),i.cp2y=cm(i.cp2y,t.top,t.bottom)))}function Zj(n,t,e,s,i){let a,l,u,h;if(t.spanGaps&&(n=n.filter(f=>!f.skip)),t.cubicInterpolationMode==="monotone")Qj(n,i);else{let f=s?n[n.length-1]:n[0];for(a=0,l=n.length;a<l;++a)u=n[a],h=Wj(f,u,n[Math.min(a+1,l-(s?0:1))%l],t.tension),u.cp1x=h.previous.x,u.cp1y=h.previous.y,u.cp2x=h.next.x,u.cp2y=h.next.y,f=u}t.capBezierPoints&&Xj(n,e)}function px(){return typeof window<"u"&&typeof document<"u"}function _x(n){let t=n.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function ug(n,t,e){let s;return typeof n=="string"?(s=parseInt(n,10),n.indexOf("%")!==-1&&(s=s/100*t.parentNode[e])):s=n,s}const Qg=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function Jj(n,t){return Qg(n).getPropertyValue(t)}const t6=["top","right","bottom","left"];function jo(n,t,e){const s={};e=e?"-"+e:"";for(let i=0;i<4;i++){const a=t6[i];s[a]=parseFloat(n[t+"-"+a+e])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const e6=(n,t,e)=>(n>0||t>0)&&(!e||!e.shadowRoot);function n6(n,t){const e=n.touches,s=e&&e.length?e[0]:n,{offsetX:i,offsetY:a}=s;let l=!1,u,h;if(e6(i,a,n.target))u=i,h=a;else{const f=t.getBoundingClientRect();u=s.clientX-f.left,h=s.clientY-f.top,l=!0}return{x:u,y:h,box:l}}function wo(n,t){if("native"in n)return n;const{canvas:e,currentDevicePixelRatio:s}=t,i=Qg(e),a=i.boxSizing==="border-box",l=jo(i,"padding"),u=jo(i,"border","width"),{x:h,y:f,box:m}=n6(n,e),_=l.left+(m&&u.left),x=l.top+(m&&u.top);let{width:E,height:S}=t;return a&&(E-=l.width+u.width,S-=l.height+u.height),{x:Math.round((h-_)/E*e.width/s),y:Math.round((f-x)/S*e.height/s)}}function s6(n,t,e){let s,i;if(t===void 0||e===void 0){const a=n&&_x(n);if(!a)t=n.clientWidth,e=n.clientHeight;else{const l=a.getBoundingClientRect(),u=Qg(a),h=jo(u,"border","width"),f=jo(u,"padding");t=l.width-f.width-h.width,e=l.height-f.height-h.height,s=ug(u.maxWidth,a,"clientWidth"),i=ug(u.maxHeight,a,"clientHeight")}}return{width:t,height:e,maxWidth:s||lg,maxHeight:i||lg}}const um=n=>Math.round(n*10)/10;function i6(n,t,e,s){const i=Qg(n),a=jo(i,"margin"),l=ug(i.maxWidth,n,"clientWidth")||lg,u=ug(i.maxHeight,n,"clientHeight")||lg,h=s6(n,t,e);let{width:f,height:m}=h;if(i.boxSizing==="content-box"){const x=jo(i,"border","width"),E=jo(i,"padding");f-=E.width+x.width,m-=E.height+x.height}return f=Math.max(0,f-a.width),m=Math.max(0,s?f/s:m-a.height),f=um(Math.min(f,l,h.maxWidth)),m=um(Math.min(m,u,h.maxHeight)),f&&!m&&(m=um(f/2)),(t!==void 0||e!==void 0)&&s&&h.height&&m>h.height&&(m=h.height,f=um(Math.floor(m*s))),{width:f,height:m}}function Y1(n,t,e){const s=t||1,i=Math.floor(n.height*s),a=Math.floor(n.width*s);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const l=n.canvas;return l.style&&(e||!l.style.height&&!l.style.width)&&(l.style.height=`${n.height}px`,l.style.width=`${n.width}px`),n.currentDevicePixelRatio!==s||l.height!==i||l.width!==a?(n.currentDevicePixelRatio=s,l.height=i,l.width=a,n.ctx.setTransform(s,0,0,s,0,0),!0):!1}const r6=(function(){let n=!1;try{const t={get passive(){return n=!0,!1}};px()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return n})();function K1(n,t){const e=Jj(n,t),s=e&&e.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function So(n,t,e,s){return{x:n.x+e*(t.x-n.x),y:n.y+e*(t.y-n.y)}}function a6(n,t,e,s){return{x:n.x+e*(t.x-n.x),y:s==="middle"?e<.5?n.y:t.y:s==="after"?e<1?n.y:t.y:e>0?t.y:n.y}}function o6(n,t,e,s){const i={x:n.cp2x,y:n.cp2y},a={x:t.cp1x,y:t.cp1y},l=So(n,i,e),u=So(i,a,e),h=So(a,t,e),f=So(l,u,e),m=So(u,h,e);return So(f,m,e)}const l6=function(n,t){return{x(e){return n+n+t-e},setWidth(e){t=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,s){return e-s},leftForLtr(e,s){return e-s}}},c6=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,t){return n+t},leftForLtr(n,t){return n}}};function oc(n,t,e){return n?l6(t,e):c6()}function FD(n,t){let e,s;(t==="ltr"||t==="rtl")&&(e=n.canvas.style,s=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),n.prevTextDirection=s)}function UD(n,t){t!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",t[0],t[1]))}function zD(n){return n==="angle"?{between:rd,compare:uj,normalize:kn}:{between:Xi,compare:(t,e)=>t-e,normalize:t=>t}}function Q1({start:n,end:t,count:e,loop:s,style:i}){return{start:n%e,end:t%e,loop:s&&(t-n+1)%e===0,style:i}}function u6(n,t,e){const{property:s,start:i,end:a}=e,{between:l,normalize:u}=zD(s),h=t.length;let{start:f,end:m,loop:_}=n,x,E;if(_){for(f+=h,m+=h,x=0,E=h;x<E&&l(u(t[f%h][s]),i,a);++x)f--,m--;f%=h,m%=h}return m<f&&(m+=h),{start:f,end:m,loop:_,style:n.style}}function HD(n,t,e){if(!e)return[n];const{property:s,start:i,end:a}=e,l=t.length,{compare:u,between:h,normalize:f}=zD(s),{start:m,end:_,loop:x,style:E}=u6(n,t,e),S=[];let T=!1,R=null,M,L,O;const H=()=>h(i,O,M)&&u(i,O)!==0,B=()=>u(a,M)===0||h(a,O,M),z=()=>T||H(),D=()=>!T||B();for(let I=m,C=m;I<=_;++I)L=t[I%l],!L.skip&&(M=f(L[s]),M!==O&&(T=h(M,i,a),R===null&&z()&&(R=u(M,i)===0?I:C),R!==null&&D()&&(S.push(Q1({start:R,end:I,loop:x,count:l,style:E})),R=null),C=I,O=M));return R!==null&&S.push(Q1({start:R,end:_,loop:x,count:l,style:E})),S}function qD(n,t){const e=[],s=n.segments;for(let i=0;i<s.length;i++){const a=HD(s[i],n.points,t);a.length&&e.push(...a)}return e}function h6(n,t,e,s){let i=0,a=t-1;if(e&&!s)for(;i<t&&!n[i].skip;)i++;for(;i<t&&n[i].skip;)i++;for(i%=t,e&&(a+=i);a>i&&n[a%t].skip;)a--;return a%=t,{start:i,end:a}}function d6(n,t,e,s){const i=n.length,a=[];let l=t,u=n[t],h;for(h=t+1;h<=e;++h){const f=n[h%i];f.skip||f.stop?u.skip||(s=!1,a.push({start:t%i,end:(h-1)%i,loop:s}),t=l=f.stop?h:null):(l=h,u.skip&&(t=h)),u=f}return l!==null&&a.push({start:t%i,end:l%i,loop:s}),a}function f6(n,t){const e=n.points,s=n.options.spanGaps,i=e.length;if(!i)return[];const a=!!n._loop,{start:l,end:u}=h6(e,i,a,s);if(s===!0)return X1(n,[{start:l,end:u,loop:a}],e,t);const h=u<l?u+i:u,f=!!n._fullLoop&&l===0&&u===i-1;return X1(n,d6(e,l,h,f),e,t)}function X1(n,t,e,s){return!s||!s.setContext||!e?t:m6(n,t,e,s)}function m6(n,t,e,s){const i=n._chart.getContext(),a=Z1(n.options),{_datasetIndex:l,options:{spanGaps:u}}=n,h=e.length,f=[];let m=a,_=t[0].start,x=_;function E(S,T,R,M){const L=u?-1:1;if(S!==T){for(S+=h;e[S%h].skip;)S-=L;for(;e[T%h].skip;)T+=L;S%h!==T%h&&(f.push({start:S%h,end:T%h,loop:R,style:M}),m=M,_=T%h)}}for(const S of t){_=u?_:S.start;let T=e[_%h],R;for(x=_+1;x<=S.end;x++){const M=e[x%h];R=Z1(s.setContext(Ma(i,{type:"segment",p0:T,p1:M,p0DataIndex:(x-1)%h,p1DataIndex:x%h,datasetIndex:l}))),g6(R,m)&&E(_,x-1,S.loop,m),T=M,m=R}_<x-1&&E(_,x-1,S.loop,m)}return f}function Z1(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function g6(n,t){if(!t)return!1;const e=[],s=function(i,a){return hx(a)?(e.includes(a)||e.push(a),e.indexOf(a)):a};return JSON.stringify(n,s)!==JSON.stringify(t,s)}function hm(n,t,e){return n.options.clip?n[e]:t[e]}function p6(n,t){const{xScale:e,yScale:s}=n;return e&&s?{left:hm(e,t,"left"),right:hm(e,t,"right"),top:hm(s,t,"top"),bottom:hm(s,t,"bottom")}:t}function GD(n,t){const e=t._clip;if(e.disabled)return!1;const s=p6(t,n.chartArea);return{left:e.left===!1?0:s.left-(e.left===!0?0:e.left),right:e.right===!1?n.width:s.right+(e.right===!0?0:e.right),top:e.top===!1?0:s.top-(e.top===!0?0:e.top),bottom:e.bottom===!1?n.height:s.bottom+(e.bottom===!0?0:e.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class _6{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,s,i){const a=e.listeners[i],l=e.duration;a.forEach(u=>u({chart:t,initial:e.initial,numSteps:l,currentStep:Math.min(s-e.start,l)}))}_refresh(){this._request||(this._running=!0,this._request=ID.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((s,i)=>{if(!s.running||!s.items.length)return;const a=s.items;let l=a.length-1,u=!1,h;for(;l>=0;--l)h=a[l],h._active?(h._total>s.duration&&(s.duration=h._total),h.tick(t),u=!0):(a[l]=a[a.length-1],a.pop());u&&(i.draw(),this._notify(i,s,t,"progress")),a.length||(s.running=!1,this._notify(i,s,t,"complete"),s.initial=!1),e+=a.length}),this._lastDate=t,e===0&&(this._running=!1)}_getAnims(t){const e=this._charts;let s=e.get(t);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,s)),s}listen(t,e,s){this._getAnims(t).listeners[e].push(s)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((s,i)=>Math.max(s,i._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const s=e.items;let i=s.length-1;for(;i>=0;--i)s[i].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Wi=new _6;const J1="transparent",y6={boolean(n,t,e){return e>.5?t:n},color(n,t,e){const s=H1(n||J1),i=s.valid&&H1(t||J1);return i&&i.valid?i.mix(s,e).hexString():t},number(n,t,e){return n+(t-n)*e}};class b6{constructor(t,e,s,i){const a=e[s];i=ph([t.to,i,a,t.from]);const l=ph([t.from,a,i]);this._active=!0,this._fn=t.fn||y6[t.type||typeof l],this._easing=Vh[t.easing]||Vh.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=s,this._from=l,this._to=i,this._promises=void 0}active(){return this._active}update(t,e,s){if(this._active){this._notify(!1);const i=this._target[this._prop],a=s-this._start,l=this._duration-a;this._start=s,this._duration=Math.floor(Math.max(l,t.duration)),this._total+=a,this._loop=!!t.loop,this._to=ph([t.to,e,i,t.from]),this._from=ph([t.from,i,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,s=this._duration,i=this._prop,a=this._from,l=this._loop,u=this._to;let h;if(this._active=a!==u&&(l||e<s),!this._active){this._target[i]=u,this._notify(!0);return}if(e<0){this._target[i]=a;return}h=e/s%2,h=l&&h>1?2-h:h,h=this._easing(Math.min(1,Math.max(0,h))),this._target[i]=this._fn(a,u,h)}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,s)=>{t.push({res:e,rej:s})})}_notify(t){const e=t?"res":"rej",s=this._promises||[];for(let i=0;i<s.length;i++)s[i][e]()}}class $D{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!Qt(t))return;const e=Object.keys(Oe.animation),s=this._properties;Object.getOwnPropertyNames(t).forEach(i=>{const a=t[i];if(!Qt(a))return;const l={};for(const u of e)l[u]=a[u];(Me(a.properties)&&a.properties||[i]).forEach(u=>{(u===i||!s.has(u))&&s.set(u,l)})})}_animateOptions(t,e){const s=e.options,i=v6(t,s);if(!i)return[];const a=this._createAnimations(i,s);return s.$shared&&x6(t.options.$animations,s).then(()=>{t.options=s},()=>{}),a}_createAnimations(t,e){const s=this._properties,i=[],a=t.$animations||(t.$animations={}),l=Object.keys(e),u=Date.now();let h;for(h=l.length-1;h>=0;--h){const f=l[h];if(f.charAt(0)==="$")continue;if(f==="options"){i.push(...this._animateOptions(t,e));continue}const m=e[f];let _=a[f];const x=s.get(f);if(_)if(x&&_.active()){_.update(x,m,u);continue}else _.cancel();if(!x||!x.duration){t[f]=m;continue}a[f]=_=new b6(x,t,f,m),i.push(_)}return i}update(t,e){if(this._properties.size===0){Object.assign(t,e);return}const s=this._createAnimations(t,e);if(s.length)return Wi.add(this._chart,s),!0}}function x6(n,t){const e=[],s=Object.keys(t);for(let i=0;i<s.length;i++){const a=n[s[i]];a&&a.active()&&e.push(a.wait())}return Promise.all(e)}function v6(n,t){if(!t)return;let e=n.options;if(!e){n.options=t;return}return e.$shared&&(n.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function tS(n,t){const e=n&&n.options||{},s=e.reverse,i=e.min===void 0?t:0,a=e.max===void 0?t:0;return{start:s?a:i,end:s?i:a}}function E6(n,t,e){if(e===!1)return!1;const s=tS(n,e),i=tS(t,e);return{top:i.end,right:s.end,bottom:i.start,left:s.start}}function T6(n){let t,e,s,i;return Qt(n)?(t=n.top,e=n.right,s=n.bottom,i=n.left):t=e=s=i=n,{top:t,right:e,bottom:s,left:i,disabled:n===!1}}function WD(n,t){const e=[],s=n._getSortedDatasetMetas(t);let i,a;for(i=0,a=s.length;i<a;++i)e.push(s[i].index);return e}function eS(n,t,e,s={}){const i=n.keys,a=s.mode==="single";let l,u,h,f;if(t===null)return;let m=!1;for(l=0,u=i.length;l<u;++l){if(h=+i[l],h===e){if(m=!0,s.all)continue;break}f=n.values[h],je(f)&&(a||t===0||bi(t)===bi(f))&&(t+=f)}return!m&&!s.all?0:t}function w6(n,t){const{iScale:e,vScale:s}=t,i=e.axis==="x"?"x":"y",a=s.axis==="x"?"x":"y",l=Object.keys(n),u=new Array(l.length);let h,f,m;for(h=0,f=l.length;h<f;++h)m=l[h],u[h]={[i]:m,[a]:n[m]};return u}function Ey(n,t){const e=n&&n.options.stacked;return e||e===void 0&&t.stack!==void 0}function S6(n,t,e){return`${n.id}.${t.id}.${e.stack||e.type}`}function A6(n){const{min:t,max:e,minDefined:s,maxDefined:i}=n.getUserBounds();return{min:s?t:Number.NEGATIVE_INFINITY,max:i?e:Number.POSITIVE_INFINITY}}function I6(n,t,e){const s=n[t]||(n[t]={});return s[e]||(s[e]={})}function nS(n,t,e,s){for(const i of t.getMatchingVisibleMetas(s).reverse()){const a=n[i.index];if(e&&a>0||!e&&a<0)return i.index}return null}function sS(n,t){const{chart:e,_cachedMeta:s}=n,i=e._stacks||(e._stacks={}),{iScale:a,vScale:l,index:u}=s,h=a.axis,f=l.axis,m=S6(a,l,s),_=t.length;let x;for(let E=0;E<_;++E){const S=t[E],{[h]:T,[f]:R}=S,M=S._stacks||(S._stacks={});x=M[f]=I6(i,m,T),x[u]=R,x._top=nS(x,l,!0,s.type),x._bottom=nS(x,l,!1,s.type);const L=x._visualValues||(x._visualValues={});L[u]=R}}function Ty(n,t){const e=n.scales;return Object.keys(e).filter(s=>e[s].axis===t).shift()}function R6(n,t){return Ma(n,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function D6(n,t,e){return Ma(n,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function ih(n,t){const e=n.controller.index,s=n.vScale&&n.vScale.axis;if(s){t=t||n._parsed;for(const i of t){const a=i._stacks;if(!a||a[s]===void 0||a[s][e]===void 0)return;delete a[s][e],a[s]._visualValues!==void 0&&a[s]._visualValues[e]!==void 0&&delete a[s]._visualValues[e]}}}const wy=n=>n==="reset"||n==="none",iS=(n,t)=>t?n:Object.assign({},n),N6=(n,t,e)=>n&&!t.hidden&&t._stacked&&{keys:WD(e,!0),values:null};class Ws{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Ey(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&ih(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,s=this.getDataset(),i=(_,x,E,S)=>_==="x"?x:_==="r"?S:E,a=e.xAxisID=jt(s.xAxisID,Ty(t,"x")),l=e.yAxisID=jt(s.yAxisID,Ty(t,"y")),u=e.rAxisID=jt(s.rAxisID,Ty(t,"r")),h=e.indexAxis,f=e.iAxisID=i(h,a,l,u),m=e.vAxisID=i(h,l,a,u);e.xScale=this.getScaleForId(a),e.yScale=this.getScaleForId(l),e.rScale=this.getScaleForId(u),e.iScale=this.getScaleForId(f),e.vScale=this.getScaleForId(m)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&F1(this._data,this),t._stacked&&ih(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),s=this._data;if(Qt(e)){const i=this._cachedMeta;this._data=w6(e,i)}else if(s!==e){if(s){F1(s,this);const i=this._cachedMeta;ih(i),i._parsed=[]}e&&Object.isExtensible(e)&&mj(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,s=this.getDataset();let i=!1;this._dataCheck();const a=e._stacked;e._stacked=Ey(e.vScale,e),e.stack!==s.stack&&(i=!0,ih(e),e.stack=s.stack),this._resyncElements(t),(i||a!==e._stacked)&&(sS(this,e._parsed),e._stacked=Ey(e.vScale,e))}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),s=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:s,_data:i}=this,{iScale:a,_stacked:l}=s,u=a.axis;let h=t===0&&e===i.length?!0:s._sorted,f=t>0&&s._parsed[t-1],m,_,x;if(this._parsing===!1)s._parsed=i,s._sorted=!0,x=i;else{Me(i[t])?x=this.parseArrayData(s,i,t,e):Qt(i[t])?x=this.parseObjectData(s,i,t,e):x=this.parsePrimitiveData(s,i,t,e);const E=()=>_[u]===null||f&&_[u]<f[u];for(m=0;m<e;++m)s._parsed[m+t]=_=x[m],h&&(E()&&(h=!1),f=_);s._sorted=h}l&&sS(this,x)}parsePrimitiveData(t,e,s,i){const{iScale:a,vScale:l}=t,u=a.axis,h=l.axis,f=a.getLabels(),m=a===l,_=new Array(i);let x,E,S;for(x=0,E=i;x<E;++x)S=x+s,_[x]={[u]:m||a.parse(f[S],S),[h]:l.parse(e[S],S)};return _}parseArrayData(t,e,s,i){const{xScale:a,yScale:l}=t,u=new Array(i);let h,f,m,_;for(h=0,f=i;h<f;++h)m=h+s,_=e[m],u[h]={x:a.parse(_[0],m),y:l.parse(_[1],m)};return u}parseObjectData(t,e,s,i){const{xScale:a,yScale:l}=t,{xAxisKey:u="x",yAxisKey:h="y"}=this._parsing,f=new Array(i);let m,_,x,E;for(m=0,_=i;m<_;++m)x=m+s,E=e[x],f[m]={x:a.parse(Ta(E,u),x),y:l.parse(Ta(E,h),x)};return f}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,s){const i=this.chart,a=this._cachedMeta,l=e[t.axis],u={keys:WD(i,!0),values:e._stacks[t.axis]._visualValues};return eS(u,l,a.index,{mode:s})}updateRangeFromParsed(t,e,s,i){const a=s[e.axis];let l=a===null?NaN:a;const u=i&&s._stacks[e.axis];i&&u&&(i.values=u,l=eS(i,a,this._cachedMeta.index)),t.min=Math.min(t.min,l),t.max=Math.max(t.max,l)}getMinMax(t,e){const s=this._cachedMeta,i=s._parsed,a=s._sorted&&t===s.iScale,l=i.length,u=this._getOtherScale(t),h=N6(e,s,this.chart),f={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:m,max:_}=A6(u);let x,E;function S(){E=i[x];const T=E[u.axis];return!je(E[t.axis])||m>T||_<T}for(x=0;x<l&&!(!S()&&(this.updateRangeFromParsed(f,t,E,h),a));++x);if(a){for(x=l-1;x>=0;--x)if(!S()){this.updateRangeFromParsed(f,t,E,h);break}}return f}getAllParsedValues(t){const e=this._cachedMeta._parsed,s=[];let i,a,l;for(i=0,a=e.length;i<a;++i)l=e[i][t.axis],je(l)&&s.push(l);return s}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,s=e.iScale,i=e.vScale,a=this.getParsed(t);return{label:s?""+s.getLabelForValue(a[s.axis]):"",value:i?""+i.getLabelForValue(a[i.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=T6(jt(this.options.clip,E6(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,s=this._cachedMeta,i=s.data||[],a=e.chartArea,l=[],u=this._drawStart||0,h=this._drawCount||i.length-u,f=this.options.drawActiveElementsOnTop;let m;for(s.dataset&&s.dataset.draw(t,a,u,h),m=u;m<u+h;++m){const _=i[m];_.hidden||(_.active&&f?l.push(_):_.draw(t,a))}for(m=0;m<l.length;++m)l[m].draw(t,a)}getStyle(t,e){const s=e?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(t||0,s)}getContext(t,e,s){const i=this.getDataset();let a;if(t>=0&&t<this._cachedMeta.data.length){const l=this._cachedMeta.data[t];a=l.$context||(l.$context=D6(this.getContext(),t,l)),a.parsed=this.getParsed(t),a.raw=i.data[t],a.index=a.dataIndex=t}else a=this.$context||(this.$context=R6(this.chart.getContext(),this.index)),a.dataset=i,a.index=a.datasetIndex=this.index;return a.active=!!e,a.mode=s,a}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",s){const i=e==="active",a=this._cachedDataOpts,l=t+"-"+e,u=a[l],h=this.enableOptionSharing&&id(s);if(u)return iS(u,h);const f=this.chart.config,m=f.datasetElementScopeKeys(this._type,t),_=i?[`${t}Hover`,"hover",t,""]:[t,""],x=f.getOptionScopes(this.getDataset(),m),E=Object.keys(Oe.elements[t]),S=()=>this.getContext(s,i,e),T=f.resolveNamedOptions(x,E,S,_);return T.$shared&&(T.$shared=h,a[l]=Object.freeze(iS(T,h))),T}_resolveAnimations(t,e,s){const i=this.chart,a=this._cachedDataOpts,l=`animation-${e}`,u=a[l];if(u)return u;let h;if(i.options.animation!==!1){const m=this.chart.config,_=m.datasetAnimationScopeKeys(this._type,e),x=m.getOptionScopes(this.getDataset(),_);h=m.createResolver(x,this.getContext(t,s,e))}const f=new $D(i,h&&h.animations);return h&&h._cacheable&&(a[l]=Object.freeze(f)),f}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||wy(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const s=this.resolveDataElementOptions(t,e),i=this._sharedOptions,a=this.getSharedOptions(s),l=this.includeOptions(e,a)||a!==i;return this.updateSharedOptions(a,e,s),{sharedOptions:a,includeOptions:l}}updateElement(t,e,s,i){wy(i)?Object.assign(t,s):this._resolveAnimations(e,i).update(t,s)}updateSharedOptions(t,e,s){t&&!wy(e)&&this._resolveAnimations(void 0,e).update(t,s)}_setStyle(t,e,s,i){t.active=i;const a=this.getStyle(e,i);this._resolveAnimations(e,s,i).update(t,{options:!i&&this.getSharedOptions(a)||a})}removeHoverStyle(t,e,s){this._setStyle(t,s,"active",!1)}setHoverStyle(t,e,s){this._setStyle(t,s,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,s=this._cachedMeta.data;for(const[u,h,f]of this._syncList)this[u](h,f);this._syncList=[];const i=s.length,a=e.length,l=Math.min(a,i);l&&this.parse(0,l),a>i?this._insertElements(i,a-i,t):a<i&&this._removeElements(a,i-a)}_insertElements(t,e,s=!0){const i=this._cachedMeta,a=i.data,l=t+e;let u;const h=f=>{for(f.length+=e,u=f.length-1;u>=l;u--)f[u]=f[u-e]};for(h(a),u=t;u<l;++u)a[u]=new this.dataElementType;this._parsing&&h(i._parsed),this.parse(t,e),s&&this.updateElements(a,t,e,"reset")}updateElements(t,e,s,i){}_removeElements(t,e){const s=this._cachedMeta;if(this._parsing){const i=s._parsed.splice(t,e);s._stacked&&ih(s,i)}s.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,s,i]=t;this[e](s,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const s=arguments.length-2;s&&this._sync(["_insertElements",t,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}_t(Ws,"defaults",{}),_t(Ws,"datasetElementType",null),_t(Ws,"dataElementType",null);function C6(n,t){if(!n._cache.$bar){const e=n.getMatchingVisibleMetas(t);let s=[];for(let i=0,a=e.length;i<a;i++)s=s.concat(e[i].controller.getAllParsedValues(n));n._cache.$bar=AD(s.sort((i,a)=>i-a))}return n._cache.$bar}function M6(n){const t=n.iScale,e=C6(t,n.type);let s=t._length,i,a,l,u;const h=()=>{l===32767||l===-32768||(id(u)&&(s=Math.min(s,Math.abs(l-u)||s)),u=l)};for(i=0,a=e.length;i<a;++i)l=t.getPixelForValue(e[i]),h();for(u=void 0,i=0,a=t.ticks.length;i<a;++i)l=t.getPixelForTick(i),h();return s}function O6(n,t,e,s){const i=e.barThickness;let a,l;return Yt(i)?(a=t.min*e.categoryPercentage,l=e.barPercentage):(a=i*s,l=1),{chunk:a/s,ratio:l,start:t.pixels[n]-a/2}}function k6(n,t,e,s){const i=t.pixels,a=i[n];let l=n>0?i[n-1]:null,u=n<i.length-1?i[n+1]:null;const h=e.categoryPercentage;l===null&&(l=a-(u===null?t.end-t.start:u-a)),u===null&&(u=a+a-l);const f=a-(a-Math.min(l,u))/2*h;return{chunk:Math.abs(u-l)/2*h/s,ratio:e.barPercentage,start:f}}function V6(n,t,e,s){const i=e.parse(n[0],s),a=e.parse(n[1],s),l=Math.min(i,a),u=Math.max(i,a);let h=l,f=u;Math.abs(l)>Math.abs(u)&&(h=u,f=l),t[e.axis]=f,t._custom={barStart:h,barEnd:f,start:i,end:a,min:l,max:u}}function YD(n,t,e,s){return Me(n)?V6(n,t,e,s):t[e.axis]=e.parse(n,s),t}function rS(n,t,e,s){const i=n.iScale,a=n.vScale,l=i.getLabels(),u=i===a,h=[];let f,m,_,x;for(f=e,m=e+s;f<m;++f)x=t[f],_={},_[i.axis]=u||i.parse(l[f],f),h.push(YD(x,_,a,f));return h}function Sy(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function P6(n,t,e){return n!==0?bi(n):(t.isHorizontal()?1:-1)*(t.min>=e?1:-1)}function L6(n){let t,e,s,i,a;return n.horizontal?(t=n.base>n.x,e="left",s="right"):(t=n.base<n.y,e="bottom",s="top"),t?(i="end",a="start"):(i="start",a="end"),{start:e,end:s,reverse:t,top:i,bottom:a}}function j6(n,t,e,s){let i=t.borderSkipped;const a={};if(!i){n.borderSkipped=a;return}if(i===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:l,end:u,reverse:h,top:f,bottom:m}=L6(n);i==="middle"&&e&&(n.enableBorderRadius=!0,(e._top||0)===s?i=f:(e._bottom||0)===s?i=m:(a[aS(m,l,u,h)]=!0,i=f)),a[aS(i,l,u,h)]=!0,n.borderSkipped=a}function aS(n,t,e,s){return s?(n=B6(n,t,e),n=oS(n,e,t)):n=oS(n,t,e),n}function B6(n,t,e){return n===t?e:n===e?t:n}function oS(n,t,e){return n==="start"?t:n==="end"?e:n}function F6(n,{inflateAmount:t},e){n.inflateAmount=t==="auto"?e===1?.33:0:t}class Nm extends Ws{parsePrimitiveData(t,e,s,i){return rS(t,e,s,i)}parseArrayData(t,e,s,i){return rS(t,e,s,i)}parseObjectData(t,e,s,i){const{iScale:a,vScale:l}=t,{xAxisKey:u="x",yAxisKey:h="y"}=this._parsing,f=a.axis==="x"?u:h,m=l.axis==="x"?u:h,_=[];let x,E,S,T;for(x=s,E=s+i;x<E;++x)T=e[x],S={},S[a.axis]=a.parse(Ta(T,f),x),_.push(YD(Ta(T,m),S,l,x));return _}updateRangeFromParsed(t,e,s,i){super.updateRangeFromParsed(t,e,s,i);const a=s._custom;a&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,a.min),t.max=Math.max(t.max,a.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:s,vScale:i}=e,a=this.getParsed(t),l=a._custom,u=Sy(l)?"["+l.start+", "+l.end+"]":""+i.getLabelForValue(a[i.axis]);return{label:""+s.getLabelForValue(a[s.axis]),value:u}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,s,i){const a=i==="reset",{index:l,_cachedMeta:{vScale:u}}=this,h=u.getBasePixel(),f=u.isHorizontal(),m=this._getRuler(),{sharedOptions:_,includeOptions:x}=this._getSharedOptions(e,i);for(let E=e;E<e+s;E++){const S=this.getParsed(E),T=a||Yt(S[u.axis])?{base:h,head:h}:this._calculateBarValuePixels(E),R=this._calculateBarIndexPixels(E,m),M=(S._stacks||{})[u.axis],L={horizontal:f,base:T.base,enableBorderRadius:!M||Sy(S._custom)||l===M._top||l===M._bottom,x:f?T.head:R.center,y:f?R.center:T.head,height:f?R.size:Math.abs(T.size),width:f?Math.abs(T.size):R.size};x&&(L.options=_||this.resolveDataElementOptions(E,t[E].active?"active":i));const O=L.options||t[E].options;j6(L,O,M,l),F6(L,O,m.ratio),this.updateElement(t[E],E,L,i)}}_getStacks(t,e){const{iScale:s}=this._cachedMeta,i=s.getMatchingVisibleMetas(this._type).filter(m=>m.controller.options.grouped),a=s.options.stacked,l=[],u=this._cachedMeta.controller.getParsed(e),h=u&&u[s.axis],f=m=>{const _=m._parsed.find(E=>E[s.axis]===h),x=_&&_[m.vScale.axis];if(Yt(x)||isNaN(x))return!0};for(const m of i)if(!(e!==void 0&&f(m))&&((a===!1||l.indexOf(m.stack)===-1||a===void 0&&m.stack===void 0)&&l.push(m.stack),m.index===t))break;return l.length||l.push(void 0),l}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,e=this.chart.options.indexAxis;return Object.keys(t).filter(s=>t[s].axis===e).shift()}_getAxis(){const t={},e=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)t[jt(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,e)]=!0;return Object.keys(t)}_getStackIndex(t,e,s){const i=this._getStacks(t,s),a=e!==void 0?i.indexOf(e):-1;return a===-1?i.length-1:a}_getRuler(){const t=this.options,e=this._cachedMeta,s=e.iScale,i=[];let a,l;for(a=0,l=e.data.length;a<l;++a)i.push(s.getPixelForValue(this.getParsed(a)[s.axis],a));const u=t.barThickness;return{min:u||M6(e),pixels:i,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:t.grouped,ratio:u?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:s,index:i},options:{base:a,minBarLength:l}}=this,u=a||0,h=this.getParsed(t),f=h._custom,m=Sy(f);let _=h[e.axis],x=0,E=s?this.applyStack(e,h,s):_,S,T;E!==_&&(x=E-_,E=_),m&&(_=f.barStart,E=f.barEnd-f.barStart,_!==0&&bi(_)!==bi(f.barEnd)&&(x=0),x+=_);const R=!Yt(a)&&!m?a:x;let M=e.getPixelForValue(R);if(this.chart.getDataVisibility(t)?S=e.getPixelForValue(x+E):S=M,T=S-M,Math.abs(T)<l){T=P6(T,e,u)*l,_===u&&(M-=T/2);const L=e.getPixelForDecimal(0),O=e.getPixelForDecimal(1),H=Math.min(L,O),B=Math.max(L,O);M=Math.max(Math.min(M,B),H),S=M+T,s&&!m&&(h._stacks[e.axis]._visualValues[i]=e.getValueForPixel(S)-e.getValueForPixel(M))}if(M===e.getPixelForValue(u)){const L=bi(T)*e.getLineWidthForValue(u)/2;M+=L,T-=L}return{size:T,base:M,head:S,center:S+T/2}}_calculateBarIndexPixels(t,e){const s=e.scale,i=this.options,a=i.skipNull,l=jt(i.maxBarThickness,1/0);let u,h;const f=this._getAxisCount();if(e.grouped){const m=a?this._getStackCount(t):e.stackCount,_=i.barThickness==="flex"?k6(t,e,i,m*f):O6(t,e,i,m*f),x=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,E=this._getAxis().indexOf(jt(x,this.getFirstScaleIdForIndexAxis())),S=this._getStackIndex(this.index,this._cachedMeta.stack,a?t:void 0)+E;u=_.start+_.chunk*S+_.chunk/2,h=Math.min(l,_.chunk*_.ratio)}else u=s.getPixelForValue(this.getParsed(t)[s.axis],t),h=Math.min(l,e.min*e.ratio);return{base:u-h/2,head:u+h/2,center:u,size:h}}draw(){const t=this._cachedMeta,e=t.vScale,s=t.data,i=s.length;let a=0;for(;a<i;++a)this.getParsed(a)[e.axis]!==null&&!s[a].hidden&&s[a].draw(this._ctx)}}_t(Nm,"id","bar"),_t(Nm,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),_t(Nm,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class Cm extends Ws{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,s,i){const a=super.parsePrimitiveData(t,e,s,i);for(let l=0;l<a.length;l++)a[l]._custom=this.resolveDataElementOptions(l+s).radius;return a}parseArrayData(t,e,s,i){const a=super.parseArrayData(t,e,s,i);for(let l=0;l<a.length;l++){const u=e[s+l];a[l]._custom=jt(u[2],this.resolveDataElementOptions(l+s).radius)}return a}parseObjectData(t,e,s,i){const a=super.parseObjectData(t,e,s,i);for(let l=0;l<a.length;l++){const u=e[s+l];a[l]._custom=jt(u&&u.r&&+u.r,this.resolveDataElementOptions(l+s).radius)}return a}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let s=t.length-1;s>=0;--s)e=Math.max(e,t[s].size(this.resolveDataElementOptions(s))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart.data.labels||[],{xScale:i,yScale:a}=e,l=this.getParsed(t),u=i.getLabelForValue(l.x),h=a.getLabelForValue(l.y),f=l._custom;return{label:s[t]||"",value:"("+u+", "+h+(f?", "+f:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,s,i){const a=i==="reset",{iScale:l,vScale:u}=this._cachedMeta,{sharedOptions:h,includeOptions:f}=this._getSharedOptions(e,i),m=l.axis,_=u.axis;for(let x=e;x<e+s;x++){const E=t[x],S=!a&&this.getParsed(x),T={},R=T[m]=a?l.getPixelForDecimal(.5):l.getPixelForValue(S[m]),M=T[_]=a?u.getBasePixel():u.getPixelForValue(S[_]);T.skip=isNaN(R)||isNaN(M),f&&(T.options=h||this.resolveDataElementOptions(x,E.active?"active":i),a&&(T.options.radius=0)),this.updateElement(E,x,T,i)}}resolveDataElementOptions(t,e){const s=this.getParsed(t);let i=super.resolveDataElementOptions(t,e);i.$shared&&(i=Object.assign({},i,{$shared:!1}));const a=i.radius;return e!=="active"&&(i.radius=0),i.radius+=jt(s&&s._custom,a),i}}_t(Cm,"id","bubble"),_t(Cm,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),_t(Cm,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function U6(n,t,e){let s=1,i=1,a=0,l=0;if(t<Ae){const u=n,h=u+t,f=Math.cos(u),m=Math.sin(u),_=Math.cos(h),x=Math.sin(h),E=(O,H,B)=>rd(O,u,h,!0)?1:Math.max(H,H*e,B,B*e),S=(O,H,B)=>rd(O,u,h,!0)?-1:Math.min(H,H*e,B,B*e),T=E(0,f,_),R=E(Ye,m,x),M=S(se,f,_),L=S(se+Ye,m,x);s=(T-M)/2,i=(R-L)/2,a=-(T+M)/2,l=-(R+L)/2}return{ratioX:s,ratioY:i,offsetX:a,offsetY:l}}class ko extends Ws{constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const s=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=s;else{let a=h=>+s[h];if(Qt(s[t])){const{key:h="value"}=this._parsing;a=f=>+Ta(s[f],h)}let l,u;for(l=t,u=t+e;l<u;++l)i._parsed[l]=a(l)}}_getRotation(){return qs(this.options.rotation-90)}_getCircumference(){return qs(this.options.circumference)}_getRotationExtents(){let t=Ae,e=-Ae;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const i=this.chart.getDatasetMeta(s).controller,a=i._getRotation(),l=i._getCircumference();t=Math.min(t,a),e=Math.max(e,a+l)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:s}=e,i=this._cachedMeta,a=i.data,l=this.getMaxBorderWidth()+this.getMaxOffset(a)+this.options.spacing,u=Math.max((Math.min(s.width,s.height)-l)/2,0),h=Math.min(JL(this.options.cutout,u),1),f=this._getRingWeight(this.index),{circumference:m,rotation:_}=this._getRotationExtents(),{ratioX:x,ratioY:E,offsetX:S,offsetY:T}=U6(_,m,h),R=(s.width-l)/x,M=(s.height-l)/E,L=Math.max(Math.min(R,M)/2,0),O=vD(this.options.radius,L),H=Math.max(O*h,0),B=(O-H)/this._getVisibleDatasetWeightTotal();this.offsetX=S*O,this.offsetY=T*O,i.total=this.calculateTotal(),this.outerRadius=O-B*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-B*f,0),this.updateElements(a,0,a.length,t)}_circumference(t,e){const s=this.options,i=this._cachedMeta,a=this._getCircumference();return e&&s.animation.animateRotate||!this.chart.getDataVisibility(t)||i._parsed[t]===null||i.data[t].hidden?0:this.calculateCircumference(i._parsed[t]*a/Ae)}updateElements(t,e,s,i){const a=i==="reset",l=this.chart,u=l.chartArea,f=l.options.animation,m=(u.left+u.right)/2,_=(u.top+u.bottom)/2,x=a&&f.animateScale,E=x?0:this.innerRadius,S=x?0:this.outerRadius,{sharedOptions:T,includeOptions:R}=this._getSharedOptions(e,i);let M=this._getRotation(),L;for(L=0;L<e;++L)M+=this._circumference(L,a);for(L=e;L<e+s;++L){const O=this._circumference(L,a),H=t[L],B={x:m+this.offsetX,y:_+this.offsetY,startAngle:M,endAngle:M+O,circumference:O,outerRadius:S,innerRadius:E};R&&(B.options=T||this.resolveDataElementOptions(L,H.active?"active":i)),M+=O,this.updateElement(H,L,B,i)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let s=0,i;for(i=0;i<e.length;i++){const a=t._parsed[i];a!==null&&!isNaN(a)&&this.chart.getDataVisibility(i)&&!e[i].hidden&&(s+=Math.abs(a))}return s}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?Ae*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart,i=s.data.labels||[],a=Dd(e._parsed[t],s.options.locale);return{label:i[t]||"",value:a}}getMaxBorderWidth(t){let e=0;const s=this.chart;let i,a,l,u,h;if(!t){for(i=0,a=s.data.datasets.length;i<a;++i)if(s.isDatasetVisible(i)){l=s.getDatasetMeta(i),t=l.data,u=l.controller;break}}if(!t)return 0;for(i=0,a=t.length;i<a;++i)h=u.resolveDataElementOptions(i),h.borderAlign!=="inner"&&(e=Math.max(e,h.borderWidth||0,h.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let s=0,i=t.length;s<i;++s){const a=this.resolveDataElementOptions(s);e=Math.max(e,a.offset||0,a.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let s=0;s<t;++s)this.chart.isDatasetVisible(s)&&(e+=this._getRingWeight(s));return e}_getRingWeight(t){return Math.max(jt(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}_t(ko,"id","doughnut"),_t(ko,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),_t(ko,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),_t(ko,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:s,color:i}}=t.legend.options;return e.labels.map((a,l)=>{const h=t.getDatasetMeta(0).controller.getStyle(l);return{text:a,fillStyle:h.backgroundColor,strokeStyle:h.borderColor,fontColor:i,lineWidth:h.borderWidth,pointStyle:s,hidden:!t.getDataVisibility(l),index:l}})}return[]}},onClick(t,e,s){s.chart.toggleDataVisibility(e.index),s.chart.update()}}}});class Mm extends Ws{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:s,data:i=[],_dataset:a}=e,l=this.chart._animationsDisabled;let{start:u,count:h}=DD(e,i,l);this._drawStart=u,this._drawCount=h,ND(e)&&(u=0,h=i.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!a._decimated,s.points=i;const f=this.resolveDatasetElementOptions(t);this.options.showLine||(f.borderWidth=0),f.segment=this.options.segment,this.updateElement(s,void 0,{animated:!l,options:f},t),this.updateElements(i,u,h,t)}updateElements(t,e,s,i){const a=i==="reset",{iScale:l,vScale:u,_stacked:h,_dataset:f}=this._cachedMeta,{sharedOptions:m,includeOptions:_}=this._getSharedOptions(e,i),x=l.axis,E=u.axis,{spanGaps:S,segment:T}=this.options,R=Cc(S)?S:Number.POSITIVE_INFINITY,M=this.chart._animationsDisabled||a||i==="none",L=e+s,O=t.length;let H=e>0&&this.getParsed(e-1);for(let B=0;B<O;++B){const z=t[B],D=M?z:{};if(B<e||B>=L){D.skip=!0;continue}const I=this.getParsed(B),C=Yt(I[E]),P=D[x]=l.getPixelForValue(I[x],B),j=D[E]=a||C?u.getBasePixel():u.getPixelForValue(h?this.applyStack(u,I,h):I[E],B);D.skip=isNaN(P)||isNaN(j)||C,D.stop=B>0&&Math.abs(I[x]-H[x])>R,T&&(D.parsed=I,D.raw=f.data[B]),_&&(D.options=m||this.resolveDataElementOptions(B,z.active?"active":i)),M||this.updateElement(z,B,D,i),H=I}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,s=e.options&&e.options.borderWidth||0,i=t.data||[];if(!i.length)return s;const a=i[0].size(this.resolveDataElementOptions(0)),l=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(s,a,l)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}_t(Mm,"id","line"),_t(Mm,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),_t(Mm,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Lh extends Ws{constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart,i=s.data.labels||[],a=Dd(e._parsed[t].r,s.options.locale);return{label:i[t]||"",value:a}}parseObjectData(t,e,s,i){return jD.bind(this)(t,e,s,i)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((s,i)=>{const a=this.getParsed(i).r;!isNaN(a)&&this.chart.getDataVisibility(i)&&(a<e.min&&(e.min=a),a>e.max&&(e.max=a))}),e}_updateRadius(){const t=this.chart,e=t.chartArea,s=t.options,i=Math.min(e.right-e.left,e.bottom-e.top),a=Math.max(i/2,0),l=Math.max(s.cutoutPercentage?a/100*s.cutoutPercentage:1,0),u=(a-l)/t.getVisibleDatasetCount();this.outerRadius=a-u*this.index,this.innerRadius=this.outerRadius-u}updateElements(t,e,s,i){const a=i==="reset",l=this.chart,h=l.options.animation,f=this._cachedMeta.rScale,m=f.xCenter,_=f.yCenter,x=f.getIndexAngle(0)-.5*se;let E=x,S;const T=360/this.countVisibleElements();for(S=0;S<e;++S)E+=this._computeAngle(S,i,T);for(S=e;S<e+s;S++){const R=t[S];let M=E,L=E+this._computeAngle(S,i,T),O=l.getDataVisibility(S)?f.getDistanceFromCenterForValue(this.getParsed(S).r):0;E=L,a&&(h.animateScale&&(O=0),h.animateRotate&&(M=L=x));const H={x:m,y:_,innerRadius:0,outerRadius:O,startAngle:M,endAngle:L,options:this.resolveDataElementOptions(S,R.active?"active":i)};this.updateElement(R,S,H,i)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach((s,i)=>{!isNaN(this.getParsed(i).r)&&this.chart.getDataVisibility(i)&&e++}),e}_computeAngle(t,e,s){return this.chart.getDataVisibility(t)?qs(this.resolveDataElementOptions(t,e).angle||s):0}}_t(Lh,"id","polarArea"),_t(Lh,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),_t(Lh,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:s,color:i}}=t.legend.options;return e.labels.map((a,l)=>{const h=t.getDatasetMeta(0).controller.getStyle(l);return{text:a,fillStyle:h.backgroundColor,strokeStyle:h.borderColor,fontColor:i,lineWidth:h.borderWidth,pointStyle:s,hidden:!t.getDataVisibility(l),index:l}})}return[]}},onClick(t,e,s){s.chart.toggleDataVisibility(e.index),s.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class v0 extends ko{}_t(v0,"id","pie"),_t(v0,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class Om extends Ws{getLabelAndValue(t){const e=this._cachedMeta.vScale,s=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(s[e.axis])}}parseObjectData(t,e,s,i){return jD.bind(this)(t,e,s,i)}update(t){const e=this._cachedMeta,s=e.dataset,i=e.data||[],a=e.iScale.getLabels();if(s.points=i,t!=="resize"){const l=this.resolveDatasetElementOptions(t);this.options.showLine||(l.borderWidth=0);const u={_loop:!0,_fullLoop:a.length===i.length,options:l};this.updateElement(s,void 0,u,t)}this.updateElements(i,0,i.length,t)}updateElements(t,e,s,i){const a=this._cachedMeta.rScale,l=i==="reset";for(let u=e;u<e+s;u++){const h=t[u],f=this.resolveDataElementOptions(u,h.active?"active":i),m=a.getPointPositionForValue(u,this.getParsed(u).r),_=l?a.xCenter:m.x,x=l?a.yCenter:m.y,E={x:_,y:x,angle:m.angle,skip:isNaN(_)||isNaN(x),options:f};this.updateElement(h,u,E,i)}}}_t(Om,"id","radar"),_t(Om,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),_t(Om,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class km extends Ws{getLabelAndValue(t){const e=this._cachedMeta,s=this.chart.data.labels||[],{xScale:i,yScale:a}=e,l=this.getParsed(t),u=i.getLabelForValue(l.x),h=a.getLabelForValue(l.y);return{label:s[t]||"",value:"("+u+", "+h+")"}}update(t){const e=this._cachedMeta,{data:s=[]}=e,i=this.chart._animationsDisabled;let{start:a,count:l}=DD(e,s,i);if(this._drawStart=a,this._drawCount=l,ND(e)&&(a=0,l=s.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:u,_dataset:h}=e;u._chart=this.chart,u._datasetIndex=this.index,u._decimated=!!h._decimated,u.points=s;const f=this.resolveDatasetElementOptions(t);f.segment=this.options.segment,this.updateElement(u,void 0,{animated:!i,options:f},t)}else this.datasetElementType&&(delete e.dataset,this.datasetElementType=!1);this.updateElements(s,a,l,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,s,i){const a=i==="reset",{iScale:l,vScale:u,_stacked:h,_dataset:f}=this._cachedMeta,m=this.resolveDataElementOptions(e,i),_=this.getSharedOptions(m),x=this.includeOptions(i,_),E=l.axis,S=u.axis,{spanGaps:T,segment:R}=this.options,M=Cc(T)?T:Number.POSITIVE_INFINITY,L=this.chart._animationsDisabled||a||i==="none";let O=e>0&&this.getParsed(e-1);for(let H=e;H<e+s;++H){const B=t[H],z=this.getParsed(H),D=L?B:{},I=Yt(z[S]),C=D[E]=l.getPixelForValue(z[E],H),P=D[S]=a||I?u.getBasePixel():u.getPixelForValue(h?this.applyStack(u,z,h):z[S],H);D.skip=isNaN(C)||isNaN(P)||I,D.stop=H>0&&Math.abs(z[E]-O[E])>M,R&&(D.parsed=z,D.raw=f.data[H]),x&&(D.options=_||this.resolveDataElementOptions(H,B.active?"active":i)),L||this.updateElement(B,H,D,i),O=z}this.updateSharedOptions(_,i,m)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let u=0;for(let h=e.length-1;h>=0;--h)u=Math.max(u,e[h].size(this.resolveDataElementOptions(h))/2);return u>0&&u}const s=t.dataset,i=s.options&&s.options.borderWidth||0;if(!e.length)return i;const a=e[0].size(this.resolveDataElementOptions(0)),l=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(i,a,l)/2}}_t(km,"id","scatter"),_t(km,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),_t(km,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var z6=Object.freeze({__proto__:null,BarController:Nm,BubbleController:Cm,DoughnutController:ko,LineController:Mm,PieController:v0,PolarAreaController:Lh,RadarController:Om,ScatterController:km});function bo(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class yx{constructor(t){_t(this,"options");this.options=t||{}}static override(t){Object.assign(yx.prototype,t)}init(){}formats(){return bo()}parse(){return bo()}format(){return bo()}add(){return bo()}diff(){return bo()}startOf(){return bo()}endOf(){return bo()}}var H6={_date:yx};function q6(n,t,e,s){const{controller:i,data:a,_sorted:l}=n,u=i._cachedMeta.iScale,h=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(u&&t===u.axis&&t!=="r"&&l&&a.length){const f=u._reversePixels?dj:Zi;if(s){if(i._sharedOptions){const m=a[0],_=typeof m.getRange=="function"&&m.getRange(t);if(_){const x=f(a,t,e-_),E=f(a,t,e+_);return{lo:x.lo,hi:E.hi}}}}else{const m=f(a,t,e);if(h){const{vScale:_}=i._cachedMeta,{_parsed:x}=n,E=x.slice(0,m.lo+1).reverse().findIndex(T=>!Yt(T[_.axis]));m.lo-=Math.max(0,E);const S=x.slice(m.hi).findIndex(T=>!Yt(T[_.axis]));m.hi+=Math.max(0,S)}return m}}return{lo:0,hi:a.length-1}}function Xg(n,t,e,s,i){const a=n.getSortedVisibleDatasetMetas(),l=e[t];for(let u=0,h=a.length;u<h;++u){const{index:f,data:m}=a[u],{lo:_,hi:x}=q6(a[u],t,l,i);for(let E=_;E<=x;++E){const S=m[E];S.skip||s(S,f,E)}}}function G6(n){const t=n.indexOf("x")!==-1,e=n.indexOf("y")!==-1;return function(s,i){const a=t?Math.abs(s.x-i.x):0,l=e?Math.abs(s.y-i.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(l,2))}}function Ay(n,t,e,s,i){const a=[];return!i&&!n.isPointInArea(t)||Xg(n,e,t,function(u,h,f){!i&&!Ji(u,n.chartArea,0)||u.inRange(t.x,t.y,s)&&a.push({element:u,datasetIndex:h,index:f})},!0),a}function $6(n,t,e,s){let i=[];function a(l,u,h){const{startAngle:f,endAngle:m}=l.getProps(["startAngle","endAngle"],s),{angle:_}=wD(l,{x:t.x,y:t.y});rd(_,f,m)&&i.push({element:l,datasetIndex:u,index:h})}return Xg(n,e,t,a),i}function W6(n,t,e,s,i,a){let l=[];const u=G6(e);let h=Number.POSITIVE_INFINITY;function f(m,_,x){const E=m.inRange(t.x,t.y,i);if(s&&!E)return;const S=m.getCenterPoint(i);if(!(!!a||n.isPointInArea(S))&&!E)return;const R=u(t,S);R<h?(l=[{element:m,datasetIndex:_,index:x}],h=R):R===h&&l.push({element:m,datasetIndex:_,index:x})}return Xg(n,e,t,f),l}function Iy(n,t,e,s,i,a){return!a&&!n.isPointInArea(t)?[]:e==="r"&&!s?$6(n,t,e,i):W6(n,t,e,s,i,a)}function lS(n,t,e,s,i){const a=[],l=e==="x"?"inXRange":"inYRange";let u=!1;return Xg(n,e,t,(h,f,m)=>{h[l]&&h[l](t[e],i)&&(a.push({element:h,datasetIndex:f,index:m}),u=u||h.inRange(t.x,t.y,i))}),s&&!u?[]:a}var Y6={modes:{index(n,t,e,s){const i=wo(t,n),a=e.axis||"x",l=e.includeInvisible||!1,u=e.intersect?Ay(n,i,a,s,l):Iy(n,i,a,!1,s,l),h=[];return u.length?(n.getSortedVisibleDatasetMetas().forEach(f=>{const m=u[0].index,_=f.data[m];_&&!_.skip&&h.push({element:_,datasetIndex:f.index,index:m})}),h):[]},dataset(n,t,e,s){const i=wo(t,n),a=e.axis||"xy",l=e.includeInvisible||!1;let u=e.intersect?Ay(n,i,a,s,l):Iy(n,i,a,!1,s,l);if(u.length>0){const h=u[0].datasetIndex,f=n.getDatasetMeta(h).data;u=[];for(let m=0;m<f.length;++m)u.push({element:f[m],datasetIndex:h,index:m})}return u},point(n,t,e,s){const i=wo(t,n),a=e.axis||"xy",l=e.includeInvisible||!1;return Ay(n,i,a,s,l)},nearest(n,t,e,s){const i=wo(t,n),a=e.axis||"xy",l=e.includeInvisible||!1;return Iy(n,i,a,e.intersect,s,l)},x(n,t,e,s){const i=wo(t,n);return lS(n,i,"x",e.intersect,s)},y(n,t,e,s){const i=wo(t,n);return lS(n,i,"y",e.intersect,s)}}};const KD=["left","top","right","bottom"];function rh(n,t){return n.filter(e=>e.pos===t)}function cS(n,t){return n.filter(e=>KD.indexOf(e.pos)===-1&&e.box.axis===t)}function ah(n,t){return n.sort((e,s)=>{const i=t?s:e,a=t?e:s;return i.weight===a.weight?i.index-a.index:i.weight-a.weight})}function K6(n){const t=[];let e,s,i,a,l,u;for(e=0,s=(n||[]).length;e<s;++e)i=n[e],{position:a,options:{stack:l,stackWeight:u=1}}=i,t.push({index:e,box:i,pos:a,horizontal:i.isHorizontal(),weight:i.weight,stack:l&&a+l,stackWeight:u});return t}function Q6(n){const t={};for(const e of n){const{stack:s,pos:i,stackWeight:a}=e;if(!s||!KD.includes(i))continue;const l=t[s]||(t[s]={count:0,placed:0,weight:0,size:0});l.count++,l.weight+=a}return t}function X6(n,t){const e=Q6(n),{vBoxMaxWidth:s,hBoxMaxHeight:i}=t;let a,l,u;for(a=0,l=n.length;a<l;++a){u=n[a];const{fullSize:h}=u.box,f=e[u.stack],m=f&&u.stackWeight/f.weight;u.horizontal?(u.width=m?m*s:h&&t.availableWidth,u.height=i):(u.width=s,u.height=m?m*i:h&&t.availableHeight)}return e}function Z6(n){const t=K6(n),e=ah(t.filter(f=>f.box.fullSize),!0),s=ah(rh(t,"left"),!0),i=ah(rh(t,"right")),a=ah(rh(t,"top"),!0),l=ah(rh(t,"bottom")),u=cS(t,"x"),h=cS(t,"y");return{fullSize:e,leftAndTop:s.concat(a),rightAndBottom:i.concat(h).concat(l).concat(u),chartArea:rh(t,"chartArea"),vertical:s.concat(i).concat(h),horizontal:a.concat(l).concat(u)}}function uS(n,t,e,s){return Math.max(n[e],t[e])+Math.max(n[s],t[s])}function QD(n,t){n.top=Math.max(n.top,t.top),n.left=Math.max(n.left,t.left),n.bottom=Math.max(n.bottom,t.bottom),n.right=Math.max(n.right,t.right)}function J6(n,t,e,s){const{pos:i,box:a}=e,l=n.maxPadding;if(!Qt(i)){e.size&&(n[i]-=e.size);const _=s[e.stack]||{size:0,count:1};_.size=Math.max(_.size,e.horizontal?a.height:a.width),e.size=_.size/_.count,n[i]+=e.size}a.getPadding&&QD(l,a.getPadding());const u=Math.max(0,t.outerWidth-uS(l,n,"left","right")),h=Math.max(0,t.outerHeight-uS(l,n,"top","bottom")),f=u!==n.w,m=h!==n.h;return n.w=u,n.h=h,e.horizontal?{same:f,other:m}:{same:m,other:f}}function t3(n){const t=n.maxPadding;function e(s){const i=Math.max(t[s]-n[s],0);return n[s]+=i,i}n.y+=e("top"),n.x+=e("left"),e("right"),e("bottom")}function e3(n,t){const e=t.maxPadding;function s(i){const a={left:0,top:0,right:0,bottom:0};return i.forEach(l=>{a[l]=Math.max(t[l],e[l])}),a}return s(n?["left","right"]:["top","bottom"])}function _h(n,t,e,s){const i=[];let a,l,u,h,f,m;for(a=0,l=n.length,f=0;a<l;++a){u=n[a],h=u.box,h.update(u.width||t.w,u.height||t.h,e3(u.horizontal,t));const{same:_,other:x}=J6(t,e,u,s);f|=_&&i.length,m=m||x,h.fullSize||i.push(u)}return f&&_h(i,t,e,s)||m}function dm(n,t,e,s,i){n.top=e,n.left=t,n.right=t+s,n.bottom=e+i,n.width=s,n.height=i}function hS(n,t,e,s){const i=e.padding;let{x:a,y:l}=t;for(const u of n){const h=u.box,f=s[u.stack]||{placed:0,weight:1},m=u.stackWeight/f.weight||1;if(u.horizontal){const _=t.w*m,x=f.size||h.height;id(f.start)&&(l=f.start),h.fullSize?dm(h,i.left,l,e.outerWidth-i.right-i.left,x):dm(h,t.left+f.placed,l,_,x),f.start=l,f.placed+=_,l=h.bottom}else{const _=t.h*m,x=f.size||h.width;id(f.start)&&(a=f.start),h.fullSize?dm(h,a,i.top,x,e.outerHeight-i.bottom-i.top):dm(h,a,t.top+f.placed,x,_),f.start=a,f.placed+=_,a=h.right}}t.x=a,t.y=l}var Pn={addBox(n,t){n.boxes||(n.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},n.boxes.push(t)},removeBox(n,t){const e=n.boxes?n.boxes.indexOf(t):-1;e!==-1&&n.boxes.splice(e,1)},configure(n,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(n,t,e,s){if(!n)return;const i=jn(n.options.layout.padding),a=Math.max(t-i.width,0),l=Math.max(e-i.height,0),u=Z6(n.boxes),h=u.vertical,f=u.horizontal;he(n.boxes,T=>{typeof T.beforeLayout=="function"&&T.beforeLayout()});const m=h.reduce((T,R)=>R.box.options&&R.box.options.display===!1?T:T+1,0)||1,_=Object.freeze({outerWidth:t,outerHeight:e,padding:i,availableWidth:a,availableHeight:l,vBoxMaxWidth:a/2/m,hBoxMaxHeight:l/2}),x=Object.assign({},i);QD(x,jn(s));const E=Object.assign({maxPadding:x,w:a,h:l,x:i.left,y:i.top},i),S=X6(h.concat(f),_);_h(u.fullSize,E,_,S),_h(h,E,_,S),_h(f,E,_,S)&&_h(h,E,_,S),t3(E),hS(u.leftAndTop,E,_,S),E.x+=E.w,E.y+=E.h,hS(u.rightAndBottom,E,_,S),n.chartArea={left:E.left,top:E.top,right:E.left+E.w,bottom:E.top+E.h,height:E.h,width:E.w},he(u.chartArea,T=>{const R=T.box;Object.assign(R,n.chartArea),R.update(E.w,E.h,{left:0,top:0,right:0,bottom:0})})}};class XD{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,s){}removeEventListener(t,e,s){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,s,i){return e=Math.max(0,e||t.width),s=s||t.height,{width:e,height:Math.max(0,i?Math.floor(e/i):s)}}isAttached(t){return!0}updateConfig(t){}}class n3 extends XD{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const Vm="$chartjs",s3={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},dS=n=>n===null||n==="";function i3(n,t){const e=n.style,s=n.getAttribute("height"),i=n.getAttribute("width");if(n[Vm]={initial:{height:s,width:i,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",dS(i)){const a=K1(n,"width");a!==void 0&&(n.width=a)}if(dS(s))if(n.style.height==="")n.height=n.width/(t||2);else{const a=K1(n,"height");a!==void 0&&(n.height=a)}return n}const ZD=r6?{passive:!0}:!1;function r3(n,t,e){n&&n.addEventListener(t,e,ZD)}function a3(n,t,e){n&&n.canvas&&n.canvas.removeEventListener(t,e,ZD)}function o3(n,t){const e=s3[n.type]||n.type,{x:s,y:i}=wo(n,t);return{type:e,chart:t,native:n,x:s!==void 0?s:null,y:i!==void 0?i:null}}function hg(n,t){for(const e of n)if(e===t||e.contains(t))return!0}function l3(n,t,e){const s=n.canvas,i=new MutationObserver(a=>{let l=!1;for(const u of a)l=l||hg(u.addedNodes,s),l=l&&!hg(u.removedNodes,s);l&&e()});return i.observe(document,{childList:!0,subtree:!0}),i}function c3(n,t,e){const s=n.canvas,i=new MutationObserver(a=>{let l=!1;for(const u of a)l=l||hg(u.removedNodes,s),l=l&&!hg(u.addedNodes,s);l&&e()});return i.observe(document,{childList:!0,subtree:!0}),i}const od=new Map;let fS=0;function JD(){const n=window.devicePixelRatio;n!==fS&&(fS=n,od.forEach((t,e)=>{e.currentDevicePixelRatio!==n&&t()}))}function u3(n,t){od.size||window.addEventListener("resize",JD),od.set(n,t)}function h3(n){od.delete(n),od.size||window.removeEventListener("resize",JD)}function d3(n,t,e){const s=n.canvas,i=s&&_x(s);if(!i)return;const a=RD((u,h)=>{const f=i.clientWidth;e(u,h),f<i.clientWidth&&e()},window),l=new ResizeObserver(u=>{const h=u[0],f=h.contentRect.width,m=h.contentRect.height;f===0&&m===0||a(f,m)});return l.observe(i),u3(n,a),l}function Ry(n,t,e){e&&e.disconnect(),t==="resize"&&h3(n)}function f3(n,t,e){const s=n.canvas,i=RD(a=>{n.ctx!==null&&e(o3(a,n))},n);return r3(s,t,i),i}class m3 extends XD{acquireContext(t,e){const s=t&&t.getContext&&t.getContext("2d");return s&&s.canvas===t?(i3(t,e),s):null}releaseContext(t){const e=t.canvas;if(!e[Vm])return!1;const s=e[Vm].initial;["height","width"].forEach(a=>{const l=s[a];Yt(l)?e.removeAttribute(a):e.setAttribute(a,l)});const i=s.style||{};return Object.keys(i).forEach(a=>{e.style[a]=i[a]}),e.width=e.width,delete e[Vm],!0}addEventListener(t,e,s){this.removeEventListener(t,e);const i=t.$proxies||(t.$proxies={}),l={attach:l3,detach:c3,resize:d3}[e]||f3;i[e]=l(t,e,s)}removeEventListener(t,e){const s=t.$proxies||(t.$proxies={}),i=s[e];if(!i)return;({attach:Ry,detach:Ry,resize:Ry}[e]||a3)(t,e,i),s[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,s,i){return i6(t,e,s,i)}isAttached(t){const e=t&&_x(t);return!!(e&&e.isConnected)}}function g3(n){return!px()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?n3:m3}class Ys{constructor(){_t(this,"x");_t(this,"y");_t(this,"active",!1);_t(this,"options");_t(this,"$animations")}tooltipPosition(t){const{x:e,y:s}=this.getProps(["x","y"],t);return{x:e,y:s}}hasValue(){return Cc(this.x)&&Cc(this.y)}getProps(t,e){const s=this.$animations;if(!e||!s)return this;const i={};return t.forEach(a=>{i[a]=s[a]&&s[a].active()?s[a]._to:this[a]}),i}}_t(Ys,"defaults",{}),_t(Ys,"defaultRoutes");function p3(n,t){const e=n.options.ticks,s=_3(n),i=Math.min(e.maxTicksLimit||s,s),a=e.major.enabled?b3(t):[],l=a.length,u=a[0],h=a[l-1],f=[];if(l>i)return x3(t,f,a,l/i),f;const m=y3(a,t,i);if(l>0){let _,x;const E=l>1?Math.round((h-u)/(l-1)):null;for(fm(t,f,m,Yt(E)?0:u-E,u),_=0,x=l-1;_<x;_++)fm(t,f,m,a[_],a[_+1]);return fm(t,f,m,h,Yt(E)?t.length:h+E),f}return fm(t,f,m),f}function _3(n){const t=n.options.offset,e=n._tickSize(),s=n._length/e+(t?0:1),i=n._maxLength/e;return Math.floor(Math.min(s,i))}function y3(n,t,e){const s=v3(n),i=t.length/e;if(!s)return Math.max(i,1);const a=oj(s);for(let l=0,u=a.length-1;l<u;l++){const h=a[l];if(h>i)return h}return Math.max(i,1)}function b3(n){const t=[];let e,s;for(e=0,s=n.length;e<s;e++)n[e].major&&t.push(e);return t}function x3(n,t,e,s){let i=0,a=e[0],l;for(s=Math.ceil(s),l=0;l<n.length;l++)l===a&&(t.push(n[l]),i++,a=e[i*s])}function fm(n,t,e,s,i){const a=jt(s,0),l=Math.min(jt(i,n.length),n.length);let u=0,h,f,m;for(e=Math.ceil(e),i&&(h=i-s,e=h/Math.floor(h/e)),m=a;m<0;)u++,m=Math.round(a+u*e);for(f=Math.max(a,0);f<l;f++)f===m&&(t.push(n[f]),u++,m=Math.round(a+u*e))}function v3(n){const t=n.length;let e,s;if(t<2)return!1;for(s=n[0],e=1;e<t;++e)if(n[e]-n[e-1]!==s)return!1;return s}const E3=n=>n==="left"?"right":n==="right"?"left":n,mS=(n,t,e)=>t==="top"||t==="left"?n[t]+e:n[t]-e,gS=(n,t)=>Math.min(t||n,n);function pS(n,t){const e=[],s=n.length/t,i=n.length;let a=0;for(;a<i;a+=s)e.push(n[Math.floor(a)]);return e}function T3(n,t,e){const s=n.ticks.length,i=Math.min(t,s-1),a=n._startPixel,l=n._endPixel,u=1e-6;let h=n.getPixelForTick(i),f;if(!(e&&(s===1?f=Math.max(h-a,l-h):t===0?f=(n.getPixelForTick(1)-h)/2:f=(h-n.getPixelForTick(i-1))/2,h+=i<t?f:-f,h<a-u||h>l+u)))return h}function w3(n,t){he(n,e=>{const s=e.gc,i=s.length/2;let a;if(i>t){for(a=0;a<i;++a)delete e.data[s[a]];s.splice(0,i)}})}function oh(n){return n.drawTicks?n.tickLength:0}function _S(n,t){if(!n.display)return 0;const e=cn(n.font,t),s=jn(n.padding);return(Me(n.text)?n.text.length:1)*e.lineHeight+s.height}function S3(n,t){return Ma(n,{scale:t,type:"scale"})}function A3(n,t,e){return Ma(n,{tick:e,index:t,type:"tick"})}function I3(n,t,e){let s=ux(n);return(e&&t!=="right"||!e&&t==="right")&&(s=E3(s)),s}function R3(n,t,e,s){const{top:i,left:a,bottom:l,right:u,chart:h}=n,{chartArea:f,scales:m}=h;let _=0,x,E,S;const T=l-i,R=u-a;if(n.isHorizontal()){if(E=Mn(s,a,u),Qt(e)){const M=Object.keys(e)[0],L=e[M];S=m[M].getPixelForValue(L)+T-t}else e==="center"?S=(f.bottom+f.top)/2+T-t:S=mS(n,e,t);x=u-a}else{if(Qt(e)){const M=Object.keys(e)[0],L=e[M];E=m[M].getPixelForValue(L)-R+t}else e==="center"?E=(f.left+f.right)/2-R+t:E=mS(n,e,t);S=Mn(s,l,i),_=e==="left"?-Ye:Ye}return{titleX:E,titleY:S,maxWidth:x,rotation:_}}let Nd=class tN extends Ys{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:s,_suggestedMax:i}=this;return t=ds(t,Number.POSITIVE_INFINITY),e=ds(e,Number.NEGATIVE_INFINITY),s=ds(s,Number.POSITIVE_INFINITY),i=ds(i,Number.NEGATIVE_INFINITY),{min:ds(t,s),max:ds(e,i),minDefined:je(t),maxDefined:je(e)}}getMinMax(t){let{min:e,max:s,minDefined:i,maxDefined:a}=this.getUserBounds(),l;if(i&&a)return{min:e,max:s};const u=this.getMatchingVisibleMetas();for(let h=0,f=u.length;h<f;++h)l=u[h].controller.getMinMax(this,t),i||(e=Math.min(e,l.min)),a||(s=Math.max(s,l.max));return e=a&&e>s?s:e,s=i&&e>s?e:s,{min:ds(e,ds(s,e)),max:ds(s,ds(e,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){ve(this.options.beforeUpdate,[this])}update(t,e,s){const{beginAtZero:i,grace:a,ticks:l}=this.options,u=l.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Pj(this,a,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const h=u<this.ticks.length;this._convertTicksToLabels(h?pS(this.ticks,u):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),l.display&&(l.autoSkip||l.source==="auto")&&(this.ticks=p3(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),h&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,e,s;this.isHorizontal()?(e=this.left,s=this.right):(e=this.top,s=this.bottom,t=!t),this._startPixel=e,this._endPixel=s,this._reversePixels=t,this._length=s-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){ve(this.options.afterUpdate,[this])}beforeSetDimensions(){ve(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){ve(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),ve(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){ve(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let s,i,a;for(s=0,i=t.length;s<i;s++)a=t[s],a.label=ve(e.callback,[a.value,s,t],this)}afterTickToLabelConversion(){ve(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){ve(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,s=gS(this.ticks.length,t.ticks.maxTicksLimit),i=e.minRotation||0,a=e.maxRotation;let l=i,u,h,f;if(!this._isVisible()||!e.display||i>=a||s<=1||!this.isHorizontal()){this.labelRotation=i;return}const m=this._getLabelSizes(),_=m.widest.width,x=m.highest.height,E=yn(this.chart.width-_,0,this.maxWidth);u=t.offset?this.maxWidth/s:E/(s-1),_+6>u&&(u=E/(s-(t.offset?.5:1)),h=this.maxHeight-oh(t.grid)-e.padding-_S(t.title,this.chart.options.font),f=Math.sqrt(_*_+x*x),l=lx(Math.min(Math.asin(yn((m.highest.height+6)/u,-1,1)),Math.asin(yn(h/f,-1,1))-Math.asin(yn(x/f,-1,1)))),l=Math.max(i,Math.min(a,l))),this.labelRotation=l}afterCalculateLabelRotation(){ve(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){ve(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:s,title:i,grid:a}}=this,l=this._isVisible(),u=this.isHorizontal();if(l){const h=_S(i,e.options.font);if(u?(t.width=this.maxWidth,t.height=oh(a)+h):(t.height=this.maxHeight,t.width=oh(a)+h),s.display&&this.ticks.length){const{first:f,last:m,widest:_,highest:x}=this._getLabelSizes(),E=s.padding*2,S=qs(this.labelRotation),T=Math.cos(S),R=Math.sin(S);if(u){const M=s.mirror?0:R*_.width+T*x.height;t.height=Math.min(this.maxHeight,t.height+M+E)}else{const M=s.mirror?0:T*_.width+R*x.height;t.width=Math.min(this.maxWidth,t.width+M+E)}this._calculatePadding(f,m,R,T)}}this._handleMargins(),u?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,s,i){const{ticks:{align:a,padding:l},position:u}=this.options,h=this.labelRotation!==0,f=u!=="top"&&this.axis==="x";if(this.isHorizontal()){const m=this.getPixelForTick(0)-this.left,_=this.right-this.getPixelForTick(this.ticks.length-1);let x=0,E=0;h?f?(x=i*t.width,E=s*e.height):(x=s*t.height,E=i*e.width):a==="start"?E=e.width:a==="end"?x=t.width:a!=="inner"&&(x=t.width/2,E=e.width/2),this.paddingLeft=Math.max((x-m+l)*this.width/(this.width-m),0),this.paddingRight=Math.max((E-_+l)*this.width/(this.width-_),0)}else{let m=e.height/2,_=t.height/2;a==="start"?(m=0,_=t.height):a==="end"&&(m=e.height,_=0),this.paddingTop=m+l,this.paddingBottom=_+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){ve(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return e==="top"||e==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let e,s;for(e=0,s=t.length;e<s;e++)Yt(t[e].label)&&(t.splice(e,1),s--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let s=this.ticks;e<s.length&&(s=pS(s,e)),this._labelSizes=t=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,s){const{ctx:i,_longestTextCache:a}=this,l=[],u=[],h=Math.floor(e/gS(e,s));let f=0,m=0,_,x,E,S,T,R,M,L,O,H,B;for(_=0;_<e;_+=h){if(S=t[_].label,T=this._resolveTickFontOptions(_),i.font=R=T.string,M=a[R]=a[R]||{data:{},gc:[]},L=T.lineHeight,O=H=0,!Yt(S)&&!Me(S))O=cg(i,M.data,M.gc,O,S),H=L;else if(Me(S))for(x=0,E=S.length;x<E;++x)B=S[x],!Yt(B)&&!Me(B)&&(O=cg(i,M.data,M.gc,O,B),H+=L);l.push(O),u.push(H),f=Math.max(O,f),m=Math.max(H,m)}w3(a,e);const z=l.indexOf(f),D=u.indexOf(m),I=C=>({width:l[C]||0,height:u[C]||0});return{first:I(0),last:I(e-1),widest:I(z),highest:I(D),widths:l,heights:u}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return hj(this._alignToPixels?yo(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const s=e[t];return s.$context||(s.$context=A3(this.getContext(),t,s))}return this.$context||(this.$context=S3(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=qs(this.labelRotation),s=Math.abs(Math.cos(e)),i=Math.abs(Math.sin(e)),a=this._getLabelSizes(),l=t.autoSkipPadding||0,u=a?a.widest.width+l:0,h=a?a.highest.height+l:0;return this.isHorizontal()?h*s>u*i?u/s:h/i:h*i<u*s?h/s:u/i}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,s=this.chart,i=this.options,{grid:a,position:l,border:u}=i,h=a.offset,f=this.isHorizontal(),_=this.ticks.length+(h?1:0),x=oh(a),E=[],S=u.setContext(this.getContext()),T=S.display?S.width:0,R=T/2,M=function(Y){return yo(s,Y,T)};let L,O,H,B,z,D,I,C,P,j,F,k;if(l==="top")L=M(this.bottom),D=this.bottom-x,C=L-R,j=M(t.top)+R,k=t.bottom;else if(l==="bottom")L=M(this.top),j=t.top,k=M(t.bottom)-R,D=L+R,C=this.top+x;else if(l==="left")L=M(this.right),z=this.right-x,I=L-R,P=M(t.left)+R,F=t.right;else if(l==="right")L=M(this.left),P=t.left,F=M(t.right)-R,z=L+R,I=this.left+x;else if(e==="x"){if(l==="center")L=M((t.top+t.bottom)/2+.5);else if(Qt(l)){const Y=Object.keys(l)[0],at=l[Y];L=M(this.chart.scales[Y].getPixelForValue(at))}j=t.top,k=t.bottom,D=L+R,C=D+x}else if(e==="y"){if(l==="center")L=M((t.left+t.right)/2);else if(Qt(l)){const Y=Object.keys(l)[0],at=l[Y];L=M(this.chart.scales[Y].getPixelForValue(at))}z=L-R,I=z-x,P=t.left,F=t.right}const nt=jt(i.ticks.maxTicksLimit,_),bt=Math.max(1,Math.ceil(_/nt));for(O=0;O<_;O+=bt){const Y=this.getContext(O),at=a.setContext(Y),mt=u.setContext(Y),Dt=at.lineWidth,U=at.color,st=mt.dash||[],ht=mt.dashOffset,dt=at.tickWidth,yt=at.tickColor,kt=at.tickBorderDash||[],At=at.tickBorderDashOffset;H=T3(this,O,h),H!==void 0&&(B=yo(s,H,Dt),f?z=I=P=F=B:D=C=j=k=B,E.push({tx1:z,ty1:D,tx2:I,ty2:C,x1:P,y1:j,x2:F,y2:k,width:Dt,color:U,borderDash:st,borderDashOffset:ht,tickWidth:dt,tickColor:yt,tickBorderDash:kt,tickBorderDashOffset:At}))}return this._ticksLength=_,this._borderValue=L,E}_computeLabelItems(t){const e=this.axis,s=this.options,{position:i,ticks:a}=s,l=this.isHorizontal(),u=this.ticks,{align:h,crossAlign:f,padding:m,mirror:_}=a,x=oh(s.grid),E=x+m,S=_?-m:E,T=-qs(this.labelRotation),R=[];let M,L,O,H,B,z,D,I,C,P,j,F,k="middle";if(i==="top")z=this.bottom-S,D=this._getXAxisLabelAlignment();else if(i==="bottom")z=this.top+S,D=this._getXAxisLabelAlignment();else if(i==="left"){const bt=this._getYAxisLabelAlignment(x);D=bt.textAlign,B=bt.x}else if(i==="right"){const bt=this._getYAxisLabelAlignment(x);D=bt.textAlign,B=bt.x}else if(e==="x"){if(i==="center")z=(t.top+t.bottom)/2+E;else if(Qt(i)){const bt=Object.keys(i)[0],Y=i[bt];z=this.chart.scales[bt].getPixelForValue(Y)+E}D=this._getXAxisLabelAlignment()}else if(e==="y"){if(i==="center")B=(t.left+t.right)/2-E;else if(Qt(i)){const bt=Object.keys(i)[0],Y=i[bt];B=this.chart.scales[bt].getPixelForValue(Y)}D=this._getYAxisLabelAlignment(x).textAlign}e==="y"&&(h==="start"?k="top":h==="end"&&(k="bottom"));const nt=this._getLabelSizes();for(M=0,L=u.length;M<L;++M){O=u[M],H=O.label;const bt=a.setContext(this.getContext(M));I=this.getPixelForTick(M)+a.labelOffset,C=this._resolveTickFontOptions(M),P=C.lineHeight,j=Me(H)?H.length:1;const Y=j/2,at=bt.color,mt=bt.textStrokeColor,Dt=bt.textStrokeWidth;let U=D;l?(B=I,D==="inner"&&(M===L-1?U=this.options.reverse?"left":"right":M===0?U=this.options.reverse?"right":"left":U="center"),i==="top"?f==="near"||T!==0?F=-j*P+P/2:f==="center"?F=-nt.highest.height/2-Y*P+P:F=-nt.highest.height+P/2:f==="near"||T!==0?F=P/2:f==="center"?F=nt.highest.height/2-Y*P:F=nt.highest.height-j*P,_&&(F*=-1),T!==0&&!bt.showLabelBackdrop&&(B+=P/2*Math.sin(T))):(z=I,F=(1-j)*P/2);let st;if(bt.showLabelBackdrop){const ht=jn(bt.backdropPadding),dt=nt.heights[M],yt=nt.widths[M];let kt=F-ht.top,At=0-ht.left;switch(k){case"middle":kt-=dt/2;break;case"bottom":kt-=dt;break}switch(D){case"center":At-=yt/2;break;case"right":At-=yt;break;case"inner":M===L-1?At-=yt:M>0&&(At-=yt/2);break}st={left:At,top:kt,width:yt+ht.width,height:dt+ht.height,color:bt.backdropColor}}R.push({label:H,font:C,textOffset:F,options:{rotation:T,color:at,strokeColor:mt,strokeWidth:Dt,textAlign:U,textBaseline:k,translation:[B,z],backdrop:st}})}return R}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-qs(this.labelRotation))return t==="top"?"left":"right";let i="center";return e.align==="start"?i="left":e.align==="end"?i="right":e.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:s,mirror:i,padding:a}}=this.options,l=this._getLabelSizes(),u=t+a,h=l.widest.width;let f,m;return e==="left"?i?(m=this.right+a,s==="near"?f="left":s==="center"?(f="center",m+=h/2):(f="right",m+=h)):(m=this.right-u,s==="near"?f="right":s==="center"?(f="center",m-=h/2):(f="left",m=this.left)):e==="right"?i?(m=this.left+a,s==="near"?f="right":s==="center"?(f="center",m-=h/2):(f="left",m-=h)):(m=this.left+u,s==="near"?f="left":s==="center"?(f="center",m+=h/2):(f="right",m=this.right)):f="right",{textAlign:f,x:m}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:s,top:i,width:a,height:l}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(s,i,a,l),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const i=this.ticks.findIndex(a=>a.value===t);return i>=0?e.setContext(this.getContext(i)).lineWidth:0}drawGrid(t){const e=this.options.grid,s=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let a,l;const u=(h,f,m)=>{!m.width||!m.color||(s.save(),s.lineWidth=m.width,s.strokeStyle=m.color,s.setLineDash(m.borderDash||[]),s.lineDashOffset=m.borderDashOffset,s.beginPath(),s.moveTo(h.x,h.y),s.lineTo(f.x,f.y),s.stroke(),s.restore())};if(e.display)for(a=0,l=i.length;a<l;++a){const h=i[a];e.drawOnChartArea&&u({x:h.x1,y:h.y1},{x:h.x2,y:h.y2},h),e.drawTicks&&u({x:h.tx1,y:h.ty1},{x:h.tx2,y:h.ty2},{color:h.tickColor,width:h.tickWidth,borderDash:h.tickBorderDash,borderDashOffset:h.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:s,grid:i}}=this,a=s.setContext(this.getContext()),l=s.display?a.width:0;if(!l)return;const u=i.setContext(this.getContext(0)).lineWidth,h=this._borderValue;let f,m,_,x;this.isHorizontal()?(f=yo(t,this.left,l)-l/2,m=yo(t,this.right,u)+u/2,_=x=h):(_=yo(t,this.top,l)-l/2,x=yo(t,this.bottom,u)+u/2,f=m=h),e.save(),e.lineWidth=a.width,e.strokeStyle=a.color,e.beginPath(),e.moveTo(f,_),e.lineTo(m,x),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const s=this.ctx,i=this._computeLabelArea();i&&Yg(s,i);const a=this.getLabelItems(t);for(const l of a){const u=l.options,h=l.font,f=l.label,m=l.textOffset;Qo(s,f,0,m,h,u)}i&&Kg(s)}drawTitle(){const{ctx:t,options:{position:e,title:s,reverse:i}}=this;if(!s.display)return;const a=cn(s.font),l=jn(s.padding),u=s.align;let h=a.lineHeight/2;e==="bottom"||e==="center"||Qt(e)?(h+=l.bottom,Me(s.text)&&(h+=a.lineHeight*(s.text.length-1))):h+=l.top;const{titleX:f,titleY:m,maxWidth:_,rotation:x}=R3(this,h,e,u);Qo(t,s.text,0,0,a,{color:s.color,maxWidth:_,rotation:x,textAlign:I3(u,e,i),textBaseline:"middle",translation:[f,m]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,s=jt(t.grid&&t.grid.z,-1),i=jt(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==tN.prototype.draw?[{z:e,draw:a=>{this.draw(a)}}]:[{z:s,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:e,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",i=[];let a,l;for(a=0,l=e.length;a<l;++a){const u=e[a];u[s]===this.id&&(!t||u.type===t)&&i.push(u)}return i}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return cn(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}};class mm{constructor(t,e,s){this.type=t,this.scope=e,this.override=s,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let s;C3(e)&&(s=this.register(e));const i=this.items,a=t.id,l=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+t);return a in i||(i[a]=t,D3(t,l,s),this.override&&Oe.override(t.id,t.overrides)),l}get(t){return this.items[t]}unregister(t){const e=this.items,s=t.id,i=this.scope;s in e&&delete e[s],i&&s in Oe[i]&&(delete Oe[i][s],this.override&&delete Ko[s])}}function D3(n,t,e){const s=sd(Object.create(null),[e?Oe.get(e):{},Oe.get(t),n.defaults]);Oe.set(t,s),n.defaultRoutes&&N3(t,n.defaultRoutes),n.descriptors&&Oe.describe(t,n.descriptors)}function N3(n,t){Object.keys(t).forEach(e=>{const s=e.split("."),i=s.pop(),a=[n].concat(s).join("."),l=t[e].split("."),u=l.pop(),h=l.join(".");Oe.route(a,i,h,u)})}function C3(n){return"id"in n&&"defaults"in n}class M3{constructor(){this.controllers=new mm(Ws,"datasets",!0),this.elements=new mm(Ys,"elements"),this.plugins=new mm(Object,"plugins"),this.scales=new mm(Nd,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,s){[...e].forEach(i=>{const a=s||this._getRegistryForType(i);s||a.isForType(i)||a===this.plugins&&i.id?this._exec(t,a,i):he(i,l=>{const u=s||this._getRegistryForType(l);this._exec(t,u,l)})})}_exec(t,e,s){const i=ox(t);ve(s["before"+i],[],s),e[t](s),ve(s["after"+i],[],s)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const s=this._typedRegistries[e];if(s.isForType(t))return s}return this.plugins}_get(t,e,s){const i=e.get(t);if(i===void 0)throw new Error('"'+t+'" is not a registered '+s+".");return i}}var hi=new M3;class O3{constructor(){this._init=[]}notify(t,e,s,i){e==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const a=i?this._descriptors(t).filter(i):this._descriptors(t),l=this._notify(a,t,e,s);return e==="afterDestroy"&&(this._notify(a,t,"stop"),this._notify(this._init,t,"uninstall")),l}_notify(t,e,s,i){i=i||{};for(const a of t){const l=a.plugin,u=l[s],h=[e,i,a.options];if(ve(u,h,l)===!1&&i.cancelable)return!1}return!0}invalidate(){Yt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const s=t&&t.config,i=jt(s.options&&s.options.plugins,{}),a=k3(s);return i===!1&&!e?[]:P3(t,a,i,e)}_notifyStateChanges(t){const e=this._oldCache||[],s=this._cache,i=(a,l)=>a.filter(u=>!l.some(h=>u.plugin.id===h.plugin.id));this._notify(i(e,s),t,"stop"),this._notify(i(s,e),t,"start")}}function k3(n){const t={},e=[],s=Object.keys(hi.plugins.items);for(let a=0;a<s.length;a++)e.push(hi.getPlugin(s[a]));const i=n.plugins||[];for(let a=0;a<i.length;a++){const l=i[a];e.indexOf(l)===-1&&(e.push(l),t[l.id]=!0)}return{plugins:e,localIds:t}}function V3(n,t){return!t&&n===!1?null:n===!0?{}:n}function P3(n,{plugins:t,localIds:e},s,i){const a=[],l=n.getContext();for(const u of t){const h=u.id,f=V3(s[h],i);f!==null&&a.push({plugin:u,options:L3(n.config,{plugin:u,local:e[h]},f,l)})}return a}function L3(n,{plugin:t,local:e},s,i){const a=n.pluginScopeKeys(t),l=n.getOptionScopes(s,a);return e&&t.defaults&&l.push(t.defaults),n.createResolver(l,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function E0(n,t){const e=Oe.datasets[n]||{};return((t.datasets||{})[n]||{}).indexAxis||t.indexAxis||e.indexAxis||"x"}function j3(n,t){let e=n;return n==="_index_"?e=t:n==="_value_"&&(e=t==="x"?"y":"x"),e}function B3(n,t){return n===t?"_index_":"_value_"}function yS(n){if(n==="x"||n==="y"||n==="r")return n}function F3(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function T0(n,...t){if(yS(n))return n;for(const e of t){const s=e.axis||F3(e.position)||n.length>1&&yS(n[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function bS(n,t,e){if(e[t+"AxisID"]===n)return{axis:t}}function U3(n,t){if(t.data&&t.data.datasets){const e=t.data.datasets.filter(s=>s.xAxisID===n||s.yAxisID===n);if(e.length)return bS(n,"x",e[0])||bS(n,"y",e[0])}return{}}function z3(n,t){const e=Ko[n.type]||{scales:{}},s=t.scales||{},i=E0(n.type,t),a=Object.create(null);return Object.keys(s).forEach(l=>{const u=s[l];if(!Qt(u))return console.error(`Invalid scale configuration for scale: ${l}`);if(u._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${l}`);const h=T0(l,u,U3(l,n),Oe.scales[u.type]),f=B3(h,i),m=e.scales||{};a[l]=Oh(Object.create(null),[{axis:h},u,m[h],m[f]])}),n.data.datasets.forEach(l=>{const u=l.type||n.type,h=l.indexAxis||E0(u,t),m=(Ko[u]||{}).scales||{};Object.keys(m).forEach(_=>{const x=j3(_,h),E=l[x+"AxisID"]||x;a[E]=a[E]||Object.create(null),Oh(a[E],[{axis:x},s[E],m[_]])})}),Object.keys(a).forEach(l=>{const u=a[l];Oh(u,[Oe.scales[u.type],Oe.scale])}),a}function eN(n){const t=n.options||(n.options={});t.plugins=jt(t.plugins,{}),t.scales=z3(n,t)}function nN(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function H3(n){return n=n||{},n.data=nN(n.data),eN(n),n}const xS=new Map,sN=new Set;function gm(n,t){let e=xS.get(n);return e||(e=t(),xS.set(n,e),sN.add(e)),e}const lh=(n,t,e)=>{const s=Ta(t,e);s!==void 0&&n.add(s)};class q3{constructor(t){this._config=H3(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=nN(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),eN(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return gm(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return gm(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return gm(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id,s=this.type;return gm(`${s}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const s=this._scopeCache;let i=s.get(t);return(!i||e)&&(i=new Map,s.set(t,i)),i}getOptionScopes(t,e,s){const{options:i,type:a}=this,l=this._cachedScopes(t,s),u=l.get(e);if(u)return u;const h=new Set;e.forEach(m=>{t&&(h.add(t),m.forEach(_=>lh(h,t,_))),m.forEach(_=>lh(h,i,_)),m.forEach(_=>lh(h,Ko[a]||{},_)),m.forEach(_=>lh(h,Oe,_)),m.forEach(_=>lh(h,b0,_))});const f=Array.from(h);return f.length===0&&f.push(Object.create(null)),sN.has(e)&&l.set(e,f),f}chartOptionScopes(){const{options:t,type:e}=this;return[t,Ko[e]||{},Oe.datasets[e]||{},{type:e},Oe,b0]}resolveNamedOptions(t,e,s,i=[""]){const a={$shared:!0},{resolver:l,subPrefixes:u}=vS(this._resolverCache,t,i);let h=l;if($3(l,e)){a.$shared=!1,s=wa(s)?s():s;const f=this.createResolver(t,s,u);h=Mc(l,s,f)}for(const f of e)a[f]=h[f];return a}createResolver(t,e,s=[""],i){const{resolver:a}=vS(this._resolverCache,t,s);return Qt(e)?Mc(a,e,void 0,i):a}}function vS(n,t,e){let s=n.get(t);s||(s=new Map,n.set(t,s));const i=e.join();let a=s.get(i);return a||(a={resolver:fx(t,e),subPrefixes:e.filter(u=>!u.toLowerCase().includes("hover"))},s.set(i,a)),a}const G3=n=>Qt(n)&&Object.getOwnPropertyNames(n).some(t=>wa(n[t]));function $3(n,t){const{isScriptable:e,isIndexable:s}=kD(n);for(const i of t){const a=e(i),l=s(i),u=(l||a)&&n[i];if(a&&(wa(u)||G3(u))||l&&Me(u))return!0}return!1}var W3="4.5.0";const Y3=["top","bottom","left","right","chartArea"];function ES(n,t){return n==="top"||n==="bottom"||Y3.indexOf(n)===-1&&t==="x"}function TS(n,t){return function(e,s){return e[n]===s[n]?e[t]-s[t]:e[n]-s[n]}}function wS(n){const t=n.chart,e=t.options.animation;t.notifyPlugins("afterRender"),ve(e&&e.onComplete,[n],t)}function K3(n){const t=n.chart,e=t.options.animation;ve(e&&e.onProgress,[n],t)}function iN(n){return px()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const Pm={},SS=n=>{const t=iN(n);return Object.values(Pm).filter(e=>e.canvas===t).pop()};function Q3(n,t,e){const s=Object.keys(n);for(const i of s){const a=+i;if(a>=t){const l=n[i];delete n[i],(e>0||a>t)&&(n[a+e]=l)}}}function X3(n,t,e,s){return!e||n.type==="mouseout"?null:s?t:n}class wn{static register(...t){hi.add(...t),AS()}static unregister(...t){hi.remove(...t),AS()}constructor(t,e){const s=this.config=new q3(e),i=iN(t),a=SS(i);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const l=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||g3(i)),this.platform.updateConfig(s);const u=this.platform.acquireContext(i,l.aspectRatio),h=u&&u.canvas,f=h&&h.height,m=h&&h.width;if(this.id=ZL(),this.ctx=u,this.canvas=h,this.width=m,this.height=f,this._options=l,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new O3,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=gj(_=>this.update(_),l.resizeDelay||0),this._dataChanges=[],Pm[this.id]=this,!u||!h){console.error("Failed to create chart: can't acquire context from the given item");return}Wi.listen(this,"complete",wS),Wi.listen(this,"progress",K3),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:s,height:i,_aspectRatio:a}=this;return Yt(t)?e&&a?a:i?s/i:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return hi}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Y1(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return G1(this.canvas,this.ctx),this}stop(){return Wi.stop(this),this}resize(t,e){Wi.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const s=this.options,i=this.canvas,a=s.maintainAspectRatio&&this.aspectRatio,l=this.platform.getMaximumSize(i,t,e,a),u=s.devicePixelRatio||this.platform.getDevicePixelRatio(),h=this.width?"resize":"attach";this.width=l.width,this.height=l.height,this._aspectRatio=this.aspectRatio,Y1(this,u,!0)&&(this.notifyPlugins("resize",{size:l}),ve(s.onResize,[this,l],this),this.attached&&this._doResize(h)&&this.render())}ensureScalesHaveIDs(){const e=this.options.scales||{};he(e,(s,i)=>{s.id=i})}buildOrUpdateScales(){const t=this.options,e=t.scales,s=this.scales,i=Object.keys(s).reduce((l,u)=>(l[u]=!1,l),{});let a=[];e&&(a=a.concat(Object.keys(e).map(l=>{const u=e[l],h=T0(l,u),f=h==="r",m=h==="x";return{options:u,dposition:f?"chartArea":m?"bottom":"left",dtype:f?"radialLinear":m?"category":"linear"}}))),he(a,l=>{const u=l.options,h=u.id,f=T0(h,u),m=jt(u.type,l.dtype);(u.position===void 0||ES(u.position,f)!==ES(l.dposition))&&(u.position=l.dposition),i[h]=!0;let _=null;if(h in s&&s[h].type===m)_=s[h];else{const x=hi.getScale(m);_=new x({id:h,type:m,ctx:this.ctx,chart:this}),s[_.id]=_}_.init(u,t)}),he(i,(l,u)=>{l||delete s[u]}),he(s,l=>{Pn.configure(this,l,l.options),Pn.addBox(this,l)})}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,s=t.length;if(t.sort((i,a)=>i.index-a.index),s>e){for(let i=e;i<s;++i)this._destroyDatasetMeta(i);t.splice(e,s-e)}this._sortedMetasets=t.slice(0).sort(TS("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach((s,i)=>{e.filter(a=>a===s._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let s,i;for(this._removeUnreferencedMetasets(),s=0,i=e.length;s<i;s++){const a=e[s];let l=this.getDatasetMeta(s);const u=a.type||this.config.type;if(l.type&&l.type!==u&&(this._destroyDatasetMeta(s),l=this.getDatasetMeta(s)),l.type=u,l.indexAxis=a.indexAxis||E0(u,this.options),l.order=a.order||0,l.index=s,l.label=""+a.label,l.visible=this.isDatasetVisible(s),l.controller)l.controller.updateIndex(s),l.controller.linkScales();else{const h=hi.getController(u),{datasetElementType:f,dataElementType:m}=Oe.datasets[u];Object.assign(h,{dataElementType:hi.getElement(m),datasetElementType:f&&hi.getElement(f)}),l.controller=new h(this,s),t.push(l.controller)}}return this._updateMetasets(),t}_resetElements(){he(this.data.datasets,(t,e)=>{this.getDatasetMeta(e).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const s=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let l=0;for(let f=0,m=this.data.datasets.length;f<m;f++){const{controller:_}=this.getDatasetMeta(f),x=!i&&a.indexOf(_)===-1;_.buildOrUpdateElements(x),l=Math.max(+_.getMaxOverflow(),l)}l=this._minPadding=s.layout.autoPadding?l:0,this._updateLayout(l),i||he(a,f=>{f.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(TS("z","_idx"));const{_active:u,_lastEvent:h}=this;h?this._eventHandler(h,!0):u.length&&this._updateHoverStyles(u,u,!0),this.render()}_updateScales(){he(this.scales,t=>{Pn.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),s=new Set(t.events);(!P1(e,s)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:s,start:i,count:a}of e){const l=s==="_removeElements"?-a:a;Q3(t,i,l)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,s=a=>new Set(t.filter(l=>l[0]===a).map((l,u)=>u+","+l.splice(1).join(","))),i=s(0);for(let a=1;a<e;a++)if(!P1(i,s(a)))return;return Array.from(i).map(a=>a.split(",")).map(a=>({method:a[1],start:+a[2],count:+a[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Pn.update(this,this.width,this.height,t);const e=this.chartArea,s=e.width<=0||e.height<=0;this._layers=[],he(this.boxes,i=>{s&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,a)=>{i._idx=a}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let e=0,s=this.data.datasets.length;e<s;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,s=this.data.datasets.length;e<s;++e)this._updateDataset(e,wa(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const s=this.getDatasetMeta(t),i={meta:s,index:t,mode:e,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(s.controller._update(e),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Wi.has(this)?this.attached&&!Wi.running(this)&&Wi.start(this):(this.draw(),wS({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:s,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,s=[];let i,a;for(i=0,a=e.length;i<a;++i){const l=e[i];(!t||l.visible)&&s.push(l)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,s={meta:t,index:t.index,cancelable:!0},i=GD(this,t);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(i&&Yg(e,i),t.controller.draw(),i&&Kg(e),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(t){return Ji(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,s,i){const a=Y6.modes[e];return typeof a=="function"?a(this,t,s,i):[]}getDatasetMeta(t){const e=this.data.datasets[t],s=this._metasets;let i=s.filter(a=>a&&a._dataset===e).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},s.push(i)),i}getContext(){return this.$context||(this.$context=Ma(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const s=this.getDatasetMeta(t);return typeof s.hidden=="boolean"?!s.hidden:!e.hidden}setDatasetVisibility(t,e){const s=this.getDatasetMeta(t);s.hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,s){const i=s?"show":"hide",a=this.getDatasetMeta(t),l=a.controller._resolveAnimations(void 0,i);id(e)?(a.data[e].hidden=!s,this.update()):(this.setDatasetVisibility(t,s),l.update(a,{visible:s}),this.update(u=>u.datasetIndex===t?i:void 0))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),Wi.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),G1(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete Pm[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,s=(a,l)=>{e.addEventListener(this,a,l),t[a]=l},i=(a,l,u)=>{a.offsetX=l,a.offsetY=u,this._eventHandler(a)};he(this.options.events,a=>s(a,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,s=(h,f)=>{e.addEventListener(this,h,f),t[h]=f},i=(h,f)=>{t[h]&&(e.removeEventListener(this,h,f),delete t[h])},a=(h,f)=>{this.canvas&&this.resize(h,f)};let l;const u=()=>{i("attach",u),this.attached=!0,this.resize(),s("resize",a),s("detach",l)};l=()=>{this.attached=!1,i("resize",a),this._stop(),this._resize(0,0),s("attach",u)},e.isAttached(this.canvas)?u():l()}unbindEvents(){he(this._listeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._listeners={},he(this._responsiveListeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,e,s){const i=s?"set":"remove";let a,l,u,h;for(e==="dataset"&&(a=this.getDatasetMeta(t[0].datasetIndex),a.controller["_"+i+"DatasetHoverStyle"]()),u=0,h=t.length;u<h;++u){l=t[u];const f=l&&this.getDatasetMeta(l.datasetIndex).controller;f&&f[i+"HoverStyle"](l.element,l.datasetIndex,l.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],s=t.map(({datasetIndex:a,index:l})=>{const u=this.getDatasetMeta(a);if(!u)throw new Error("No dataset found at index "+a);return{datasetIndex:a,element:u.data[l],index:l}});!ag(s,e)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,e))}notifyPlugins(t,e,s){return this._plugins.notify(this,t,e,s)}isPluginEnabled(t){return this._plugins._cache.filter(e=>e.plugin.id===t).length===1}_updateHoverStyles(t,e,s){const i=this.options.hover,a=(h,f)=>h.filter(m=>!f.some(_=>m.datasetIndex===_.datasetIndex&&m.index===_.index)),l=a(e,t),u=s?t:a(t,e);l.length&&this.updateHoverStyle(l,i.mode,!1),u.length&&i.mode&&this.updateHoverStyle(u,i.mode,!0)}_eventHandler(t,e){const s={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},i=l=>(l.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",s,i)===!1)return;const a=this._handleEvent(t,e,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,i),(a||s.changed)&&this.render(),this}_handleEvent(t,e,s){const{_active:i=[],options:a}=this,l=e,u=this._getActiveElements(t,i,s,l),h=ij(t),f=X3(t,this._lastEvent,s,h);s&&(this._lastEvent=null,ve(a.onHover,[t,u,this],this),h&&ve(a.onClick,[t,u,this],this));const m=!ag(u,i);return(m||e)&&(this._active=u,this._updateHoverStyles(u,i,e)),this._lastEvent=f,m}_getActiveElements(t,e,s,i){if(t.type==="mouseout")return[];if(!s)return e;const a=this.options.hover;return this.getElementsAtEventForMode(t,a.mode,a,i)}}_t(wn,"defaults",Oe),_t(wn,"instances",Pm),_t(wn,"overrides",Ko),_t(wn,"registry",hi),_t(wn,"version",W3),_t(wn,"getChart",SS);function AS(){return he(wn.instances,n=>n._plugins.invalidate())}function Z3(n,t,e){const{startAngle:s,x:i,y:a,outerRadius:l,innerRadius:u,options:h}=t,{borderWidth:f,borderJoinStyle:m}=h,_=Math.min(f/l,kn(s-e));if(n.beginPath(),n.arc(i,a,l-f/2,s+_/2,e-_/2),u>0){const x=Math.min(f/u,kn(s-e));n.arc(i,a,u+f/2,e-x/2,s+x/2,!0)}else{const x=Math.min(f/2,l*kn(s-e));if(m==="round")n.arc(i,a,x,e-se/2,s+se/2,!0);else if(m==="bevel"){const E=2*x*x,S=-E*Math.cos(e+se/2)+i,T=-E*Math.sin(e+se/2)+a,R=E*Math.cos(s+se/2)+i,M=E*Math.sin(s+se/2)+a;n.lineTo(S,T),n.lineTo(R,M)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function J3(n,t,e){const{startAngle:s,pixelMargin:i,x:a,y:l,outerRadius:u,innerRadius:h}=t;let f=i/u;n.beginPath(),n.arc(a,l,u,s-f,e+f),h>i?(f=i/h,n.arc(a,l,h,e+f,s-f,!0)):n.arc(a,l,i,e+Ye,s-Ye),n.closePath(),n.clip()}function t5(n){return dx(n,["outerStart","outerEnd","innerStart","innerEnd"])}function e5(n,t,e,s){const i=t5(n.options.borderRadius),a=(e-t)/2,l=Math.min(a,s*t/2),u=h=>{const f=(e-Math.min(a,h))*s/2;return yn(h,0,Math.min(a,f))};return{outerStart:u(i.outerStart),outerEnd:u(i.outerEnd),innerStart:yn(i.innerStart,0,l),innerEnd:yn(i.innerEnd,0,l)}}function Zl(n,t,e,s){return{x:e+n*Math.cos(t),y:s+n*Math.sin(t)}}function dg(n,t,e,s,i,a){const{x:l,y:u,startAngle:h,pixelMargin:f,innerRadius:m}=t,_=Math.max(t.outerRadius+s+e-f,0),x=m>0?m+s+e+f:0;let E=0;const S=i-h;if(s){const bt=m>0?m-s:0,Y=_>0?_-s:0,at=(bt+Y)/2,mt=at!==0?S*at/(at+s):S;E=(S-mt)/2}const T=Math.max(.001,S*_-e/se)/_,R=(S-T)/2,M=h+R+E,L=i-R-E,{outerStart:O,outerEnd:H,innerStart:B,innerEnd:z}=e5(t,x,_,L-M),D=_-O,I=_-H,C=M+O/D,P=L-H/I,j=x+B,F=x+z,k=M+B/j,nt=L-z/F;if(n.beginPath(),a){const bt=(C+P)/2;if(n.arc(l,u,_,C,bt),n.arc(l,u,_,bt,P),H>0){const Dt=Zl(I,P,l,u);n.arc(Dt.x,Dt.y,H,P,L+Ye)}const Y=Zl(F,L,l,u);if(n.lineTo(Y.x,Y.y),z>0){const Dt=Zl(F,nt,l,u);n.arc(Dt.x,Dt.y,z,L+Ye,nt+Math.PI)}const at=(L-z/x+(M+B/x))/2;if(n.arc(l,u,x,L-z/x,at,!0),n.arc(l,u,x,at,M+B/x,!0),B>0){const Dt=Zl(j,k,l,u);n.arc(Dt.x,Dt.y,B,k+Math.PI,M-Ye)}const mt=Zl(D,M,l,u);if(n.lineTo(mt.x,mt.y),O>0){const Dt=Zl(D,C,l,u);n.arc(Dt.x,Dt.y,O,M-Ye,C)}}else{n.moveTo(l,u);const bt=Math.cos(C)*_+l,Y=Math.sin(C)*_+u;n.lineTo(bt,Y);const at=Math.cos(P)*_+l,mt=Math.sin(P)*_+u;n.lineTo(at,mt)}n.closePath()}function n5(n,t,e,s,i){const{fullCircles:a,startAngle:l,circumference:u}=t;let h=t.endAngle;if(a){dg(n,t,e,s,h,i);for(let f=0;f<a;++f)n.fill();isNaN(u)||(h=l+(u%Ae||Ae))}return dg(n,t,e,s,h,i),n.fill(),h}function s5(n,t,e,s,i){const{fullCircles:a,startAngle:l,circumference:u,options:h}=t,{borderWidth:f,borderJoinStyle:m,borderDash:_,borderDashOffset:x,borderRadius:E}=h,S=h.borderAlign==="inner";if(!f)return;n.setLineDash(_||[]),n.lineDashOffset=x,S?(n.lineWidth=f*2,n.lineJoin=m||"round"):(n.lineWidth=f,n.lineJoin=m||"bevel");let T=t.endAngle;if(a){dg(n,t,e,s,T,i);for(let R=0;R<a;++R)n.stroke();isNaN(u)||(T=l+(u%Ae||Ae))}S&&J3(n,t,T),h.selfJoin&&T-l>=se&&E===0&&m!=="miter"&&Z3(n,t,T),a||(dg(n,t,e,s,T,i),n.stroke())}class yh extends Ys{constructor(e){super();_t(this,"circumference");_t(this,"endAngle");_t(this,"fullCircles");_t(this,"innerRadius");_t(this,"outerRadius");_t(this,"pixelMargin");_t(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,s,i){const a=this.getProps(["x","y"],i),{angle:l,distance:u}=wD(a,{x:e,y:s}),{startAngle:h,endAngle:f,innerRadius:m,outerRadius:_,circumference:x}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),E=(this.options.spacing+this.options.borderWidth)/2,S=jt(x,f-h),T=rd(l,h,f)&&h!==f,R=S>=Ae||T,M=Xi(u,m+E,_+E);return R&&M}getCenterPoint(e){const{x:s,y:i,startAngle:a,endAngle:l,innerRadius:u,outerRadius:h}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:f,spacing:m}=this.options,_=(a+l)/2,x=(u+h+m+f)/2;return{x:s+Math.cos(_)*x,y:i+Math.sin(_)*x}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:s,circumference:i}=this,a=(s.offset||0)/4,l=(s.spacing||0)/2,u=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=i>Ae?Math.floor(i/Ae):0,i===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const h=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(h)*a,Math.sin(h)*a);const f=1-Math.sin(Math.min(se,i||0)),m=a*f;e.fillStyle=s.backgroundColor,e.strokeStyle=s.borderColor,n5(e,this,m,l,u),s5(e,this,m,l,u),e.restore()}}_t(yh,"id","arc"),_t(yh,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),_t(yh,"defaultRoutes",{backgroundColor:"backgroundColor"}),_t(yh,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"});function rN(n,t,e=t){n.lineCap=jt(e.borderCapStyle,t.borderCapStyle),n.setLineDash(jt(e.borderDash,t.borderDash)),n.lineDashOffset=jt(e.borderDashOffset,t.borderDashOffset),n.lineJoin=jt(e.borderJoinStyle,t.borderJoinStyle),n.lineWidth=jt(e.borderWidth,t.borderWidth),n.strokeStyle=jt(e.borderColor,t.borderColor)}function i5(n,t,e){n.lineTo(e.x,e.y)}function r5(n){return n.stepped?Ij:n.tension||n.cubicInterpolationMode==="monotone"?Rj:i5}function aN(n,t,e={}){const s=n.length,{start:i=0,end:a=s-1}=e,{start:l,end:u}=t,h=Math.max(i,l),f=Math.min(a,u),m=i<l&&a<l||i>u&&a>u;return{count:s,start:h,loop:t.loop,ilen:f<h&&!m?s+f-h:f-h}}function a5(n,t,e,s){const{points:i,options:a}=t,{count:l,start:u,loop:h,ilen:f}=aN(i,e,s),m=r5(a);let{move:_=!0,reverse:x}=s||{},E,S,T;for(E=0;E<=f;++E)S=i[(u+(x?f-E:E))%l],!S.skip&&(_?(n.moveTo(S.x,S.y),_=!1):m(n,T,S,x,a.stepped),T=S);return h&&(S=i[(u+(x?f:0))%l],m(n,T,S,x,a.stepped)),!!h}function o5(n,t,e,s){const i=t.points,{count:a,start:l,ilen:u}=aN(i,e,s),{move:h=!0,reverse:f}=s||{};let m=0,_=0,x,E,S,T,R,M;const L=H=>(l+(f?u-H:H))%a,O=()=>{T!==R&&(n.lineTo(m,R),n.lineTo(m,T),n.lineTo(m,M))};for(h&&(E=i[L(0)],n.moveTo(E.x,E.y)),x=0;x<=u;++x){if(E=i[L(x)],E.skip)continue;const H=E.x,B=E.y,z=H|0;z===S?(B<T?T=B:B>R&&(R=B),m=(_*m+H)/++_):(O(),n.lineTo(H,B),S=z,_=0,T=R=B),M=B}O()}function w0(n){const t=n.options,e=t.borderDash&&t.borderDash.length;return!n._decimated&&!n._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!e?o5:a5}function l5(n){return n.stepped?a6:n.tension||n.cubicInterpolationMode==="monotone"?o6:So}function c5(n,t,e,s){let i=t._path;i||(i=t._path=new Path2D,t.path(i,e,s)&&i.closePath()),rN(n,t.options),n.stroke(i)}function u5(n,t,e,s){const{segments:i,options:a}=t,l=w0(t);for(const u of i)rN(n,a,u.style),n.beginPath(),l(n,t,u,{start:e,end:e+s-1})&&n.closePath(),n.stroke()}const h5=typeof Path2D=="function";function d5(n,t,e,s){h5&&!t.options.segment?c5(n,t,e,s):u5(n,t,e,s)}class ra extends Ys{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const i=s.spanGaps?this._loop:this._fullLoop;Zj(this._points,s,t,i,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=f6(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,s=t.length;return s&&e[t[s-1].end]}interpolate(t,e){const s=this.options,i=t[e],a=this.points,l=qD(this,{property:e,start:i,end:i});if(!l.length)return;const u=[],h=l5(s);let f,m;for(f=0,m=l.length;f<m;++f){const{start:_,end:x}=l[f],E=a[_],S=a[x];if(E===S){u.push(E);continue}const T=Math.abs((i-E[e])/(S[e]-E[e])),R=h(E,S,T,s.stepped);R[e]=t[e],u.push(R)}return u.length===1?u[0]:u}pathSegment(t,e,s){return w0(this)(t,this,e,s)}path(t,e,s){const i=this.segments,a=w0(this);let l=this._loop;e=e||0,s=s||this.points.length-e;for(const u of i)l&=a(t,this,u,{start:e,end:e+s-1});return!!l}draw(t,e,s,i){const a=this.options||{};(this.points||[]).length&&a.borderWidth&&(t.save(),d5(t,this,s,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}_t(ra,"id","line"),_t(ra,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),_t(ra,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),_t(ra,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function IS(n,t,e,s){const i=n.options,{[e]:a}=n.getProps([e],s);return Math.abs(t-a)<i.radius+i.hitRadius}class Lm extends Ys{constructor(e){super();_t(this,"parsed");_t(this,"skip");_t(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,s,i){const a=this.options,{x:l,y:u}=this.getProps(["x","y"],i);return Math.pow(e-l,2)+Math.pow(s-u,2)<Math.pow(a.hitRadius+a.radius,2)}inXRange(e,s){return IS(this,e,"x",s)}inYRange(e,s){return IS(this,e,"y",s)}getCenterPoint(e){const{x:s,y:i}=this.getProps(["x","y"],e);return{x:s,y:i}}size(e){e=e||this.options||{};let s=e.radius||0;s=Math.max(s,s&&e.hoverRadius||0);const i=s&&e.borderWidth||0;return(s+i)*2}draw(e,s){const i=this.options;this.skip||i.radius<.1||!Ji(this,s,this.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,x0(e,i,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}_t(Lm,"id","point"),_t(Lm,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),_t(Lm,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function oN(n,t){const{x:e,y:s,base:i,width:a,height:l}=n.getProps(["x","y","base","width","height"],t);let u,h,f,m,_;return n.horizontal?(_=l/2,u=Math.min(e,i),h=Math.max(e,i),f=s-_,m=s+_):(_=a/2,u=e-_,h=e+_,f=Math.min(s,i),m=Math.max(s,i)),{left:u,top:f,right:h,bottom:m}}function aa(n,t,e,s){return n?0:yn(t,e,s)}function f5(n,t,e){const s=n.options.borderWidth,i=n.borderSkipped,a=OD(s);return{t:aa(i.top,a.top,0,e),r:aa(i.right,a.right,0,t),b:aa(i.bottom,a.bottom,0,e),l:aa(i.left,a.left,0,t)}}function m5(n,t,e){const{enableBorderRadius:s}=n.getProps(["enableBorderRadius"]),i=n.options.borderRadius,a=Lo(i),l=Math.min(t,e),u=n.borderSkipped,h=s||Qt(i);return{topLeft:aa(!h||u.top||u.left,a.topLeft,0,l),topRight:aa(!h||u.top||u.right,a.topRight,0,l),bottomLeft:aa(!h||u.bottom||u.left,a.bottomLeft,0,l),bottomRight:aa(!h||u.bottom||u.right,a.bottomRight,0,l)}}function g5(n){const t=oN(n),e=t.right-t.left,s=t.bottom-t.top,i=f5(n,e/2,s/2),a=m5(n,e/2,s/2);return{outer:{x:t.left,y:t.top,w:e,h:s,radius:a},inner:{x:t.left+i.l,y:t.top+i.t,w:e-i.l-i.r,h:s-i.t-i.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,a.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(i.b,i.r))}}}}function Dy(n,t,e,s){const i=t===null,a=e===null,u=n&&!(i&&a)&&oN(n,s);return u&&(i||Xi(t,u.left,u.right))&&(a||Xi(e,u.top,u.bottom))}function p5(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function _5(n,t){n.rect(t.x,t.y,t.w,t.h)}function Ny(n,t,e={}){const s=n.x!==e.x?-t:0,i=n.y!==e.y?-t:0,a=(n.x+n.w!==e.x+e.w?t:0)-s,l=(n.y+n.h!==e.y+e.h?t:0)-i;return{x:n.x+s,y:n.y+i,w:n.w+a,h:n.h+l,radius:n.radius}}class jm extends Ys{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:s,backgroundColor:i}}=this,{inner:a,outer:l}=g5(this),u=p5(l.radius)?ad:_5;t.save(),(l.w!==a.w||l.h!==a.h)&&(t.beginPath(),u(t,Ny(l,e,a)),t.clip(),u(t,Ny(a,-e,l)),t.fillStyle=s,t.fill("evenodd")),t.beginPath(),u(t,Ny(a,e)),t.fillStyle=i,t.fill(),t.restore()}inRange(t,e,s){return Dy(this,t,e,s)}inXRange(t,e){return Dy(this,t,null,e)}inYRange(t,e){return Dy(this,null,t,e)}getCenterPoint(t){const{x:e,y:s,base:i,horizontal:a}=this.getProps(["x","y","base","horizontal"],t);return{x:a?(e+i)/2:e,y:a?s:(s+i)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}_t(jm,"id","bar"),_t(jm,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),_t(jm,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var y5=Object.freeze({__proto__:null,ArcElement:yh,BarElement:jm,LineElement:ra,PointElement:Lm});const S0=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],RS=S0.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function lN(n){return S0[n%S0.length]}function cN(n){return RS[n%RS.length]}function b5(n,t){return n.borderColor=lN(t),n.backgroundColor=cN(t),++t}function x5(n,t){return n.backgroundColor=n.data.map(()=>lN(t++)),t}function v5(n,t){return n.backgroundColor=n.data.map(()=>cN(t++)),t}function E5(n){let t=0;return(e,s)=>{const i=n.getDatasetMeta(s).controller;i instanceof ko?t=x5(e,t):i instanceof Lh?t=v5(e,t):i&&(t=b5(e,t))}}function DS(n){let t;for(t in n)if(n[t].borderColor||n[t].backgroundColor)return!0;return!1}function T5(n){return n&&(n.borderColor||n.backgroundColor)}function w5(){return Oe.borderColor!=="rgba(0,0,0,0.1)"||Oe.backgroundColor!=="rgba(0,0,0,0.1)"}var S5={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,t,e){if(!e.enabled)return;const{data:{datasets:s},options:i}=n.config,{elements:a}=i,l=DS(s)||T5(i)||a&&DS(a)||w5();if(!e.forceOverride&&l)return;const u=E5(n);s.forEach(u)}};function A5(n,t,e,s,i){const a=i.samples||s;if(a>=e)return n.slice(t,t+e);const l=[],u=(e-2)/(a-2);let h=0;const f=t+e-1;let m=t,_,x,E,S,T;for(l[h++]=n[m],_=0;_<a-2;_++){let R=0,M=0,L;const O=Math.floor((_+1)*u)+1+t,H=Math.min(Math.floor((_+2)*u)+1,e)+t,B=H-O;for(L=O;L<H;L++)R+=n[L].x,M+=n[L].y;R/=B,M/=B;const z=Math.floor(_*u)+1+t,D=Math.min(Math.floor((_+1)*u)+1,e)+t,{x:I,y:C}=n[m];for(E=S=-1,L=z;L<D;L++)S=.5*Math.abs((I-R)*(n[L].y-C)-(I-n[L].x)*(M-C)),S>E&&(E=S,x=n[L],T=L);l[h++]=x,m=T}return l[h++]=n[f],l}function I5(n,t,e,s){let i=0,a=0,l,u,h,f,m,_,x,E,S,T;const R=[],M=t+e-1,L=n[t].x,H=n[M].x-L;for(l=t;l<t+e;++l){u=n[l],h=(u.x-L)/H*s,f=u.y;const B=h|0;if(B===m)f<S?(S=f,_=l):f>T&&(T=f,x=l),i=(a*i+u.x)/++a;else{const z=l-1;if(!Yt(_)&&!Yt(x)){const D=Math.min(_,x),I=Math.max(_,x);D!==E&&D!==z&&R.push({...n[D],x:i}),I!==E&&I!==z&&R.push({...n[I],x:i})}l>0&&z!==E&&R.push(n[z]),R.push(u),m=B,a=0,S=T=f,_=x=E=l}}return R}function uN(n){if(n._decimated){const t=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function NS(n){n.data.datasets.forEach(t=>{uN(t)})}function R5(n,t){const e=t.length;let s=0,i;const{iScale:a}=n,{min:l,max:u,minDefined:h,maxDefined:f}=a.getUserBounds();return h&&(s=yn(Zi(t,a.axis,l).lo,0,e-1)),f?i=yn(Zi(t,a.axis,u).hi+1,s,e)-s:i=e-s,{start:s,count:i}}var D5={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,t,e)=>{if(!e.enabled){NS(n);return}const s=n.width;n.data.datasets.forEach((i,a)=>{const{_data:l,indexAxis:u}=i,h=n.getDatasetMeta(a),f=l||i.data;if(ph([u,n.options.indexAxis])==="y"||!h.controller.supportsDecimation)return;const m=n.scales[h.xAxisID];if(m.type!=="linear"&&m.type!=="time"||n.options.parsing)return;let{start:_,count:x}=R5(h,f);const E=e.threshold||4*s;if(x<=E){uN(i);return}Yt(l)&&(i._data=f,delete i.data,Object.defineProperty(i,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(T){this._data=T}}));let S;switch(e.algorithm){case"lttb":S=A5(f,_,x,s,e);break;case"min-max":S=I5(f,_,x,s);break;default:throw new Error(`Unsupported decimation algorithm '${e.algorithm}'`)}i._decimated=S})},destroy(n){NS(n)}};function N5(n,t,e){const s=n.segments,i=n.points,a=t.points,l=[];for(const u of s){let{start:h,end:f}=u;f=Zg(h,f,i);const m=A0(e,i[h],i[f],u.loop);if(!t.segments){l.push({source:u,target:m,start:i[h],end:i[f]});continue}const _=qD(t,m);for(const x of _){const E=A0(e,a[x.start],a[x.end],x.loop),S=HD(u,i,E);for(const T of S)l.push({source:T,target:x,start:{[e]:CS(m,E,"start",Math.max)},end:{[e]:CS(m,E,"end",Math.min)}})}}return l}function A0(n,t,e,s){if(s)return;let i=t[n],a=e[n];return n==="angle"&&(i=kn(i),a=kn(a)),{property:n,start:i,end:a}}function C5(n,t){const{x:e=null,y:s=null}=n||{},i=t.points,a=[];return t.segments.forEach(({start:l,end:u})=>{u=Zg(l,u,i);const h=i[l],f=i[u];s!==null?(a.push({x:h.x,y:s}),a.push({x:f.x,y:s})):e!==null&&(a.push({x:e,y:h.y}),a.push({x:e,y:f.y}))}),a}function Zg(n,t,e){for(;t>n;t--){const s=e[t];if(!isNaN(s.x)&&!isNaN(s.y))break}return t}function CS(n,t,e,s){return n&&t?s(n[e],t[e]):n?n[e]:t?t[e]:0}function hN(n,t){let e=[],s=!1;return Me(n)?(s=!0,e=n):e=C5(n,t),e.length?new ra({points:e,options:{tension:0},_loop:s,_fullLoop:s}):null}function MS(n){return n&&n.fill!==!1}function M5(n,t,e){let i=n[t].fill;const a=[t];let l;if(!e)return i;for(;i!==!1&&a.indexOf(i)===-1;){if(!je(i))return i;if(l=n[i],!l)return!1;if(l.visible)return i;a.push(i),i=l.fill}return!1}function O5(n,t,e){const s=L5(n);if(Qt(s))return isNaN(s.value)?!1:s;let i=parseFloat(s);return je(i)&&Math.floor(i)===i?k5(s[0],t,i,e):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function k5(n,t,e,s){return(n==="-"||n==="+")&&(e=t+e),e===t||e<0||e>=s?!1:e}function V5(n,t){let e=null;return n==="start"?e=t.bottom:n==="end"?e=t.top:Qt(n)?e=t.getPixelForValue(n.value):t.getBasePixel&&(e=t.getBasePixel()),e}function P5(n,t,e){let s;return n==="start"?s=e:n==="end"?s=t.options.reverse?t.min:t.max:Qt(n)?s=n.value:s=t.getBaseValue(),s}function L5(n){const t=n.options,e=t.fill;let s=jt(e&&e.target,e);return s===void 0&&(s=!!t.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function j5(n){const{scale:t,index:e,line:s}=n,i=[],a=s.segments,l=s.points,u=B5(t,e);u.push(hN({x:null,y:t.bottom},s));for(let h=0;h<a.length;h++){const f=a[h];for(let m=f.start;m<=f.end;m++)F5(i,l[m],u)}return new ra({points:i,options:{}})}function B5(n,t){const e=[],s=n.getMatchingVisibleMetas("line");for(let i=0;i<s.length;i++){const a=s[i];if(a.index===t)break;a.hidden||e.unshift(a.dataset)}return e}function F5(n,t,e){const s=[];for(let i=0;i<e.length;i++){const a=e[i],{first:l,last:u,point:h}=U5(a,t,"x");if(!(!h||l&&u)){if(l)s.unshift(h);else if(n.push(h),!u)break}}n.push(...s)}function U5(n,t,e){const s=n.interpolate(t,e);if(!s)return{};const i=s[e],a=n.segments,l=n.points;let u=!1,h=!1;for(let f=0;f<a.length;f++){const m=a[f],_=l[m.start][e],x=l[m.end][e];if(Xi(i,_,x)){u=i===_,h=i===x;break}}return{first:u,last:h,point:s}}class dN{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,s){const{x:i,y:a,radius:l}=this;return e=e||{start:0,end:Ae},t.arc(i,a,l,e.end,e.start,!0),!s.bounds}interpolate(t){const{x:e,y:s,radius:i}=this,a=t.angle;return{x:e+Math.cos(a)*i,y:s+Math.sin(a)*i,angle:a}}}function z5(n){const{chart:t,fill:e,line:s}=n;if(je(e))return H5(t,e);if(e==="stack")return j5(n);if(e==="shape")return!0;const i=q5(n);return i instanceof dN?i:hN(i,s)}function H5(n,t){const e=n.getDatasetMeta(t);return e&&n.isDatasetVisible(t)?e.dataset:null}function q5(n){return(n.scale||{}).getPointPositionForValue?$5(n):G5(n)}function G5(n){const{scale:t={},fill:e}=n,s=V5(e,t);if(je(s)){const i=t.isHorizontal();return{x:i?s:null,y:i?null:s}}return null}function $5(n){const{scale:t,fill:e}=n,s=t.options,i=t.getLabels().length,a=s.reverse?t.max:t.min,l=P5(e,t,a),u=[];if(s.grid.circular){const h=t.getPointPositionForValue(0,a);return new dN({x:h.x,y:h.y,radius:t.getDistanceFromCenterForValue(l)})}for(let h=0;h<i;++h)u.push(t.getPointPositionForValue(h,l));return u}function Cy(n,t,e){const s=z5(t),{chart:i,index:a,line:l,scale:u,axis:h}=t,f=l.options,m=f.fill,_=f.backgroundColor,{above:x=_,below:E=_}=m||{},S=i.getDatasetMeta(a),T=GD(i,S);s&&l.points.length&&(Yg(n,e),W5(n,{line:l,target:s,above:x,below:E,area:e,scale:u,axis:h,clip:T}),Kg(n))}function W5(n,t){const{line:e,target:s,above:i,below:a,area:l,scale:u,clip:h}=t,f=e._loop?"angle":t.axis;n.save();let m=a;a!==i&&(f==="x"?(OS(n,s,l.top),My(n,{line:e,target:s,color:i,scale:u,property:f,clip:h}),n.restore(),n.save(),OS(n,s,l.bottom)):f==="y"&&(kS(n,s,l.left),My(n,{line:e,target:s,color:a,scale:u,property:f,clip:h}),n.restore(),n.save(),kS(n,s,l.right),m=i)),My(n,{line:e,target:s,color:m,scale:u,property:f,clip:h}),n.restore()}function OS(n,t,e){const{segments:s,points:i}=t;let a=!0,l=!1;n.beginPath();for(const u of s){const{start:h,end:f}=u,m=i[h],_=i[Zg(h,f,i)];a?(n.moveTo(m.x,m.y),a=!1):(n.lineTo(m.x,e),n.lineTo(m.x,m.y)),l=!!t.pathSegment(n,u,{move:l}),l?n.closePath():n.lineTo(_.x,e)}n.lineTo(t.first().x,e),n.closePath(),n.clip()}function kS(n,t,e){const{segments:s,points:i}=t;let a=!0,l=!1;n.beginPath();for(const u of s){const{start:h,end:f}=u,m=i[h],_=i[Zg(h,f,i)];a?(n.moveTo(m.x,m.y),a=!1):(n.lineTo(e,m.y),n.lineTo(m.x,m.y)),l=!!t.pathSegment(n,u,{move:l}),l?n.closePath():n.lineTo(e,_.y)}n.lineTo(e,t.first().y),n.closePath(),n.clip()}function My(n,t){const{line:e,target:s,property:i,color:a,scale:l,clip:u}=t,h=N5(e,s,i);for(const{source:f,target:m,start:_,end:x}of h){const{style:{backgroundColor:E=a}={}}=f,S=s!==!0;n.save(),n.fillStyle=E,Y5(n,l,u,S&&A0(i,_,x)),n.beginPath();const T=!!e.pathSegment(n,f);let R;if(S){T?n.closePath():VS(n,s,x,i);const M=!!s.pathSegment(n,m,{move:T,reverse:!0});R=T&&M,R||VS(n,s,_,i)}n.closePath(),n.fill(R?"evenodd":"nonzero"),n.restore()}}function Y5(n,t,e,s){const i=t.chart.chartArea,{property:a,start:l,end:u}=s||{};if(a==="x"||a==="y"){let h,f,m,_;a==="x"?(h=l,f=i.top,m=u,_=i.bottom):(h=i.left,f=l,m=i.right,_=u),n.beginPath(),e&&(h=Math.max(h,e.left),m=Math.min(m,e.right),f=Math.max(f,e.top),_=Math.min(_,e.bottom)),n.rect(h,f,m-h,_-f),n.clip()}}function VS(n,t,e,s){const i=t.interpolate(e,s);i&&n.lineTo(i.x,i.y)}var K5={id:"filler",afterDatasetsUpdate(n,t,e){const s=(n.data.datasets||[]).length,i=[];let a,l,u,h;for(l=0;l<s;++l)a=n.getDatasetMeta(l),u=a.dataset,h=null,u&&u.options&&u instanceof ra&&(h={visible:n.isDatasetVisible(l),index:l,fill:O5(u,l,s),chart:n,axis:a.controller.options.indexAxis,scale:a.vScale,line:u}),a.$filler=h,i.push(h);for(l=0;l<s;++l)h=i[l],!(!h||h.fill===!1)&&(h.fill=M5(i,l,e.propagate))},beforeDraw(n,t,e){const s=e.drawTime==="beforeDraw",i=n.getSortedVisibleDatasetMetas(),a=n.chartArea;for(let l=i.length-1;l>=0;--l){const u=i[l].$filler;u&&(u.line.updateControlPoints(a,u.axis),s&&u.fill&&Cy(n.ctx,u,a))}},beforeDatasetsDraw(n,t,e){if(e.drawTime!=="beforeDatasetsDraw")return;const s=n.getSortedVisibleDatasetMetas();for(let i=s.length-1;i>=0;--i){const a=s[i].$filler;MS(a)&&Cy(n.ctx,a,n.chartArea)}},beforeDatasetDraw(n,t,e){const s=t.meta.$filler;!MS(s)||e.drawTime!=="beforeDatasetDraw"||Cy(n.ctx,s,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const PS=(n,t)=>{let{boxHeight:e=t,boxWidth:s=t}=n;return n.usePointStyle&&(e=Math.min(e,t),s=n.pointStyleWidth||Math.min(s,t)),{boxWidth:s,boxHeight:e,itemHeight:Math.max(t,e)}},Q5=(n,t)=>n!==null&&t!==null&&n.datasetIndex===t.datasetIndex&&n.index===t.index;class LS extends Ys{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,s){this.maxWidth=t,this.maxHeight=e,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=ve(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(s=>t.filter(s,this.chart.data))),t.sort&&(e=e.sort((s,i)=>t.sort(s,i,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display){this.width=this.height=0;return}const s=t.labels,i=cn(s.font),a=i.size,l=this._computeTitleHeight(),{boxWidth:u,itemHeight:h}=PS(s,a);let f,m;e.font=i.string,this.isHorizontal()?(f=this.maxWidth,m=this._fitRows(l,a,u,h)+10):(m=this.maxHeight,f=this._fitCols(l,i,u,h)+10),this.width=Math.min(f,t.maxWidth||this.maxWidth),this.height=Math.min(m,t.maxHeight||this.maxHeight)}_fitRows(t,e,s,i){const{ctx:a,maxWidth:l,options:{labels:{padding:u}}}=this,h=this.legendHitBoxes=[],f=this.lineWidths=[0],m=i+u;let _=t;a.textAlign="left",a.textBaseline="middle";let x=-1,E=-m;return this.legendItems.forEach((S,T)=>{const R=s+e/2+a.measureText(S.text).width;(T===0||f[f.length-1]+R+2*u>l)&&(_+=m,f[f.length-(T>0?0:1)]=0,E+=m,x++),h[T]={left:0,top:E,row:x,width:R,height:i},f[f.length-1]+=R+u}),_}_fitCols(t,e,s,i){const{ctx:a,maxHeight:l,options:{labels:{padding:u}}}=this,h=this.legendHitBoxes=[],f=this.columnSizes=[],m=l-t;let _=u,x=0,E=0,S=0,T=0;return this.legendItems.forEach((R,M)=>{const{itemWidth:L,itemHeight:O}=X5(s,e,a,R,i);M>0&&E+O+2*u>m&&(_+=x+u,f.push({width:x,height:E}),S+=x+u,T++,x=E=0),h[M]={left:S,top:E,col:T,width:L,height:O},x=Math.max(x,L),E+=O+u}),_+=x,f.push({width:x,height:E}),_}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:s,labels:{padding:i},rtl:a}}=this,l=oc(a,this.left,this.width);if(this.isHorizontal()){let u=0,h=Mn(s,this.left+i,this.right-this.lineWidths[u]);for(const f of e)u!==f.row&&(u=f.row,h=Mn(s,this.left+i,this.right-this.lineWidths[u])),f.top+=this.top+t+i,f.left=l.leftForLtr(l.x(h),f.width),h+=f.width+i}else{let u=0,h=Mn(s,this.top+t+i,this.bottom-this.columnSizes[u].height);for(const f of e)f.col!==u&&(u=f.col,h=Mn(s,this.top+t+i,this.bottom-this.columnSizes[u].height)),f.top=h,f.left+=this.left+i,f.left=l.leftForLtr(l.x(f.left),f.width),h+=f.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;Yg(t,this),this._draw(),Kg(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:s,ctx:i}=this,{align:a,labels:l}=t,u=Oe.color,h=oc(t.rtl,this.left,this.width),f=cn(l.font),{padding:m}=l,_=f.size,x=_/2;let E;this.drawTitle(),i.textAlign=h.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=f.string;const{boxWidth:S,boxHeight:T,itemHeight:R}=PS(l,_),M=function(z,D,I){if(isNaN(S)||S<=0||isNaN(T)||T<0)return;i.save();const C=jt(I.lineWidth,1);if(i.fillStyle=jt(I.fillStyle,u),i.lineCap=jt(I.lineCap,"butt"),i.lineDashOffset=jt(I.lineDashOffset,0),i.lineJoin=jt(I.lineJoin,"miter"),i.lineWidth=C,i.strokeStyle=jt(I.strokeStyle,u),i.setLineDash(jt(I.lineDash,[])),l.usePointStyle){const P={radius:T*Math.SQRT2/2,pointStyle:I.pointStyle,rotation:I.rotation,borderWidth:C},j=h.xPlus(z,S/2),F=D+x;MD(i,P,j,F,l.pointStyleWidth&&S)}else{const P=D+Math.max((_-T)/2,0),j=h.leftForLtr(z,S),F=Lo(I.borderRadius);i.beginPath(),Object.values(F).some(k=>k!==0)?ad(i,{x:j,y:P,w:S,h:T,radius:F}):i.rect(j,P,S,T),i.fill(),C!==0&&i.stroke()}i.restore()},L=function(z,D,I){Qo(i,I.text,z,D+R/2,f,{strikethrough:I.hidden,textAlign:h.textAlign(I.textAlign)})},O=this.isHorizontal(),H=this._computeTitleHeight();O?E={x:Mn(a,this.left+m,this.right-s[0]),y:this.top+m+H,line:0}:E={x:this.left+m,y:Mn(a,this.top+H+m,this.bottom-e[0].height),line:0},FD(this.ctx,t.textDirection);const B=R+m;this.legendItems.forEach((z,D)=>{i.strokeStyle=z.fontColor,i.fillStyle=z.fontColor;const I=i.measureText(z.text).width,C=h.textAlign(z.textAlign||(z.textAlign=l.textAlign)),P=S+x+I;let j=E.x,F=E.y;h.setWidth(this.width),O?D>0&&j+P+m>this.right&&(F=E.y+=B,E.line++,j=E.x=Mn(a,this.left+m,this.right-s[E.line])):D>0&&F+B>this.bottom&&(j=E.x=j+e[E.line].width+m,E.line++,F=E.y=Mn(a,this.top+H+m,this.bottom-e[E.line].height));const k=h.x(j);if(M(k,F,z),j=pj(C,j+S+x,O?j+P:this.right,t.rtl),L(h.x(j),F,z),O)E.x+=P+m;else if(typeof z.text!="string"){const nt=f.lineHeight;E.y+=fN(z,nt)+m}else E.y+=B}),UD(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,s=cn(e.font),i=jn(e.padding);if(!e.display)return;const a=oc(t.rtl,this.left,this.width),l=this.ctx,u=e.position,h=s.size/2,f=i.top+h;let m,_=this.left,x=this.width;if(this.isHorizontal())x=Math.max(...this.lineWidths),m=this.top+f,_=Mn(t.align,_,this.right-x);else{const S=this.columnSizes.reduce((T,R)=>Math.max(T,R.height),0);m=f+Mn(t.align,this.top,this.bottom-S-t.labels.padding-this._computeTitleHeight())}const E=Mn(u,_,_+x);l.textAlign=a.textAlign(ux(u)),l.textBaseline="middle",l.strokeStyle=e.color,l.fillStyle=e.color,l.font=s.string,Qo(l,e.text,E,m,s)}_computeTitleHeight(){const t=this.options.title,e=cn(t.font),s=jn(t.padding);return t.display?e.lineHeight+s.height:0}_getLegendItemAt(t,e){let s,i,a;if(Xi(t,this.left,this.right)&&Xi(e,this.top,this.bottom)){for(a=this.legendHitBoxes,s=0;s<a.length;++s)if(i=a[s],Xi(t,i.left,i.left+i.width)&&Xi(e,i.top,i.top+i.height))return this.legendItems[s]}return null}handleEvent(t){const e=this.options;if(!t9(t.type,e))return;const s=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const i=this._hoveredItem,a=Q5(i,s);i&&!a&&ve(e.onLeave,[t,i,this],this),this._hoveredItem=s,s&&!a&&ve(e.onHover,[t,s,this],this)}else s&&ve(e.onClick,[t,s,this],this)}}function X5(n,t,e,s,i){const a=Z5(s,n,t,e),l=J5(i,s,t.lineHeight);return{itemWidth:a,itemHeight:l}}function Z5(n,t,e,s){let i=n.text;return i&&typeof i!="string"&&(i=i.reduce((a,l)=>a.length>l.length?a:l)),t+e.size/2+s.measureText(i).width}function J5(n,t,e){let s=n;return typeof t.text!="string"&&(s=fN(t,e)),s}function fN(n,t){const e=n.text?n.text.length:0;return t*e}function t9(n,t){return!!((n==="mousemove"||n==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(n==="click"||n==="mouseup"))}var e9={id:"legend",_element:LS,start(n,t,e){const s=n.legend=new LS({ctx:n.ctx,options:e,chart:n});Pn.configure(n,s,e),Pn.addBox(n,s)},stop(n){Pn.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,t,e){const s=n.legend;Pn.configure(n,s,e),s.options=e},afterUpdate(n){const t=n.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(n,t){t.replay||n.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,t,e){const s=t.datasetIndex,i=e.chart;i.isDatasetVisible(s)?(i.hide(s),t.hidden=!0):(i.show(s),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const t=n.data.datasets,{labels:{usePointStyle:e,pointStyle:s,textAlign:i,color:a,useBorderRadius:l,borderRadius:u}}=n.legend.options;return n._getSortedDatasetMetas().map(h=>{const f=h.controller.getStyle(e?0:void 0),m=jn(f.borderWidth);return{text:t[h.index].label,fillStyle:f.backgroundColor,fontColor:a,hidden:!h.visible,lineCap:f.borderCapStyle,lineDash:f.borderDash,lineDashOffset:f.borderDashOffset,lineJoin:f.borderJoinStyle,lineWidth:(m.width+m.height)/4,strokeStyle:f.borderColor,pointStyle:s||f.pointStyle,rotation:f.rotation,textAlign:i||f.textAlign,borderRadius:l&&(u||f.borderRadius),datasetIndex:h.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class bx extends Ys{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;const i=Me(s.text)?s.text.length:1;this._padding=jn(s.padding);const a=i*cn(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=a:this.width=a}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:e,left:s,bottom:i,right:a,options:l}=this,u=l.align;let h=0,f,m,_;return this.isHorizontal()?(m=Mn(u,s,a),_=e+t,f=a-s):(l.position==="left"?(m=s+t,_=Mn(u,i,e),h=se*-.5):(m=a-t,_=Mn(u,e,i),h=se*.5),f=i-e),{titleX:m,titleY:_,maxWidth:f,rotation:h}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const s=cn(e.font),a=s.lineHeight/2+this._padding.top,{titleX:l,titleY:u,maxWidth:h,rotation:f}=this._drawArgs(a);Qo(t,e.text,0,0,s,{color:e.color,maxWidth:h,rotation:f,textAlign:ux(e.align),textBaseline:"middle",translation:[l,u]})}}function n9(n,t){const e=new bx({ctx:n.ctx,options:t,chart:n});Pn.configure(n,e,t),Pn.addBox(n,e),n.titleBlock=e}var s9={id:"title",_element:bx,start(n,t,e){n9(n,e)},stop(n){const t=n.titleBlock;Pn.removeBox(n,t),delete n.titleBlock},beforeUpdate(n,t,e){const s=n.titleBlock;Pn.configure(n,s,e),s.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const pm=new WeakMap;var i9={id:"subtitle",start(n,t,e){const s=new bx({ctx:n.ctx,options:e,chart:n});Pn.configure(n,s,e),Pn.addBox(n,s),pm.set(n,s)},stop(n){Pn.removeBox(n,pm.get(n)),pm.delete(n)},beforeUpdate(n,t,e){const s=pm.get(n);Pn.configure(n,s,e),s.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const bh={average(n){if(!n.length)return!1;let t,e,s=new Set,i=0,a=0;for(t=0,e=n.length;t<e;++t){const u=n[t].element;if(u&&u.hasValue()){const h=u.tooltipPosition();s.add(h.x),i+=h.y,++a}}return a===0||s.size===0?!1:{x:[...s].reduce((u,h)=>u+h)/s.size,y:i/a}},nearest(n,t){if(!n.length)return!1;let e=t.x,s=t.y,i=Number.POSITIVE_INFINITY,a,l,u;for(a=0,l=n.length;a<l;++a){const h=n[a].element;if(h&&h.hasValue()){const f=h.getCenterPoint(),m=y0(t,f);m<i&&(i=m,u=h)}}if(u){const h=u.tooltipPosition();e=h.x,s=h.y}return{x:e,y:s}}};function ui(n,t){return t&&(Me(t)?Array.prototype.push.apply(n,t):n.push(t)),n}function Yi(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function r9(n,t){const{element:e,datasetIndex:s,index:i}=t,a=n.getDatasetMeta(s).controller,{label:l,value:u}=a.getLabelAndValue(i);return{chart:n,label:l,parsed:a.getParsed(i),raw:n.data.datasets[s].data[i],formattedValue:u,dataset:a.getDataset(),dataIndex:i,datasetIndex:s,element:e}}function jS(n,t){const e=n.chart.ctx,{body:s,footer:i,title:a}=n,{boxWidth:l,boxHeight:u}=t,h=cn(t.bodyFont),f=cn(t.titleFont),m=cn(t.footerFont),_=a.length,x=i.length,E=s.length,S=jn(t.padding);let T=S.height,R=0,M=s.reduce((H,B)=>H+B.before.length+B.lines.length+B.after.length,0);if(M+=n.beforeBody.length+n.afterBody.length,_&&(T+=_*f.lineHeight+(_-1)*t.titleSpacing+t.titleMarginBottom),M){const H=t.displayColors?Math.max(u,h.lineHeight):h.lineHeight;T+=E*H+(M-E)*h.lineHeight+(M-1)*t.bodySpacing}x&&(T+=t.footerMarginTop+x*m.lineHeight+(x-1)*t.footerSpacing);let L=0;const O=function(H){R=Math.max(R,e.measureText(H).width+L)};return e.save(),e.font=f.string,he(n.title,O),e.font=h.string,he(n.beforeBody.concat(n.afterBody),O),L=t.displayColors?l+2+t.boxPadding:0,he(s,H=>{he(H.before,O),he(H.lines,O),he(H.after,O)}),L=0,e.font=m.string,he(n.footer,O),e.restore(),R+=S.width,{width:R,height:T}}function a9(n,t){const{y:e,height:s}=t;return e<s/2?"top":e>n.height-s/2?"bottom":"center"}function o9(n,t,e,s){const{x:i,width:a}=s,l=e.caretSize+e.caretPadding;if(n==="left"&&i+a+l>t.width||n==="right"&&i-a-l<0)return!0}function l9(n,t,e,s){const{x:i,width:a}=e,{width:l,chartArea:{left:u,right:h}}=n;let f="center";return s==="center"?f=i<=(u+h)/2?"left":"right":i<=a/2?f="left":i>=l-a/2&&(f="right"),o9(f,n,t,e)&&(f="center"),f}function BS(n,t,e){const s=e.yAlign||t.yAlign||a9(n,e);return{xAlign:e.xAlign||t.xAlign||l9(n,t,e,s),yAlign:s}}function c9(n,t){let{x:e,width:s}=n;return t==="right"?e-=s:t==="center"&&(e-=s/2),e}function u9(n,t,e){let{y:s,height:i}=n;return t==="top"?s+=e:t==="bottom"?s-=i+e:s-=i/2,s}function FS(n,t,e,s){const{caretSize:i,caretPadding:a,cornerRadius:l}=n,{xAlign:u,yAlign:h}=e,f=i+a,{topLeft:m,topRight:_,bottomLeft:x,bottomRight:E}=Lo(l);let S=c9(t,u);const T=u9(t,h,f);return h==="center"?u==="left"?S+=f:u==="right"&&(S-=f):u==="left"?S-=Math.max(m,x)+i:u==="right"&&(S+=Math.max(_,E)+i),{x:yn(S,0,s.width-t.width),y:yn(T,0,s.height-t.height)}}function _m(n,t,e){const s=jn(e.padding);return t==="center"?n.x+n.width/2:t==="right"?n.x+n.width-s.right:n.x+s.left}function US(n){return ui([],Yi(n))}function h9(n,t,e){return Ma(n,{tooltip:t,tooltipItems:e,type:"tooltip"})}function zS(n,t){const e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?n.override(e):n}const mN={beforeTitle:$i,title(n){if(n.length>0){const t=n[0],e=t.chart.data.labels,s=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(s>0&&t.dataIndex<s)return e[t.dataIndex]}return""},afterTitle:$i,beforeBody:$i,beforeLabel:$i,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let t=n.dataset.label||"";t&&(t+=": ");const e=n.formattedValue;return Yt(e)||(t+=e),t},labelColor(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:$i,afterBody:$i,beforeFooter:$i,footer:$i,afterFooter:$i};function Jn(n,t,e,s){const i=n[t].call(e,s);return typeof i>"u"?mN[t].call(e,s):i}class I0 extends Ys{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,s=this.options.setContext(this.getContext()),i=s.enabled&&e.options.animation&&s.animations,a=new $D(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=h9(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:s}=e,i=Jn(s,"beforeTitle",this,t),a=Jn(s,"title",this,t),l=Jn(s,"afterTitle",this,t);let u=[];return u=ui(u,Yi(i)),u=ui(u,Yi(a)),u=ui(u,Yi(l)),u}getBeforeBody(t,e){return US(Jn(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:s}=e,i=[];return he(t,a=>{const l={before:[],lines:[],after:[]},u=zS(s,a);ui(l.before,Yi(Jn(u,"beforeLabel",this,a))),ui(l.lines,Jn(u,"label",this,a)),ui(l.after,Yi(Jn(u,"afterLabel",this,a))),i.push(l)}),i}getAfterBody(t,e){return US(Jn(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:s}=e,i=Jn(s,"beforeFooter",this,t),a=Jn(s,"footer",this,t),l=Jn(s,"afterFooter",this,t);let u=[];return u=ui(u,Yi(i)),u=ui(u,Yi(a)),u=ui(u,Yi(l)),u}_createItems(t){const e=this._active,s=this.chart.data,i=[],a=[],l=[];let u=[],h,f;for(h=0,f=e.length;h<f;++h)u.push(r9(this.chart,e[h]));return t.filter&&(u=u.filter((m,_,x)=>t.filter(m,_,x,s))),t.itemSort&&(u=u.sort((m,_)=>t.itemSort(m,_,s))),he(u,m=>{const _=zS(t.callbacks,m);i.push(Jn(_,"labelColor",this,m)),a.push(Jn(_,"labelPointStyle",this,m)),l.push(Jn(_,"labelTextColor",this,m))}),this.labelColors=i,this.labelPointStyles=a,this.labelTextColors=l,this.dataPoints=u,u}update(t,e){const s=this.options.setContext(this.getContext()),i=this._active;let a,l=[];if(!i.length)this.opacity!==0&&(a={opacity:0});else{const u=bh[s.position].call(this,i,this._eventPosition);l=this._createItems(s),this.title=this.getTitle(l,s),this.beforeBody=this.getBeforeBody(l,s),this.body=this.getBody(l,s),this.afterBody=this.getAfterBody(l,s),this.footer=this.getFooter(l,s);const h=this._size=jS(this,s),f=Object.assign({},u,h),m=BS(this.chart,s,f),_=FS(s,f,m,this.chart);this.xAlign=m.xAlign,this.yAlign=m.yAlign,a={opacity:1,x:_.x,y:_.y,width:h.width,height:h.height,caretX:u.x,caretY:u.y}}this._tooltipItems=l,this.$context=void 0,a&&this._resolveAnimations().update(this,a),t&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,s,i){const a=this.getCaretPosition(t,s,i);e.lineTo(a.x1,a.y1),e.lineTo(a.x2,a.y2),e.lineTo(a.x3,a.y3)}getCaretPosition(t,e,s){const{xAlign:i,yAlign:a}=this,{caretSize:l,cornerRadius:u}=s,{topLeft:h,topRight:f,bottomLeft:m,bottomRight:_}=Lo(u),{x,y:E}=t,{width:S,height:T}=e;let R,M,L,O,H,B;return a==="center"?(H=E+T/2,i==="left"?(R=x,M=R-l,O=H+l,B=H-l):(R=x+S,M=R+l,O=H-l,B=H+l),L=R):(i==="left"?M=x+Math.max(h,m)+l:i==="right"?M=x+S-Math.max(f,_)-l:M=this.caretX,a==="top"?(O=E,H=O-l,R=M-l,L=M+l):(O=E+T,H=O+l,R=M+l,L=M-l),B=O),{x1:R,x2:M,x3:L,y1:O,y2:H,y3:B}}drawTitle(t,e,s){const i=this.title,a=i.length;let l,u,h;if(a){const f=oc(s.rtl,this.x,this.width);for(t.x=_m(this,s.titleAlign,s),e.textAlign=f.textAlign(s.titleAlign),e.textBaseline="middle",l=cn(s.titleFont),u=s.titleSpacing,e.fillStyle=s.titleColor,e.font=l.string,h=0;h<a;++h)e.fillText(i[h],f.x(t.x),t.y+l.lineHeight/2),t.y+=l.lineHeight+u,h+1===a&&(t.y+=s.titleMarginBottom-u)}}_drawColorBox(t,e,s,i,a){const l=this.labelColors[s],u=this.labelPointStyles[s],{boxHeight:h,boxWidth:f}=a,m=cn(a.bodyFont),_=_m(this,"left",a),x=i.x(_),E=h<m.lineHeight?(m.lineHeight-h)/2:0,S=e.y+E;if(a.usePointStyle){const T={radius:Math.min(f,h)/2,pointStyle:u.pointStyle,rotation:u.rotation,borderWidth:1},R=i.leftForLtr(x,f)+f/2,M=S+h/2;t.strokeStyle=a.multiKeyBackground,t.fillStyle=a.multiKeyBackground,x0(t,T,R,M),t.strokeStyle=l.borderColor,t.fillStyle=l.backgroundColor,x0(t,T,R,M)}else{t.lineWidth=Qt(l.borderWidth)?Math.max(...Object.values(l.borderWidth)):l.borderWidth||1,t.strokeStyle=l.borderColor,t.setLineDash(l.borderDash||[]),t.lineDashOffset=l.borderDashOffset||0;const T=i.leftForLtr(x,f),R=i.leftForLtr(i.xPlus(x,1),f-2),M=Lo(l.borderRadius);Object.values(M).some(L=>L!==0)?(t.beginPath(),t.fillStyle=a.multiKeyBackground,ad(t,{x:T,y:S,w:f,h,radius:M}),t.fill(),t.stroke(),t.fillStyle=l.backgroundColor,t.beginPath(),ad(t,{x:R,y:S+1,w:f-2,h:h-2,radius:M}),t.fill()):(t.fillStyle=a.multiKeyBackground,t.fillRect(T,S,f,h),t.strokeRect(T,S,f,h),t.fillStyle=l.backgroundColor,t.fillRect(R,S+1,f-2,h-2))}t.fillStyle=this.labelTextColors[s]}drawBody(t,e,s){const{body:i}=this,{bodySpacing:a,bodyAlign:l,displayColors:u,boxHeight:h,boxWidth:f,boxPadding:m}=s,_=cn(s.bodyFont);let x=_.lineHeight,E=0;const S=oc(s.rtl,this.x,this.width),T=function(I){e.fillText(I,S.x(t.x+E),t.y+x/2),t.y+=x+a},R=S.textAlign(l);let M,L,O,H,B,z,D;for(e.textAlign=l,e.textBaseline="middle",e.font=_.string,t.x=_m(this,R,s),e.fillStyle=s.bodyColor,he(this.beforeBody,T),E=u&&R!=="right"?l==="center"?f/2+m:f+2+m:0,H=0,z=i.length;H<z;++H){for(M=i[H],L=this.labelTextColors[H],e.fillStyle=L,he(M.before,T),O=M.lines,u&&O.length&&(this._drawColorBox(e,t,H,S,s),x=Math.max(_.lineHeight,h)),B=0,D=O.length;B<D;++B)T(O[B]),x=_.lineHeight;he(M.after,T)}E=0,x=_.lineHeight,he(this.afterBody,T),t.y-=a}drawFooter(t,e,s){const i=this.footer,a=i.length;let l,u;if(a){const h=oc(s.rtl,this.x,this.width);for(t.x=_m(this,s.footerAlign,s),t.y+=s.footerMarginTop,e.textAlign=h.textAlign(s.footerAlign),e.textBaseline="middle",l=cn(s.footerFont),e.fillStyle=s.footerColor,e.font=l.string,u=0;u<a;++u)e.fillText(i[u],h.x(t.x),t.y+l.lineHeight/2),t.y+=l.lineHeight+s.footerSpacing}}drawBackground(t,e,s,i){const{xAlign:a,yAlign:l}=this,{x:u,y:h}=t,{width:f,height:m}=s,{topLeft:_,topRight:x,bottomLeft:E,bottomRight:S}=Lo(i.cornerRadius);e.fillStyle=i.backgroundColor,e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.beginPath(),e.moveTo(u+_,h),l==="top"&&this.drawCaret(t,e,s,i),e.lineTo(u+f-x,h),e.quadraticCurveTo(u+f,h,u+f,h+x),l==="center"&&a==="right"&&this.drawCaret(t,e,s,i),e.lineTo(u+f,h+m-S),e.quadraticCurveTo(u+f,h+m,u+f-S,h+m),l==="bottom"&&this.drawCaret(t,e,s,i),e.lineTo(u+E,h+m),e.quadraticCurveTo(u,h+m,u,h+m-E),l==="center"&&a==="left"&&this.drawCaret(t,e,s,i),e.lineTo(u,h+_),e.quadraticCurveTo(u,h,u+_,h),e.closePath(),e.fill(),i.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,s=this.$animations,i=s&&s.x,a=s&&s.y;if(i||a){const l=bh[t.position].call(this,this._active,this._eventPosition);if(!l)return;const u=this._size=jS(this,t),h=Object.assign({},l,this._size),f=BS(e,t,h),m=FS(t,h,f,e);(i._to!==m.x||a._to!==m.y)&&(this.xAlign=f.xAlign,this.yAlign=f.yAlign,this.width=u.width,this.height=u.height,this.caretX=l.x,this.caretY=l.y,this._resolveAnimations().update(this,m))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(e);const i={width:this.width,height:this.height},a={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const l=jn(e.padding),u=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&u&&(t.save(),t.globalAlpha=s,this.drawBackground(a,t,i,e),FD(t,e.textDirection),a.y+=l.top,this.drawTitle(a,t,e),this.drawBody(a,t,e),this.drawFooter(a,t,e),UD(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const s=this._active,i=t.map(({datasetIndex:u,index:h})=>{const f=this.chart.getDatasetMeta(u);if(!f)throw new Error("Cannot find a dataset at index "+u);return{datasetIndex:u,element:f.data[h],index:h}}),a=!ag(s,i),l=this._positionChanged(i,e);(a||l)&&(this._active=i,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,s=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,a=this._active||[],l=this._getActiveElements(t,a,e,s),u=this._positionChanged(l,t),h=e||!ag(l,a)||u;return h&&(this._active=l,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),h}_getActiveElements(t,e,s,i){const a=this.options;if(t.type==="mouseout")return[];if(!i)return e.filter(u=>this.chart.data.datasets[u.datasetIndex]&&this.chart.getDatasetMeta(u.datasetIndex).controller.getParsed(u.index)!==void 0);const l=this.chart.getElementsAtEventForMode(t,a.mode,a,s);return a.reverse&&l.reverse(),l}_positionChanged(t,e){const{caretX:s,caretY:i,options:a}=this,l=bh[a.position].call(this,t,e);return l!==!1&&(s!==l.x||i!==l.y)}}_t(I0,"positioners",bh);var d9={id:"tooltip",_element:I0,positioners:bh,afterInit(n,t,e){e&&(n.tooltip=new I0({chart:n,options:e}))},beforeUpdate(n,t,e){n.tooltip&&n.tooltip.initialize(e)},reset(n,t,e){n.tooltip&&n.tooltip.initialize(e)},afterDraw(n){const t=n.tooltip;if(t&&t._willRender()){const e={tooltip:t};if(n.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0})===!1)return;t.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",e)}},afterEvent(n,t){if(n.tooltip){const e=t.replay;n.tooltip.handleEvent(t.event,e,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,t)=>t.bodyFont.size,boxWidth:(n,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:mN},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},f9=Object.freeze({__proto__:null,Colors:S5,Decimation:D5,Filler:K5,Legend:e9,SubTitle:i9,Title:s9,Tooltip:d9});const m9=(n,t,e,s)=>(typeof t=="string"?(e=n.push(t)-1,s.unshift({index:e,label:t})):isNaN(t)&&(e=null),e);function g9(n,t,e,s){const i=n.indexOf(t);if(i===-1)return m9(n,t,e,s);const a=n.lastIndexOf(t);return i!==a?e:i}const p9=(n,t)=>n===null?null:yn(Math.round(n),0,t);function HS(n){const t=this.getLabels();return n>=0&&n<t.length?t[n]:n}class R0 extends Nd{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const s=this.getLabels();for(const{index:i,label:a}of e)s[i]===a&&s.splice(i,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(Yt(t))return null;const s=this.getLabels();return e=isFinite(e)&&s[e]===t?e:g9(s,t,jt(e,t),this._addedLabels),p9(e,s.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:s,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(s=0),e||(i=this.getLabels().length-1)),this.min=s,this.max=i}buildTicks(){const t=this.min,e=this.max,s=this.options.offset,i=[];let a=this.getLabels();a=t===0&&e===a.length-1?a:a.slice(t,e+1),this._valueRange=Math.max(a.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let l=t;l<=e;l++)i.push({value:l});return i}getLabelForValue(t){return HS.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}_t(R0,"id","category"),_t(R0,"defaults",{ticks:{callback:HS}});function _9(n,t){const e=[],{bounds:i,step:a,min:l,max:u,precision:h,count:f,maxTicks:m,maxDigits:_,includeBounds:x}=n,E=a||1,S=m-1,{min:T,max:R}=t,M=!Yt(l),L=!Yt(u),O=!Yt(f),H=(R-T)/(_+1);let B=j1((R-T)/S/E)*E,z,D,I,C;if(B<1e-14&&!M&&!L)return[{value:T},{value:R}];C=Math.ceil(R/B)-Math.floor(T/B),C>S&&(B=j1(C*B/S/E)*E),Yt(h)||(z=Math.pow(10,h),B=Math.ceil(B*z)/z),i==="ticks"?(D=Math.floor(T/B)*B,I=Math.ceil(R/B)*B):(D=T,I=R),M&&L&&a&&cj((u-l)/a,B/1e3)?(C=Math.round(Math.min((u-l)/B,m)),B=(u-l)/C,D=l,I=u):O?(D=M?l:D,I=L?u:I,C=f-1,B=(I-D)/C):(C=(I-D)/B,kh(C,Math.round(C),B/1e3)?C=Math.round(C):C=Math.ceil(C));const P=Math.max(B1(B),B1(D));z=Math.pow(10,Yt(h)?P:h),D=Math.round(D*z)/z,I=Math.round(I*z)/z;let j=0;for(M&&(x&&D!==l?(e.push({value:l}),D<l&&j++,kh(Math.round((D+j*B)*z)/z,l,qS(l,H,n))&&j++):D<l&&j++);j<C;++j){const F=Math.round((D+j*B)*z)/z;if(L&&F>u)break;e.push({value:F})}return L&&x&&I!==u?e.length&&kh(e[e.length-1].value,u,qS(u,H,n))?e[e.length-1].value=u:e.push({value:u}):(!L||I===u)&&e.push({value:I}),e}function qS(n,t,{horizontal:e,minRotation:s}){const i=qs(s),a=(e?Math.sin(i):Math.cos(i))||.001,l=.75*t*(""+n).length;return Math.min(t/a,l)}class fg extends Nd{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return Yt(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:s}=this.getUserBounds();let{min:i,max:a}=this;const l=h=>i=e?i:h,u=h=>a=s?a:h;if(t){const h=bi(i),f=bi(a);h<0&&f<0?u(0):h>0&&f>0&&l(0)}if(i===a){let h=a===0?1:Math.abs(a*.05);u(a+h),t||l(i-h)}this.min=i,this.max=a}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:e,stepSize:s}=t,i;return s?(i=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),e=e||11),e&&(i=Math.min(e,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let s=this.getTickLimit();s=Math.max(2,s);const i={maxTicks:s,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},a=this._range||this,l=_9(i,a);return t.bounds==="ticks"&&TD(l,this,"value"),t.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}configure(){const t=this.ticks;let e=this.min,s=this.max;if(super.configure(),this.options.offset&&t.length){const i=(s-e)/Math.max(t.length-1,1)/2;e-=i,s+=i}this._startValue=e,this._endValue=s,this._valueRange=s-e}getLabelForValue(t){return Dd(t,this.chart.options.locale,this.options.ticks.format)}}class D0 extends fg{determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=je(t)?t:0,this.max=je(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,s=qs(this.options.ticks.minRotation),i=(t?Math.sin(s):Math.cos(s))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,a.lineHeight/i))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}_t(D0,"id","linear"),_t(D0,"defaults",{ticks:{callback:Wg.formatters.numeric}});const ld=n=>Math.floor(ia(n)),xo=(n,t)=>Math.pow(10,ld(n)+t);function GS(n){return n/Math.pow(10,ld(n))===1}function $S(n,t,e){const s=Math.pow(10,e),i=Math.floor(n/s);return Math.ceil(t/s)-i}function y9(n,t){const e=t-n;let s=ld(e);for(;$S(n,t,s)>10;)s++;for(;$S(n,t,s)<10;)s--;return Math.min(s,ld(n))}function b9(n,{min:t,max:e}){t=ds(n.min,t);const s=[],i=ld(t);let a=y9(t,e),l=a<0?Math.pow(10,Math.abs(a)):1;const u=Math.pow(10,a),h=i>a?Math.pow(10,i):0,f=Math.round((t-h)*l)/l,m=Math.floor((t-h)/u/10)*u*10;let _=Math.floor((f-m)/Math.pow(10,a)),x=ds(n.min,Math.round((h+m+_*Math.pow(10,a))*l)/l);for(;x<e;)s.push({value:x,major:GS(x),significand:_}),_>=10?_=_<15?15:20:_++,_>=20&&(a++,_=2,l=a>=0?1:l),x=Math.round((h+m+_*Math.pow(10,a))*l)/l;const E=ds(n.max,x);return s.push({value:E,major:GS(E),significand:_}),s}class N0 extends Nd{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const s=fg.prototype.parse.apply(this,[t,e]);if(s===0){this._zero=!0;return}return je(s)&&s>0?s:null}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=je(t)?Math.max(0,t):null,this.max=je(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!je(this._userMin)&&(this.min=t===xo(this.min,0)?xo(this.min,-1):xo(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let s=this.min,i=this.max;const a=u=>s=t?s:u,l=u=>i=e?i:u;s===i&&(s<=0?(a(1),l(10)):(a(xo(s,-1)),l(xo(i,1)))),s<=0&&a(xo(i,-1)),i<=0&&l(xo(s,1)),this.min=s,this.max=i}buildTicks(){const t=this.options,e={min:this._userMin,max:this._userMax},s=b9(e,this);return t.bounds==="ticks"&&TD(s,this,"value"),t.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(t){return t===void 0?"0":Dd(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=ia(t),this._valueRange=ia(this.max)-ia(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(ia(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}_t(N0,"id","logarithmic"),_t(N0,"defaults",{ticks:{callback:Wg.formatters.logarithmic,major:{enabled:!0}}});function C0(n){const t=n.ticks;if(t.display&&n.display){const e=jn(t.backdropPadding);return jt(t.font&&t.font.size,Oe.font.size)+e.height}return 0}function x9(n,t,e){return e=Me(e)?e:[e],{w:Aj(n,t.string,e),h:e.length*t.lineHeight}}function WS(n,t,e,s,i){return n===s||n===i?{start:t-e/2,end:t+e/2}:n<s||n>i?{start:t-e,end:t}:{start:t,end:t+e}}function v9(n){const t={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},e=Object.assign({},t),s=[],i=[],a=n._pointLabels.length,l=n.options.pointLabels,u=l.centerPointLabels?se/a:0;for(let h=0;h<a;h++){const f=l.setContext(n.getPointLabelContext(h));i[h]=f.padding;const m=n.getPointPosition(h,n.drawingArea+i[h],u),_=cn(f.font),x=x9(n.ctx,_,n._pointLabels[h]);s[h]=x;const E=kn(n.getIndexAngle(h)+u),S=Math.round(lx(E)),T=WS(S,m.x,x.w,0,180),R=WS(S,m.y,x.h,90,270);E9(e,t,E,T,R)}n.setCenterPoint(t.l-e.l,e.r-t.r,t.t-e.t,e.b-t.b),n._pointLabelItems=S9(n,s,i)}function E9(n,t,e,s,i){const a=Math.abs(Math.sin(e)),l=Math.abs(Math.cos(e));let u=0,h=0;s.start<t.l?(u=(t.l-s.start)/a,n.l=Math.min(n.l,t.l-u)):s.end>t.r&&(u=(s.end-t.r)/a,n.r=Math.max(n.r,t.r+u)),i.start<t.t?(h=(t.t-i.start)/l,n.t=Math.min(n.t,t.t-h)):i.end>t.b&&(h=(i.end-t.b)/l,n.b=Math.max(n.b,t.b+h))}function T9(n,t,e){const s=n.drawingArea,{extra:i,additionalAngle:a,padding:l,size:u}=e,h=n.getPointPosition(t,s+i+l,a),f=Math.round(lx(kn(h.angle+Ye))),m=R9(h.y,u.h,f),_=A9(f),x=I9(h.x,u.w,_);return{visible:!0,x:h.x,y:m,textAlign:_,left:x,top:m,right:x+u.w,bottom:m+u.h}}function w9(n,t){if(!t)return!0;const{left:e,top:s,right:i,bottom:a}=n;return!(Ji({x:e,y:s},t)||Ji({x:e,y:a},t)||Ji({x:i,y:s},t)||Ji({x:i,y:a},t))}function S9(n,t,e){const s=[],i=n._pointLabels.length,a=n.options,{centerPointLabels:l,display:u}=a.pointLabels,h={extra:C0(a)/2,additionalAngle:l?se/i:0};let f;for(let m=0;m<i;m++){h.padding=e[m],h.size=t[m];const _=T9(n,m,h);s.push(_),u==="auto"&&(_.visible=w9(_,f),_.visible&&(f=_))}return s}function A9(n){return n===0||n===180?"center":n<180?"left":"right"}function I9(n,t,e){return e==="right"?n-=t:e==="center"&&(n-=t/2),n}function R9(n,t,e){return e===90||e===270?n-=t/2:(e>270||e<90)&&(n-=t),n}function D9(n,t,e){const{left:s,top:i,right:a,bottom:l}=e,{backdropColor:u}=t;if(!Yt(u)){const h=Lo(t.borderRadius),f=jn(t.backdropPadding);n.fillStyle=u;const m=s-f.left,_=i-f.top,x=a-s+f.width,E=l-i+f.height;Object.values(h).some(S=>S!==0)?(n.beginPath(),ad(n,{x:m,y:_,w:x,h:E,radius:h}),n.fill()):n.fillRect(m,_,x,E)}}function N9(n,t){const{ctx:e,options:{pointLabels:s}}=n;for(let i=t-1;i>=0;i--){const a=n._pointLabelItems[i];if(!a.visible)continue;const l=s.setContext(n.getPointLabelContext(i));D9(e,l,a);const u=cn(l.font),{x:h,y:f,textAlign:m}=a;Qo(e,n._pointLabels[i],h,f+u.lineHeight/2,u,{color:l.color,textAlign:m,textBaseline:"middle"})}}function gN(n,t,e,s){const{ctx:i}=n;if(e)i.arc(n.xCenter,n.yCenter,t,0,Ae);else{let a=n.getPointPosition(0,t);i.moveTo(a.x,a.y);for(let l=1;l<s;l++)a=n.getPointPosition(l,t),i.lineTo(a.x,a.y)}}function C9(n,t,e,s,i){const a=n.ctx,l=t.circular,{color:u,lineWidth:h}=t;!l&&!s||!u||!h||e<0||(a.save(),a.strokeStyle=u,a.lineWidth=h,a.setLineDash(i.dash||[]),a.lineDashOffset=i.dashOffset,a.beginPath(),gN(n,e,l,s),a.closePath(),a.stroke(),a.restore())}function M9(n,t,e){return Ma(n,{label:e,index:t,type:"pointLabel"})}class xh extends fg{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=jn(C0(this.options)/2),e=this.width=this.maxWidth-t.width,s=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+s/2+t.top),this.drawingArea=Math.floor(Math.min(e,s)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=je(t)&&!isNaN(t)?t:0,this.max=je(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/C0(this.options))}generateTickLabels(t){fg.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((e,s)=>{const i=ve(this.options.pointLabels.callback,[e,s],this);return i||i===0?i:""}).filter((e,s)=>this.chart.getDataVisibility(s))}fit(){const t=this.options;t.display&&t.pointLabels.display?v9(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,s,i){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((s-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,s,i))}getIndexAngle(t){const e=Ae/(this._pointLabels.length||1),s=this.options.startAngle||0;return kn(t*e+qs(s))}getDistanceFromCenterForValue(t){if(Yt(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(Yt(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const s=e[t];return M9(this.getContext(),t,s)}}getPointPosition(t,e,s=0){const i=this.getIndexAngle(t)-Ye+s;return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter,angle:i}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:s,right:i,bottom:a}=this._pointLabelItems[t];return{left:e,top:s,right:i,bottom:a}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const s=this.ctx;s.save(),s.beginPath(),gN(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),s.closePath(),s.fillStyle=t,s.fill(),s.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:s,grid:i,border:a}=e,l=this._pointLabels.length;let u,h,f;if(e.pointLabels.display&&N9(this,l),i.display&&this.ticks.forEach((m,_)=>{if(_!==0||_===0&&this.min<0){h=this.getDistanceFromCenterForValue(m.value);const x=this.getContext(_),E=i.setContext(x),S=a.setContext(x);C9(this,E,h,l,S)}}),s.display){for(t.save(),u=l-1;u>=0;u--){const m=s.setContext(this.getPointLabelContext(u)),{color:_,lineWidth:x}=m;!x||!_||(t.lineWidth=x,t.strokeStyle=_,t.setLineDash(m.borderDash),t.lineDashOffset=m.borderDashOffset,h=this.getDistanceFromCenterForValue(e.reverse?this.min:this.max),f=this.getPointPosition(u,h),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(f.x,f.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,s=e.ticks;if(!s.display)return;const i=this.getIndexAngle(0);let a,l;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(i),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((u,h)=>{if(h===0&&this.min>=0&&!e.reverse)return;const f=s.setContext(this.getContext(h)),m=cn(f.font);if(a=this.getDistanceFromCenterForValue(this.ticks[h].value),f.showLabelBackdrop){t.font=m.string,l=t.measureText(u.label).width,t.fillStyle=f.backdropColor;const _=jn(f.backdropPadding);t.fillRect(-l/2-_.left,-a-m.size/2-_.top,l+_.width,m.size+_.height)}Qo(t,u.label,0,-a,m,{color:f.color,strokeColor:f.textStrokeColor,strokeWidth:f.textStrokeWidth})}),t.restore()}drawTitle(){}}_t(xh,"id","radialLinear"),_t(xh,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Wg.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),_t(xh,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),_t(xh,"descriptors",{angleLines:{_fallback:"grid"}});const Jg={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},ts=Object.keys(Jg);function YS(n,t){return n-t}function KS(n,t){if(Yt(t))return null;const e=n._adapter,{parser:s,round:i,isoWeekday:a}=n._parseOpts;let l=t;return typeof s=="function"&&(l=s(l)),je(l)||(l=typeof s=="string"?e.parse(l,s):e.parse(l)),l===null?null:(i&&(l=i==="week"&&(Cc(a)||a===!0)?e.startOf(l,"isoWeek",a):e.startOf(l,i)),+l)}function QS(n,t,e,s){const i=ts.length;for(let a=ts.indexOf(n);a<i-1;++a){const l=Jg[ts[a]],u=l.steps?l.steps:Number.MAX_SAFE_INTEGER;if(l.common&&Math.ceil((e-t)/(u*l.size))<=s)return ts[a]}return ts[i-1]}function O9(n,t,e,s,i){for(let a=ts.length-1;a>=ts.indexOf(e);a--){const l=ts[a];if(Jg[l].common&&n._adapter.diff(i,s,l)>=t-1)return l}return ts[e?ts.indexOf(e):0]}function k9(n){for(let t=ts.indexOf(n)+1,e=ts.length;t<e;++t)if(Jg[ts[t]].common)return ts[t]}function XS(n,t,e){if(!e)n[t]=!0;else if(e.length){const{lo:s,hi:i}=cx(e,t),a=e[s]>=t?e[s]:e[i];n[a]=!0}}function V9(n,t,e,s){const i=n._adapter,a=+i.startOf(t[0].value,s),l=t[t.length-1].value;let u,h;for(u=a;u<=l;u=+i.add(u,1,s))h=e[u],h>=0&&(t[h].major=!0);return t}function ZS(n,t,e){const s=[],i={},a=t.length;let l,u;for(l=0;l<a;++l)u=t[l],i[u]=l,s.push({value:u,major:!1});return a===0||!e?s:V9(n,s,i,e)}class cd extends Nd{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const s=t.time||(t.time={}),i=this._adapter=new H6._date(t.adapters.date);i.init(e),Oh(s.displayFormats,i.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return t===void 0?null:KS(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,s=t.time.unit||"day";let{min:i,max:a,minDefined:l,maxDefined:u}=this.getUserBounds();function h(f){!l&&!isNaN(f.min)&&(i=Math.min(i,f.min)),!u&&!isNaN(f.max)&&(a=Math.max(a,f.max))}(!l||!u)&&(h(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&h(this.getMinMax(!1))),i=je(i)&&!isNaN(i)?i:+e.startOf(Date.now(),s),a=je(a)&&!isNaN(a)?a:+e.endOf(Date.now(),s)+1,this.min=Math.min(i,a-1),this.max=Math.max(i+1,a)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],s=t[t.length-1]),{min:e,max:s}}buildTicks(){const t=this.options,e=t.time,s=t.ticks,i=s.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const a=this.min,l=this.max,u=fj(i,a,l);return this._unit=e.unit||(s.autoSkip?QS(e.minUnit,this.min,this.max,this._getLabelCapacity(a)):O9(this,u.length,e.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:k9(this._unit),this.initOffsets(i),t.reverse&&u.reverse(),ZS(this,u,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let e=0,s=0,i,a;this.options.offset&&t.length&&(i=this.getDecimalForValue(t[0]),t.length===1?e=1-i:e=(this.getDecimalForValue(t[1])-i)/2,a=this.getDecimalForValue(t[t.length-1]),t.length===1?s=a:s=(a-this.getDecimalForValue(t[t.length-2]))/2);const l=t.length<3?.5:.25;e=yn(e,0,l),s=yn(s,0,l),this._offsets={start:e,end:s,factor:1/(e+1+s)}}_generate(){const t=this._adapter,e=this.min,s=this.max,i=this.options,a=i.time,l=a.unit||QS(a.minUnit,e,s,this._getLabelCapacity(e)),u=jt(i.ticks.stepSize,1),h=l==="week"?a.isoWeekday:!1,f=Cc(h)||h===!0,m={};let _=e,x,E;if(f&&(_=+t.startOf(_,"isoWeek",h)),_=+t.startOf(_,f?"day":l),t.diff(s,e,l)>1e5*u)throw new Error(e+" and "+s+" are too far apart with stepSize of "+u+" "+l);const S=i.ticks.source==="data"&&this.getDataTimestamps();for(x=_,E=0;x<s;x=+t.add(x,u,l),E++)XS(m,x,S);return(x===s||i.bounds==="ticks"||E===1)&&XS(m,x,S),Object.keys(m).sort(YS).map(T=>+T)}getLabelForValue(t){const e=this._adapter,s=this.options.time;return s.tooltipFormat?e.format(t,s.tooltipFormat):e.format(t,s.displayFormats.datetime)}format(t,e){const i=this.options.time.displayFormats,a=this._unit,l=e||i[a];return this._adapter.format(t,l)}_tickFormatFunction(t,e,s,i){const a=this.options,l=a.ticks.callback;if(l)return ve(l,[t,e,s],this);const u=a.time.displayFormats,h=this._unit,f=this._majorUnit,m=h&&u[h],_=f&&u[f],x=s[e],E=f&&_&&x&&x.major;return this._adapter.format(t,i||(E?_:m))}generateTickLabels(t){let e,s,i;for(e=0,s=t.length;e<s;++e)i=t[e],i.label=this._tickFormatFunction(i.value,e,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,s=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+s)*e.factor)}getValueForPixel(t){const e=this._offsets,s=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+s*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,s=this.ctx.measureText(t).width,i=qs(this.isHorizontal()?e.maxRotation:e.minRotation),a=Math.cos(i),l=Math.sin(i),u=this._resolveTickFontOptions(0).size;return{w:s*a+u*l,h:s*l+u*a}}_getLabelCapacity(t){const e=this.options.time,s=e.displayFormats,i=s[e.unit]||s.millisecond,a=this._tickFormatFunction(t,0,ZS(this,[t],this._majorUnit),i),l=this._getLabelSize(a),u=Math.floor(this.isHorizontal()?this.width/l.w:this.height/l.h)-1;return u>0?u:1}getDataTimestamps(){let t=this._cache.data||[],e,s;if(t.length)return t;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(e=0,s=i.length;e<s;++e)t=t.concat(i[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let e,s;if(t.length)return t;const i=this.getLabels();for(e=0,s=i.length;e<s;++e)t.push(KS(this,i[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return AD(t.sort(YS))}}_t(cd,"id","time"),_t(cd,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function ym(n,t,e){let s=0,i=n.length-1,a,l,u,h;e?(t>=n[s].pos&&t<=n[i].pos&&({lo:s,hi:i}=Zi(n,"pos",t)),{pos:a,time:u}=n[s],{pos:l,time:h}=n[i]):(t>=n[s].time&&t<=n[i].time&&({lo:s,hi:i}=Zi(n,"time",t)),{time:a,pos:u}=n[s],{time:l,pos:h}=n[i]);const f=l-a;return f?u+(h-u)*(t-a)/f:u}class M0 extends cd{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=ym(e,this.min),this._tableRange=ym(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:s}=this,i=[],a=[];let l,u,h,f,m;for(l=0,u=t.length;l<u;++l)f=t[l],f>=e&&f<=s&&i.push(f);if(i.length<2)return[{time:e,pos:0},{time:s,pos:1}];for(l=0,u=i.length;l<u;++l)m=i[l+1],h=i[l-1],f=i[l],Math.round((m+h)/2)!==f&&a.push({time:f,pos:l/(u-1)});return a}_generate(){const t=this.min,e=this.max;let s=super.getDataTimestamps();return(!s.includes(t)||!s.length)&&s.splice(0,0,t),(!s.includes(e)||s.length===1)&&s.push(e),s.sort((i,a)=>i-a)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),s=this.getLabelTimestamps();return e.length&&s.length?t=this.normalize(e.concat(s)):t=e.length?e:s,t=this._cache.all=t,t}getDecimalForValue(t){return(ym(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,s=this.getDecimalForPixel(t)/e.factor-e.end;return ym(this._table,s*this._tableRange+this._minPos,!0)}}_t(M0,"id","timeseries"),_t(M0,"defaults",cd.defaults);var P9=Object.freeze({__proto__:null,CategoryScale:R0,LinearScale:D0,LogarithmicScale:N0,RadialLinearScale:xh,TimeScale:cd,TimeSeriesScale:M0});const L9=[z6,y5,f9,P9];wn.register(...L9);const mg={income:["薪水","獎金","投資收益","副業收入","其他收入"],expense:["餐飲","交通","居住","娛樂","教育","醫療","購物","通訊","保險","其他支出"]},ch={現金:"#4CAF50",ETF:"#2196F3",股票:"#FFC107",不動產:"#9C27B0",美元資產:"#FF5722"},j9=(n,t)=>n.map(e=>({...e,assets:(e.assets||[]).map(s=>{const i=parseFloat(String(s.currentValue))||0,a=parseFloat(String(s.cost))||0,l=parseFloat(String(s.units))||0,u=s.currency==="USD"?t:1,h=i*l*u,f=a*l*u,m=h-f;return{...s,currentValueTWD:h,costTWD:f,profitLossTWD:m}})})),xx=n=>{let t=0,e=0;const s={現金:{value:0,color:ch.現金},ETF:{value:0,color:ch.ETF},股票:{value:0,color:ch.股票},不動產:{value:0,color:ch.不動產},美元資產:{value:0,color:ch.美元資產}};n.forEach(a=>{(a.assets||[]).forEach(l=>{const u=l.currentValueTWD||0;t+=u,s[l.accountType]&&(s[l.accountType].value+=u),l.currency==="USD"&&(e+=u)})});const i=Object.keys(s).filter(a=>s[a].value>0).map(a=>({type:a,value:s[a].value,color:s[a].color}));return{total:t,breakdown:i,totalUsdAssetsInTwd:e}},B9=(n,t)=>{var H,B;const{total:e,breakdown:s}=xx(n);if(e===0)return{score:0,feedback:["請先新增您的資產以進行評分。"],level:"待加強",levelColor:"text-red-500"};let i=0;const a=[],l=t.filter(z=>z.type==="expense"),u=new Map;l.forEach(z=>{const D=z.date.slice(0,7);u.set(D,(u.get(D)||0)+z.amount)});const h=Array.from(u.values()).reduce((z,D)=>z+D,0),f=u.size>0?h/u.size:0,m=((H=s.find(z=>z.type==="現金"))==null?void 0:H.value)||0,_=f>0?m/f:0;f===0?(i+=10,a.push("尚無支出數據，無法評估緊急備用金。")):_>=3&&_<=6?(i+=40,a.push(`緊急備用金充足 (${_.toFixed(1)}個月)，財務基礎穩固。`)):_>6?(i+=25,a.push(`現金持有稍多 (${_.toFixed(1)}個月)，可考慮將部分資金用於投資。`)):_>=1?(i+=15,a.push(`緊急備用金 (${_.toFixed(1)}個月) 略顯不足，建議提升至3-6個月。`)):(i+=5,a.push(`緊急備用金嚴重不足 (${_.toFixed(1)}個月)，請優先儲蓄！`));const x=n.flatMap(z=>z.assets||[]).filter(z=>["股票","ETF"].includes(z.accountType)),E=x.reduce((z,D)=>z+(D.currentValueTWD||0),0),S=E>0?[...x].sort((z,D)=>(D.currentValueTWD??0)-(z.currentValueTWD??0))[0]:null,T=E>0&&S?(S.currentValueTWD??0)/E*100:0;T>50?(i+=5,a.push(`投資過度集中於「${S==null?void 0:S.code}」(${T.toFixed(1)}%)，風險極高。`)):T>30?(i+=15,a.push(`單一資產佔比較高 (${T.toFixed(1)}%)，建議分散投資。`)):(i+=30,a.push(`投資組合分散良好，最大持股佔比為 ${T.toFixed(1)}%。`));const R=((B=s.find(z=>z.type==="股票"))==null?void 0:B.value)||0,M=e>0?R/e*100:0;M>60?(i+=5,a.push(`個股佔總資產 ${M.toFixed(1)}%，風險配置過於激進。`)):M>35?(i+=15,a.push(`個股佔比 ${M.toFixed(1)}% 偏高，請留意風險。`)):(i+=30,a.push(`個股風險控制良好，佔總資產 ${M.toFixed(1)}%。`)),i=Math.round(i);let L,O;return i>=80?(L="優良",O="text-green-500"):i>=50?(L="中等",O="text-yellow-500"):(L="待加強",O="text-red-500"),{score:i,feedback:a,level:L,levelColor:O}},ln=({children:n,className:t=""})=>y.jsx("div",{className:`bg-white rounded-xl shadow-lg border border-gray-200/75 p-6 sm:p-8 ${t}`,children:n}),cr=({title:n,subtitle:t})=>y.jsxs("div",{className:"mb-8 border-b border-gray-200 pb-5",children:[y.jsx("h2",{className:"text-3xl font-semibold tracking-tight text-gray-900",children:n}),t&&y.jsx("p",{className:"mt-2 text-base text-gray-600",children:t})]}),Cd=({Icon:n,title:t,message:e,children:s})=>y.jsxs("div",{className:"text-center flex flex-col items-center justify-center h-full text-gray-500 bg-gray-50 rounded-lg p-8 border-2 border-dashed",children:[y.jsx(n,{className:"h-16 w-16 text-gray-400 mb-4",strokeWidth:1}),y.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:t}),y.jsx("p",{className:"text-sm mt-1 max-w-sm mx-auto",children:e}),s&&y.jsx("div",{className:"mt-6",children:s})]}),F9=n=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24",stroke:"currentColor",...n,children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]}),U9=({score:n,level:t,color:e,feedback:s})=>{const i=2*Math.PI*52,a=i-n/100*i;return y.jsxs(ln,{className:"flex flex-col items-center justify-center",children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"財務健康分數"}),y.jsxs("div",{className:"relative w-40 h-40",children:[y.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 120 120",children:[y.jsx("circle",{cx:"60",cy:"60",r:"52",fill:"none",stroke:"#e6e6e6",strokeWidth:"8"}),y.jsx("circle",{cx:"60",cy:"60",r:"52",fill:"none",className:`stroke-current ${e.replace("text-","stroke-")}`,strokeWidth:"8",strokeDasharray:i,strokeDashoffset:a,strokeLinecap:"round",transform:"rotate(-90 60 60)",style:{transition:"stroke-dashoffset 0.8s ease-out"}})]}),y.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[y.jsx("span",{className:`text-4xl font-bold ${e}`,children:n}),y.jsx("span",{className:`text-sm font-semibold ${e}`,children:t})]})]}),y.jsx("div",{className:"text-center mt-3 text-xs text-gray-500 w-full",children:s.slice(0,1).map((l,u)=>y.jsx("p",{children:l},u))})]})},z9=({assetAccounts:n})=>{const{total:t,breakdown:e}=xx(n),i=(()=>{var x,E,S;if(t===0)return{title:"開始您的理財之旅",message:"您的資產組合目前是空的。請前往「資料管理」新增您的第一筆資產，開始追踪您的財務狀況！",icon:"🚀"};const a=(((x=e.find(T=>T.type==="現金"))==null?void 0:x.value)||0)/t,l=(((E=e.find(T=>T.type==="ETF"))==null?void 0:E.value)||0)/t,u=(((S=e.find(T=>T.type==="股票"))==null?void 0:S.value)||0)/t,h=n.flatMap(T=>T.assets||[]).filter(T=>["股票","ETF"].includes(T.accountType)),f=h.reduce((T,R)=>T+(R.currentValueTWD||0),0),m=f>0?[...h].sort((T,R)=>(R.currentValueTWD??0)-(T.currentValueTWD??0))[0]:null,_=f>0&&m?(m.currentValueTWD??0)/f*100:0;return a>.4?{title:"現金比例偏高",message:`您有超過 ${(a*100).toFixed(0)}% 的資產是現金。雖然保有流動性是好事，但考慮將部分閒置資金投入 ETF 或其他投資，可能會有更好的長期回報。`,icon:"💰"}:_>40?{title:"注意投資集中風險",message:`您在「${m==null?void 0:m.code}」上的投資佔了投資組合的 ${_.toFixed(1)}%。這可能會帶來較高的風險。建議您考慮增加其他標的，以達到更好的分散效果。`,icon:"⚠️"}:l<.3&&(u>0||a>.1)?{title:"建立穩健的投資核心",message:"您的 ETF 佔比目前較低。考慮增加指數型 ETF 的配置，這有助於建立一個分散風險、穩健增長的投資組合核心。",icon:"📈"}:{title:"資產配置均衡",message:"您的資產配置看起來相當均衡。請繼續保持定期檢視，並根據您的財務目標進行調整。做得很好！",icon:"👍"}})();return y.jsxs(ln,{children:[y.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center",children:[y.jsx("span",{className:"text-2xl mr-2",children:i.icon}),"投資組合洞察"]}),y.jsxs("div",{className:"text-gray-600 text-base leading-relaxed h-full flex flex-col justify-center",children:[y.jsx("p",{className:"font-semibold text-gray-700 mb-1",children:i.title}),y.jsx("p",{className:"text-sm",children:i.message})]})]})},JS=({userId:n,assetAccounts:t,cashflowRecords:e})=>{const s=ut.useRef(null),i=ut.useRef(null),a=ut.useMemo(()=>xx(t),[t]),l=ut.useMemo(()=>B9(t,e),[t,e]),{total:u,breakdown:h,totalUsdAssetsInTwd:f}=a,m=ut.useMemo(()=>{const _=new Date,x=new Date(_.getFullYear(),_.getMonth(),15),E=new Date(x);E.setMonth(E.getMonth()-1);const S=E.getFullYear(),T=E.getMonth(),R=`${S}-${String(T+1).padStart(2,"0")}`,M=e.filter(z=>z.date.startsWith(R)),L=M.filter(z=>z.type==="income").reduce((z,D)=>z+D.amount,0),O=M.filter(z=>z.type==="expense").reduce((z,D)=>z+D.amount,0),H=L-O,B=L>0?H/L*100:0;return{totalIncome:L,totalExpense:O,netSavings:H,savingsRate:B,monthLabel:`${S}年${T+1}月`}},[e]);return ut.useEffect(()=>{if(s.current&&u>0){i.current&&i.current.destroy();const _=s.current.getContext("2d");_&&(i.current=new wn(_,{type:"pie",data:{labels:h.map(x=>x.type),datasets:[{data:h.map(x=>x.value),backgroundColor:h.map(x=>x.color),borderColor:"#fff",borderWidth:2,hoverOffset:8}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{font:{size:14,family:"Inter, sans-serif"},color:"#333",boxWidth:20}},title:{display:!0,text:"資產配置圓餅圖",font:{size:18,family:"Inter, sans-serif"},color:"#333"}}}}))}else i.current&&(i.current.destroy(),i.current=null);return()=>{i.current&&i.current.destroy()}},[u,h]),y.jsxs("div",{children:[y.jsx(cr,{title:"您的個人財務導航中心"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[y.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-indigo-600 p-6 rounded-xl shadow-lg text-white transform hover:scale-105 transition-transform duration-300 relative overflow-hidden",children:[y.jsx("div",{className:"absolute -top-4 -left-4 w-24 h-24 bg-white/10 rounded-full"}),y.jsxs("div",{className:"relative z-10",children:[y.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center",children:[y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-7 h-7 mr-2 opacity-75",children:[y.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"}),y.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),"總資產顯示"]}),y.jsxs("p",{className:"text-4xl font-bold mt-4",children:["$",u.toLocaleString(void 0,{maximumFractionDigits:0})]}),y.jsx("p",{className:"text-blue-200 text-sm mt-2",children:"包含所有帳戶資產"})]})]}),y.jsxs("div",{className:"bg-gradient-to-br from-emerald-500 to-teal-600 p-6 rounded-xl shadow-lg text-white transform hover:scale-105 transition-transform duration-300 relative overflow-hidden",children:[y.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-white/10 rounded-full"}),y.jsxs("div",{className:"relative z-10",children:[y.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center",children:[y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-7 h-7 mr-2 opacity-75",children:[y.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),y.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]}),"美元計價資產總值 (TWD)"]}),y.jsxs("p",{className:"text-4xl font-bold mt-4",children:["$",f.toLocaleString(void 0,{maximumFractionDigits:0})]}),y.jsx("p",{className:"text-emerald-100 text-sm mt-2",children:"已轉換為新台幣"})]})]}),y.jsx(U9,{score:l.score,level:l.level,color:l.levelColor,feedback:l.feedback}),y.jsx(z9,{assetAccounts:t})]}),y.jsxs("div",{className:"mb-8",children:[y.jsxs("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:[m.monthLabel," 財務摘要"]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[y.jsxs(ln,{className:"bg-green-50 border-green-200",children:[y.jsxs("h4",{className:"text-md font-semibold text-green-800 mb-2 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),"總收入"]}),y.jsxs("p",{className:"text-3xl font-bold text-green-900",children:["$",m.totalIncome.toLocaleString()]})]}),y.jsxs(ln,{className:"bg-red-50 border-red-200",children:[y.jsxs("h4",{className:"text-md font-semibold text-red-800 mb-2 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),"總支出"]}),y.jsxs("p",{className:"text-3xl font-bold text-red-900",children:["$",m.totalExpense.toLocaleString()]})]}),y.jsxs(ln,{className:"bg-blue-50 border-blue-200",children:[y.jsxs("h4",{className:"text-md font-semibold text-blue-800 mb-2 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})}),"淨儲蓄"]}),y.jsxs("p",{className:`text-3xl font-bold ${m.netSavings>=0?"text-blue-900":"text-red-900"}`,children:["$",m.netSavings.toLocaleString()]})]}),y.jsxs(ln,{className:"bg-purple-50 border-purple-200",children:[y.jsxs("h4",{className:"text-md font-semibold text-purple-800 mb-2 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),"儲蓄率"]}),y.jsxs("p",{className:"text-3xl font-bold text-purple-900",children:[m.savingsRate.toFixed(1),"%"]})]})]})]}),y.jsx(ln,{className:"h-[450px]",children:u>0?y.jsx("canvas",{ref:s}):y.jsx(Cd,{Icon:F9,title:"尚無資產數據",message:"新增您的第一個資產，開始視覺化您的財務狀況。"})})]})},Oy=25,H9=({userId:n,db:t,cashflowRecords:e,assetAccounts:s,settings:i,setNotification:a,appId:l,effectiveUsdToTwdRate:u})=>{const h={id:"",date:new Date().toISOString().split("T")[0],type:"expense",category:"",amount:"",currency:"TWD",description:"",isRecurring:!1,accountId:"",recurrenceDay:""},[f,m]=ut.useState(h),[_,x]=ut.useState(null),[E,S]=ut.useState(String(u)),[T,R]=ut.useState(""),[M,L]=ut.useState(""),[O,H]=ut.useState(1);ut.useEffect(()=>{S(String(u))},[u]),ut.useEffect(()=>{const nt=setTimeout(()=>{L(T),H(1)},300);return()=>{clearTimeout(nt)}},[T]);const B=ut.useMemo(()=>M?e.filter(nt=>{var bt;return nt.category.toLowerCase().includes(M.toLowerCase())||nt.description.toLowerCase().includes(M.toLowerCase())||((bt=nt.accountName)==null?void 0:bt.toLowerCase().includes(M.toLowerCase()))||nt.amount.toString().includes(M)}):e,[e,M]),z=ut.useMemo(()=>{const nt=(O-1)*Oy;return B.slice(nt,nt+Oy)},[B,O]),D=Math.ceil(B.length/Oy),I=nt=>{const{name:bt,value:Y}=nt.target,at=nt.target.checked;m(mt=>({...mt,[bt]:nt.target.type==="checkbox"?at:Y}))},C=async()=>{const nt=parseFloat(E);!isNaN(nt)&&nt>0?nt!==i.manualRate&&(await t.doc(`artifacts/${l}/users/${n}/settings/userSettings`).set({manualRate:nt},{merge:!0}),a({message:`匯率已更新為 ${nt}`,type:"info",show:!0})):E===""&&i.manualRate!==null&&(await t.doc(`artifacts/${l}/users/${n}/settings/userSettings`).set({manualRate:null},{merge:!0}),a({message:"手動匯率已清除，將使用系統預設值。",type:"info",show:!0}))},P=async nt=>{var mt;if(nt.preventDefault(),!f.category||!f.amount||!f.accountId){a({message:"類別、金額和帳戶為必填項。",type:"error",show:!0});return}if(f.isRecurring&&(!f.recurrenceDay||Number(f.recurrenceDay)<1||Number(f.recurrenceDay)>31)){a({message:"請為定額項目設定有效的每月執行日期 (1-31)。",type:"error",show:!0});return}const bt=`artifacts/${l}/users/${n}/cashflowRecords`,Y=((mt=s.find(Dt=>Dt.id===f.accountId))==null?void 0:mt.name)||"",at={date:f.date,type:f.type,category:f.category,amount:parseFloat(f.amount)||0,currency:f.currency,description:f.description,isRecurring:f.isRecurring,accountId:f.accountId,accountName:Y};f.isRecurring&&(at.recurrenceDay=Number(f.recurrenceDay));try{_?(await t.doc(`${bt}/${_}`).set(at),a({message:"收支紀錄更新成功！",type:"success",show:!0})):(await t.collection(bt).add(at),a({message:"收支紀錄新增成功！",type:"success",show:!0})),m(h),x(null)}catch(Dt){console.error("Error saving cashflow record:",Dt);const U=Dt instanceof Error?Dt.message:"An unknown error occurred.";a({message:`儲存失敗: ${U}`,type:"error",show:!0})}},j=nt=>{m({...h,...nt,amount:nt.amount.toString(),recurrenceDay:String(nt.recurrenceDay||"")}),x(nt.id),window.scrollTo({top:0,behavior:"smooth"})},F=async nt=>{window.confirm("您確定要刪除這筆紀錄嗎？")&&(await t.doc(`artifacts/${l}/users/${n}/cashflowRecords/${nt}`).delete(),a({message:"紀錄已刪除。",type:"success",show:!0}))},k=f.type==="income"?[...mg.income,...i.customIncome||[]]:[...mg.expense,...i.customExpense||[]];return y.jsxs("div",{children:[y.jsxs("form",{onSubmit:P,className:"mb-8 p-6 border rounded-lg bg-gray-50 shadow-sm",children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:_?"編輯收支紀錄":"新增收支紀錄"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"日期"}),y.jsx("input",{type:"date",name:"date",value:f.date,onChange:I,className:"mt-1 w-full p-2 border rounded-md shadow-sm"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"帳戶*"}),y.jsxs("select",{name:"accountId",value:f.accountId,onChange:I,className:"mt-1 w-full p-2 border rounded-md shadow-sm bg-white",children:[y.jsx("option",{value:"",children:"選擇帳戶"}),s.map(nt=>y.jsx("option",{value:nt.id,children:nt.name},nt.id))]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"類型"}),y.jsxs("select",{name:"type",value:f.type,onChange:I,className:"mt-1 w-full p-2 border rounded-md shadow-sm bg-white",children:[y.jsx("option",{value:"expense",children:"支出"}),y.jsx("option",{value:"income",children:"收入"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"類別*"}),y.jsxs("select",{name:"category",value:f.category,onChange:I,className:"mt-1 w-full p-2 border rounded-md shadow-sm bg-white",children:[y.jsx("option",{value:"",children:"選擇類別"}),k.map(nt=>y.jsx("option",{value:nt,children:nt},nt))]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"金額*"}),y.jsx("input",{type:"number",name:"amount",placeholder:"輸入金額",value:f.amount,onChange:I,className:"mt-1 w-full p-2 border rounded-md shadow-sm"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"幣別 & 匯率"}),y.jsxs("div",{className:"flex space-x-2 mt-1",children:[y.jsxs("select",{name:"currency",value:f.currency,onChange:I,className:`p-2 border rounded-md shadow-sm bg-white transition-all duration-200 ${f.currency==="USD"?"w-1/2":"w-full"}`,children:[y.jsx("option",{value:"TWD",children:"TWD"}),y.jsx("option",{value:"USD",children:"USD"})]}),f.currency==="USD"&&y.jsx("input",{type:"number",step:"0.01","aria-label":"USD to TWD Exchange Rate",placeholder:"匯率",value:E,onChange:nt=>S(nt.target.value),onBlur:C,className:"p-2 border rounded-md shadow-sm w-1/2"})]})]}),y.jsxs("div",{className:"md:col-span-2",children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"說明 (選填)"}),y.jsx("input",{type:"text",name:"description",placeholder:"例如：與同事的午餐",value:f.description,onChange:I,className:"mt-1 w-full p-2 border rounded-md shadow-sm"})]}),y.jsx("div",{className:"flex items-end",children:y.jsxs("div",{className:"p-3 border rounded-md bg-white shadow-sm w-full",children:[y.jsxs("div",{className:"flex items-center",children:[y.jsx("input",{type:"checkbox",id:"isRecurring",name:"isRecurring",checked:f.isRecurring,onChange:I,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),y.jsx("label",{htmlFor:"isRecurring",className:"ml-2 block text-sm text-gray-900",children:"設為定額項目"})]}),f.isRecurring&&y.jsxs("div",{className:"flex items-center mt-2",children:[y.jsx("label",{htmlFor:"recurrenceDay",className:"mr-2 text-sm text-gray-700",children:"每月"}),y.jsx("input",{type:"number",id:"recurrenceDay",name:"recurrenceDay",value:f.recurrenceDay,onChange:I,min:"1",max:"31",placeholder:"日",className:"p-1 border rounded-md shadow-sm w-20"}),y.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"日執行"})]})]})})]}),y.jsxs("div",{className:"mt-4 flex justify-end space-x-3",children:[_&&y.jsx("button",{type:"button",onClick:()=>{x(null),m(h)},className:"bg-gray-200 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-300 font-medium",children:"取消編輯"}),y.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 font-medium shadow-sm",children:_?"更新紀錄":"新增紀錄"})]})]}),y.jsx("div",{className:"mb-4",children:y.jsxs("div",{className:"relative",children:[y.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:y.jsx("svg",{className:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),y.jsx("input",{type:"text",placeholder:"搜尋類別、說明、金額...",value:T,onChange:nt=>R(nt.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})}),y.jsxs("div",{className:"overflow-x-auto shadow-md rounded-lg",children:[y.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[y.jsx("thead",{className:"bg-gray-50",children:y.jsxs("tr",{children:[y.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"日期"}),y.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"帳戶"}),y.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"類型"}),y.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"類別"}),y.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"金額"}),y.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"說明"}),y.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),y.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:z.map((nt,bt)=>y.jsxs("tr",{className:`transition-colors ${bt%2===0?"bg-white":"bg-gray-50"} ${_===nt.id?"bg-blue-100":"hover:bg-yellow-50"}`,children:[y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:nt.date}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:nt.accountName}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:y.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${nt.type==="income"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:nt.type==="income"?"收入":"支出"})}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:nt.category}),y.jsxs("td",{className:`px-6 py-4 whitespace-nowrap text-sm text-right font-medium ${nt.type==="income"?"text-green-700":"text-red-700"}`,children:[nt.amount.toLocaleString()," ",y.jsx("span",{className:"text-xs text-gray-400",children:nt.currency})]}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 truncate max-w-xs",title:nt.description||"-",children:nt.description||"-"}),y.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:[nt.isRecurring&&y.jsx("span",{title:`定額項目: 每月 ${nt.recurrenceDay} 日`,className:"mr-3 text-blue-500 cursor-help",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h5M5 12a7 7 0 0011.66 4.995M20 20v-5h-5"})})}),y.jsx("button",{onClick:()=>j(nt),className:"text-indigo-600 hover:text-indigo-900 mr-4",children:"編輯"}),y.jsx("button",{onClick:()=>F(nt.id),className:"text-red-600 hover:text-red-900",children:"刪除"})]})]},nt.id))})]}),D>1&&y.jsxs("div",{className:"flex justify-between items-center mt-4 p-2",children:[y.jsx("button",{onClick:()=>H(nt=>Math.max(1,nt-1)),disabled:O===1,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"上一頁"}),y.jsxs("span",{className:"text-sm text-gray-700",children:["第 ",O," 頁 / 共 ",D," 頁"]}),y.jsx("button",{onClick:()=>H(nt=>Math.min(D,nt+1)),disabled:O===D,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"下一頁"})]})]})]})},q9=({userId:n,db:t,assetAccounts:e,setNotification:s,appId:i})=>{var D;const[a,l]=ut.useState(""),[u,h]=ut.useState(""),f={code:"",accountType:"股票",units:0,cost:0,currentValue:0,currency:"TWD"},[m,_]=ut.useState(f),[x,E]=ut.useState(null);ut.useEffect(()=>{!u&&e.length>0&&h(e[0].id)},[e,u]);const S=async()=>{a.trim()&&(await t.collection(`artifacts/${i}/users/${n}/assetAccounts`).add({name:a,assets:[]}),l(""),s({message:"帳戶新增成功！",type:"success",show:!0}))},T=async I=>{window.confirm("您確定嗎？這將會刪除該帳戶及其中的所有資產。")&&(I===u&&h(""),await t.doc(`artifacts/${i}/users/${n}/assetAccounts/${I}`).delete(),s({message:"帳戶已刪除。",type:"success",show:!0}))},R=async I=>{I.preventDefault();const C=e.find(at=>at.id===u);if(!C)return;const P=Number(m.units)||0,j=Number(m.cost)||0,F=Number(m.currentValue)||0;let k;switch(m.accountType){case"現金":k={...m,units:1,cost:F,currentValue:F};break;case"不動產":case"美元資產":k={...m,units:1,cost:j,currentValue:F};break;default:k={...m,units:P,cost:j,currentValue:F};break}const{id:nt,...bt}=k;let Y;if(x)Y=(C.assets||[]).map(at=>at.id===x?{...at,...bt}:at);else{const at={...bt,id:Date.now().toString()};Y=[...C.assets||[],at]}await t.doc(`artifacts/${i}/users/${n}/assetAccounts/${u}`).update({assets:Y}),_(f),E(null),s({message:`資產${x?"更新":"新增"}成功！`,type:"success",show:!0})},M=async()=>{s({message:"正在模擬抓取最新市價...",type:"info",show:!0});for(const I of e){if(!I.assets||I.assets.length===0)continue;const C=I.assets.map(P=>{if(P.accountType==="股票"||P.accountType==="ETF"){const j=(Math.random()-.45)*.1,F=parseFloat(String(P.currentValue))*(1+j);return{...P,currentValue:F}}return P});await t.doc(`artifacts/${i}/users/${n}/assetAccounts/${I.id}`).update({assets:C})}s({message:"所有投資標的市價已更新！",type:"success",show:!0})},L=I=>{_(I),E(I.id),window.scrollTo({top:0,behavior:"smooth"})},O=async I=>{const C=e.find(j=>j.id===u);if(!C)return;const P=C.assets.filter(j=>j.id!==I);await t.doc(`artifacts/${i}/users/${n}/assetAccounts/${u}`).update({assets:P}),s({message:"資產已刪除。",type:"success",show:!0})},H=I=>{const C=I.target.value;_({...f,accountType:C,currency:C==="美元資產"?"USD":"TWD"})},B=()=>{const I="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",C=(P,j,F,k,nt,bt)=>y.jsxs("div",{children:[y.jsx("label",{htmlFor:P,className:"block text-sm font-medium text-gray-700 mb-1",children:j}),y.jsx("input",{id:P,name:bt,type:F,placeholder:k,value:nt,onChange:Y=>_({...m,[bt]:Y.target.value}),className:I,required:!0})]});switch(m.accountType){case"股票":case"ETF":return y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[C("asset-code","股票/ETF 代號*","text","例如: 2330, 0050, AAPL",m.code,"code"),C("asset-units","持有股數/單位數*","number","例如: 1000 (股) or 2 (張)",m.units,"units"),C("asset-cost","平均買入成本 (每股)*","number","例如: 650.5",m.cost,"cost"),C("asset-currentValue","目前市價 (每股)*","number","例如: 680",m.currentValue,"currentValue")]});case"現金":return y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[C("asset-code","現金項目名稱*","text","例如: 台幣活存、緊急備用金",m.code,"code"),C("asset-currentValue","現金總額*","number","例如: 500000",m.currentValue,"currentValue")]});case"不動產":return y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[C("asset-code","房產地址/名稱*","text","例如: 台北市信義區的房子",m.code,"code"),C("asset-cost","購入總成本*","number","例如: 30000000",m.cost,"cost"),C("asset-currentValue","目前估計市價*","number","例如: 45000000",m.currentValue,"currentValue")]});case"美元資產":return y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[C("asset-code","資產名稱*","text","例如: 美元定存, 美元計價基金",m.code,"code"),C("asset-cost","投入成本 (USD)*","number","例如: 10000",m.cost,"cost"),C("asset-currentValue","目前價值 (USD)*","number","例如: 10500",m.currentValue,"currentValue")]});default:return null}},z=((D=e.find(I=>I.id===u))==null?void 0:D.assets)||[];return y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"p-6 border rounded-lg bg-gray-50 shadow-sm",children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"1. 管理資產帳戶"}),y.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:[y.jsx("input",{type:"text",value:a,onChange:I=>l(I.target.value),placeholder:"新帳戶名稱 (例如: 富邦證券)",className:"p-2 border rounded-md shadow-sm flex-grow"}),y.jsx("button",{onClick:S,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 shadow-sm transition-colors",children:"新增帳戶"})]}),e.length>0&&y.jsxs("div",{className:"mt-4 space-y-2",children:[y.jsx("p",{className:"text-sm font-medium text-gray-600",children:"現有帳戶:"}),e.map(I=>y.jsxs("div",{className:"flex justify-between items-center p-2 bg-white rounded-md border group",children:[y.jsx("span",{className:"text-gray-800",children:I.name}),y.jsx("button",{onClick:()=>T(I.id),className:"text-red-500 hover:text-red-700 text-sm opacity-50 group-hover:opacity-100 transition-opacity",children:"刪除"})]},I.id))]})]}),y.jsxs("div",{className:"p-6 border rounded-lg bg-white shadow-sm",children:[y.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"2. 管理帳戶內的資產"}),y.jsx("button",{onClick:M,className:"bg-blue-500 text-white text-sm px-4 py-2 rounded-md hover:bg-blue-600 shadow-sm transition-colors w-full sm:w-auto",children:"模擬獲取最新市價"})]}),y.jsxs("div",{className:"mb-6",children:[y.jsx("label",{htmlFor:"managing-account-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"選擇要管理的帳戶:"}),y.jsxs("select",{id:"managing-account-select",value:u,onChange:I=>h(I.target.value),className:"w-full p-2 border rounded-md shadow-sm bg-white",disabled:e.length===0,children:[y.jsx("option",{value:"",children:e.length>0?"— 請選擇 —":"請先新增一個帳戶"}),e.map(I=>y.jsx("option",{value:I.id,children:I.name},I.id))]})]}),u&&y.jsxs(y.Fragment,{children:[y.jsxs("form",{onSubmit:R,className:"mb-6 p-4 border rounded-lg bg-gray-50 space-y-4",children:[y.jsx("h4",{className:"font-semibold text-gray-700",children:x?"編輯資產":"新增資產"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"asset-type",className:"block text-sm font-medium text-gray-700 mb-1",children:"資產類型*"}),y.jsxs("select",{id:"asset-type",value:m.accountType,onChange:H,className:"w-full p-2 border border-gray-300 rounded-md bg-white shadow-sm focus:ring-indigo-500 focus:border-indigo-500",children:[y.jsx("option",{value:"股票",children:"股票 (Stock)"}),y.jsx("option",{value:"ETF",children:"ETF"}),y.jsx("option",{value:"現金",children:"現金 (Cash)"}),y.jsx("option",{value:"不動產",children:"不動產 (Real Estate)"}),y.jsx("option",{value:"美元資產",children:"其他美元計價資產"})]})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"asset-currency",className:"block text-sm font-medium text-gray-700 mb-1",children:"幣別*"}),y.jsxs("select",{id:"asset-currency",name:"currency",value:m.currency,disabled:m.accountType==="美元資產",onChange:I=>_({...m,currency:I.target.value}),className:"w-full p-2 border border-gray-300 rounded-md bg-white shadow-sm focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100",children:[y.jsx("option",{value:"TWD",children:"TWD"}),y.jsx("option",{value:"USD",children:"USD"})]})]})]}),B(),y.jsxs("div",{className:"col-span-full flex justify-end space-x-3 pt-2",children:[x&&y.jsx("button",{type:"button",onClick:()=>{E(null),_(f)},className:"bg-gray-200 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-300 font-medium",children:"取消編輯"}),y.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 font-medium shadow-sm",children:x?"更新資產":"新增資產"})]})]}),y.jsx("h4",{className:"text-md font-medium mb-3 text-gray-700",children:"帳戶資產列表"}),y.jsxs("div",{className:"overflow-x-auto shadow-md rounded-lg",children:[y.jsxs("table",{className:"min-w-full text-sm text-left text-gray-500",children:[y.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:y.jsxs("tr",{children:[y.jsx("th",{scope:"col",className:"px-4 py-3",children:"代號/名稱"}),y.jsx("th",{scope:"col",className:"px-4 py-3",children:"類型"}),y.jsx("th",{scope:"col",className:"px-4 py-3 text-right",children:"單位"}),y.jsx("th",{scope:"col",className:"px-4 py-3 text-right",children:"成本"}),y.jsx("th",{scope:"col",className:"px-4 py-3 text-right",children:"現價"}),y.jsx("th",{scope:"col",className:"px-4 py-3",children:"幣別"}),y.jsx("th",{scope:"col",className:"px-4 py-3 text-center",children:"操作"})]})}),y.jsx("tbody",{children:z.map(I=>y.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50 transition-colors",children:[y.jsx("td",{className:"px-4 py-2 font-medium text-gray-900 whitespace-nowrap",children:I.code}),y.jsx("td",{className:"px-4 py-2",children:I.accountType}),y.jsx("td",{className:"px-4 py-2 text-right",children:I.units.toLocaleString()}),y.jsx("td",{className:"px-4 py-2 text-right",children:I.cost.toLocaleString()}),y.jsx("td",{className:"px-4 py-2 text-right",children:I.currentValue.toLocaleString()}),y.jsx("td",{className:"px-4 py-2",children:I.currency}),y.jsxs("td",{className:"px-4 py-2 text-center",children:[y.jsx("button",{onClick:()=>L(I),className:"font-medium text-indigo-600 hover:text-indigo-900 mr-4",children:"編輯"}),y.jsx("button",{onClick:()=>O(I.id),className:"font-medium text-red-600 hover:text-red-900",children:"刪除"})]})]},I.id))})]}),z.length===0&&y.jsx("p",{className:"text-center text-gray-500 py-6 bg-white",children:"此帳戶尚無資產。"})]})]})]})]})},G9=({userId:n,db:t,budgets:e,cashflowRecords:s,settings:i,setNotification:a,appId:l})=>{const[u,h]=ut.useState(new Date().toISOString().slice(0,7)),[f,m]=ut.useState({}),_=[...mg.expense,...i.customExpense||[]];ut.useEffect(()=>{const L=e.filter(O=>O.month===u).reduce((O,H)=>({...O,[H.category]:String(H.amount)}),{});m(L)},[u,e]);const{monthlySpending:x,averageSpending:E}=ut.useMemo(()=>{const M={},L={};s.filter(D=>D.date.startsWith(u)&&D.type==="expense").forEach(D=>{M[D.category]=(M[D.category]||0)+D.amount});const O=new Date(u);O.setMonth(O.getMonth()-3);const H=O.toISOString().slice(0,7),B=s.filter(D=>D.type==="expense"&&D.date>=H&&D.date<u),z={};return B.forEach(D=>{const I=D.date.slice(0,7);z[I]||(z[I]={}),z[I][D.category]=(z[I][D.category]||0)+D.amount}),_.forEach(D=>{let I=0,C=0;Object.values(z).forEach(P=>{P[D]&&(I+=P[D],C++)}),C>0&&(L[D]=I/C)}),{monthlySpending:M,averageSpending:L}},[u,s,_]),S=(M,L)=>{m(O=>({...O,[M]:L}))},T=()=>{const M=new Date(u+"-02");M.setMonth(M.getMonth()-1);const L=M.toISOString().slice(0,7),O=e.filter(B=>B.month===L);if(O.length===0){a({message:"上個月沒有設定預算可供複製。",type:"info",show:!0});return}const H=O.reduce((B,z)=>({...B,[z.category]:String(z.amount)}),{});m(H),a({message:`已從 ${L} 複製 ${Object.keys(H).length} 個預算項目。請記得儲存變更。`,type:"success",show:!0})},R=async()=>{try{const M=t.batch(),L=`artifacts/${l}/users/${n}/budgets`;for(const O of _){const H=f[O],B=H?parseFloat(H):0,z=e.find(D=>D.month===u&&D.category===O);if(z)if(B>0){if(z.amount!==B){const D=t.doc(`${L}/${z.id}`);M.update(D,{amount:B})}}else{const D=t.doc(`${L}/${z.id}`);M.delete(D)}else if(B>0){const D=t.collection(L).doc();M.set(D,{month:u,category:O,amount:B})}}await M.commit(),a({message:"預算儲存成功！",type:"success",show:!0})}catch(M){console.error("Error saving budgets:",M),a({message:"儲存預算時發生錯誤。",type:"error",show:!0})}};return y.jsxs("div",{className:"p-6 border rounded-lg bg-gray-50 shadow-sm",children:[y.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center mb-6 gap-4",children:[y.jsxs("div",{className:"flex items-center space-x-4",children:[y.jsx("label",{htmlFor:"budget-month",className:"text-md font-medium text-gray-700",children:"選擇月份:"}),y.jsx("input",{type:"month",id:"budget-month",value:u,onChange:M=>h(M.target.value),className:"p-2 border rounded-md shadow-sm bg-white"})]}),y.jsxs("button",{onClick:T,className:"bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 shadow-sm transition-colors font-medium flex items-center justify-center text-sm",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2"})}),"從上個月複製"]}),y.jsx("button",{onClick:R,className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 shadow-sm transition-colors font-medium",children:"儲存所有預算"})]}),y.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-x-8 gap-y-4",children:_.map(M=>{const L=x[M]||0,O=parseFloat(f[M])||0,H=O-L,B=O>0,z=E[M];return y.jsxs("div",{className:"grid grid-cols-2 items-center gap-2",children:[y.jsxs("label",{className:"text-right font-medium text-gray-700",children:[M,":"]}),y.jsxs("div",{children:[y.jsxs("div",{className:"relative",children:[y.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:"$"}),y.jsx("input",{type:"number",value:f[M]||"",onChange:D=>S(M,D.target.value),placeholder:"設定預算",className:"p-2 pl-7 border rounded-md shadow-sm w-full"})]}),y.jsx("div",{className:"text-xs mt-1 text-right h-4",children:B?y.jsxs("p",{className:`${H>=0?"text-gray-500":"text-red-500 font-bold"}`,children:["已支出: ",L.toLocaleString(),", ",H>=0?`剩餘: ${H.toLocaleString()}`:`超支: ${Math.abs(H).toLocaleString()}`]}):L>0?y.jsxs("p",{className:"text-gray-500",children:["已支出: ",L.toLocaleString()]}):z&&y.jsxs("p",{className:"text-gray-400 italic",children:["近3個月平均: ",Math.round(z).toLocaleString()]})})]})]},M)})}),y.jsx("div",{className:"mt-6 flex justify-end",children:y.jsx("button",{onClick:R,className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 shadow-sm transition-colors font-medium",children:"儲存所有預算"})})]})},$9=({userId:n,db:t,goals:e,assetAccounts:s,setNotification:i,appId:a,effectiveUsdToTwdRate:l})=>{const u={name:"",targetAmount:"",currentAmount:"",targetDate:"",linkedAccountIds:[]},[h,f]=ut.useState(u),[m,_]=ut.useState(null),x=ut.useMemo(()=>s.map(O=>{const H=(O.assets||[]).reduce((B,z)=>{const D=z.currency==="USD"?l:1,I=parseFloat(String(z.currentValue))||0,C=parseFloat(String(z.units))||0;return B+I*C*D},0);return{id:O.id,name:O.name,totalValueTWD:H}}).sort((O,H)=>H.totalValueTWD-O.totalValueTWD),[s,l]);ut.useEffect(()=>{const O=(h.linkedAccountIds||[]).reduce((H,B)=>{const z=x.find(D=>D.id===B);return H+((z==null?void 0:z.totalValueTWD)||0)},0);h.linkedAccountIds.length>0&&f(H=>({...H,currentAmount:O.toFixed(0)}))},[h.linkedAccountIds,x]);const E=O=>{f(H=>{const B=H.linkedAccountIds||[],z=B.includes(O)?B.filter(D=>D!==O):[...B,O];return z.length===0?{...H,linkedAccountIds:[],currentAmount:""}:{...H,linkedAccountIds:z}})},S=O=>{const{name:H,value:B}=O.target;f(z=>({...z,[H]:B}))},T=async O=>{O.preventDefault();const H={name:h.name,targetAmount:parseFloat(h.targetAmount)||0,targetDate:h.targetDate,linkedAccountIds:h.linkedAccountIds||[]};H.linkedAccountIds.length===0&&(H.currentAmount=parseFloat(h.currentAmount)||0);const B=`artifacts/${a}/users/${n}/goals`;m?(await t.doc(`${B}/${m}`).set(H),i({message:"目標更新成功！",type:"success",show:!0})):(await t.collection(B).add(H),i({message:"目標新增成功！",type:"success",show:!0})),f(u),_(null)},R=O=>{f({name:O.name,targetAmount:String(O.targetAmount),currentAmount:String(O.currentAmount||0),targetDate:O.targetDate,linkedAccountIds:O.linkedAccountIds||[]}),_(O.id),window.scrollTo({top:0,behavior:"smooth"})},M=async O=>{window.confirm("您確定要刪除這個目標嗎？")&&(await t.doc(`artifacts/${a}/users/${n}/goals/${O}`).delete(),i({message:"目標已刪除。",type:"success",show:!0}))},L=h.linkedAccountIds&&h.linkedAccountIds.length>0;return y.jsxs("div",{children:[y.jsxs("form",{onSubmit:T,className:"mb-8 p-6 border rounded-lg bg-gray-50 space-y-4 shadow-sm",children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:m?"編輯財務目標":"新增財務目標"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"目標名稱*"}),y.jsx("input",{name:"name",value:h.name,onChange:S,placeholder:"例如: 購車基金",className:"mt-1 w-full p-2 border rounded-md shadow-sm",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"目標金額 (TWD)*"}),y.jsx("input",{type:"number",name:"targetAmount",value:h.targetAmount,onChange:S,placeholder:"例如: 500000",className:"mt-1 w-full p-2 border rounded-md shadow-sm",required:!0})]}),y.jsxs("div",{className:"md:col-span-2",children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"連結資產帳戶 (選填)"}),y.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"選擇一個或多個帳戶，將自動加總其目前價值作為已存金額。"}),y.jsx("div",{className:"p-2 border rounded-md bg-white shadow-sm max-h-32 overflow-y-auto space-y-1",children:x.map(O=>y.jsxs("div",{className:"flex items-center",children:[y.jsx("input",{type:"checkbox",id:`acc-${O.id}`,checked:(h.linkedAccountIds||[]).includes(O.id),onChange:()=>E(O.id),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),y.jsxs("label",{htmlFor:`acc-${O.id}`,className:"ml-2 text-sm text-gray-700",children:[O.name," ($",O.totalValueTWD.toLocaleString(void 0,{maximumFractionDigits:0}),")"]})]},O.id))})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:L?"目前已存金額 (自動計算)":"目前已存金額 (手動輸入)*"}),y.jsx("input",{type:"number",name:"currentAmount",value:h.currentAmount,onChange:S,placeholder:L?"由連結帳戶計算":"例如: 150000",className:"mt-1 w-full p-2 border rounded-md shadow-sm disabled:bg-gray-100 disabled:text-gray-500",required:!0,disabled:L})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"目標日期"}),y.jsx("input",{type:"date",name:"targetDate",value:h.targetDate,onChange:S,className:"mt-1 w-full p-2 border rounded-md shadow-sm"})]})]}),y.jsxs("div",{className:"flex justify-end space-x-3 pt-2",children:[m&&y.jsx("button",{type:"button",onClick:()=>{_(null),f(u)},className:"bg-gray-200 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-300 font-medium",children:"取消"}),y.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 font-medium shadow-sm",children:m?"更新目標":"新增目標"})]})]}),y.jsxs("div",{className:"space-y-4",children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"現有目標"}),e.map(O=>{const H=O.linkedAccountIds&&O.linkedAccountIds.length>0?(O.linkedAccountIds||[]).reduce((D,I)=>{const C=x.find(P=>P.id===I);return D+((C==null?void 0:C.totalValueTWD)||0)},0):O.currentAmount||0,B=Math.min(H/O.targetAmount*100,100),z=(O.linkedAccountIds||[]).map(D=>{var I;return(I=s.find(C=>C.id===D))==null?void 0:I.name}).filter(Boolean).join(", ");return y.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm transition-shadow hover:shadow-md",children:[y.jsxs("div",{className:"flex justify-between items-start mb-2",children:[y.jsxs("div",{children:[y.jsx("h4",{className:"font-bold text-gray-800",children:O.name}),y.jsxs("p",{className:"text-xs text-gray-500",children:["目標日期: ",O.targetDate||"未設定",z&&` | 連結帳戶: ${z}`]})]}),y.jsxs("div",{children:[y.jsx("button",{onClick:()=>R(O),className:"text-indigo-600 hover:text-indigo-900 mr-3 text-sm font-medium",children:"編輯"}),y.jsx("button",{onClick:()=>M(O.id),className:"text-red-600 hover:text-red-900 text-sm font-medium",children:"刪除"})]})]}),y.jsxs("p",{className:"text-gray-700 text-sm mt-3",children:["$",H.toLocaleString(void 0,{maximumFractionDigits:0})," / ",y.jsxs("span",{className:"font-medium",children:["$",O.targetAmount.toLocaleString()]})]}),y.jsxs("div",{className:"mt-1",children:[y.jsxs("div",{className:"flex justify-between mb-1",children:[y.jsx("span",{className:"text-xs font-medium text-blue-700",children:"進度"}),y.jsxs("span",{className:"text-sm font-medium text-blue-700",children:[B.toFixed(1),"%"]})]}),y.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:y.jsx("div",{className:"bg-gradient-to-r from-green-400 to-blue-500 h-2.5 rounded-full transition-all duration-1000 ease-out",style:{width:`${B}%`}})})]})]},O.id)}),e.length===0&&y.jsx("p",{className:"text-gray-500 text-center py-6",children:"尚未新增任何財務目標。"})]})]})},W9=n=>{const{userId:t,db:e,settings:s,setNotification:i,appId:a,assetAccounts:l,cashflowRecords:u,budgets:h,goals:f}=n,[m,_]=ut.useState(""),[x,E]=ut.useState(""),[S,T]=ut.useState(s.manualRate||""),[R,M]=ut.useState(""),[L,O]=ut.useState(""),[H,B]=ut.useState("financial_data.json"),[z,D]=ut.useState(null),[I,C]=ut.useState(!1),[P,j]=ut.useState("同步中...");ut.useEffect(()=>{T(s.manualRate||""),M(localStorage.getItem("githubToken")||""),O(localStorage.getItem("githubRepo")||""),B(localStorage.getItem("githubPath")||"financial_data.json"),D(localStorage.getItem("lastSync"))},[s.manualRate]);const F=()=>{localStorage.setItem("githubToken",R),localStorage.setItem("githubRepo",L),localStorage.setItem("githubPath",H),i({message:"GitHub settings saved locally in your browser.",type:"info",show:!0})},k=()=>({assetAccounts:l,cashflowRecords:u,budgets:h,goals:f,settings:s,backupTimestamp:new Date().toISOString()}),nt=()=>{C(!0),j("正在產生備份檔案..."),setTimeout(()=>{try{const U=k(),st=JSON.stringify(U,null,2),ht=new Blob([st],{type:"application/json"}),dt=URL.createObjectURL(ht),yt=document.createElement("a");yt.href=dt,yt.download="financial_data_backup.json",document.body.appendChild(yt),yt.click(),document.body.removeChild(yt),URL.revokeObjectURL(dt),i({message:"備份檔案已成功下載！",type:"success",show:!0})}catch(U){console.error("Backup file generation error:",U);const st=U instanceof Error?U.message:"An unknown error occurred.";i({message:`產生備份檔案失敗: ${st}`,type:"error",show:!0})}finally{C(!1)}},50)},bt=async()=>{if(!R||!L||!H){i({message:"請填寫完整的 GitHub 同步設定。",type:"error",show:!0});return}C(!0),j("正在同步至 GitHub...");const U=`https://api.github.com/repos/${L}/contents/${H}`,st={Authorization:`Bearer ${R}`,Accept:"application/vnd.github.v3+json"};try{let ht;try{const Fe=await fetch(U,{headers:st});if(Fe.ok)ht=(await Fe.json()).sha;else if(Fe.status!==404)throw new Error(`無法讀取 GitHub 檔案: ${Fe.statusText}`)}catch(Fe){console.warn("Could not fetch current file SHA, proceeding without it.",Fe)}const dt=k(),yt=JSON.stringify(dt,null,2),kt=btoa(unescape(encodeURIComponent(yt))),At=JSON.stringify({message:`Sync financial data: ${new Date().toISOString()}`,content:kt,sha:ht}),Ie=await fetch(U,{method:"PUT",headers:st,body:At});if(!Ie.ok)throw new Error(`GitHub API 錯誤: ${(await Ie.json()).message}`);const te=new Date().toLocaleString();D(te),localStorage.setItem("lastSync",te),i({message:"資料已成功同步至 GitHub！",type:"success",show:!0})}catch(ht){console.error("GitHub Sync Error:",ht);const dt=ht instanceof Error?ht.message:"An unknown error occurred.";i({message:`同步失敗: ${dt}`,type:"error",show:!0})}finally{C(!1)}},Y=async()=>{if(!R||!L||!H){i({message:"請填寫完整的 GitHub 同步設定。",type:"error",show:!0});return}if(!window.confirm("您確定要從 GitHub 載入資料嗎？這將會覆寫您目前的所有本地資料！"))return;C(!0),j("正在從 GitHub 載入...");const U=`https://api.github.com/repos/${L}/contents/${H}`;try{const st=await fetch(U,{headers:{Authorization:`Bearer ${R}`,Accept:"application/vnd.github.v3+json"}});if(!st.ok)throw new Error(`無法讀取 GitHub 檔案: ${st.statusText}`);const ht=await st.json(),dt=decodeURIComponent(escape(atob(ht.content))),yt=JSON.parse(dt),kt=[{name:"assetAccounts",data:yt.assetAccounts||[]},{name:"cashflowRecords",data:yt.cashflowRecords||[]},{name:"budgets",data:yt.budgets||[]},{name:"goals",data:yt.goals||[]}];j("正在寫入資料庫...");for(const At of kt){const Ie=`artifacts/${a}/users/${t}/${At.name}`,te=await e.collection(Ie).get(),Fe=e.batch();te.docs.forEach(Ks=>Fe.delete(Ks.ref)),await Fe.commit();const ur=e.batch();At.data.forEach(Ks=>{const{id:Ti,...wi}=Ks,hr=Ti?e.collection(Ie).doc(Ti):e.collection(Ie).doc();ur.set(hr,wi)}),await ur.commit()}await e.doc(`artifacts/${a}/users/${t}/settings/userSettings`).set(yt.settings||{}),i({message:"資料已成功從 GitHub 載入並同步！",type:"success",show:!0})}catch(st){console.error("GitHub Load Error:",st);const ht=st instanceof Error?st.message:"An unknown error occurred.";i({message:`載入失敗: ${ht}`,type:"error",show:!0})}finally{C(!1)}},at=async()=>{const U={...s,manualRate:parseFloat(String(S))||null};await e.doc(`artifacts/${a}/users/${t}/settings/userSettings`).set(U,{merge:!0}),i({message:"設定已儲存！",type:"success",show:!0})},mt=async U=>{const st=U==="income"?m.trim():x.trim();if(!st)return;const ht=U==="income"?"customIncome":"customExpense",dt=s[ht]||[];if(dt.includes(st)){i({message:"類別已存在。",type:"error",show:!0});return}await e.doc(`artifacts/${a}/users/${t}/settings/userSettings`).set({[ht]:[...dt,st]},{merge:!0}),U==="income"?_(""):E(""),i({message:"類別新增成功！",type:"success",show:!0})},Dt=async(U,st)=>{if(window.confirm(`您確定要移除「${st}」這個類別嗎？`)){const ht=U==="income"?"customIncome":"customExpense",dt=(s[ht]||[]).filter(yt=>yt!==st);await e.doc(`artifacts/${a}/users/${t}/settings/userSettings`).set({[ht]:dt},{merge:!0}),i({message:"類別已移除。",type:"success",show:!0})}};return y.jsxs("div",{className:"relative",children:[I&&y.jsxs("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center z-50 rounded-lg",children:[y.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600"}),y.jsx("p",{className:"text-lg text-gray-700 mt-4 font-semibold",children:P})]}),y.jsxs("div",{className:`space-y-8 max-w-3xl mx-auto ${I?"filter blur-sm":""}`,children:[y.jsxs("div",{className:"p-6 border rounded-xl bg-white shadow-lg",children:[y.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-2 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-3 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12s-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"GitHub 同步"]}),y.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"將您的財務資料安全地備份至私有 GitHub 儲存庫，實現跨裝置同步。"}),y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"GitHub Personal Access Token (PAT)"}),y.jsx("input",{type:"password",value:R,onChange:U=>M(U.target.value),onBlur:F,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm",placeholder:"ghp_xxxxxxxxxxxxxxxxxxxx"}),y.jsxs("div",{className:"mt-1 text-xs text-gray-500 p-2 bg-gray-50 rounded-md border",children:[y.jsxs("p",{children:["1. 前往您的 GitHub ",y.jsx("a",{href:"https://github.com/settings/tokens",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline font-semibold",children:"開發者設定"}),"。"]}),y.jsx("p",{children:'2. 點擊 "Generate new token" 並選擇 "Generate new token (classic)"。'}),y.jsxs("p",{children:["3. ",y.jsxs("strong",{children:["最重要的一步：請務必勾選授予 ",y.jsx("code",{className:"text-xs bg-gray-200 p-1 rounded",children:"repo"})," 權限"]}),"，以允許此應用程式讀寫您的儲存庫。"]}),y.jsx("strong",{className:"block text-red-600 mt-2",children:"警告：此金鑰將儲存在您的瀏覽器本地儲存空間中。請勿在公共或不信任的電腦上使用此功能。"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"儲存庫 (Repository)"}),y.jsx("input",{type:"text",value:L,onChange:U=>O(U.target.value),onBlur:F,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm",placeholder:"your_username/your_repo_name"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"檔案路徑 (File Path)"}),y.jsx("input",{type:"text",value:H,onChange:U=>B(U.target.value),onBlur:F,className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm"})]})]}),y.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-4",children:[y.jsxs("button",{onClick:bt,disabled:I,className:"flex-1 bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700 transition-colors shadow-sm flex items-center justify-center font-semibold disabled:bg-green-300",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),I?"同步中...":"儲存至 GitHub"]}),y.jsxs("button",{onClick:Y,disabled:I,className:"flex-1 bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors shadow-sm flex items-center justify-center font-semibold disabled:bg-blue-300",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),I?"載入中...":"從 GitHub 載入"]})]}),z&&y.jsxs("p",{className:"text-xs text-gray-500 mt-4 text-center",children:["上次同步時間: ",z]})]}),y.jsxs("div",{className:"p-6 border rounded-xl bg-white shadow-lg",children:[y.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-3 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"手動資料匯出 / 備份"]}),y.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"點擊按鈕將您的所有應用程式資料匯出為一個 JSON 檔案作為手動備份。"}),y.jsx("div",{className:"flex justify-center",children:y.jsxs("button",{onClick:nt,disabled:I,className:"w-full sm:w-auto bg-gray-600 text-white px-6 py-3 rounded-md hover:bg-gray-700 transition-colors shadow-sm flex items-center justify-center font-semibold disabled:bg-gray-400",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"下載手動備份"]})})]}),y.jsxs("div",{className:"p-6 border rounded-xl bg-white shadow-lg",children:[y.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-3 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 012-2h2a2 2 0 012 2v1m-6 0h6"})}),"自訂類別"]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[y.jsxs("div",{children:[y.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"收入類別"}),y.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[y.jsx("input",{value:m,onChange:U=>_(U.target.value),onKeyPress:U=>{U.key==="Enter"&&mt("income")},placeholder:"新增收入類別",className:"flex-grow p-2 border rounded-md"}),y.jsx("button",{onClick:()=>mt("income"),className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition-colors",children:"新增"})]}),y.jsx("ul",{className:"space-y-2",children:(s.customIncome||[]).map(U=>y.jsxs("li",{className:"flex justify-between items-center bg-gray-50 p-2 rounded-md group",children:[y.jsx("span",{className:"text-gray-700",children:U}),y.jsx("button",{onClick:()=>Dt("income",U),className:"text-gray-400 opacity-0 group-hover:opacity-100 h-t-r",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},U))})]}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"支出類別"}),y.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[y.jsx("input",{value:x,onChange:U=>E(U.target.value),onKeyPress:U=>{U.key==="Enter"&&mt("expense")},placeholder:"新增支出類別",className:"flex-grow p-2 border rounded-md"}),y.jsx("button",{onClick:()=>mt("expense"),className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition-colors",children:"新增"})]}),y.jsx("ul",{className:"space-y-2",children:(s.customExpense||[]).map(U=>y.jsxs("li",{className:"flex justify-between items-center bg-gray-50 p-2 rounded-md group",children:[y.jsx("span",{className:"text-gray-700",children:U}),y.jsx("button",{onClick:()=>Dt("expense",U),className:"text-gray-400 opacity-0 group-hover:opacity-100 h-t-r",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},U))})]})]})]}),y.jsxs("div",{className:"p-6 border rounded-xl bg-white shadow-lg",children:[y.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-3 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v.01"})}),"匯率設定"]}),y.jsxs("div",{className:"flex items-center space-x-4",children:[y.jsx("label",{className:"font-medium text-gray-700",children:"USD-TWD 手動匯率:"}),y.jsx("input",{type:"number",step:"any",value:S,onChange:U=>T(U.target.value),className:"p-2 border border-gray-300 rounded-md shadow-sm",placeholder:"例如: 32.5"})]}),y.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"* 留白則使用系統預設匯率。"})]}),y.jsx("div",{className:"flex justify-end pt-6 border-t mt-8",children:y.jsx("button",{onClick:at,className:"bg-blue-600 text-white px-8 py-2.5 rounded-lg hover:bg-blue-700 shadow-md font-semibold transition-transform transform hover:scale-105",children:"儲存所有設定"})})]})]})},Y9={cashflow:n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),assets:n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),budgets:n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M12 8h.01M15 8h.01M15 14h.01M18 17h.01M18 14h.01M18 11h.01M18 8h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),goals:n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6H8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"})}),settings:n=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})},K9=n=>{const[t,e]=ut.useState("cashflow"),s=()=>{switch(t){case"assets":return y.jsx(q9,{...n});case"cashflow":return y.jsx(H9,{...n});case"budgets":return y.jsx(G9,{...n});case"goals":return y.jsx($9,{...n});case"settings":return y.jsx(W9,{...n});default:return null}},i=[{id:"cashflow",label:"收支管理"},{id:"assets",label:"資產管理"},{id:"budgets",label:"預算管理"},{id:"goals",label:"目標管理"},{id:"settings",label:"系統設定"}];return y.jsxs("div",{children:[y.jsx(cr,{title:"資料管理中心"}),y.jsx("div",{className:"border-b border-gray-200 mb-6",children:y.jsx("nav",{className:"-mb-px flex space-x-6 overflow-x-auto","aria-label":"Tabs",children:i.map(a=>{const l=Y9[a.id];return y.jsxs("button",{onClick:()=>e(a.id),className:`${t===a.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm capitalize transition-colors duration-200`,children:[y.jsx(l,{className:"h-5 w-5 mr-2"}),a.label]},a.id)})})}),y.jsx("div",{className:"mt-6",children:s()})]})},Q9=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),ky=15,X9=({assetAccounts:n})=>{const[t,e]=ut.useState(null),[s,i]=ut.useState({key:"currentValueTWD",direction:"descending"}),[a,l]=ut.useState(1);ut.useEffect(()=>{n.length>0&&!t||n.length>0&&!n.find(S=>S.id===t)?(e(n[0].id),l(1)):n.length===0&&e(null)},[n,t]);const u=n.find(S=>S.id===t),h=ut.useMemo(()=>!u||!u.assets?0:u.assets.reduce((S,T)=>S+(T.currentValueTWD||0),0),[u]),f=ut.useMemo(()=>{l(1);const S=u==null?void 0:u.assets;if(!S)return[];const T=[...S];return T.sort((R,M)=>{const L=R[s.key]??(s.key==="code"?"":0),O=M[s.key]??(s.key==="code"?"":0);return L<O?s.direction==="ascending"?-1:1:L>O?s.direction==="ascending"?1:-1:0}),T},[u,s]),m=ut.useMemo(()=>{const S=(a-1)*ky;return f.slice(S,S+ky)},[f,a]),_=Math.ceil(f.length/ky),x=S=>{let T="ascending";s.key===S&&s.direction==="ascending"&&(T="descending"),i({key:S,direction:T})},E=S=>s.key!==S?null:s.direction==="ascending"?" ▲":" ▼";return y.jsxs(ln,{children:[y.jsx(cr,{title:"資產總覽",subtitle:"此頁面為您的資產總覽。如需新增、編輯或刪除資產，請前往「資料管理」頁面。"}),n.length===0?y.jsx("div",{className:"mt-8",children:y.jsx(Cd,{Icon:Q9,title:"尚未建立任何資產帳戶",message:"請先至「資料管理」頁面的「資產管理」分頁新增您的第一個帳戶，再來此處查看總覽。"})}):y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"mb-6",children:[y.jsx("label",{htmlFor:"account-select",className:"block text-sm font-medium text-gray-700 mb-2",children:"選擇資產帳戶:"}),y.jsx("select",{id:"account-select",className:"mt-1 block w-full md:w-1/2 pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md shadow-sm",value:t||"",onChange:S=>e(S.target.value),children:n.map(S=>y.jsx("option",{value:S.id,children:S.name},S.id))})]}),u?y.jsxs("div",{className:"mt-8",children:[y.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center mb-4 p-4 bg-gray-50 rounded-lg border",children:[y.jsxs("h3",{className:"text-2xl font-semibold text-gray-800",children:[u.name," 的資產"]}),y.jsxs("div",{className:"text-right",children:[y.jsx("p",{className:"text-sm text-gray-600",children:"帳戶總價值 (TWD)"}),y.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["$",h.toLocaleString(void 0,{maximumFractionDigits:0})]})]})]}),u.assets&&u.assets.length>0?y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"overflow-x-auto relative shadow-md sm:rounded-lg mt-6",children:y.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[y.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:y.jsxs("tr",{children:[y.jsxs("th",{scope:"col",className:"py-3 px-6 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>x("code"),children:["代號/名稱",E("code")]}),y.jsx("th",{scope:"col",className:"py-3 px-6",children:"單位"}),y.jsx("th",{scope:"col",className:"py-3 px-6",children:"成本"}),y.jsx("th",{scope:"col",className:"py-3 px-6",children:"幣別"}),y.jsxs("th",{scope:"col",className:"py-3 px-6 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>x("currentValueTWD"),children:["當前價值 (TWD)",E("currentValueTWD")]}),y.jsxs("th",{scope:"col",className:"py-3 px-6 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>x("profitLossTWD"),children:["損益 (TWD)",E("profitLossTWD")]})]})}),y.jsx("tbody",{children:m.map((S,T)=>{const R=S.profitLossTWD||0;return y.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50",children:[y.jsx("td",{className:"py-4 px-6 font-medium text-gray-900 whitespace-nowrap",children:S.code}),y.jsx("td",{className:"py-4 px-6",children:S.units.toLocaleString()}),y.jsx("td",{className:"py-4 px-6",children:S.cost.toLocaleString()}),y.jsx("td",{className:"py-4 px-6",children:S.currency}),y.jsx("td",{className:"py-4 px-6",children:(S.currentValueTWD||0).toLocaleString(void 0,{maximumFractionDigits:0})}),y.jsx("td",{className:`py-4 px-6 font-semibold ${R>=0?"text-green-600":"text-red-600"}`,children:R.toLocaleString(void 0,{maximumFractionDigits:0})})]},S.id||T)})})]})}),_>1&&y.jsxs("div",{className:"flex justify-between items-center mt-4",children:[y.jsx("button",{onClick:()=>l(S=>Math.max(1,S-1)),disabled:a===1,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"上一頁"}),y.jsxs("span",{className:"text-sm text-gray-700",children:["第 ",a," 頁 / 共 ",_," 頁"]}),y.jsx("button",{onClick:()=>l(S=>Math.min(_,S+1)),disabled:a===_,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"下一頁"})]})]}):y.jsx("p",{className:"text-gray-500 text-center py-8",children:"此帳戶中沒有資產，快去「資料管理」新增吧！"})]}):y.jsx("p",{className:"text-center text-gray-500 py-12",children:"請選擇一個帳戶以查看其資產。"})]})]})},Z9=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),Vy=25,J9=({cashflowRecords:n})=>{const[t,e]=ut.useState({key:"date",direction:"descending"}),[s,i]=ut.useState(1),a=new Date().toISOString().slice(0,7),l=ut.useMemo(()=>{const x=n.filter(R=>R.date.startsWith(a)),E=x.filter(R=>R.type==="income").reduce((R,M)=>R+M.amount,0),S=x.filter(R=>R.type==="expense").reduce((R,M)=>R+M.amount,0),T=E-S;return{income:E,expense:S,net:T}},[n,a]),u=ut.useMemo(()=>{if(i(1),n.length===0)return[];let x=[...n];return x.sort((E,S)=>{const T=E[t.key],R=S[t.key];return T<R?t.direction==="ascending"?-1:1:T>R?t.direction==="ascending"?1:-1:0}),x},[n,t]),h=ut.useMemo(()=>{const x=(s-1)*Vy;return u.slice(x,x+Vy)},[u,s]),f=Math.ceil(u.length/Vy),m=x=>{let E="ascending";t.key===x&&t.direction==="ascending"&&(E="descending"),e({key:x,direction:E})},_=[{key:"date",label:"日期"},{key:"type",label:"類型"},{key:"category",label:"類別"},{key:"amount",label:"金額"},{key:"currency",label:"幣別"},{key:"accountName",label:"帳戶"},{key:"description",label:"說明"}];return y.jsxs(ln,{children:[y.jsx(cr,{title:"收支管理 & 帳本",subtitle:"此頁面為您的收支記錄。如需新增、編輯或刪除記錄，請前往「資料管理」頁面。"}),y.jsxs("div",{className:"mb-8 p-4 bg-gray-50 rounded-lg border",children:[y.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:["本月 (",a,") 財務快照"]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center",children:[y.jsxs("div",{children:[y.jsx("p",{className:"text-sm font-medium text-green-600",children:"總收入"}),y.jsxs("p",{className:"text-2xl font-bold text-green-700",children:["$",l.income.toLocaleString()]})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-sm font-medium text-red-600",children:"總支出"}),y.jsxs("p",{className:"text-2xl font-bold text-red-700",children:["$",l.expense.toLocaleString()]})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-sm font-medium text-blue-600",children:"淨儲蓄"}),y.jsxs("p",{className:`text-2xl font-bold ${l.net>=0?"text-blue-700":"text-red-700"}`,children:["$",l.net.toLocaleString()]})]})]})]}),y.jsx("div",{className:"mt-8",children:n.length>0?y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"overflow-x-auto relative shadow-md sm:rounded-lg",children:y.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[y.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:y.jsx("tr",{children:_.map(({key:x,label:E})=>y.jsxs("th",{scope:"col",className:"py-3 px-6 cursor-pointer",onClick:()=>m(x),children:[E,t.key===x?t.direction==="ascending"?" ▲":" ▼":""]},x))})}),y.jsx("tbody",{children:h.map(x=>y.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50",children:[y.jsx("td",{className:"py-4 px-6",children:x.date}),y.jsx("td",{className:`py-4 px-6 font-medium ${x.type==="income"?"text-green-600":"text-red-600"}`,children:x.type==="income"?"收入":"支出"}),y.jsx("td",{className:"py-4 px-6",children:x.category}),y.jsx("td",{className:"py-4 px-6",children:x.amount.toLocaleString()}),y.jsx("td",{className:"py-4 px-6",children:x.currency||"TWD"}),y.jsx("td",{className:"py-4 px-6 text-gray-600",children:x.accountName||"N/A"}),y.jsx("td",{className:"py-4 px-6 max-w-xs truncate",title:x.description||"N/A",children:x.description||"N/A"})]},x.id))})]})}),f>1&&y.jsxs("div",{className:"flex justify-between items-center mt-4",children:[y.jsx("button",{onClick:()=>i(x=>Math.max(1,x-1)),disabled:s===1,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"上一頁"}),y.jsxs("span",{className:"text-sm text-gray-700",children:["第 ",s," 頁 / 共 ",f," 頁"]}),y.jsx("button",{onClick:()=>i(x=>Math.min(f,x+1)),disabled:s===f,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"下一頁"})]})]}):y.jsx(Cd,{Icon:Z9,title:"目前沒有收支記錄",message:"請前往「資料管理」頁面的「收支管理」分頁，開始記錄您的第一筆收入或支出。"})})]})},tB=({cashflowRecords:n,budgets:t,db:e,userId:s,appId:i,settings:a,setNotification:l})=>{const u=ut.useRef(null),h=ut.useRef(null),[f,m]=ut.useState(new Date().toISOString().slice(0,7)),[_,x]=ut.useState(!1),E={category:"",amount:""},[S,T]=ut.useState(E),R=[...mg.expense,...a.customExpense||[]],M=ut.useMemo(()=>{const z=n.filter(k=>k.date.startsWith(f)&&k.type==="expense"),D=t.filter(k=>k.month===f),I=z.reduce((k,nt)=>(k[nt.category]=(k[nt.category]||0)+nt.amount,k),{}),P=[...new Set([...D.map(k=>k.category),...Object.keys(I)])].map(k=>{var Y;const nt=((Y=D.find(at=>at.category===k))==null?void 0:Y.amount)||0,bt=I[k]||0;return{category:k,budget:nt,spent:bt,overBudget:bt>nt}}),j=D.reduce((k,nt)=>k+nt.amount,0),F=Object.values(I).reduce((k,nt)=>k+Number(nt),0);return{combinedData:P,totalBudget:j,totalSpent:F}},[f,n,t]),L=()=>{T(E),x(!0)},O=async z=>{z.preventDefault();const{category:D,amount:I}=S,C=parseFloat(I);if(!D||isNaN(C)||C<=0){l({message:"請選擇一個類別並輸入有效的預算金額。",type:"error",show:!0});return}const P=`artifacts/${i}/users/${s}/budgets`,j=t.find(F=>F.month===f&&F.category===D);try{j?(await e.doc(`${P}/${j.id}`).update({amount:C}),l({message:"預算更新成功！",type:"success",show:!0})):(await e.collection(P).add({month:f,category:D,amount:C}),l({message:"預算新增成功！",type:"success",show:!0}))}catch(F){console.error("Error saving budget:",F),l({message:"儲存預算時發生錯誤。",type:"error",show:!0})}x(!1)};ut.useEffect(()=>{if(u.current&&M.combinedData.length>0){h.current&&h.current.destroy();const z=u.current.getContext("2d");if(z){const D=M.combinedData.map(k=>k.category),I=M.combinedData.map(k=>k.budget),C=M.combinedData.map(k=>k.spent),P=z.createLinearGradient(0,0,0,400);P.addColorStop(0,"rgba(59, 130, 246, 0.7)"),P.addColorStop(1,"rgba(59, 130, 246, 0.3)");const j=z.createLinearGradient(0,0,0,400);j.addColorStop(0,"rgba(16, 185, 129, 0.7)"),j.addColorStop(1,"rgba(16, 185, 129, 0.3)");const F=z.createLinearGradient(0,0,0,400);F.addColorStop(0,"rgba(239, 68, 68, 0.7)"),F.addColorStop(1,"rgba(239, 68, 68, 0.3)"),h.current=new wn(z,{type:"bar",data:{labels:D,datasets:[{label:"預算金額",data:I,backgroundColor:P,borderColor:"rgba(59, 130, 246, 1)",borderWidth:1,borderRadius:5,hoverBackgroundColor:"rgba(59, 130, 246, 1)"},{label:"實際支出",data:C,backgroundColor:C.map((k,nt)=>k>I[nt]?F:j),borderColor:C.map((k,nt)=>k>I[nt]?"rgba(239, 68, 68, 1)":"rgba(16, 185, 129, 1)"),borderWidth:1,borderRadius:5,hoverBackgroundColor:C.map((k,nt)=>k>I[nt]?"rgba(239, 68, 68, 1)":"rgba(16, 185, 129, 1)")}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},scales:{y:{beginAtZero:!0,grid:{color:"rgba(200, 200, 200, 0.2)"},ticks:{callback:k=>`${Number(k)/1e3}k`}},x:{grid:{display:!1}}},plugins:{title:{display:!0,text:`${f} 預算 vs. 支出分析`,font:{size:16}},tooltip:{enabled:!0,backgroundColor:"rgba(30, 41, 59, 0.9)",titleColor:"#ffffff",bodyColor:"#ffffff",footerColor:"#ffffff",titleFont:{size:14,weight:"bold"},bodyFont:{size:12},footerFont:{size:12,weight:"bold"},padding:12,cornerRadius:8,displayColors:!0,callbacks:{label:function(k){let nt=k.dataset.label||"";return nt&&(nt+=": "),k.parsed.y!==null&&(nt+=new Intl.NumberFormat("en-US",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(k.parsed.y)),nt},footer:k=>{let nt=0,bt=0;const Y=k.find(mt=>mt.dataset.label==="預算金額"),at=k.find(mt=>mt.dataset.label==="實際支出");if(Y&&(nt=Y.raw),at&&(bt=at.raw),nt>0){const mt=nt-bt;return mt>=0?`剩餘額度: ${mt.toLocaleString()} 元`:`超支金額: ${Math.abs(mt).toLocaleString()} 元`}return""}}}}}})}}return()=>{h.current&&h.current.destroy()}},[M,f]);const H=ut.useMemo(()=>{const z=[],{combinedData:D,totalBudget:I,totalSpent:C}=M;I>0?z.push(C>I?{title:"超出總預算",message:`本月總支出已超出總預算 ${(C-I).toLocaleString()} 元。`,type:"warning"}:{title:"預算控制良好",message:`本月總支出仍在預算內，剩餘額度為 ${(I-C).toLocaleString()} 元。`,type:"success"}):z.push({title:"設定月度預算",message:"您尚未設定本月預算，可點擊上方按鈕快速新增或前往「資料管理」設定。",type:"info"});const P=D.filter(j=>j.overBudget&&j.budget>0);return P.length>0&&z.push({title:"注意超支項目",message:`您在「${P.map(j=>j.category).join(", ")}」等項目上已超支。`,type:"warning"}),z},[M]),B={success:"bg-green-50 border-green-500 text-green-800",warning:"bg-red-100 border-red-600 text-red-900",info:"bg-blue-50 border-blue-500 text-blue-800"};return y.jsxs(ln,{children:[y.jsx(cr,{title:"預算檢視 & 月任務卡",subtitle:"此頁面為您的預算檢視。點擊「快速新增預算」來為當前月份新增項目，或前往「資料管理」頁面進行更詳細的設定。"}),y.jsxs("div",{className:"flex justify-between items-center mb-6",children:[y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx("label",{htmlFor:"budget-month-select",className:"text-sm font-medium text-gray-700",children:"選擇月份:"}),y.jsx("input",{type:"month",id:"budget-month-select",value:f,onChange:z=>m(z.target.value),className:"p-2 border rounded-md shadow-sm"})]}),y.jsxs("button",{onClick:L,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 shadow-sm transition-colors flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"快速新增預算"]})]}),y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[y.jsx("div",{className:"lg:col-span-3 bg-gray-50 p-4 rounded-lg border h-96",children:M.combinedData.length>0?y.jsx("canvas",{ref:u}):y.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:"此月份無預算或支出數據可供分析。"})}),y.jsxs("div",{className:"lg:col-span-2",children:[y.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-800",children:"本月任務與洞察"}),y.jsx("div",{className:"space-y-4",children:H.map((z,D)=>y.jsxs("div",{className:`flex items-start p-4 ${z.type==="warning"?"border-l-8":"border-l-[5px]"} rounded-r-lg shadow-sm ${B[z.type]}`,children:[z.type==="warning"&&y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-3 flex-shrink-0 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),z.type==="success"&&y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-3 flex-shrink-0 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),z.type==="info"&&y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-3 flex-shrink-0 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-bold",children:z.title}),y.jsx("p",{className:"text-sm leading-tight",children:z.message})]})]},D))})]})]}),_&&y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 transition-opacity",onClick:()=>x(!1),children:y.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-md transform transition-all",onClick:z=>z.stopPropagation(),children:[y.jsxs("h3",{className:"text-xl font-semibold mb-4 text-gray-800",children:["為 ",f," 新增/更新預算"]}),y.jsxs("form",{onSubmit:O,className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"budget-category",className:"block text-sm font-medium text-gray-700",children:"支出類別"}),y.jsxs("select",{id:"budget-category",name:"category",value:S.category,onChange:z=>T(D=>({...D,category:z.target.value})),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",required:!0,children:[y.jsx("option",{value:"",disabled:!0,children:"-- 請選擇類別 --"}),R.map(z=>y.jsx("option",{value:z,children:z},z))]})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"budget-amount",className:"block text-sm font-medium text-gray-700",children:"預算金額 (TWD)"}),y.jsx("input",{type:"number",id:"budget-amount",name:"amount",value:S.amount,onChange:z=>T(D=>({...D,amount:z.target.value})),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:"例如: 5000",required:!0,min:"1"})]}),y.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[y.jsx("button",{type:"button",onClick:()=>x(!1),className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 font-medium",children:"取消"}),y.jsx("button",{type:"submit",className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 font-medium",children:"儲存預算"})]})]})]})})]})},eB=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),nB=({assetAccounts:n})=>{const[t,e]=ut.useState(null),s=ut.useRef(null),i=ut.useRef(null),a=t||n,l=ut.useMemo(()=>{const T=a.flatMap(F=>(F.assets||[]).map(k=>({...k,accountName:F.name}))).filter(F=>F.accountType==="股票"||F.accountType==="ETF");if(T.length===0)return{totalValue:0,totalCost:0,totalPNL:0,roi:0,assets:[],best:null,worst:null,concentration:0,topAsset:null,stockPercentage:0,numberOfAssets:0};const R=T.reduce((F,k)=>F+(k.currentValueTWD||0),0),M=T.reduce((F,k)=>F+(k.costTWD||0),0),L=R-M,O=M>0?L/M*100:0,H=T.map(F=>{const k=F.profitLossTWD||0,nt=F.costTWD||0,bt=nt>0?k/nt*100:0;return{...F,pnl:k,roi:bt}}).sort((F,k)=>k.pnl-F.pnl),B=H[0],z=H[H.length-1],D=[...H].sort((F,k)=>(k.currentValueTWD??0)-(F.currentValueTWD??0))[0],I=R>0&&D?(D.currentValueTWD??0)/R*100:0,C=T.filter(F=>F.accountType==="股票").reduce((F,k)=>F+(k.currentValueTWD||0),0),P=R>0?C/R*100:0,j=T.length;return{totalValue:R,totalCost:M,totalPNL:L,roi:O,assets:H,best:B,worst:z,topAsset:D,concentration:I,stockPercentage:P,numberOfAssets:j}},[a]),u=()=>{const R=JSON.parse(JSON.stringify(t||n)).map(M=>({...M,assets:(M.assets||[]).map(L=>{if(L.accountType==="股票"||L.accountType==="ETF"){const O=(Math.random()-.45)*.1,H=(L.currentValueTWD||0)*(1+O);return{...L,currentValueTWD:H,profitLossTWD:H-(L.costTWD||0)}}return L})}));e(R)},h=()=>{e(null)},f=()=>{const{best:T,worst:R,concentration:M,topAsset:L,stockPercentage:O,numberOfAssets:H}=l,B=[];return H===0?(B.push({title:"開始您的投資",message:"您尚未加入任何投資項目。前往「資料管理」新增您的股票或ETF，開始追蹤績效。",type:"info"}),B):(O>60?B.push({title:"風險等級: 偏高",message:`您的投資組合偏向高風險，個股佔比達 ${O.toFixed(1)}%。`,type:"warning"}):O<30?B.push({title:"風險等級: 穩健",message:`您的投資組合偏向穩健，個股佔比為 ${O.toFixed(1)}%。`,type:"success"}):B.push({title:"風險等級: 適中",message:`您的投資組合風險適中，個股佔比為 ${O.toFixed(1)}%。`,type:"info"}),M>40&&B.push({title:"風險集中警告",message:`您的資金過度集中於「${L==null?void 0:L.code}」，佔總投資額的 ${M.toFixed(1)}%。`,type:"warning"}),H<5&&B.push({title:"分散度提醒",message:`您目前僅持有 ${H} 項投資標的，可考慮增加持股以提高分散性。`,type:"info"}),T&&B.push({title:"最佳貢獻",message:`「${T.code}」是您目前獲利最高的資產，貢獻了 ${T.pnl.toLocaleString()} 元的收益。`,type:"info"}),R&&R.pnl<0&&B.push({title:"主要虧損來源",message:`「${R.code}」是您目前虧損最多的資產，虧損達 ${R.pnl.toLocaleString()} 元。`,type:"warning"}),B)},m=()=>{const{stockPercentage:T,concentration:R,topAsset:M,numberOfAssets:L}=l,O=[];let H=!1;return L===0?{suggestions:[],isBalanced:!1}:(T>60&&O.push("考慮增加指數型ETF的比重，以分散個股風險並降低波動性。"),R>40&&O.push(`建議適度減持「${M==null?void 0:M.code}」，並將資金分配到其他資產中。`),L<5&&O.push("研究並增加新的投資標的，以提高投資組合的多元性。"),O.length===0&&(H=!0,O.push("您的投資組合目前配置均衡，無需立即進行重大調整。繼續保持監控！")),{suggestions:O,isBalanced:H})};ut.useEffect(()=>{if(s.current&&l.assets.length>0){i.current&&i.current.destroy();const T=s.current.getContext("2d");if(T){const R=l.assets.reduce((M,L)=>{const O=L.code;return M[O]=(M[O]||0)+(L.currentValueTWD??0),M},{});i.current=new wn(T,{type:"doughnut",data:{labels:Object.keys(R),datasets:[{data:Object.values(R),backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#E7E9ED"],borderColor:"#fff",borderWidth:2,hoverOffset:8}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{boxWidth:20}},title:{display:!0,text:"投資組合佔比"}}}})}}return()=>{i.current&&i.current.destroy()}},[l]);const _=f(),{suggestions:x,isBalanced:E}=m(),S={success:"bg-green-100 border-green-400 text-green-800",warning:"bg-yellow-100 border-yellow-400 text-yellow-800",info:"bg-blue-100 border-blue-400 text-blue-800"};return y.jsxs(ln,{children:[y.jsx(cr,{title:"投資追蹤 & 智慧分析"}),n.length===0||l.numberOfAssets===0?y.jsx(Cd,{Icon:eB,title:"開始追蹤您的投資",message:"您尚未新增任何股票或ETF資產。請前往「資料管理」新增您的投資項目，即可在此查看詳細的績效分析與智慧建議。"}):y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[y.jsxs("div",{className:"p-4 bg-green-100 rounded-lg text-center shadow-sm",children:[y.jsx("h3",{className:"text-sm font-semibold text-green-800",children:"總投資價值 (TWD)"}),y.jsxs("p",{className:"text-2xl font-bold text-green-900",children:["$",l.totalValue.toLocaleString(void 0,{maximumFractionDigits:0})]})]}),y.jsxs("div",{className:`p-4 rounded-lg text-center shadow-sm ${l.totalPNL>=0?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:[y.jsx("h3",{className:"text-sm font-semibold",children:"總損益 (TWD)"}),y.jsx("p",{className:`text-2xl font-bold ${l.totalPNL>=0?"text-blue-900":"text-red-900"}`,children:l.totalPNL.toLocaleString(void 0,{maximumFractionDigits:0})})]}),y.jsxs("div",{className:"p-4 bg-purple-100 rounded-lg text-center shadow-sm",children:[y.jsx("h3",{className:"text-sm font-semibold text-purple-800",children:"總投資回報率"}),y.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:[l.roi.toFixed(2),"%"]})]})]}),y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[y.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[y.jsxs(ln,{className:"h-96 flex flex-col",children:[y.jsx("h3",{className:"text-xl font-semibold mb-2 text-gray-800 text-center",children:"投資組合分佈"}),y.jsx("div",{className:"relative flex-grow h-full",children:y.jsx("canvas",{ref:s})})]}),y.jsxs(ln,{children:[y.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-800",children:"資產詳細表現"}),y.jsx("div",{className:"overflow-x-auto max-h-96 shadow-inner rounded-lg bg-gray-50",children:y.jsxs("table",{className:"w-full text-sm text-left",children:[y.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-100 sticky top-0",children:y.jsxs("tr",{children:[y.jsx("th",{className:"py-2 px-4",children:"代號"}),y.jsx("th",{className:"py-2 px-4",children:"帳戶"}),y.jsx("th",{className:"py-2 px-4",children:"損益(TWD)"}),y.jsx("th",{className:"py-2 px-4",children:"回報率"})]})}),y.jsx("tbody",{children:l.assets.map(T=>y.jsxs("tr",{className:"bg-white border-b",children:[y.jsx("td",{className:"py-2 px-4 font-medium",children:T.code}),y.jsx("td",{className:"py-2 px-4 text-gray-600",children:T.accountName}),y.jsx("td",{className:`py-2 px-4 font-semibold ${T.pnl>=0?"text-green-600":"text-red-600"}`,children:T.pnl.toLocaleString(void 0,{maximumFractionDigits:0})}),y.jsxs("td",{className:`py-2 px-4 font-semibold ${T.roi>=0?"text-green-600":"text-red-600"}`,children:[T.roi.toFixed(2),"%"]})]},T.id))})]})})]})]}),y.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[y.jsxs(ln,{className:"bg-gray-50",children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-3",children:'"What-If" 壓力測試'}),y.jsx("p",{className:"text-xs text-gray-600 mb-4",children:"模擬市場波動對您投資組合的影響，此操作不會儲存。"}),y.jsxs("div",{className:"flex space-x-2",children:[y.jsxs("button",{onClick:u,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-lg font-semibold flex items-center justify-center text-sm",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"執行市場模擬"]}),t&&y.jsxs("button",{onClick:h,className:"w-full bg-gray-500 text-white py-2 px-4 rounded-lg hover:bg-gray-600 transition-colors shadow-lg font-semibold flex items-center justify-center text-sm",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h5M5 12a7 7 0 0011.66 4.995M20 20v-5h-5"})}),"重置為原始數據"]})]}),t&&y.jsx("p",{className:"text-center text-indigo-700 text-xs mt-3 font-semibold",children:"模擬模式已啟用"})]}),y.jsxs(ln,{children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-3",children:"投資組合洞察"}),y.jsx("div",{className:"space-y-3",children:_.map((T,R)=>y.jsxs("div",{className:`p-3 border-l-4 rounded-r-lg ${S[T.type]}`,children:[y.jsx("h4",{className:"font-bold text-sm",children:T.title}),y.jsx("p",{className:"text-xs",children:T.message})]},R))})]}),y.jsxs(ln,{className:"bg-teal-50 border border-teal-200",children:[y.jsxs("h3",{className:"text-xl font-semibold text-teal-800 mb-4 flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"智慧再平衡建議"]}),E?y.jsxs("div",{className:"flex items-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3 text-green-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),y.jsx("p",{className:"text-green-900 text-sm font-medium",children:x[0]})]}):y.jsx("ul",{className:"space-y-3",children:x.map((T,R)=>y.jsxs("li",{className:"flex items-start",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3 mt-0.5 text-teal-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),y.jsx("span",{className:"text-teal-900 text-sm",children:T})]},R))})]})]})]})]})]})},sB=n=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...n,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6H8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"})}),iB=({goals:n,assetAccounts:t,cashflowRecords:e})=>{const s=ut.useMemo(()=>{const l=new Date;l.setMonth(l.getMonth()-6);const u=l.toISOString().slice(0,7),h={};e.filter(_=>_.date>=u).forEach(_=>{const x=_.date.slice(0,7);h[x]||(h[x]=0),h[x]+=_.type==="income"?_.amount:-_.amount});const f=Object.values(h);return f.length===0?0:f.reduce((_,x)=>_+x,0)/f.length},[e]),i=l=>(l||[]).map(u=>{var h;return(h=t.find(f=>f.id===u))==null?void 0:h.name}).filter(Boolean).join(", ")||"未連結",a=ut.useMemo(()=>n.map(l=>{const u=(l.linkedAccountIds||[]).reduce((f,m)=>{const _=t.find(E=>E.id===m),x=((_==null?void 0:_.assets)||[]).reduce((E,S)=>E+(S.currentValueTWD||0),0);return f+x},0),h=l.linkedAccountIds&&l.linkedAccountIds.length>0?u:l.currentAmount||0;return{...l,currentAmount:h}}),[n,t]);return y.jsxs(ln,{children:[y.jsx(cr,{title:"財務目標進度",subtitle:"此頁面為您的目標進度。如需新增或修改目標，請前往「資料管理」頁面。"}),a.length>0?y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(l=>{const u=Math.min(l.currentAmount/l.targetAmount*100,100),h=u>=100,f=Math.max(0,l.targetAmount-l.currentAmount);let m=null;if(!h&&s>0&&f>0){const _=Math.ceil(f/s),x=new Date;x.setMonth(x.getMonth()+_),m=`${_} 個月後 (${x.getFullYear()}/${x.getMonth()+1})`}return y.jsxs("div",{className:"p-5 border rounded-lg shadow-sm bg-white transition-transform transform hover:-translate-y-1 hover:shadow-lg flex flex-col",children:[y.jsxs("div",{className:"flex justify-between items-start mb-2",children:[y.jsxs("div",{children:[y.jsxs("h3",{className:"font-bold text-lg text-gray-800 flex items-center",children:[h&&y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-green-500",viewBox:"0 0 20 20",fill:"currentColor",children:y.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),l.name]}),y.jsxs("p",{className:"text-xs text-gray-500",children:["連結帳戶: ",i(l.linkedAccountIds)]})]}),y.jsx("span",{className:"text-sm text-gray-500 font-medium bg-gray-100 px-2 py-1 rounded",children:l.targetDate})]}),y.jsxs("p",{className:"text-gray-700 text-sm mt-4",children:["進度: $",l.currentAmount.toLocaleString(void 0,{maximumFractionDigits:0})," / ",y.jsxs("span",{className:"font-medium",children:["$",l.targetAmount.toLocaleString()]})]}),y.jsxs("div",{className:"mt-2 mb-4",children:[y.jsxs("div",{className:"flex justify-between mb-1",children:[y.jsx("span",{className:"text-xs font-medium text-blue-700",children:"進度"}),y.jsxs("span",{className:"text-sm font-medium text-blue-700",children:[u.toFixed(1),"%"]})]}),y.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 overflow-hidden",children:y.jsx("div",{className:"bg-gradient-to-r from-green-400 to-blue-500 h-4 rounded-full transition-all duration-1000 ease-out",style:{width:`${u}%`},"aria-valuenow":u,"aria-valuemin":0,"aria-valuemax":100,role:"progressbar","aria-label":`${l.name} progress`})})]}),y.jsx("div",{className:"mt-auto pt-4 border-t border-gray-100",children:h?y.jsx("div",{className:"text-center font-semibold text-green-600",children:"恭喜！目標已達成！"}):y.jsxs("div",{className:"text-xs text-gray-600",children:[y.jsxs("div",{className:"flex justify-between",children:[y.jsx("span",{children:"尚需金額:"}),y.jsxs("span",{className:"font-medium",children:["$",f.toLocaleString(void 0,{maximumFractionDigits:0})]})]}),y.jsxs("div",{className:"flex justify-between",children:[y.jsx("span",{children:"預計達成時間:"}),y.jsx("span",{className:"font-medium",children:m||"需正向儲蓄"})]})]})})]},l.id)})}):y.jsx(Cd,{Icon:sB,title:"尚無財務目標",message:"設定您的第一個財務目標，例如「購車基金」或「房屋頭期款」，並開始追踪您的進度！"})]})},rB=({assetAccounts:n,onBack:t})=>{const[e,s]=ut.useState({key:"profitLossTWD",direction:"desc"}),{pnlData:i,totalValue:a,totalCost:l,totalPNL:u,overallROI:h,bestPerformer:f,topGainer:m}=ut.useMemo(()=>{const T=n.flatMap(D=>(D.assets||[]).map(I=>({...I,accountName:D.name}))).filter(D=>D.accountType==="股票"||D.accountType==="ETF"||D.accountType==="美元資產");if(T.length===0)return{pnlData:[],totalValue:0,totalCost:0,totalPNL:0,overallROI:0,bestPerformer:null,topGainer:null};const R=T.map(D=>{const I=D.costTWD||0,C=D.profitLossTWD||0,P=I>0?C/I*100:0;return{...D,pnlPercentage:P}}),M=[...R].sort((D,I)=>(I.profitLossTWD||0)-(D.profitLossTWD||0))[0],L=[...R].sort((D,I)=>I.pnlPercentage-D.pnlPercentage)[0],O=R.reduce((D,I)=>D+(I.currentValueTWD||0),0),H=R.reduce((D,I)=>D+(I.costTWD||0),0),B=O-H,z=H>0?B/H*100:0;return{pnlData:R,totalValue:O,totalCost:H,totalPNL:B,overallROI:z,bestPerformer:M,topGainer:L}},[n]),_=ut.useMemo(()=>[...i].sort((T,R)=>{const M=T[e.key]||(e.key==="code"?"":0),L=R[e.key]||(e.key==="code"?"":0);return M<L?e.direction==="asc"?-1:1:M>L?e.direction==="asc"?1:-1:0}),[i,e]),x=T=>{let R="asc";e.key===T&&e.direction==="asc"&&(R="desc"),s({key:T,direction:R})},E=T=>e.key!==T?null:e.direction==="asc"?" ▲":" ▼",S=[{key:"code",label:"資產代號"},{key:"accountType",label:"類型"},{key:"accountName",label:"帳戶"},{key:"costTWD",label:"總成本 (TWD)",className:"text-right"},{key:"currentValueTWD",label:"現值 (TWD)",className:"text-right"},{key:"profitLossTWD",label:"損益 (TWD)",className:"text-right"},{key:"pnlPercentage",label:"損益 (%)",className:"text-right"}];return y.jsxs(ln,{children:[y.jsxs("div",{className:"flex justify-between items-start mb-6",children:[y.jsx(cr,{title:"詳細投資損益表",subtitle:"此為您目前所有投資項目的總損益。注意：因缺乏歷史數據，尚不支援依日期範圍篩選。"}),y.jsx("button",{onClick:t,className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 font-medium h-fit whitespace-nowrap shadow-sm transition-colors",children:"← 返回總覽"})]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[y.jsxs("div",{className:`p-4 rounded-lg text-center shadow-sm ${u>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[y.jsx("h3",{className:`text-sm font-semibold ${u>=0?"text-green-800":"text-red-800"}`,children:"總損益 (TWD)"}),y.jsx("p",{className:`text-2xl font-bold ${u>=0?"text-green-900":"text-red-900"}`,children:u.toLocaleString(void 0,{maximumFractionDigits:0,signDisplay:"always"})})]}),y.jsxs("div",{className:`p-4 rounded-lg text-center shadow-sm ${h>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[y.jsx("h3",{className:`text-sm font-semibold ${h>=0?"text-green-800":"text-red-800"}`,children:"總投資回報率 (ROI)"}),y.jsxs("p",{className:`text-2xl font-bold ${h>=0?"text-green-900":"text-red-900"}`,children:[h.toFixed(2),"%"]})]}),y.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg text-center shadow-sm",children:[y.jsx("h3",{className:"text-sm font-semibold text-blue-800",children:"最佳貢獻 (依金額)"}),f?y.jsxs(y.Fragment,{children:[y.jsx("p",{className:"text-xl font-bold text-blue-900 truncate",children:f.code}),y.jsxs("p",{className:"text-sm font-medium text-green-600",children:["+",(f.profitLossTWD||0).toLocaleString(void 0,{maximumFractionDigits:0})," 元"]})]}):y.jsx("p",{className:"text-gray-500 pt-2",children:"-"})]}),y.jsxs("div",{className:"p-4 bg-indigo-50 border border-indigo-200 rounded-lg text-center shadow-sm",children:[y.jsx("h3",{className:"text-sm font-semibold text-indigo-800",children:"最高回報 (依 ROI)"}),m?y.jsxs(y.Fragment,{children:[y.jsx("p",{className:"text-xl font-bold text-indigo-900 truncate",children:m.code}),y.jsxs("p",{className:"text-sm font-medium text-green-600",children:["+",m.pnlPercentage.toFixed(2),"%"]})]}):y.jsx("p",{className:"text-gray-500 pt-2",children:"-"})]})]}),y.jsxs("div",{className:"overflow-x-auto",children:[y.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[y.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-100",children:y.jsx("tr",{children:S.map(T=>y.jsxs("th",{scope:"col",className:`py-3 px-6 cursor-pointer hover:bg-gray-200 transition-colors ${T.className||""}`,onClick:()=>x(T.key),children:[T.label," ",E(T.key)]},T.key))})}),y.jsx("tbody",{children:_.map((T,R)=>{const M=T.profitLossTWD||0,L=M>=0;return y.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50",children:[y.jsx("td",{className:"py-4 px-6 font-medium text-gray-900",children:T.code}),y.jsx("td",{className:"py-4 px-6 text-gray-600",children:T.accountType}),y.jsx("td",{className:"py-4 px-6 text-gray-600",children:T.accountName}),y.jsx("td",{className:"py-4 px-6 text-right",children:(T.costTWD||0).toLocaleString(void 0,{maximumFractionDigits:0})}),y.jsx("td",{className:"py-4 px-6 text-right",children:(T.currentValueTWD||0).toLocaleString(void 0,{maximumFractionDigits:0})}),y.jsx("td",{className:`py-4 px-6 text-right font-semibold ${L?"text-green-600":"text-red-600"}`,children:M.toLocaleString(void 0,{maximumFractionDigits:0,signDisplay:"always"})}),y.jsxs("td",{className:`py-4 px-6 text-right font-semibold ${L?"text-green-600":"text-red-600"}`,children:[T.pnlPercentage.toFixed(2),"%"]})]},T.id||R)})}),y.jsx("tfoot",{className:"bg-gray-100 border-t-2 border-gray-300",children:y.jsxs("tr",{className:"font-bold text-gray-800",children:[y.jsx("td",{className:"py-3 px-6",colSpan:3,children:"總計"}),y.jsx("td",{className:"py-3 px-6 text-right",children:l.toLocaleString(void 0,{maximumFractionDigits:0})}),y.jsx("td",{className:"py-3 px-6 text-right",children:a.toLocaleString(void 0,{maximumFractionDigits:0})}),y.jsx("td",{className:`py-3 px-6 text-right ${u>=0?"text-green-600":"text-red-600"}`,children:u.toLocaleString(void 0,{maximumFractionDigits:0,signDisplay:"always"})}),y.jsxs("td",{className:`py-3 px-6 text-right ${h>=0?"text-green-600":"text-red-600"}`,children:[h.toFixed(2),"%"]})]})})]}),_.length===0&&y.jsx("p",{className:"text-center text-gray-500 py-8",children:"無投資項目可供分析。"})]})]})},aB=({assetAccounts:n,cashflowRecords:t})=>{const[e,s]=ut.useState(new Date().toISOString().slice(0,7)),[i,a]=ut.useState("desc"),[l,u]=ut.useState("main"),h=ut.useRef(null),f=ut.useRef(null),m=ut.useRef(null),_=ut.useMemo(()=>{const E={},S=new Date;for(let P=11;P>=0;P--){const F=new Date(S.getFullYear(),S.getMonth()-P,1).toISOString().slice(0,7);E[F]={income:0,expense:0,net:0}}t.forEach(P=>{const j=P.date.slice(0,7);E[j]&&(P.type==="income"?E[j].income+=P.amount:E[j].expense+=P.amount)}),Object.keys(E).forEach(P=>{E[P].net=E[P].income-E[P].expense});const T=t.filter(P=>P.date.startsWith(e)&&P.type==="expense").reduce((P,j)=>(P[j.category]=(P[j.category]||0)+j.amount,P),{}),R=n.reduce((P,j)=>P+(j.assets||[]).reduce((F,k)=>F+(k.currentValueTWD||0),0),0),L=n.flatMap(P=>P.assets||[]).map(P=>{const j=P.costTWD||0,F=P.profitLossTWD||0,k=j>0?F/j*100:0;return{...P,pnlPercentage:k}}),O=Object.keys(E).sort((P,j)=>j.localeCompare(P)),B=L.reduce((P,j)=>P+(j.profitLossTWD||0),0)/12;let z=R;const D=[];for(const P of O)D.push({month:P,value:z}),z-=E[P].net+B;D.reverse();const I=E[e]||{income:0,expense:0},C=I.income>0?(I.income-I.expense)/I.income*100:0;return{monthlySummaries:E,expenseBreakdown:T,pnlReportData:L,netWorthTrendData:D,kpis:{savingsRate:C.toFixed(1)}}},[t,n,e]),x=ut.useMemo(()=>[..._.pnlReportData].sort((E,S)=>{const T=E.profitLossTWD||0,R=S.profitLossTWD||0;return i==="desc"?R-T:T-R}),[_.pnlReportData,i]);return ut.useEffect(()=>{if(l!=="main")return;const E=[],S={enabled:!0,backgroundColor:"rgba(30, 41, 59, 0.9)",titleColor:"#ffffff",bodyColor:"#ffffff",titleFont:{size:14,weight:"bold"},bodyFont:{size:12},padding:12,cornerRadius:8,displayColors:!1};if(h.current){const T=wn.getChart(h.current);T&&T.destroy();const R=h.current.getContext("2d");if(R){const M=Object.keys(_.monthlySummaries),L=R.createLinearGradient(0,0,0,400);L.addColorStop(0,"rgba(59, 130, 246, 0.8)"),L.addColorStop(1,"rgba(59, 130, 246, 0.1)");const O=R.createLinearGradient(0,0,0,400);O.addColorStop(0,"rgba(239, 68, 68, 0.8)"),O.addColorStop(1,"rgba(239, 68, 68, 0.1)");const H=new wn(h.current,{type:"bar",data:{labels:M,datasets:[{label:"總收入",data:M.map(B=>_.monthlySummaries[B].income),backgroundColor:L,borderColor:"rgba(59, 130, 246, 1)",hoverBackgroundColor:"rgba(59, 130, 246, 1)",borderWidth:1,borderRadius:5},{label:"總支出",data:M.map(B=>_.monthlySummaries[B].expense),backgroundColor:O,borderColor:"rgba(239, 68, 68, 1)",hoverBackgroundColor:"rgba(239, 68, 68, 1)",borderWidth:1,borderRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{title:{display:!0,text:"近12個月收支趨勢",font:{size:16}},tooltip:{...S,callbacks:{title:B=>B[0].label,label:B=>` ${B.dataset.label}: ${Number(B.raw).toLocaleString()} 元`}}},scales:{y:{beginAtZero:!0,ticks:{callback:B=>`${Number(B)/1e3}k`}},x:{grid:{display:!1}}}}});E.push(H)}}if(f.current){const T=wn.getChart(f.current);T&&T.destroy();const R=Object.keys(_.expenseBreakdown),M=Object.values(_.expenseBreakdown),L=M.reduce((B,z)=>B+z,0),O=["#3B82F6","#10B981","#F59E0B","#8B5CF6","#EF4444","#EC4899","#6366F1","#F97316"],H=new wn(f.current,{type:"doughnut",data:{labels:R,datasets:[{data:M,backgroundColor:O,borderColor:"#fff",borderWidth:3,hoverOffset:15,hoverBorderColor:"#fff"}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{title:{display:!1},legend:{position:"right"},tooltip:{...S,callbacks:{title:B=>B[0].label,label:B=>{const z=B.raw,D=L>0?(z/L*100).toFixed(1):0;return`金額: ${z.toLocaleString()} 元 (${D}%)`}}}}}});E.push(H)}if(m.current){const T=wn.getChart(m.current);T&&T.destroy();const R=m.current.getContext("2d");if(R){const M=R.createLinearGradient(0,0,0,400);M.addColorStop(0,"rgba(139, 92, 246, 0.7)"),M.addColorStop(1,"rgba(139, 92, 246, 0.1)");const L=new wn(m.current,{type:"line",data:{labels:_.netWorthTrendData.map(O=>O.month),datasets:[{label:"資產淨值趨勢 (TWD)",data:_.netWorthTrendData.map(O=>O.value),borderColor:"rgb(139, 92, 246)",backgroundColor:M,tension:.4,fill:!0,pointBackgroundColor:"rgb(139, 92, 246)",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgb(139, 92, 246)",pointRadius:4,pointHoverRadius:8,pointBorderWidth:2,pointHoverBorderWidth:3}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{title:{display:!0,text:"資產淨值趨勢 (含投資損益模擬)",font:{size:16}},tooltip:{...S,callbacks:{title:O=>`月份: ${O[0].label}`,label:O=>` 淨值: ${Number(O.raw).toLocaleString()} 元`}}},scales:{y:{ticks:{callback:O=>`${Number(O)/1e3}k`}},x:{grid:{display:!1}}}}});E.push(L)}}return()=>E.forEach(T=>T.destroy())},[_,l]),l==="pnl"?y.jsx(rB,{assetAccounts:n,onBack:()=>u("main")}):y.jsxs(ln,{children:[y.jsx(cr,{title:"財務報表與分析"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 items-center",children:[y.jsxs("div",{className:"md:col-span-2 flex items-center space-x-4 bg-gray-50 p-4 rounded-lg border",children:[y.jsx("label",{htmlFor:"analysis-month-select",className:"text-lg font-medium text-gray-700",children:"分析月份:"}),y.jsx("input",{id:"analysis-month-select",type:"month",value:e,onChange:E=>s(E.target.value),className:"p-2 border rounded-md shadow-sm","aria-label":"Select month for analysis"})]}),y.jsxs("div",{className:"p-4 bg-blue-100 rounded-lg shadow",children:[y.jsxs("h3",{className:"text-lg font-semibold text-blue-800",children:["儲蓄率 (",e,")"]}),y.jsxs("p",{className:"text-3xl font-bold text-blue-900",children:[_.kpis.savingsRate,"%"]}),y.jsx("p",{className:"text-xs text-blue-700",children:"(收入 - 支出) / 收入"})]})]}),y.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border mb-8",children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"近12個月收支趨勢"}),y.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"將滑鼠懸停在圖表上以查看詳細數據。"}),y.jsx("div",{className:"h-96",children:y.jsx("canvas",{ref:h})})]}),y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[y.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border h-96 flex flex-col",children:[y.jsxs("h3",{className:"text-xl font-semibold text-gray-800 text-center",children:[e," 支出分類"]}),y.jsx("p",{className:"text-xs text-gray-500 mb-2 text-center",children:"將滑鼠懸停在圓環圖上以查看百分比。"}),y.jsx("div",{className:"relative flex-grow h-full",children:y.jsx("canvas",{ref:f})})]}),y.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border h-96 flex flex-col",children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"資產淨值趨勢"}),y.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"將滑鼠懸停在圖表上以查看每月淨值。"}),y.jsx("div",{className:"relative flex-grow h-full",children:y.jsx("canvas",{ref:m})}),y.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"* 此圖表基於歷史收支淨額，並將總投資損益平均分配至過去12個月進行模擬。"})]})]}),y.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"資產損益總表"}),y.jsxs("button",{onClick:()=>u("pnl"),className:"text-sm bg-blue-500 text-white px-3 py-1.5 rounded-md hover:bg-blue-600 transition-colors shadow-sm font-semibold flex items-center",children:["查看詳細報表",y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})]}),y.jsxs("div",{className:"overflow-x-auto",children:[y.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[y.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-100",children:y.jsxs("tr",{children:[y.jsx("th",{scope:"col",className:"py-3 px-6",children:"資產代號"}),y.jsx("th",{scope:"col",className:"py-3 px-6",children:"類型"}),y.jsx("th",{scope:"col",className:"py-3 px-6 text-right",children:"現值 (TWD)"}),y.jsxs("th",{scope:"col",className:"py-3 px-6 text-right cursor-pointer",onClick:()=>a(E=>E==="asc"?"desc":"asc"),children:["損益 (TWD) ",i==="desc"?"▼":"▲"]}),y.jsx("th",{scope:"col",className:"py-3 px-6 text-right",children:"損益 (%)"})]})}),y.jsx("tbody",{children:x.slice(0,5).map((E,S)=>{const T=E.profitLossTWD||0,R=T>=0;return y.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50",children:[y.jsx("td",{className:"py-4 px-6 font-medium text-gray-900",children:E.code}),y.jsx("td",{className:"py-4 px-6",children:E.accountType}),y.jsx("td",{className:"py-4 px-6 text-right",children:(E.currentValueTWD||0).toLocaleString(void 0,{maximumFractionDigits:0})}),y.jsx("td",{className:`py-4 px-6 text-right font-semibold ${R?"text-green-600":"text-red-600"}`,children:T.toLocaleString(void 0,{maximumFractionDigits:0,signDisplay:"always"})}),y.jsxs("td",{className:`py-4 px-6 text-right font-semibold ${R?"text-green-600":"text-red-600"}`,children:[E.pnlPercentage.toFixed(2),"%"]})]},E.id||S)})})]}),x.length>5&&y.jsxs("p",{className:"text-center text-xs text-gray-500 pt-2",children:["...及其他 ",x.length-5," 項資產。請至詳細報表查看。"]})]})]})]})};var ie;(function(n){n.assertEqual=i=>{};function t(i){}n.assertIs=t;function e(i){throw new Error}n.assertNever=e,n.arrayToEnum=i=>{const a={};for(const l of i)a[l]=l;return a},n.getValidEnumValues=i=>{const a=n.objectKeys(i).filter(u=>typeof i[i[u]]!="number"),l={};for(const u of a)l[u]=i[u];return n.objectValues(l)},n.objectValues=i=>n.objectKeys(i).map(function(a){return i[a]}),n.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const a=[];for(const l in i)Object.prototype.hasOwnProperty.call(i,l)&&a.push(l);return a},n.find=(i,a)=>{for(const l of i)if(a(l))return l},n.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function s(i,a=" | "){return i.map(l=>typeof l=="string"?`'${l}'`:l).join(a)}n.joinValues=s,n.jsonStringifyReplacer=(i,a)=>typeof a=="bigint"?a.toString():a})(ie||(ie={}));var tA;(function(n){n.mergeShapes=(t,e)=>({...t,...e})})(tA||(tA={}));const St=ie.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Jr=n=>{switch(typeof n){case"undefined":return St.undefined;case"string":return St.string;case"number":return Number.isNaN(n)?St.nan:St.number;case"boolean":return St.boolean;case"function":return St.function;case"bigint":return St.bigint;case"symbol":return St.symbol;case"object":return Array.isArray(n)?St.array:n===null?St.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?St.promise:typeof Map<"u"&&n instanceof Map?St.map:typeof Set<"u"&&n instanceof Set?St.set:typeof Date<"u"&&n instanceof Date?St.date:St.object;default:return St.unknown}},ft=ie.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ir extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const e=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,e):this.__proto__=e,this.name="ZodError",this.issues=t}format(t){const e=t||function(a){return a.message},s={_errors:[]},i=a=>{for(const l of a.issues)if(l.code==="invalid_union")l.unionErrors.map(i);else if(l.code==="invalid_return_type")i(l.returnTypeError);else if(l.code==="invalid_arguments")i(l.argumentsError);else if(l.path.length===0)s._errors.push(e(l));else{let u=s,h=0;for(;h<l.path.length;){const f=l.path[h];h===l.path.length-1?(u[f]=u[f]||{_errors:[]},u[f]._errors.push(e(l))):u[f]=u[f]||{_errors:[]},u=u[f],h++}}};return i(this),s}static assert(t){if(!(t instanceof ir))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ie.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=e=>e.message){const e={},s=[];for(const i of this.issues)if(i.path.length>0){const a=i.path[0];e[a]=e[a]||[],e[a].push(t(i))}else s.push(t(i));return{formErrors:s,fieldErrors:e}}get formErrors(){return this.flatten()}}ir.create=n=>new ir(n);const O0=(n,t)=>{let e;switch(n.code){case ft.invalid_type:n.received===St.undefined?e="Required":e=`Expected ${n.expected}, received ${n.received}`;break;case ft.invalid_literal:e=`Invalid literal value, expected ${JSON.stringify(n.expected,ie.jsonStringifyReplacer)}`;break;case ft.unrecognized_keys:e=`Unrecognized key(s) in object: ${ie.joinValues(n.keys,", ")}`;break;case ft.invalid_union:e="Invalid input";break;case ft.invalid_union_discriminator:e=`Invalid discriminator value. Expected ${ie.joinValues(n.options)}`;break;case ft.invalid_enum_value:e=`Invalid enum value. Expected ${ie.joinValues(n.options)}, received '${n.received}'`;break;case ft.invalid_arguments:e="Invalid function arguments";break;case ft.invalid_return_type:e="Invalid function return type";break;case ft.invalid_date:e="Invalid date";break;case ft.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(e=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(e=`${e} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?e=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?e=`Invalid input: must end with "${n.validation.endsWith}"`:ie.assertNever(n.validation):n.validation!=="regex"?e=`Invalid ${n.validation}`:e="Invalid";break;case ft.too_small:n.type==="array"?e=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?e=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?e=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?e=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?e=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:e="Invalid input";break;case ft.too_big:n.type==="array"?e=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?e=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?e=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?e=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?e=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:e="Invalid input";break;case ft.custom:e="Invalid input";break;case ft.invalid_intersection_types:e="Intersection results could not be merged";break;case ft.not_multiple_of:e=`Number must be a multiple of ${n.multipleOf}`;break;case ft.not_finite:e="Number must be finite";break;default:e=t.defaultError,ie.assertNever(n)}return{message:e}};let oB=O0;function lB(){return oB}const cB=n=>{const{data:t,path:e,errorMaps:s,issueData:i}=n,a=[...e,...i.path||[]],l={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let u="";const h=s.filter(f=>!!f).slice().reverse();for(const f of h)u=f(l,{data:t,defaultError:u}).message;return{...i,path:a,message:u}};function Et(n,t){const e=lB(),s=cB({issueData:t,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,e,e===O0?void 0:O0].filter(i=>!!i)});n.common.issues.push(s)}class ps{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,e){const s=[];for(const i of e){if(i.status==="aborted")return Lt;i.status==="dirty"&&t.dirty(),s.push(i.value)}return{status:t.value,value:s}}static async mergeObjectAsync(t,e){const s=[];for(const i of e){const a=await i.key,l=await i.value;s.push({key:a,value:l})}return ps.mergeObjectSync(t,s)}static mergeObjectSync(t,e){const s={};for(const i of e){const{key:a,value:l}=i;if(a.status==="aborted"||l.status==="aborted")return Lt;a.status==="dirty"&&t.dirty(),l.status==="dirty"&&t.dirty(),a.value!=="__proto__"&&(typeof l.value<"u"||i.alwaysSet)&&(s[a.value]=l.value)}return{status:t.value,value:s}}}const Lt=Object.freeze({status:"aborted"}),vh=n=>({status:"dirty",value:n}),Ms=n=>({status:"valid",value:n}),eA=n=>n.status==="aborted",nA=n=>n.status==="dirty",kc=n=>n.status==="valid",gg=n=>typeof Promise<"u"&&n instanceof Promise;var It;(function(n){n.errToObj=t=>typeof t=="string"?{message:t}:t||{},n.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(It||(It={}));class Sa{constructor(t,e,s,i){this._cachedPath=[],this.parent=t,this.data=e,this._path=s,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const sA=(n,t)=>{if(kc(t))return{success:!0,data:t.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const e=new ir(n.common.issues);return this._error=e,this._error}}};function qt(n){if(!n)return{};const{errorMap:t,invalid_type_error:e,required_error:s,description:i}=n;if(t&&(e||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:i}:{errorMap:(l,u)=>{const{message:h}=n;return l.code==="invalid_enum_value"?{message:h??u.defaultError}:typeof u.data>"u"?{message:h??s??u.defaultError}:l.code!=="invalid_type"?{message:u.defaultError}:{message:h??e??u.defaultError}},description:i}}class ee{get description(){return this._def.description}_getType(t){return Jr(t.data)}_getOrReturnCtx(t,e){return e||{common:t.parent.common,data:t.data,parsedType:Jr(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new ps,ctx:{common:t.parent.common,data:t.data,parsedType:Jr(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const e=this._parse(t);if(gg(e))throw new Error("Synchronous parse encountered promise.");return e}_parseAsync(t){const e=this._parse(t);return Promise.resolve(e)}parse(t,e){const s=this.safeParse(t,e);if(s.success)return s.data;throw s.error}safeParse(t,e){const s={common:{issues:[],async:(e==null?void 0:e.async)??!1,contextualErrorMap:e==null?void 0:e.errorMap},path:(e==null?void 0:e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Jr(t)},i=this._parseSync({data:t,path:s.path,parent:s});return sA(s,i)}"~validate"(t){var s,i;const e={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Jr(t)};if(!this["~standard"].async)try{const a=this._parseSync({data:t,path:[],parent:e});return kc(a)?{value:a.value}:{issues:e.common.issues}}catch(a){(i=(s=a==null?void 0:a.message)==null?void 0:s.toLowerCase())!=null&&i.includes("encountered")&&(this["~standard"].async=!0),e.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:e}).then(a=>kc(a)?{value:a.value}:{issues:e.common.issues})}async parseAsync(t,e){const s=await this.safeParseAsync(t,e);if(s.success)return s.data;throw s.error}async safeParseAsync(t,e){const s={common:{issues:[],contextualErrorMap:e==null?void 0:e.errorMap,async:!0},path:(e==null?void 0:e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Jr(t)},i=this._parse({data:t,path:s.path,parent:s}),a=await(gg(i)?i:Promise.resolve(i));return sA(s,a)}refine(t,e){const s=i=>typeof e=="string"||typeof e>"u"?{message:e}:typeof e=="function"?e(i):e;return this._refinement((i,a)=>{const l=t(i),u=()=>a.addIssue({code:ft.custom,...s(i)});return typeof Promise<"u"&&l instanceof Promise?l.then(h=>h?!0:(u(),!1)):l?!0:(u(),!1)})}refinement(t,e){return this._refinement((s,i)=>t(s)?!0:(i.addIssue(typeof e=="function"?e(s,i):e),!1))}_refinement(t){return new Pc({schema:this,typeName:Bt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return da.create(this,this._def)}nullable(){return Lc.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return xi.create(this)}promise(){return bg.create(this,this._def)}or(t){return _g.create([this,t],this._def)}and(t){return yg.create(this,t,this._def)}transform(t){return new Pc({...qt(this._def),schema:this,typeName:Bt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const e=typeof t=="function"?t:()=>t;return new V0({...qt(this._def),innerType:this,defaultValue:e,typeName:Bt.ZodDefault})}brand(){return new MB({typeName:Bt.ZodBranded,type:this,...qt(this._def)})}catch(t){const e=typeof t=="function"?t:()=>t;return new P0({...qt(this._def),innerType:this,catchValue:e,typeName:Bt.ZodCatch})}describe(t){const e=this.constructor;return new e({...this._def,description:t})}pipe(t){return vx.create(this,t)}readonly(){return L0.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const uB=/^c[^\s-]{8,}$/i,hB=/^[0-9a-z]+$/,dB=/^[0-9A-HJKMNP-TV-Z]{26}$/i,fB=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,mB=/^[a-z0-9_-]{21}$/i,gB=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,pB=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,_B=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,yB="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Py;const bB=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,xB=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,vB=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,EB=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,TB=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,wB=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,pN="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",SB=new RegExp(`^${pN}$`);function _N(n){let t="[0-5]\\d";n.precision?t=`${t}\\.\\d{${n.precision}}`:n.precision==null&&(t=`${t}(\\.\\d+)?`);const e=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${e}`}function AB(n){return new RegExp(`^${_N(n)}$`)}function IB(n){let t=`${pN}T${_N(n)}`;const e=[];return e.push(n.local?"Z?":"Z"),n.offset&&e.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${e.join("|")})`,new RegExp(`^${t}$`)}function RB(n,t){return!!((t==="v4"||!t)&&bB.test(n)||(t==="v6"||!t)&&vB.test(n))}function DB(n,t){if(!gB.test(n))return!1;try{const[e]=n.split(".");if(!e)return!1;const s=e.replace(/-/g,"+").replace(/_/g,"/").padEnd(e.length+(4-e.length%4)%4,"="),i=JSON.parse(atob(s));return!(typeof i!="object"||i===null||"typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||t&&i.alg!==t)}catch{return!1}}function NB(n,t){return!!((t==="v4"||!t)&&xB.test(n)||(t==="v6"||!t)&&EB.test(n))}class Vo extends ee{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==St.string){const a=this._getOrReturnCtx(t);return Et(a,{code:ft.invalid_type,expected:St.string,received:a.parsedType}),Lt}const s=new ps;let i;for(const a of this._def.checks)if(a.kind==="min")t.data.length<a.value&&(i=this._getOrReturnCtx(t,i),Et(i,{code:ft.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),s.dirty());else if(a.kind==="max")t.data.length>a.value&&(i=this._getOrReturnCtx(t,i),Et(i,{code:ft.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),s.dirty());else if(a.kind==="length"){const l=t.data.length>a.value,u=t.data.length<a.value;(l||u)&&(i=this._getOrReturnCtx(t,i),l?Et(i,{code:ft.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):u&&Et(i,{code:ft.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),s.dirty())}else if(a.kind==="email")_B.test(t.data)||(i=this._getOrReturnCtx(t,i),Et(i,{validation:"email",code:ft.invalid_string,message:a.message}),s.dirty());else if(a.kind==="emoji")Py||(Py=new RegExp(yB,"u")),Py.test(t.data)||(i=this._getOrReturnCtx(t,i),Et(i,{validation:"emoji",code:ft.invalid_string,message:a.message}),s.dirty());else if(a.kind==="uuid")fB.test(t.data)||(i=this._getOrReturnCtx(t,i),Et(i,{validation:"uuid",code:ft.invalid_string,message:a.message}),s.dirty());else if(a.kind==="nanoid")mB.test(t.data)||(i=this._getOrReturnCtx(t,i),Et(i,{validation:"nanoid",code:ft.invalid_string,message:a.message}),s.dirty());else if(a.kind==="cuid")uB.test(t.data)||(i=this._getOrReturnCtx(t,i),Et(i,{validation:"cuid",code:ft.invalid_string,message:a.message}),s.dirty());else if(a.kind==="cuid2")hB.test(t.data)||(i=this._getOrReturnCtx(t,i),Et(i,{validation:"cuid2",code:ft.invalid_string,message:a.message}),s.dirty());else if(a.kind==="ulid")dB.test(t.data)||(i=this._getOrReturnCtx(t,i),Et(i,{validation:"ulid",code:ft.invalid_string,message:a.message}),s.dirty());else if(a.kind==="url")try{new URL(t.data)}catch{i=this._getOrReturnCtx(t,i),Et(i,{validation:"url",code:ft.invalid_string,message:a.message}),s.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(t.data)||(i=this._getOrReturnCtx(t,i),Et(i,{validation:"regex",code:ft.invalid_string,message:a.message}),s.dirty())):a.kind==="trim"?t.data=t.data.trim():a.kind==="includes"?t.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(t,i),Et(i,{code:ft.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),s.dirty()):a.kind==="toLowerCase"?t.data=t.data.toLowerCase():a.kind==="toUpperCase"?t.data=t.data.toUpperCase():a.kind==="startsWith"?t.data.startsWith(a.value)||(i=this._getOrReturnCtx(t,i),Et(i,{code:ft.invalid_string,validation:{startsWith:a.value},message:a.message}),s.dirty()):a.kind==="endsWith"?t.data.endsWith(a.value)||(i=this._getOrReturnCtx(t,i),Et(i,{code:ft.invalid_string,validation:{endsWith:a.value},message:a.message}),s.dirty()):a.kind==="datetime"?IB(a).test(t.data)||(i=this._getOrReturnCtx(t,i),Et(i,{code:ft.invalid_string,validation:"datetime",message:a.message}),s.dirty()):a.kind==="date"?SB.test(t.data)||(i=this._getOrReturnCtx(t,i),Et(i,{code:ft.invalid_string,validation:"date",message:a.message}),s.dirty()):a.kind==="time"?AB(a).test(t.data)||(i=this._getOrReturnCtx(t,i),Et(i,{code:ft.invalid_string,validation:"time",message:a.message}),s.dirty()):a.kind==="duration"?pB.test(t.data)||(i=this._getOrReturnCtx(t,i),Et(i,{validation:"duration",code:ft.invalid_string,message:a.message}),s.dirty()):a.kind==="ip"?RB(t.data,a.version)||(i=this._getOrReturnCtx(t,i),Et(i,{validation:"ip",code:ft.invalid_string,message:a.message}),s.dirty()):a.kind==="jwt"?DB(t.data,a.alg)||(i=this._getOrReturnCtx(t,i),Et(i,{validation:"jwt",code:ft.invalid_string,message:a.message}),s.dirty()):a.kind==="cidr"?NB(t.data,a.version)||(i=this._getOrReturnCtx(t,i),Et(i,{validation:"cidr",code:ft.invalid_string,message:a.message}),s.dirty()):a.kind==="base64"?TB.test(t.data)||(i=this._getOrReturnCtx(t,i),Et(i,{validation:"base64",code:ft.invalid_string,message:a.message}),s.dirty()):a.kind==="base64url"?wB.test(t.data)||(i=this._getOrReturnCtx(t,i),Et(i,{validation:"base64url",code:ft.invalid_string,message:a.message}),s.dirty()):ie.assertNever(a);return{status:s.value,value:t.data}}_regex(t,e,s){return this.refinement(i=>t.test(i),{validation:e,code:ft.invalid_string,...It.errToObj(s)})}_addCheck(t){return new Vo({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...It.errToObj(t)})}url(t){return this._addCheck({kind:"url",...It.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...It.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...It.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...It.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...It.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...It.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...It.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...It.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...It.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...It.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...It.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...It.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...It.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...It.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...It.errToObj(t)})}regex(t,e){return this._addCheck({kind:"regex",regex:t,...It.errToObj(e)})}includes(t,e){return this._addCheck({kind:"includes",value:t,position:e==null?void 0:e.position,...It.errToObj(e==null?void 0:e.message)})}startsWith(t,e){return this._addCheck({kind:"startsWith",value:t,...It.errToObj(e)})}endsWith(t,e){return this._addCheck({kind:"endsWith",value:t,...It.errToObj(e)})}min(t,e){return this._addCheck({kind:"min",value:t,...It.errToObj(e)})}max(t,e){return this._addCheck({kind:"max",value:t,...It.errToObj(e)})}length(t,e){return this._addCheck({kind:"length",value:t,...It.errToObj(e)})}nonempty(t){return this.min(1,It.errToObj(t))}trim(){return new Vo({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Vo({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Vo({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxLength(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}}Vo.create=n=>new Vo({checks:[],typeName:Bt.ZodString,coerce:(n==null?void 0:n.coerce)??!1,...qt(n)});function CB(n,t){const e=(n.toString().split(".")[1]||"").length,s=(t.toString().split(".")[1]||"").length,i=e>s?e:s,a=Number.parseInt(n.toFixed(i).replace(".","")),l=Number.parseInt(t.toFixed(i).replace(".",""));return a%l/10**i}class ud extends ee{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==St.number){const a=this._getOrReturnCtx(t);return Et(a,{code:ft.invalid_type,expected:St.number,received:a.parsedType}),Lt}let s;const i=new ps;for(const a of this._def.checks)a.kind==="int"?ie.isInteger(t.data)||(s=this._getOrReturnCtx(t,s),Et(s,{code:ft.invalid_type,expected:"integer",received:"float",message:a.message}),i.dirty()):a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(s=this._getOrReturnCtx(t,s),Et(s,{code:ft.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(s=this._getOrReturnCtx(t,s),Et(s,{code:ft.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="multipleOf"?CB(t.data,a.value)!==0&&(s=this._getOrReturnCtx(t,s),Et(s,{code:ft.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind==="finite"?Number.isFinite(t.data)||(s=this._getOrReturnCtx(t,s),Et(s,{code:ft.not_finite,message:a.message}),i.dirty()):ie.assertNever(a);return{status:i.value,value:t.data}}gte(t,e){return this.setLimit("min",t,!0,It.toString(e))}gt(t,e){return this.setLimit("min",t,!1,It.toString(e))}lte(t,e){return this.setLimit("max",t,!0,It.toString(e))}lt(t,e){return this.setLimit("max",t,!1,It.toString(e))}setLimit(t,e,s,i){return new ud({...this._def,checks:[...this._def.checks,{kind:t,value:e,inclusive:s,message:It.toString(i)}]})}_addCheck(t){return new ud({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:It.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:It.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:It.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:It.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:It.toString(t)})}multipleOf(t,e){return this._addCheck({kind:"multipleOf",value:t,message:It.toString(e)})}finite(t){return this._addCheck({kind:"finite",message:It.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:It.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:It.toString(t)})}get minValue(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxValue(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&ie.isInteger(t.value))}get isFinite(){let t=null,e=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(e===null||s.value>e)&&(e=s.value):s.kind==="max"&&(t===null||s.value<t)&&(t=s.value)}return Number.isFinite(e)&&Number.isFinite(t)}}ud.create=n=>new ud({checks:[],typeName:Bt.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...qt(n)});class hd extends ee{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==St.bigint)return this._getInvalidInput(t);let s;const i=new ps;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(s=this._getOrReturnCtx(t,s),Et(s,{code:ft.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(s=this._getOrReturnCtx(t,s),Et(s,{code:ft.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="multipleOf"?t.data%a.value!==BigInt(0)&&(s=this._getOrReturnCtx(t,s),Et(s,{code:ft.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):ie.assertNever(a);return{status:i.value,value:t.data}}_getInvalidInput(t){const e=this._getOrReturnCtx(t);return Et(e,{code:ft.invalid_type,expected:St.bigint,received:e.parsedType}),Lt}gte(t,e){return this.setLimit("min",t,!0,It.toString(e))}gt(t,e){return this.setLimit("min",t,!1,It.toString(e))}lte(t,e){return this.setLimit("max",t,!0,It.toString(e))}lt(t,e){return this.setLimit("max",t,!1,It.toString(e))}setLimit(t,e,s,i){return new hd({...this._def,checks:[...this._def.checks,{kind:t,value:e,inclusive:s,message:It.toString(i)}]})}_addCheck(t){return new hd({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:It.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:It.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:It.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:It.toString(t)})}multipleOf(t,e){return this._addCheck({kind:"multipleOf",value:t,message:It.toString(e)})}get minValue(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t}get maxValue(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t}}hd.create=n=>new hd({checks:[],typeName:Bt.ZodBigInt,coerce:(n==null?void 0:n.coerce)??!1,...qt(n)});class iA extends ee{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==St.boolean){const s=this._getOrReturnCtx(t);return Et(s,{code:ft.invalid_type,expected:St.boolean,received:s.parsedType}),Lt}return Ms(t.data)}}iA.create=n=>new iA({typeName:Bt.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...qt(n)});class pg extends ee{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==St.date){const a=this._getOrReturnCtx(t);return Et(a,{code:ft.invalid_type,expected:St.date,received:a.parsedType}),Lt}if(Number.isNaN(t.data.getTime())){const a=this._getOrReturnCtx(t);return Et(a,{code:ft.invalid_date}),Lt}const s=new ps;let i;for(const a of this._def.checks)a.kind==="min"?t.data.getTime()<a.value&&(i=this._getOrReturnCtx(t,i),Et(i,{code:ft.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),s.dirty()):a.kind==="max"?t.data.getTime()>a.value&&(i=this._getOrReturnCtx(t,i),Et(i,{code:ft.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),s.dirty()):ie.assertNever(a);return{status:s.value,value:new Date(t.data.getTime())}}_addCheck(t){return new pg({...this._def,checks:[...this._def.checks,t]})}min(t,e){return this._addCheck({kind:"min",value:t.getTime(),message:It.toString(e)})}max(t,e){return this._addCheck({kind:"max",value:t.getTime(),message:It.toString(e)})}get minDate(){let t=null;for(const e of this._def.checks)e.kind==="min"&&(t===null||e.value>t)&&(t=e.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const e of this._def.checks)e.kind==="max"&&(t===null||e.value<t)&&(t=e.value);return t!=null?new Date(t):null}}pg.create=n=>new pg({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:Bt.ZodDate,...qt(n)});class rA extends ee{_parse(t){if(this._getType(t)!==St.symbol){const s=this._getOrReturnCtx(t);return Et(s,{code:ft.invalid_type,expected:St.symbol,received:s.parsedType}),Lt}return Ms(t.data)}}rA.create=n=>new rA({typeName:Bt.ZodSymbol,...qt(n)});class aA extends ee{_parse(t){if(this._getType(t)!==St.undefined){const s=this._getOrReturnCtx(t);return Et(s,{code:ft.invalid_type,expected:St.undefined,received:s.parsedType}),Lt}return Ms(t.data)}}aA.create=n=>new aA({typeName:Bt.ZodUndefined,...qt(n)});class oA extends ee{_parse(t){if(this._getType(t)!==St.null){const s=this._getOrReturnCtx(t);return Et(s,{code:ft.invalid_type,expected:St.null,received:s.parsedType}),Lt}return Ms(t.data)}}oA.create=n=>new oA({typeName:Bt.ZodNull,...qt(n)});class lA extends ee{constructor(){super(...arguments),this._any=!0}_parse(t){return Ms(t.data)}}lA.create=n=>new lA({typeName:Bt.ZodAny,...qt(n)});class cA extends ee{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Ms(t.data)}}cA.create=n=>new cA({typeName:Bt.ZodUnknown,...qt(n)});class Aa extends ee{_parse(t){const e=this._getOrReturnCtx(t);return Et(e,{code:ft.invalid_type,expected:St.never,received:e.parsedType}),Lt}}Aa.create=n=>new Aa({typeName:Bt.ZodNever,...qt(n)});class uA extends ee{_parse(t){if(this._getType(t)!==St.undefined){const s=this._getOrReturnCtx(t);return Et(s,{code:ft.invalid_type,expected:St.void,received:s.parsedType}),Lt}return Ms(t.data)}}uA.create=n=>new uA({typeName:Bt.ZodVoid,...qt(n)});class xi extends ee{_parse(t){const{ctx:e,status:s}=this._processInputParams(t),i=this._def;if(e.parsedType!==St.array)return Et(e,{code:ft.invalid_type,expected:St.array,received:e.parsedType}),Lt;if(i.exactLength!==null){const l=e.data.length>i.exactLength.value,u=e.data.length<i.exactLength.value;(l||u)&&(Et(e,{code:l?ft.too_big:ft.too_small,minimum:u?i.exactLength.value:void 0,maximum:l?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),s.dirty())}if(i.minLength!==null&&e.data.length<i.minLength.value&&(Et(e,{code:ft.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),s.dirty()),i.maxLength!==null&&e.data.length>i.maxLength.value&&(Et(e,{code:ft.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),s.dirty()),e.common.async)return Promise.all([...e.data].map((l,u)=>i.type._parseAsync(new Sa(e,l,e.path,u)))).then(l=>ps.mergeArray(s,l));const a=[...e.data].map((l,u)=>i.type._parseSync(new Sa(e,l,e.path,u)));return ps.mergeArray(s,a)}get element(){return this._def.type}min(t,e){return new xi({...this._def,minLength:{value:t,message:It.toString(e)}})}max(t,e){return new xi({...this._def,maxLength:{value:t,message:It.toString(e)}})}length(t,e){return new xi({...this._def,exactLength:{value:t,message:It.toString(e)}})}nonempty(t){return this.min(1,t)}}xi.create=(n,t)=>new xi({type:n,minLength:null,maxLength:null,exactLength:null,typeName:Bt.ZodArray,...qt(t)});function ic(n){if(n instanceof on){const t={};for(const e in n.shape){const s=n.shape[e];t[e]=da.create(ic(s))}return new on({...n._def,shape:()=>t})}else return n instanceof xi?new xi({...n._def,type:ic(n.element)}):n instanceof da?da.create(ic(n.unwrap())):n instanceof Lc?Lc.create(ic(n.unwrap())):n instanceof Xo?Xo.create(n.items.map(t=>ic(t))):n}class on extends ee{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),e=ie.objectKeys(t);return this._cached={shape:t,keys:e},this._cached}_parse(t){if(this._getType(t)!==St.object){const f=this._getOrReturnCtx(t);return Et(f,{code:ft.invalid_type,expected:St.object,received:f.parsedType}),Lt}const{status:s,ctx:i}=this._processInputParams(t),{shape:a,keys:l}=this._getCached(),u=[];if(!(this._def.catchall instanceof Aa&&this._def.unknownKeys==="strip"))for(const f in i.data)l.includes(f)||u.push(f);const h=[];for(const f of l){const m=a[f],_=i.data[f];h.push({key:{status:"valid",value:f},value:m._parse(new Sa(i,_,i.path,f)),alwaysSet:f in i.data})}if(this._def.catchall instanceof Aa){const f=this._def.unknownKeys;if(f==="passthrough")for(const m of u)h.push({key:{status:"valid",value:m},value:{status:"valid",value:i.data[m]}});else if(f==="strict")u.length>0&&(Et(i,{code:ft.unrecognized_keys,keys:u}),s.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const m of u){const _=i.data[m];h.push({key:{status:"valid",value:m},value:f._parse(new Sa(i,_,i.path,m)),alwaysSet:m in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const f=[];for(const m of h){const _=await m.key,x=await m.value;f.push({key:_,value:x,alwaysSet:m.alwaysSet})}return f}).then(f=>ps.mergeObjectSync(s,f)):ps.mergeObjectSync(s,h)}get shape(){return this._def.shape()}strict(t){return It.errToObj,new on({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(e,s)=>{var a,l;const i=((l=(a=this._def).errorMap)==null?void 0:l.call(a,e,s).message)??s.defaultError;return e.code==="unrecognized_keys"?{message:It.errToObj(t).message??i}:{message:i}}}:{}})}strip(){return new on({...this._def,unknownKeys:"strip"})}passthrough(){return new on({...this._def,unknownKeys:"passthrough"})}extend(t){return new on({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new on({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Bt.ZodObject})}setKey(t,e){return this.augment({[t]:e})}catchall(t){return new on({...this._def,catchall:t})}pick(t){const e={};for(const s of ie.objectKeys(t))t[s]&&this.shape[s]&&(e[s]=this.shape[s]);return new on({...this._def,shape:()=>e})}omit(t){const e={};for(const s of ie.objectKeys(this.shape))t[s]||(e[s]=this.shape[s]);return new on({...this._def,shape:()=>e})}deepPartial(){return ic(this)}partial(t){const e={};for(const s of ie.objectKeys(this.shape)){const i=this.shape[s];t&&!t[s]?e[s]=i:e[s]=i.optional()}return new on({...this._def,shape:()=>e})}required(t){const e={};for(const s of ie.objectKeys(this.shape))if(t&&!t[s])e[s]=this.shape[s];else{let a=this.shape[s];for(;a instanceof da;)a=a._def.innerType;e[s]=a}return new on({...this._def,shape:()=>e})}keyof(){return yN(ie.objectKeys(this.shape))}}on.create=(n,t)=>new on({shape:()=>n,unknownKeys:"strip",catchall:Aa.create(),typeName:Bt.ZodObject,...qt(t)});on.strictCreate=(n,t)=>new on({shape:()=>n,unknownKeys:"strict",catchall:Aa.create(),typeName:Bt.ZodObject,...qt(t)});on.lazycreate=(n,t)=>new on({shape:n,unknownKeys:"strip",catchall:Aa.create(),typeName:Bt.ZodObject,...qt(t)});class _g extends ee{_parse(t){const{ctx:e}=this._processInputParams(t),s=this._def.options;function i(a){for(const u of a)if(u.result.status==="valid")return u.result;for(const u of a)if(u.result.status==="dirty")return e.common.issues.push(...u.ctx.common.issues),u.result;const l=a.map(u=>new ir(u.ctx.common.issues));return Et(e,{code:ft.invalid_union,unionErrors:l}),Lt}if(e.common.async)return Promise.all(s.map(async a=>{const l={...e,common:{...e.common,issues:[]},parent:null};return{result:await a._parseAsync({data:e.data,path:e.path,parent:l}),ctx:l}})).then(i);{let a;const l=[];for(const h of s){const f={...e,common:{...e.common,issues:[]},parent:null},m=h._parseSync({data:e.data,path:e.path,parent:f});if(m.status==="valid")return m;m.status==="dirty"&&!a&&(a={result:m,ctx:f}),f.common.issues.length&&l.push(f.common.issues)}if(a)return e.common.issues.push(...a.ctx.common.issues),a.result;const u=l.map(h=>new ir(h));return Et(e,{code:ft.invalid_union,unionErrors:u}),Lt}}get options(){return this._def.options}}_g.create=(n,t)=>new _g({options:n,typeName:Bt.ZodUnion,...qt(t)});function k0(n,t){const e=Jr(n),s=Jr(t);if(n===t)return{valid:!0,data:n};if(e===St.object&&s===St.object){const i=ie.objectKeys(t),a=ie.objectKeys(n).filter(u=>i.indexOf(u)!==-1),l={...n,...t};for(const u of a){const h=k0(n[u],t[u]);if(!h.valid)return{valid:!1};l[u]=h.data}return{valid:!0,data:l}}else if(e===St.array&&s===St.array){if(n.length!==t.length)return{valid:!1};const i=[];for(let a=0;a<n.length;a++){const l=n[a],u=t[a],h=k0(l,u);if(!h.valid)return{valid:!1};i.push(h.data)}return{valid:!0,data:i}}else return e===St.date&&s===St.date&&+n==+t?{valid:!0,data:n}:{valid:!1}}class yg extends ee{_parse(t){const{status:e,ctx:s}=this._processInputParams(t),i=(a,l)=>{if(eA(a)||eA(l))return Lt;const u=k0(a.value,l.value);return u.valid?((nA(a)||nA(l))&&e.dirty(),{status:e.value,value:u.data}):(Et(s,{code:ft.invalid_intersection_types}),Lt)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([a,l])=>i(a,l)):i(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}yg.create=(n,t,e)=>new yg({left:n,right:t,typeName:Bt.ZodIntersection,...qt(e)});class Xo extends ee{_parse(t){const{status:e,ctx:s}=this._processInputParams(t);if(s.parsedType!==St.array)return Et(s,{code:ft.invalid_type,expected:St.array,received:s.parsedType}),Lt;if(s.data.length<this._def.items.length)return Et(s,{code:ft.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Lt;!this._def.rest&&s.data.length>this._def.items.length&&(Et(s,{code:ft.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),e.dirty());const a=[...s.data].map((l,u)=>{const h=this._def.items[u]||this._def.rest;return h?h._parse(new Sa(s,l,s.path,u)):null}).filter(l=>!!l);return s.common.async?Promise.all(a).then(l=>ps.mergeArray(e,l)):ps.mergeArray(e,a)}get items(){return this._def.items}rest(t){return new Xo({...this._def,rest:t})}}Xo.create=(n,t)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Xo({items:n,typeName:Bt.ZodTuple,rest:null,...qt(t)})};class hA extends ee{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:e,ctx:s}=this._processInputParams(t);if(s.parsedType!==St.map)return Et(s,{code:ft.invalid_type,expected:St.map,received:s.parsedType}),Lt;const i=this._def.keyType,a=this._def.valueType,l=[...s.data.entries()].map(([u,h],f)=>({key:i._parse(new Sa(s,u,s.path,[f,"key"])),value:a._parse(new Sa(s,h,s.path,[f,"value"]))}));if(s.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const h of l){const f=await h.key,m=await h.value;if(f.status==="aborted"||m.status==="aborted")return Lt;(f.status==="dirty"||m.status==="dirty")&&e.dirty(),u.set(f.value,m.value)}return{status:e.value,value:u}})}else{const u=new Map;for(const h of l){const f=h.key,m=h.value;if(f.status==="aborted"||m.status==="aborted")return Lt;(f.status==="dirty"||m.status==="dirty")&&e.dirty(),u.set(f.value,m.value)}return{status:e.value,value:u}}}}hA.create=(n,t,e)=>new hA({valueType:t,keyType:n,typeName:Bt.ZodMap,...qt(e)});class dd extends ee{_parse(t){const{status:e,ctx:s}=this._processInputParams(t);if(s.parsedType!==St.set)return Et(s,{code:ft.invalid_type,expected:St.set,received:s.parsedType}),Lt;const i=this._def;i.minSize!==null&&s.data.size<i.minSize.value&&(Et(s,{code:ft.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),e.dirty()),i.maxSize!==null&&s.data.size>i.maxSize.value&&(Et(s,{code:ft.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),e.dirty());const a=this._def.valueType;function l(h){const f=new Set;for(const m of h){if(m.status==="aborted")return Lt;m.status==="dirty"&&e.dirty(),f.add(m.value)}return{status:e.value,value:f}}const u=[...s.data.values()].map((h,f)=>a._parse(new Sa(s,h,s.path,f)));return s.common.async?Promise.all(u).then(h=>l(h)):l(u)}min(t,e){return new dd({...this._def,minSize:{value:t,message:It.toString(e)}})}max(t,e){return new dd({...this._def,maxSize:{value:t,message:It.toString(e)}})}size(t,e){return this.min(t,e).max(t,e)}nonempty(t){return this.min(1,t)}}dd.create=(n,t)=>new dd({valueType:n,minSize:null,maxSize:null,typeName:Bt.ZodSet,...qt(t)});class dA extends ee{get schema(){return this._def.getter()}_parse(t){const{ctx:e}=this._processInputParams(t);return this._def.getter()._parse({data:e.data,path:e.path,parent:e})}}dA.create=(n,t)=>new dA({getter:n,typeName:Bt.ZodLazy,...qt(t)});class fA extends ee{_parse(t){if(t.data!==this._def.value){const e=this._getOrReturnCtx(t);return Et(e,{received:e.data,code:ft.invalid_literal,expected:this._def.value}),Lt}return{status:"valid",value:t.data}}get value(){return this._def.value}}fA.create=(n,t)=>new fA({value:n,typeName:Bt.ZodLiteral,...qt(t)});function yN(n,t){return new Vc({values:n,typeName:Bt.ZodEnum,...qt(t)})}class Vc extends ee{_parse(t){if(typeof t.data!="string"){const e=this._getOrReturnCtx(t),s=this._def.values;return Et(e,{expected:ie.joinValues(s),received:e.parsedType,code:ft.invalid_type}),Lt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const e=this._getOrReturnCtx(t),s=this._def.values;return Et(e,{received:e.data,code:ft.invalid_enum_value,options:s}),Lt}return Ms(t.data)}get options(){return this._def.values}get enum(){const t={};for(const e of this._def.values)t[e]=e;return t}get Values(){const t={};for(const e of this._def.values)t[e]=e;return t}get Enum(){const t={};for(const e of this._def.values)t[e]=e;return t}extract(t,e=this._def){return Vc.create(t,{...this._def,...e})}exclude(t,e=this._def){return Vc.create(this.options.filter(s=>!t.includes(s)),{...this._def,...e})}}Vc.create=yN;class mA extends ee{_parse(t){const e=ie.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(t);if(s.parsedType!==St.string&&s.parsedType!==St.number){const i=ie.objectValues(e);return Et(s,{expected:ie.joinValues(i),received:s.parsedType,code:ft.invalid_type}),Lt}if(this._cache||(this._cache=new Set(ie.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const i=ie.objectValues(e);return Et(s,{received:s.data,code:ft.invalid_enum_value,options:i}),Lt}return Ms(t.data)}get enum(){return this._def.values}}mA.create=(n,t)=>new mA({values:n,typeName:Bt.ZodNativeEnum,...qt(t)});class bg extends ee{unwrap(){return this._def.type}_parse(t){const{ctx:e}=this._processInputParams(t);if(e.parsedType!==St.promise&&e.common.async===!1)return Et(e,{code:ft.invalid_type,expected:St.promise,received:e.parsedType}),Lt;const s=e.parsedType===St.promise?e.data:Promise.resolve(e.data);return Ms(s.then(i=>this._def.type.parseAsync(i,{path:e.path,errorMap:e.common.contextualErrorMap})))}}bg.create=(n,t)=>new bg({type:n,typeName:Bt.ZodPromise,...qt(t)});class Pc extends ee{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Bt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:e,ctx:s}=this._processInputParams(t),i=this._def.effect||null,a={addIssue:l=>{Et(s,l),l.fatal?e.abort():e.dirty()},get path(){return s.path}};if(a.addIssue=a.addIssue.bind(a),i.type==="preprocess"){const l=i.transform(s.data,a);if(s.common.async)return Promise.resolve(l).then(async u=>{if(e.value==="aborted")return Lt;const h=await this._def.schema._parseAsync({data:u,path:s.path,parent:s});return h.status==="aborted"?Lt:h.status==="dirty"||e.value==="dirty"?vh(h.value):h});{if(e.value==="aborted")return Lt;const u=this._def.schema._parseSync({data:l,path:s.path,parent:s});return u.status==="aborted"?Lt:u.status==="dirty"||e.value==="dirty"?vh(u.value):u}}if(i.type==="refinement"){const l=u=>{const h=i.refinement(u,a);if(s.common.async)return Promise.resolve(h);if(h instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(s.common.async===!1){const u=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return u.status==="aborted"?Lt:(u.status==="dirty"&&e.dirty(),l(u.value),{status:e.value,value:u.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(u=>u.status==="aborted"?Lt:(u.status==="dirty"&&e.dirty(),l(u.value).then(()=>({status:e.value,value:u.value}))))}if(i.type==="transform")if(s.common.async===!1){const l=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!kc(l))return Lt;const u=i.transform(l.value,a);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:e.value,value:u}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(l=>kc(l)?Promise.resolve(i.transform(l.value,a)).then(u=>({status:e.value,value:u})):Lt);ie.assertNever(i)}}Pc.create=(n,t,e)=>new Pc({schema:n,typeName:Bt.ZodEffects,effect:t,...qt(e)});Pc.createWithPreprocess=(n,t,e)=>new Pc({schema:t,effect:{type:"preprocess",transform:n},typeName:Bt.ZodEffects,...qt(e)});class da extends ee{_parse(t){return this._getType(t)===St.undefined?Ms(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}da.create=(n,t)=>new da({innerType:n,typeName:Bt.ZodOptional,...qt(t)});class Lc extends ee{_parse(t){return this._getType(t)===St.null?Ms(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Lc.create=(n,t)=>new Lc({innerType:n,typeName:Bt.ZodNullable,...qt(t)});class V0 extends ee{_parse(t){const{ctx:e}=this._processInputParams(t);let s=e.data;return e.parsedType===St.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:e.path,parent:e})}removeDefault(){return this._def.innerType}}V0.create=(n,t)=>new V0({innerType:n,typeName:Bt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...qt(t)});class P0 extends ee{_parse(t){const{ctx:e}=this._processInputParams(t),s={...e,common:{...e.common,issues:[]}},i=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return gg(i)?i.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new ir(s.common.issues)},input:s.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ir(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}P0.create=(n,t)=>new P0({innerType:n,typeName:Bt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...qt(t)});class gA extends ee{_parse(t){if(this._getType(t)!==St.nan){const s=this._getOrReturnCtx(t);return Et(s,{code:ft.invalid_type,expected:St.nan,received:s.parsedType}),Lt}return{status:"valid",value:t.data}}}gA.create=n=>new gA({typeName:Bt.ZodNaN,...qt(n)});class MB extends ee{_parse(t){const{ctx:e}=this._processInputParams(t),s=e.data;return this._def.type._parse({data:s,path:e.path,parent:e})}unwrap(){return this._def.type}}class vx extends ee{_parse(t){const{status:e,ctx:s}=this._processInputParams(t);if(s.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return a.status==="aborted"?Lt:a.status==="dirty"?(e.dirty(),vh(a.value)):this._def.out._parseAsync({data:a.value,path:s.path,parent:s})})();{const i=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?Lt:i.status==="dirty"?(e.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:s.path,parent:s})}}static create(t,e){return new vx({in:t,out:e,typeName:Bt.ZodPipeline})}}class L0 extends ee{_parse(t){const e=this._def.innerType._parse(t),s=i=>(kc(i)&&(i.value=Object.freeze(i.value)),i);return gg(e)?e.then(i=>s(i)):s(e)}unwrap(){return this._def.innerType}}L0.create=(n,t)=>new L0({innerType:n,typeName:Bt.ZodReadonly,...qt(t)});var Bt;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(Bt||(Bt={}));Aa.create;const OB=xi.create,kB=_g.create;yg.create;Xo.create;const VB=Vc.create;bg.create;da.create;Lc.create;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var pA;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(pA||(pA={}));var _A;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(_A||(_A={}));var yA;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(yA||(yA={}));var bA;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(bA||(bA={}));var xA;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(xA||(xA={}));var vA;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT"})(vA||(vA={}));var EA;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(EA||(EA={}));var TA;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(TA||(TA={}));var wA;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY"})(wA||(wA={}));var SA;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(SA||(SA={}));var AA;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(AA||(AA={}));var IA;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(IA||(IA={}));var RA;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(RA||(RA={}));var DA;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(DA||(DA={}));var NA;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(NA||(NA={}));var CA;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(CA||(CA={}));var MA;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(MA||(MA={}));var OA;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(OA||(OA={}));var kA;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(kA||(kA={}));var VA;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(VA||(VA={}));var PA;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(PA||(PA={}));var LA;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(LA||(LA={}));var jA;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(jA||(jA={}));var BA;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(BA||(BA={}));var FA;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi"})(FA||(FA={}));var UA;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(UA||(UA={}));var zA;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(zA||(zA={}));var HA;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(HA||(HA={}));var qA;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(qA||(qA={}));var GA;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(GA||(GA={}));var $A;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})($A||($A={}));var WA;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(WA||(WA={}));var YA;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(YA||(YA={}));var KA;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(KA||(KA={}));var QA;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(QA||(QA={}));var XA;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(XA||(XA={}));var ZA;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(ZA||(ZA={}));var JA;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(JA||(JA={}));var t2;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY"})(t2||(t2={}));var e2;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(e2||(e2={}));const n2=VB(["string","number","integer","object","array","boolean","null"]);kB([n2,OB(n2)]);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var s2;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(s2||(s2={}));const PB=({text:n})=>{const t=n.split(/(\*\*.*?\*\*)/g);return y.jsx(y.Fragment,{children:t.map((e,s)=>e.startsWith("**")&&e.endsWith("**")?y.jsx("strong",{children:e.slice(2,-2)},s):e)})},LB=({isOpen:n,onClose:t,assetAccounts:e,cashflowRecords:s,budgets:i,goals:a})=>{const[l,u]=ut.useState([]),[h,f]=ut.useState(""),[m,_]=ut.useState(!1),x=ut.useRef(null),E=ut.useRef(null);ut.useEffect(()=>{if(n&&(setTimeout(()=>{var T;return(T=E.current)==null?void 0:T.focus()},100),l.length===0)){const T=e.reduce((M,L)=>M+(L.assets||[]).reduce((O,H)=>O+(H.currentValueTWD||0),0),0);let R="你好！我是您的個人財務助理 Navi。請問有什麼可以為您服務的嗎？";T>0?R=`你好！我是 Navi。我注意到您目前的總資產約為 **$${T.toLocaleString(void 0,{maximumFractionDigits:0})}**。

您可以問我：
* "分析我的資產配置"
* "我上個月的開銷如何？"
* "給我一些儲蓄建議"`:R=`你好！我是您的個人財務助理 Navi。很高興為您服務！

您可以從記錄您的第一筆資產或收支開始，然後向我提問以獲得財務建議。`,u([{role:"model",content:R}])}},[n,l.length,e]),ut.useEffect(()=>{var T;(T=x.current)==null||T.scrollIntoView({behavior:"smooth"})},[l,m]);const S=async T=>{if(T.preventDefault(),!h.trim()||m)return;const R={role:"user",content:h};u(M=>[...M,R]),f(""),_(!0);{setTimeout(()=>{const M={role:"model",content:"AI 助理未設定 API 金鑰，目前無法使用。"};u(L=>[...L,M]),_(!1)},500);return}};return n?y.jsxs("div",{className:"fixed bottom-6 right-6 w-full max-w-md h-[70vh] max-h-[600px] bg-white rounded-2xl shadow-2xl flex flex-col z-50 transition-all duration-300 ease-in-out transform origin-bottom-right",children:[y.jsxs("header",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-blue-600 to-indigo-700 text-white rounded-t-2xl shadow-md",children:[y.jsx("h3",{className:"text-lg font-bold",children:"AI 財務助理"}),y.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-white/20 transition-colors","aria-label":"Close chat",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),y.jsx("div",{className:"flex-1 p-4 overflow-y-auto bg-gray-50",children:y.jsxs("div",{className:"space-y-4",children:[l.map((T,R)=>y.jsx("div",{className:`flex ${T.role==="user"?"justify-end":"justify-start"}`,children:y.jsx("div",{className:`max-w-xs md:max-w-sm px-4 py-2 rounded-2xl shadow ${T.role==="user"?"bg-blue-500 text-white":"bg-gray-200 text-gray-800"}`,children:y.jsx("div",{className:"text-sm whitespace-pre-wrap",children:y.jsx(PB,{text:T.content})})})},R)),m&&y.jsx("div",{className:"flex justify-start",children:y.jsx("div",{className:"max-w-xs md:max-w-sm px-4 py-2 rounded-2xl shadow bg-gray-200 text-gray-800",children:y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-pulse"}),y.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-pulse delay-75"}),y.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-pulse delay-150"})]})})}),y.jsx("div",{ref:x})]})}),y.jsx("form",{onSubmit:S,className:"p-4 border-t border-gray-200 bg-white rounded-b-2xl",children:y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx("input",{ref:E,type:"text",value:h,onChange:T=>f(T.target.value),placeholder:"請在這裡輸入您的問題...",className:"flex-1 w-full px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:m,autoComplete:"off"}),y.jsx("button",{type:"submit",className:"bg-blue-600 text-white p-3 rounded-full hover:bg-blue-700 disabled:bg-blue-300 transition-colors shadow",disabled:m||!h.trim(),children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 transform rotate-90",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})]}):null},jB=(n,t,e)=>{const[s,i]=ut.useState([]),[a,l]=ut.useState([]),[u,h]=ut.useState([]),[f,m]=ut.useState([]),[_,x]=ut.useState({customIncome:[],customExpense:[],manualRate:null,lastRecurringCheck:null});return ut.useEffect(()=>{if(!n||!t||!e){i([]),l([]),h([]),m([]),x({customIncome:[],customExpense:[],manualRate:null,lastRecurringCheck:null});return}const E=`artifacts/${e}/users/${t}`,S=n.collection(`${E}/assetAccounts`).onSnapshot(O=>{i(O.docs.map(H=>({id:H.id,...H.data()})))}),T=n.collection(`${E}/cashflowRecords`).orderBy("date","desc").onSnapshot(O=>{l(O.docs.map(H=>({id:H.id,...H.data()})))}),R=n.collection(`${E}/budgets`).onSnapshot(O=>{h(O.docs.map(H=>({id:H.id,...H.data()})))}),M=n.collection(`${E}/goals`).orderBy("targetDate","asc").onSnapshot(O=>{m(O.docs.map(H=>({id:H.id,...H.data()})))}),L=n.doc(`${E}/settings/userSettings`).onSnapshot(O=>{O.exists?x(O.data()):x({customIncome:[],customExpense:[],manualRate:null,lastRecurringCheck:null})});return()=>{S(),T(),R(),M(),L()}},[n,t,e]),{assetAccounts:s,cashflowRecords:a,budgets:u,goals:f,settings:_}},BB=async(n,t,e,s,i)=>{const a=n.doc(`artifacts/${i}/users/${t}/settings/userSettings`),l=new Date,u=s.lastRecurringCheck?new Date(s.lastRecurringCheck):new Date(l.getFullYear(),l.getMonth(),0);if(u.getMonth()===l.getMonth()&&u.getFullYear()===l.getFullYear())return!1;const h=e.filter(_=>_.isRecurring&&_.recurrenceDay);if(h.length===0)return await a.set({lastRecurringCheck:l.toISOString()},{merge:!0}),!1;let f=!1;const m=n.collection(`artifacts/${i}/users/${t}/cashflowRecords`);for(const _ of h){const x=Number(_.recurrenceDay);if(isNaN(x)||x<1||x>31)continue;const E=new Date(l.getFullYear(),l.getMonth()+1,0).getDate(),S=Math.min(x,E),T=new Date(l.getFullYear(),l.getMonth(),S).toISOString().slice(0,10);if(!e.some(M=>{var L;return M.date.startsWith(l.toISOString().slice(0,7))&&((L=M.description)==null?void 0:L.includes(_.description))&&M.amount===_.amount&&M.category===_.category})){const{id:M,isRecurring:L,recurrenceDay:O,...H}=_,B={...H,isRecurring:!1,date:T,description:_.description?`${_.description} (定額)`:"(定額)"};await m.add(B),f=!0}}return await a.set({lastRecurringCheck:l.toISOString()},{merge:!0}),f},FB={apiKey:"AIzaSyC_placeholder_api_key",authDomain:"placeholder-project.firebaseapp.com",projectId:"placeholder-project",storageBucket:"placeholder-project.appspot.com",messagingSenderId:"123456789012",appId:"1:123456789012:web:abcdef1234567890abcdef"},UB="test-user-123",zB="finance-dashboard-v1",HB=()=>{const[n,t]=ut.useState("dashboard"),[e,s]=ut.useState({message:"",type:"info",show:!1}),[i,a]=ut.useState(null),[l,u]=ut.useState(32.5),[h,f]=ut.useState(!1),m=ut.useCallback((B,z)=>{s({message:B,type:z,show:!0}),setTimeout(()=>{s({message:"",type:"info",show:!1})},3e3)},[]);ut.useEffect(()=>{try{Th.apps.length||Th.initializeApp(FB);const B=Th.firestore();B.disableNetwork().then(()=>{console.log("Firestore network disabled. Running in offline mode."),a(B)}).catch(z=>{console.error("Failed to disable Firestore network, may see connection errors:",z),a(B)})}catch(B){console.error("Firebase initialization failed:",B),m("Firebase initialization failed. Please check your configuration.","error")}},[m]),ut.useEffect(()=>{const B=setTimeout(()=>u(32.8),2e3);return()=>clearTimeout(B)},[]);const _=UB,x=zB,{assetAccounts:E,cashflowRecords:S,budgets:T,goals:R,settings:M}=jB(i,_,x);ut.useEffect(()=>{i&&_&&M&&BB(i,_,S,M,x).then(B=>{B&&m("定額收支項目已自動建立。","info")}).catch(B=>{console.error("Error checking recurring transactions:",B),m("檢查定額項目時發生錯誤。","error")})},[i,_,S,M,x,m]);const L=M.manualRate||l,O=j9(E,L),H=()=>{if(!i)return y.jsxs("div",{className:"fixed inset-0 bg-gray-100 flex flex-col items-center justify-center z-50",children:[y.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-600"}),y.jsx("p",{className:"text-xl text-gray-700 mt-6 font-semibold",children:"正在連接您的財務數據庫..."}),y.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"請稍候，正在準備您的個人財務導航中心。"})]});switch(n){case"dashboard":return y.jsx(JS,{userId:_,assetAccounts:O,cashflowRecords:S});case"data-manager":return y.jsx(K9,{userId:_,db:i,assetAccounts:E,cashflowRecords:S,budgets:T,goals:R,settings:M,setNotification:B=>m(B.message,B.type),appId:x,effectiveUsdToTwdRate:L});case"asset-management":return y.jsx(X9,{assetAccounts:O});case"cashflow-management":return y.jsx(J9,{cashflowRecords:S});case"budget-missions":return y.jsx(tB,{db:i,userId:_,appId:x,cashflowRecords:S,budgets:T,settings:M,setNotification:B=>m(B.message,B.type)});case"investment-tracking":return y.jsx(nB,{assetAccounts:O});case"financial-goals":return y.jsx(iB,{goals:R,assetAccounts:E,cashflowRecords:S});case"report-analysis":return y.jsx(aB,{assetAccounts:O,cashflowRecords:S});default:return y.jsx(JS,{userId:_,assetAccounts:O,cashflowRecords:S})}};return y.jsxs("div",{className:"flex flex-col min-h-screen font-sans",children:[y.jsx(IL,{currentPage:n,setCurrentPage:t}),y.jsx("div",{className:"bg-blue-100 border-b border-blue-200 text-blue-800 text-center py-2 px-4 text-sm font-semibold shadow-inner z-30",children:y.jsxs("div",{className:"container mx-auto flex items-center justify-center",children:[y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),y.jsx("span",{children:"Offline Mode: The application is running locally and data is not synced with a server."})]})}),y.jsx("main",{className:"flex-grow container mx-auto p-6 md:p-8",children:H()}),y.jsx(DL,{notification:e}),y.jsx(RL,{}),y.jsx(LB,{isOpen:h,onClose:()=>f(!1),assetAccounts:O,cashflowRecords:S,budgets:T,goals:R}),!h&&y.jsx("button",{onClick:()=>f(!0),className:"fixed bottom-6 right-6 bg-gradient-to-r from-blue-600 to-indigo-700 text-white w-16 h-16 rounded-full shadow-2xl flex items-center justify-center transform hover:scale-110 transition-transform duration-300 ease-in-out focus:outline-none focus:ring-4 focus:ring-blue-300","aria-label":"Open AI Assistant",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})})]})},bN=document.getElementById("root");if(!bN)throw new Error("Could not find root element to mount to");const qB=aM.createRoot(bN);qB.render(y.jsx(ZC.StrictMode,{children:y.jsx(HB,{})}));
